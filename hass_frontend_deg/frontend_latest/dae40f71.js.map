{"version":3,"file":"dae40f71.js","mappings":";AAqMA;AAEA;AACA;AAEA;AACA;AAIA;AAkCA;AACA;AACA;AAIA;;;;;;;;;;;;;;;;AA8JA;;AAkBA;;AAQA;;;;;;AAYA;;AAKA;;;;;AA/KA;;;;;AAOA;AAGA;;;;;AAOA;AAGA;;;;;AAOA;;;;;AAOA;AAGA;;;;;;;;;AAWA;AAGA;;;;;;;;;;;;;;;;;AAmBA;AAGA;;;;;;;;;AAWA;AAGA;;;;;;;;;AAWA;AAGA;;;;;;;;;;;;;AAeA;AAGA;;;;;AAOA;AAkDA;;;AAOA;;AAJA;;ACzTA;;AAKA;;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;;AAIA;;;AAIA;AAKA;AAGA;AACA;AACA;;AAQA;AAEA;AAGA;AAEA;AAKA;AAEA;;AA/JA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;ACgFA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AApGA;;;;;;;;;;;;;;;AAAA;;AC6JA;AAGA;;;AAKA;;;AAIA;;AAEA;AAEA;;AAEA;;AAIA;AACA;;AALA;;AAfA;;AA8BA;;;AAKA;;AA3CA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzEA;;AAKA;AAQA;;AAEA;;;AAGA;AACA;AACA;AAMA;;;;;;AAMA;AAcA;;AAGA;;AAKA;;AAGA;;AA7HA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;ACiHA;AACA;AACA;;;AArHA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AA8NA;;AAGA;;AAEA;AAEA;AAEA;AAIA;AAEA;AAIA;;;AAKA;AACA;AACA;AAIA;;AAIA;AAGA;;AAGA;AACA;AACA;AACA;AACA;;AAIA;AAEA;;AAGA;;AAeA;AACA;;;AAGA;;AAbA;AACA;AACA;;;;;AAkBA;;AA7SA;;;;ACjCA;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8GA;;AC1BA;;AAKA;;;;AASA;;AAIA;;;;;;;;;;AAUA;AACA;AACA;AACA;AACA;;;AAOA;AAKA;AACA;AAIA;AACA;;;;AAOA;AACA;;;;;;AAMA;AACA;;AAGA;;AAMA;AAEA;;;;AApIA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AC0CA;AAGA;AAPA;;;;;;;;;;;;;AAzDA;;AC8FA;;AAKA;;AAeA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAIA;;;;;;;;;AASA;;AAQA;;;;AAQA;;;;AAIA;AAQA;AAGA;AAGA;AAEA;AAIA;AAIA;AAGA;AAGA;AAEA;;;;;;;;AAYA;AASA;;AAKA;AAGA;;;;AAQA;;AAEA;;;;AAMA;;AAIA;;;;;;;AAOA;;AAEA;;;;AAIA;;AAEA;;AAKA;;;;AAtNA;;AAgXA;AACA;AACA;;AAEA;AACA;;;AATA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA5WA;;ACoGA;;AAKA;AAEA;AACA;;AASA;;AAuCA;AACA;AAIA;;AAIA;;;AAIA;;;AAIA;;;;;;;;AAQA;;AAMA;;AAEA;;;;;AAKA;AAIA;;;;AAIA;AAEA;;;AAKA;;AAIA;AAIA;AAQA;AAMA;;AAKA;;;;;AAMA;AAEA;;AAGA;;;AAIA;AAEA;;AAKA;;AAMA;AAGA;AAIA;AAEA;;;AAMA;;AAGA;;AAOA;AAEA;;AAIA;;AAKA;AAEA;;AAGA;;AAEA;;;;AAMA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AApUA;;ACHA;AAGA;AAIA;;AAZA;;;;;;;;;;;AC/BA;;;;AAAA","sources":["webpack://home-assistant-frontend/./src/data/weather.ts","webpack://home-assistant-frontend/./src/panels/lovelace/cards/hui-button-card.ts","webpack://home-assistant-frontend/./src/panels/lovelace/cards/hui-calendar-card.ts","webpack://home-assistant-frontend/./src/panels/lovelace/cards/hui-entities-card.ts","webpack://home-assistant-frontend/./src/panels/lovelace/cards/hui-entity-card.ts","webpack://home-assistant-frontend/./src/panels/lovelace/cards/hui-glance-card.ts","webpack://home-assistant-frontend/./src/panels/lovelace/cards/hui-grid-card.ts","webpack://home-assistant-frontend/./src/panels/lovelace/cards/hui-light-card.ts","webpack://home-assistant-frontend/./src/panels/lovelace/cards/hui-stack-card.ts","webpack://home-assistant-frontend/./src/panels/lovelace/cards/hui-thermostat-card.ts","webpack://home-assistant-frontend/./src/panels/lovelace/cards/hui-weather-forecast-card.ts","webpack://home-assistant-frontend/./src/panels/lovelace/components/hui-entities-toggle.ts","webpack://home-assistant-frontend/./src/panels/lovelace/components/hui-warning-element.ts"],"sourcesContent":["import {\n  mdiAlertCircleOutline,\n  mdiGauge,\n  mdiWaterPercent,\n  mdiWeatherFog,\n  mdiWeatherRainy,\n  mdiWeatherWindy,\n} from \"@mdi/js\";\nimport {\n  HassEntityAttributeBase,\n  HassEntityBase,\n} from \"home-assistant-js-websocket\";\nimport { css, html, svg, SVGTemplateResult, TemplateResult } from \"lit\";\nimport { styleMap } from \"lit/directives/style-map\";\nimport { formatNumber } from \"../common/number/format_number\";\nimport \"../components/ha-svg-icon\";\nimport type { HomeAssistant } from \"../types\";\n\ninterface ForecastAttribute {\n  temperature: number;\n  datetime: string;\n  templow?: number;\n  precipitation?: number;\n  precipitation_probability?: number;\n  humidity?: number;\n  condition?: string;\n  daytime?: boolean;\n}\n\ninterface WeatherEntityAttributes extends HassEntityAttributeBase {\n  temperature: number;\n  humidity?: number;\n  forecast?: ForecastAttribute[];\n  wind_speed: string;\n  wind_bearing: string;\n}\n\nexport interface WeatherEntity extends HassEntityBase {\n  attributes: WeatherEntityAttributes;\n}\n\nexport const weatherSVGs = new Set<string>([\n  \"clear-night\",\n  \"cloudy\",\n  \"fog\",\n  \"lightning\",\n  \"lightning-rainy\",\n  \"partlycloudy\",\n  \"pouring\",\n  \"rainy\",\n  \"hail\",\n  \"snowy\",\n  \"snowy-rainy\",\n  \"sunny\",\n  \"windy\",\n  \"windy-variant\",\n]);\n\nexport const weatherIcons = {\n  exceptional: mdiAlertCircleOutline,\n};\n\nexport const weatherAttrIcons = {\n  humidity: mdiWaterPercent,\n  wind_bearing: mdiWeatherWindy,\n  wind_speed: mdiWeatherWindy,\n  pressure: mdiGauge,\n  visibility: mdiWeatherFog,\n  precipitation: mdiWeatherRainy,\n};\n\nconst cloudyStates = new Set<string>([\n  \"partlycloudy\",\n  \"cloudy\",\n  \"fog\",\n  \"windy\",\n  \"windy-variant\",\n  \"hail\",\n  \"rainy\",\n  \"snowy\",\n  \"snowy-rainy\",\n  \"pouring\",\n  \"lightning\",\n  \"lightning-rainy\",\n]);\n\nconst rainStates = new Set<string>([\"hail\", \"rainy\", \"pouring\"]);\n\nconst windyStates = new Set<string>([\"windy\", \"windy-variant\"]);\n\nconst snowyStates = new Set<string>([\"snowy\", \"snowy-rainy\"]);\n\nconst lightningStates = new Set<string>([\"lightning\", \"lightning-rainy\"]);\n\nconst cardinalDirections = [\n  \"N\",\n  \"NNE\",\n  \"NE\",\n  \"ENE\",\n  \"E\",\n  \"ESE\",\n  \"SE\",\n  \"SSE\",\n  \"S\",\n  \"SSW\",\n  \"SW\",\n  \"WSW\",\n  \"W\",\n  \"WNW\",\n  \"NW\",\n  \"NNW\",\n  \"N\",\n];\n\nconst getWindBearingText = (degree: string): string => {\n  const degreenum = parseInt(degree, 10);\n  if (isFinite(degreenum)) {\n    // eslint-disable-next-line no-bitwise\n    return cardinalDirections[(((degreenum + 11.25) / 22.5) | 0) % 16];\n  }\n  return degree;\n};\n\nconst getWindBearing = (bearing: string): string => {\n  if (bearing != null) {\n    return getWindBearingText(bearing);\n  }\n  return \"\";\n};\n\nexport const getWind = (\n  hass: HomeAssistant,\n  speed: string,\n  bearing: string\n): string => {\n  const speedText = `${formatNumber(speed, hass.locale)} ${getWeatherUnit(\n    hass!,\n    \"wind_speed\"\n  )}`;\n  if (bearing !== null) {\n    const cardinalDirection = getWindBearing(bearing);\n    return `${speedText} (${\n      hass.localize(\n        `ui.card.weather.cardinal_direction.${cardinalDirection.toLowerCase()}`\n      ) || cardinalDirection\n    })`;\n  }\n  return speedText;\n};\n\nexport const getWeatherUnit = (\n  hass: HomeAssistant,\n  measure: string\n): string => {\n  switch (measure) {\n    case \"visibility\":\n      return hass.config.unit_system.length || \"\";\n    case \"precipitation\":\n      return hass.config.unit_system.accumulated_precipitation || \"\";\n    case \"humidity\":\n    case \"precipitation_probability\":\n      return \"%\";\n    default:\n      return hass.config.unit_system[measure] || \"\";\n  }\n};\n\nexport const getSecondaryWeatherAttribute = (\n  hass: HomeAssistant,\n  stateObj: WeatherEntity\n): TemplateResult | undefined => {\n  const extrema = getWeatherExtrema(hass, stateObj);\n\n  if (extrema) {\n    return extrema;\n  }\n\n  let value: number;\n  let attribute: string;\n\n  if (\n    stateObj.attributes.forecast?.length &&\n    stateObj.attributes.forecast[0].precipitation !== undefined &&\n    stateObj.attributes.forecast[0].precipitation !== null\n  ) {\n    value = stateObj.attributes.forecast[0].precipitation!;\n    attribute = \"precipitation\";\n  } else if (\"humidity\" in stateObj.attributes) {\n    value = stateObj.attributes.humidity!;\n    attribute = \"humidity\";\n  } else {\n    return undefined;\n  }\n\n  const weatherAttrIcon = weatherAttrIcons[attribute];\n\n  return html`\n    ${weatherAttrIcon\n      ? html`\n          <ha-svg-icon class=\"attr-icon\" .path=${weatherAttrIcon}></ha-svg-icon>\n        `\n      : hass!.localize(`ui.card.weather.attributes.${attribute}`)}\n    ${formatNumber(value, hass.locale, { maximumFractionDigits: 1 })}\n    ${getWeatherUnit(hass!, attribute)}\n  `;\n};\n\nconst getWeatherExtrema = (\n  hass: HomeAssistant,\n  stateObj: WeatherEntity\n): TemplateResult | undefined => {\n  if (!stateObj.attributes.forecast?.length) {\n    return undefined;\n  }\n\n  let tempLow: number | undefined;\n  let tempHigh: number | undefined;\n  const today = new Date().getDate();\n\n  for (const forecast of stateObj.attributes.forecast!) {\n    if (new Date(forecast.datetime).getDate() !== today) {\n      break;\n    }\n    if (!tempHigh || forecast.temperature > tempHigh) {\n      tempHigh = forecast.temperature;\n    }\n    if (!tempLow || (forecast.templow && forecast.templow < tempLow)) {\n      tempLow = forecast.templow;\n    }\n    if (!forecast.templow && (!tempLow || forecast.temperature < tempLow)) {\n      tempLow = forecast.temperature;\n    }\n  }\n\n  if (!tempLow && !tempHigh) {\n    return undefined;\n  }\n\n  const unit = getWeatherUnit(hass!, \"temperature\");\n\n  return html`\n    ${tempHigh ? `${formatNumber(tempHigh, hass.locale)} ${unit}` : \"\"}\n    ${tempLow && tempHigh ? \" / \" : \"\"}\n    ${tempLow ? `${formatNumber(tempLow, hass.locale)} ${unit}` : \"\"}\n  `;\n};\n\nexport const weatherSVGStyles = css`\n  .rain {\n    fill: var(--weather-icon-rain-color, #30b3ff);\n  }\n  .sun {\n    fill: var(--weather-icon-sun-color, #fdd93c);\n  }\n  .moon {\n    fill: var(--weather-icon-moon-color, #fcf497);\n  }\n  .cloud-back {\n    fill: var(--weather-icon-cloud-back-color, #d4d4d4);\n  }\n  .cloud-front {\n    fill: var(--weather-icon-cloud-front-color, #f9f9f9);\n  }\n`;\n\nconst getWeatherStateSVG = (\n  state: string,\n  nightTime?: boolean\n): SVGTemplateResult => svg`\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 17 17\"\n  >\n  ${\n    state === \"sunny\"\n      ? svg`\n          <path\n            class=\"sun\"\n            d=\"m 14.39303,8.4033507 c 0,3.3114723 -2.684145,5.9956173 -5.9956169,5.9956173 -3.3114716,0 -5.9956168,-2.684145 -5.9956168,-5.9956173 0,-3.311471 2.6841452,-5.995617 5.9956168,-5.995617 3.3114719,0 5.9956169,2.684146 5.9956169,5.995617\"\n          />\n        `\n      : \"\"\n  }\n  ${\n    state === \"clear-night\"\n      ? svg`\n          <path\n            class=\"moon\"\n            d=\"m 13.502891,11.382935 c -1.011285,1.859223 -2.976664,3.121381 -5.2405751,3.121381 -3.289929,0 -5.953329,-2.663833 -5.953329,-5.9537625 0,-2.263911 1.261724,-4.228856 3.120948,-5.240575 -0.452782,0.842738 -0.712753,1.806363 -0.712753,2.832381 0,3.289928 2.663833,5.9533275 5.9533291,5.9533275 1.026017,0 1.989641,-0.259969 2.83238,-0.712752\"\n          />\n        `\n      : \"\"\n  }\n  ${\n    state === \"partlycloudy\" && nightTime\n      ? svg`\n          <path\n            class=\"moon\"\n            d=\"m14.981 4.2112c0 1.9244-1.56 3.4844-3.484 3.4844-1.9244 0-3.4844-1.56-3.4844-3.4844s1.56-3.484 3.4844-3.484c1.924 0 3.484 1.5596 3.484 3.484\"\n          />\n        `\n      : state === \"partlycloudy\"\n      ? svg`\n          <path\n            class=\"sun\"\n            d=\"m14.981 4.2112c0 1.9244-1.56 3.4844-3.484 3.4844-1.9244 0-3.4844-1.56-3.4844-3.4844s1.56-3.484 3.4844-3.484c1.924 0 3.484 1.5596 3.484 3.484\"\n          />\n        `\n      : \"\"\n  }\n  ${\n    cloudyStates.has(state)\n      ? svg`\n          <path\n            class=\"cloud-back\"\n            d=\"m3.8863 5.035c-0.54892 0.16898-1.04 0.46637-1.4372 0.8636-0.63077 0.63041-1.0206 1.4933-1.0206 2.455 0 1.9251 1.5589 3.4682 3.4837 3.4682h6.9688c1.9251 0 3.484-1.5981 3.484-3.5232 0-1.9251-1.5589-3.5232-3.484-3.5232h-1.0834c-0.25294-1.6916-1.6986-2.9083-3.4463-2.9083-1.7995 0-3.2805 1.4153-3.465 3.1679\"\n          />\n          <path\n            class=\"cloud-front\"\n            d=\"m4.1996 7.6995c-0.33902 0.10407-0.64276 0.28787-0.88794 0.5334-0.39017 0.38982-0.63147 0.92322-0.63147 1.5176 0 1.1896 0.96414 2.1431 2.1537 2.1431h4.3071c1.1896 0 2.153-0.98742 2.153-2.1777 0-1.1896-0.96344-2.1777-2.153-2.1777h-0.66992c-0.15593-1.0449-1.0499-1.7974-2.1297-1.7974-1.112 0-2.0274 0.87524-2.1417 1.9586\"\n          />\n        `\n      : \"\"\n  }\n  ${\n    rainStates.has(state)\n      ? svg`\n          <path\n            class=\"rain\"\n            d=\"m5.2852 14.734c-0.22401 0.24765-0.57115 0.2988-0.77505 0.11395-0.20391-0.1845-0.18732-0.53481 0.036689-0.78281 0.14817-0.16298 0.59126-0.32914 0.87559-0.42369 0.12453-0.04092 0.22684 0.05186 0.19791 0.17956-0.065617 0.2921-0.18732 0.74965-0.33514 0.91299\"\n          />\n          <path\n            class=\"rain\"\n            d=\"m11.257 14.163c-0.22437 0.24765-0.57115 0.2988-0.77505 0.11395-0.2039-0.1845-0.18768-0.53481 0.03669-0.78281 0.14817-0.16298 0.59126-0.32914 0.8756-0.42369 0.12453-0.04092 0.22684 0.05186 0.19791 0.17956-0.06562 0.2921-0.18732 0.74965-0.33514 0.91299\"\n          />\n          <path\n            class=\"rain\"\n            d=\"m8.432 15.878c-0.15452 0.17039-0.3937 0.20567-0.53446 0.07867-0.14041-0.12735-0.12876-0.36865 0.025753-0.53975 0.10195-0.11218 0.40711-0.22684 0.60325-0.29175 0.085725-0.02858 0.15628 0.03563 0.13652 0.12382-0.045508 0.20108-0.12912 0.51647-0.23107 0.629\"\n          />\n          <path\n            class=\"rain\"\n            d=\"m7.9991 14.118c-0.19226 0.21237-0.49001 0.25612-0.66499 0.09737-0.17462-0.15804-0.16051-0.45861 0.03175-0.67098 0.12665-0.14005 0.50729-0.28293 0.75071-0.36336 0.10689-0.03563 0.19473 0.0441 0.17004 0.15346-0.056092 0.25082-0.16051 0.64347-0.28751 0.78352\"\n          />\n        `\n      : \"\"\n  }\n  ${\n    state === \"pouring\"\n      ? svg`\n          <path\n            class=\"rain\"\n            d=\"m10.648 16.448c-0.19226 0.21449-0.49001 0.25894-0.66499 0.09878-0.17498-0.16016-0.16087-0.4639 0.03175-0.67874 0.12665-0.14146 0.50694-0.2854 0.75071-0.36724 0.10689-0.03563 0.19473 0.0448 0.17004 0.15558-0.05645 0.25365-0.16051 0.65017-0.28751 0.79163\"\n          />\n          <path\n            class=\"rain\"\n            d=\"m5.9383 16.658c-0.22437 0.25012-0.5715 0.30162-0.77505 0.11501-0.20391-0.18627-0.18768-0.54046 0.036689-0.79093 0.14817-0.1651 0.59126-0.33267 0.87559-0.42827 0.12418-0.04127 0.22648 0.05221 0.19791 0.18168-0.065617 0.29528-0.18732 0.75741-0.33514 0.92251\"\n          />\n        `\n      : \"\"\n  }\n  ${\n    windyStates.has(state)\n      ? svg`\n          <path\n            class=\"cloud-back\"\n            d=\"m 13.59616,15.30968 c 0,0 -0.09137,-0.0071 -0.250472,-0.0187 -0.158045,-0.01235 -0.381353,-0.02893 -0.64382,-0.05715 -0.262466,-0.02716 -0.564444,-0.06385 -0.877358,-0.124531 -0.156986,-0.03034 -0.315383,-0.06844 -0.473781,-0.111478 -0.157691,-0.04551 -0.313266,-0.09842 -0.463902,-0.161219 l -0.267406,-0.0949 c -0.09984,-0.02646 -0.205669,-0.04904 -0.305153,-0.06738 -0.193322,-0.02716 -0.3838218,-0.03316 -0.5640912,-0.02011 -0.3626556,0.02611 -0.6847417,0.119239 -0.94615,0.226483 -0.2617611,0.108656 -0.4642556,0.230364 -0.600075,0.324203 -0.1358195,0.09419 -0.2049639,0.160514 -0.2049639,0.160514 0,0 0.089958,-0.01623 0.24765,-0.04445 0.1559278,-0.02575 0.3764139,-0.06174 0.6367639,-0.08714 0.2596444,-0.02646 0.5591527,-0.0441 0.8678333,-0.02328 0.076905,0.0035 0.1538111,0.01658 0.2321278,0.02293 0.077611,0.01058 0.1534581,0.02893 0.2314221,0.04022 0.07267,0.01834 0.1397,0.03986 0.213078,0.05644 l 0.238125,0.08925 c 0.09207,0.03281 0.183444,0.07055 0.275872,0.09878 0.09243,0.0261 0.185208,0.05327 0.277636,0.07161 0.184856,0.0388 0.367947,0.06174 0.543983,0.0702 0.353131,0.01905 0.678745,-0.01341 0.951442,-0.06456 0.27305,-0.05292 0.494595,-0.123119 0.646642,-0.181681 0.152047,-0.05785 0.234597,-0.104069 0.234597,-0.104069\"\n          />\n          <path\n            class=\"cloud-back\"\n            d=\"m 4.7519154,13.905801 c 0,0 0.091369,-0.0032 0.2511778,-0.0092 0.1580444,-0.0064 0.3820583,-0.01446 0.6455833,-0.03281 0.2631722,-0.01729 0.5662083,-0.04269 0.8812389,-0.09137 0.1576916,-0.02434 0.3175,-0.05609 0.4776611,-0.09384 0.1591027,-0.03951 0.3167944,-0.08643 0.4699,-0.14358 l 0.2702277,-0.08467 c 0.1008945,-0.02222 0.2074334,-0.04127 0.3072695,-0.05574 0.1943805,-0.01976 0.3848805,-0.0187 0.5651499,0.0014 0.3608917,0.03951 0.67945,0.144639 0.936625,0.261761 0.2575278,0.118534 0.4554364,0.247297 0.5873754,0.346781 0.132291,0.09913 0.198966,0.168275 0.198966,0.168275 0,0 -0.08925,-0.01976 -0.245886,-0.05397 C 9.9423347,14.087088 9.7232597,14.042988 9.4639681,14.00736 9.2057347,13.97173 8.9072848,13.94245 8.5978986,13.95162 c -0.077258,7.06e-4 -0.1541638,0.01058 -0.2328333,0.01411 -0.077964,0.0078 -0.1545166,0.02328 -0.2331861,0.03175 -0.073025,0.01588 -0.1404055,0.03422 -0.2141361,0.04798 l -0.2420055,0.08008 c -0.093486,0.02963 -0.1859139,0.06421 -0.2794,0.0889 C 7.3028516,14.23666 7.2093653,14.2603 7.116232,14.27512 6.9303181,14.30722 6.7465209,14.3231 6.5697792,14.32486 6.2166487,14.33046 5.8924459,14.28605 5.6218654,14.224318 5.3505793,14.161565 5.1318571,14.082895 4.9822793,14.01869 4.8327015,13.95519 4.7519154,13.905801 4.7519154,13.905801\"\n          />\n        `\n      : \"\"\n  }\n  ${\n    snowyStates.has(state)\n      ? svg`\n          <path\n            class=\"rain\"\n            d=\"m 8.4319893,15.348341 c 0,0.257881 -0.209197,0.467079 -0.467078,0.467079 -0.258586,0 -0.46743,-0.209198 -0.46743,-0.467079 0,-0.258233 0.208844,-0.467431 0.46743,-0.467431 0.257881,0 0.467078,0.209198 0.467078,0.467431\"\n          />\n          <path\n            class=\"rain\"\n            d=\"m 11.263878,14.358553 c 0,0.364067 -0.295275,0.659694 -0.659695,0.659694 -0.364419,0 -0.6596937,-0.295627 -0.6596937,-0.659694 0,-0.364419 0.2952747,-0.659694 0.6596937,-0.659694 0.36442,0 0.659695,0.295275 0.659695,0.659694\"\n          />\n          <path\n            class=\"rain\"\n            d=\"m 5.3252173,13.69847 c 0,0.364419 -0.295275,0.660047 -0.659695,0.660047 -0.364067,0 -0.659694,-0.295628 -0.659694,-0.660047 0,-0.364067 0.295627,-0.659694 0.659694,-0.659694 0.36442,0 0.659695,0.295627 0.659695,0.659694\"\n          />\n        `\n      : \"\"\n  }\n  ${\n    lightningStates.has(state)\n      ? svg`\n          <path\n            class=\"sun\"\n            d=\"m 9.9252695,10.935875 -1.6483986,2.341014 1.1170184,0.05929 -1.2169864,2.02141 3.0450261,-2.616159 H 9.8864918 L 10.97937,11.294651 10.700323,10.79794 h -0.508706 l -0.2663475,0.137936\"\n          />\n        `\n      : \"\"\n  }\n  </svg>`;\n\n// IoB\nexport const weatherStateIsImage = (state: string): boolean => {\n  const imageRexExt = /.+\\.png|\\.svg|\\.jpg|\\.jpeg/i;\n  return imageRexExt.test(state);\n};\n\nexport const getWeatherStateIcon = (\n  state: string,\n  element: HTMLElement,\n  nightTime?: boolean,\n  token?: string // IoB - weather icons with auth.\n): TemplateResult | undefined => {\n  const userDefinedIcon = getComputedStyle(element).getPropertyValue(\n    `--weather-icon-${state}`\n  );\n\n  if (userDefinedIcon) {\n    return html`\n      <div\n        style=\"background-size: cover;${styleMap({\n          \"background-image\": userDefinedIcon,\n        })}\"\n      ></div>\n    `;\n  }\n\n  // IoB weather icon\n  if (weatherStateIsImage(state)) {\n    let imgUrl = state.toString();\n    if (imgUrl.startsWith(\"/adapter\")) {\n      // make sure we do not send token to 3rd parties!\n      imgUrl += token ? \"?token=\" + token : \"\";\n    }\n    return html`\n      <div\n        style=\"\n            min-width: 32px;\n            min-height: 32px;\n            background-size: cover; \n               background-image: url(${imgUrl});\"\n      ></div>\n    `;\n  }\n\n  if (weatherSVGs.has(state)) {\n    return html`${getWeatherStateSVG(state, nightTime)}`;\n  }\n\n  if (state in weatherIcons) {\n    return html`\n      <ha-svg-icon\n        class=\"weather-icon\"\n        .path=${weatherIcons[state]}\n      ></ha-svg-icon>\n    `;\n  }\n\n  return undefined;\n};\n","import \"@material/mwc-ripple\";\nimport type { Ripple } from \"@material/mwc-ripple\";\nimport { RippleHandlers } from \"@material/mwc-ripple/ripple-handlers\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport {\n  customElement,\n  eventOptions,\n  property,\n  queryAsync,\n  state,\n} from \"lit/decorators\";\nimport { ifDefined } from \"lit/directives/if-defined\";\nimport { styleMap } from \"lit/directives/style-map\";\nimport { DOMAINS_TOGGLE } from \"../../../common/const\";\nimport { applyThemesOnElement } from \"../../../common/dom/apply_themes_on_element\";\nimport { computeActiveState } from \"../../../common/entity/compute_active_state\";\nimport { computeDomain } from \"../../../common/entity/compute_domain\";\nimport { computeStateDisplay } from \"../../../common/entity/compute_state_display\";\nimport { computeStateDomain } from \"../../../common/entity/compute_state_domain\";\nimport { computeStateName } from \"../../../common/entity/compute_state_name\";\nimport { isValidEntityId } from \"../../../common/entity/valid_entity_id\";\nimport { iconColorCSS } from \"../../../common/style/icon_color_css\";\nimport \"../../../components/ha-card\";\nimport { LightEntity } from \"../../../data/light\";\nimport { ActionHandlerEvent } from \"../../../data/lovelace\";\nimport { HomeAssistant } from \"../../../types\";\nimport { actionHandler } from \"../common/directives/action-handler-directive\";\nimport { findEntities } from \"../common/find-entities\";\nimport { handleAction } from \"../common/handle-action\";\nimport { hasAction } from \"../common/has-action\";\nimport { createEntityNotFoundWarning } from \"../components/hui-warning\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { ButtonCardConfig } from \"./types\";\n\n@customElement(\"hui-button-card\")\nexport class HuiButtonCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(\"../editor/config-elements/hui-button-card-editor\");\n    return document.createElement(\"hui-button-card-editor\");\n  }\n\n  public static getStubConfig(\n    hass: HomeAssistant,\n    entities: string[],\n    entitiesFallback: string[]\n  ): ButtonCardConfig {\n    const maxEntities = 1;\n    const foundEntities = findEntities(\n      hass,\n      maxEntities,\n      entities,\n      entitiesFallback,\n      [\"light\", \"switch\"]\n    );\n\n    return {\n      type: \"button\",\n      tap_action: {\n        action: \"toggle\",\n      },\n      entity: foundEntities[0] || \"\",\n    };\n  }\n\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @state() private _config?: ButtonCardConfig;\n\n  @queryAsync(\"mwc-ripple\") private _ripple!: Promise<Ripple | null>;\n\n  @state() private _shouldRenderRipple = false;\n\n  public getCardSize(): number {\n    return (\n      (this._config?.show_icon ? 4 : 0) + (this._config?.show_name ? 1 : 0)\n    );\n  }\n\n  public setConfig(config: ButtonCardConfig): void {\n    if (config.entity && !isValidEntityId(config.entity)) {\n      throw new Error(\"Invalid entity\");\n    }\n\n    this._config = {\n      tap_action: {\n        action:\n          config.entity && DOMAINS_TOGGLE.has(computeDomain(config.entity))\n            ? \"toggle\"\n            : \"more-info\",\n      },\n      hold_action: { action: \"more-info\" },\n      show_icon: true,\n      show_name: true,\n      state_color: true,\n      ...config,\n    };\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (changedProps.has(\"_config\")) {\n      return true;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n\n    if (\n      !oldHass ||\n      oldHass.themes !== this.hass!.themes ||\n      oldHass.locale !== this.hass!.locale\n    ) {\n      return true;\n    }\n\n    return (\n      Boolean(this._config!.entity) &&\n      oldHass.states[this._config!.entity!] !==\n        this.hass!.states[this._config!.entity!]\n    );\n  }\n\n  protected render(): TemplateResult {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n    const stateObj = this._config.entity\n      ? this.hass.states[this._config.entity]\n      : undefined;\n\n    if (this._config.entity && !stateObj) {\n      return html`\n        <hui-warning>\n          ${createEntityNotFoundWarning(this.hass, this._config.entity)}\n        </hui-warning>\n      `;\n    }\n\n    const name = this._config.show_name\n      ? this._config.name || (stateObj ? computeStateName(stateObj) : \"\")\n      : \"\";\n\n    return html`\n      <ha-card\n        @action=${this._handleAction}\n        @focus=${this.handleRippleFocus}\n        @blur=${this.handleRippleBlur}\n        @mousedown=${this.handleRippleActivate}\n        @mouseup=${this.handleRippleDeactivate}\n        @touchstart=${this.handleRippleActivate}\n        @touchend=${this.handleRippleDeactivate}\n        @touchcancel=${this.handleRippleDeactivate}\n        .actionHandler=${actionHandler({\n          hasHold: hasAction(this._config!.hold_action),\n          hasDoubleClick: hasAction(this._config!.double_tap_action),\n        })}\n        tabindex=${ifDefined(\n          hasAction(this._config.tap_action) ? \"0\" : undefined\n        )}\n      >\n        ${this._config.show_icon\n          ? html`\n              <ha-state-icon\n                tabindex=\"-1\"\n                data-domain=${ifDefined(\n                  this._config.state_color && stateObj\n                    ? computeStateDomain(stateObj)\n                    : undefined\n                )}\n                data-state=${ifDefined(\n                  stateObj ? computeActiveState(stateObj) : undefined\n                )}\n                .icon=${this._config.icon}\n                .state=${stateObj}\n                style=${styleMap({\n                  filter: stateObj ? this._computeBrightness(stateObj) : \"\",\n                  color: stateObj ? this._computeColor(stateObj) : \"\",\n                  height: this._config.icon_height\n                    ? this._config.icon_height\n                    : \"\",\n                })}\n              ></ha-state-icon>\n            `\n          : \"\"}\n        ${this._config.show_name\n          ? html`<span tabindex=\"-1\" .title=${name}>${name}</span>`\n          : \"\"}\n        ${this._config.show_state && stateObj\n          ? html`<span class=\"state\">\n              ${computeStateDisplay(\n                this.hass.localize,\n                stateObj,\n                this.hass.locale\n              )}\n            </span>`\n          : \"\"}\n        ${this._shouldRenderRipple ? html`<mwc-ripple></mwc-ripple>` : \"\"}\n      </ha-card>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (!this._config || !this.hass) {\n      return;\n    }\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    const oldConfig = changedProps.get(\"_config\") as\n      | ButtonCardConfig\n      | undefined;\n\n    if (\n      !oldHass ||\n      !oldConfig ||\n      oldHass.themes !== this.hass.themes ||\n      oldConfig.theme !== this._config.theme\n    ) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n  }\n\n  private _rippleHandlers: RippleHandlers = new RippleHandlers(() => {\n    this._shouldRenderRipple = true;\n    return this._ripple;\n  });\n\n  @eventOptions({ passive: true })\n  private handleRippleActivate(evt?: Event) {\n    this._rippleHandlers.startPress(evt);\n  }\n\n  private handleRippleDeactivate() {\n    this._rippleHandlers.endPress();\n  }\n\n  private handleRippleFocus() {\n    this._rippleHandlers.startFocus();\n  }\n\n  private handleRippleBlur() {\n    this._rippleHandlers.endFocus();\n  }\n\n  static get styles(): CSSResultGroup {\n    return [\n      iconColorCSS,\n      css`\n        ha-card {\n          cursor: pointer;\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          text-align: center;\n          padding: 4% 0;\n          font-size: 1.2rem;\n          height: 100%;\n          box-sizing: border-box;\n          justify-content: center;\n          position: relative;\n        }\n\n        ha-card:focus {\n          outline: none;\n        }\n\n        ha-state-icon {\n          width: 40%;\n          height: auto;\n          color: var(--paper-item-icon-color, #44739e);\n          --mdc-icon-size: 100%;\n        }\n\n        ha-state-icon + span {\n          margin-top: 8px;\n        }\n\n        ha-state-icon,\n        span {\n          outline: none;\n        }\n\n        .state {\n          font-size: 0.9rem;\n          color: var(--secondary-text-color);\n        }\n      `,\n    ];\n  }\n\n  private _computeBrightness(stateObj: HassEntity | LightEntity): string {\n    if (!stateObj.attributes.brightness || !this._config?.state_color) {\n      return \"\";\n    }\n    const brightness = stateObj.attributes.brightness;\n    return `brightness(${(brightness + 245) / 5}%)`;\n  }\n\n  private _computeColor(stateObj: HassEntity | LightEntity): string {\n    if (this._config?.state_color && stateObj.attributes.rgb_color) {\n      return `rgb(${stateObj.attributes.rgb_color.join(\",\")})`;\n    }\n    return \"\";\n  }\n\n  private _handleAction(ev: ActionHandlerEvent) {\n    handleAction(this, this.hass!, this._config!, ev.detail.action!);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-button-card\": HuiButtonCard;\n  }\n}\n","import {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { customElement, property, state, query } from \"lit/decorators\";\nimport { getColorByIndex } from \"../../../common/color/colors\";\nimport { applyThemesOnElement } from \"../../../common/dom/apply_themes_on_element\";\nimport { HASSDomEvent } from \"../../../common/dom/fire_event\";\nimport { debounce } from \"../../../common/util/debounce\";\nimport \"../../../components/ha-card\";\nimport { Calendar, fetchCalendarEvents } from \"../../../data/calendar\";\nimport type {\n  CalendarEvent,\n  CalendarViewChanged,\n  FullCalendarView,\n  HomeAssistant,\n} from \"../../../types\";\nimport \"../../calendar/ha-full-calendar\";\nimport type { HAFullCalendar } from \"../../calendar/ha-full-calendar\";\nimport { findEntities } from \"../common/find-entities\";\nimport { installResizeObserver } from \"../common/install-resize-observer\";\nimport \"../components/hui-warning\";\nimport type { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport type { CalendarCardConfig } from \"./types\";\n\n@customElement(\"hui-calendar-card\")\nexport class HuiCalendarCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(\"../editor/config-elements/hui-calendar-card-editor\");\n    return document.createElement(\"hui-calendar-card-editor\");\n  }\n\n  public static getStubConfig(\n    hass: HomeAssistant,\n    entities: string[],\n    entitiesFill: string[]\n  ) {\n    const includeDomains = [\"calendar\"];\n    const maxEntities = 2;\n    const foundEntities = findEntities(\n      hass,\n      maxEntities,\n      entities,\n      entitiesFill,\n      includeDomains\n    );\n\n    return {\n      entities: foundEntities,\n    };\n  }\n\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @property({ attribute: false }) public _events: CalendarEvent[] = [];\n\n  @state() private _config?: CalendarCardConfig;\n\n  @state() private _calendars: Calendar[] = [];\n\n  @state() private _narrow = false;\n\n  @state() private _veryNarrow = false;\n\n  @query(\"ha-full-calendar\", true) private _calendar?: HAFullCalendar;\n\n  private _startDate?: Date;\n\n  private _endDate?: Date;\n\n  private _resizeObserver?: ResizeObserver;\n\n  public setConfig(config: CalendarCardConfig): void {\n    if (!config.entities?.length) {\n      throw new Error(\"Entities must be specified\");\n    }\n\n    if (!Array.isArray(config.entities)) {\n      throw new Error(\"Entities need to be an array\");\n    }\n\n    this._calendars = config!.entities.map((entity, idx) => ({\n      entity_id: entity,\n      backgroundColor: getColorByIndex(idx),\n    }));\n\n    if (this._config?.entities !== config.entities) {\n      this._fetchCalendarEvents();\n    }\n\n    this._config = { initial_view: \"dayGridMonth\", ...config };\n  }\n\n  public getCardSize(): number {\n    return this._config?.header ? 1 : 0 + 11;\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this.updateComplete.then(() => this._attachObserver());\n  }\n\n  public disconnectedCallback(): void {\n    if (this._resizeObserver) {\n      this._resizeObserver.disconnect();\n    }\n  }\n\n  protected render(): TemplateResult {\n    if (!this._config || !this.hass || !this._calendars.length) {\n      return html``;\n    }\n\n    const views: FullCalendarView[] = this._veryNarrow\n      ? [\"list\"]\n      : [\"list\", \"dayGridMonth\", \"dayGridDay\"];\n\n    return html`\n      <ha-card>\n        <div class=\"header\">${this._config.title}</div>\n        <ha-full-calendar\n          .narrow=${this._narrow}\n          .events=${this._events}\n          .hass=${this.hass}\n          .views=${views}\n          .initialView=${this._config.initial_view!}\n          @view-changed=${this._handleViewChanged}\n        ></ha-full-calendar>\n      </ha-card>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    super.updated(changedProps);\n    if (!this._config || !this.hass) {\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    const oldConfig = changedProps.get(\"_config\") as\n      | CalendarCardConfig\n      | undefined;\n\n    if (\n      !oldHass ||\n      !oldConfig ||\n      (changedProps.has(\"hass\") && oldHass.themes !== this.hass.themes) ||\n      (changedProps.has(\"_config\") && oldConfig.theme !== this._config.theme)\n    ) {\n      applyThemesOnElement(this, this.hass.themes, this._config!.theme);\n    }\n  }\n\n  private _handleViewChanged(ev: HASSDomEvent<CalendarViewChanged>): void {\n    this._startDate = ev.detail.start;\n    this._endDate = ev.detail.end;\n    this._fetchCalendarEvents();\n  }\n\n  private async _fetchCalendarEvents(): Promise<void> {\n    if (!this._startDate || !this._endDate) {\n      return;\n    }\n\n    this._events = await fetchCalendarEvents(\n      this.hass!,\n      this._startDate,\n      this._endDate,\n      this._calendars\n    );\n  }\n\n  private _measureCard() {\n    const card = this.shadowRoot!.querySelector(\"ha-card\");\n    if (!card) {\n      return;\n    }\n    this._narrow = card.offsetWidth < 870;\n    this._veryNarrow = card.offsetWidth < 350;\n\n    this._calendar?.updateSize();\n  }\n\n  private async _attachObserver(): Promise<void> {\n    if (!this._resizeObserver) {\n      await installResizeObserver();\n      this._resizeObserver = new ResizeObserver(\n        debounce(() => this._measureCard(), 250, false)\n      );\n    }\n    const card = this.shadowRoot!.querySelector(\"ha-card\");\n    // If we show an error or warning there is no ha-card\n    if (!card) {\n      return;\n    }\n    this._resizeObserver.observe(card);\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      ha-card {\n        position: relative;\n        padding: 0 8px 8px;\n        box-sizing: border-box;\n        height: 100%;\n      }\n\n      .header {\n        color: var(--ha-card-header-color, --primary-text-color);\n        font-size: var(--ha-card-header-font-size, 24px);\n        line-height: 1.2;\n        padding-top: 16px;\n        padding-left: 8px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-calendar-card\": HuiCalendarCard;\n  }\n}\n","import {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { customElement, state } from \"lit/decorators\";\nimport { DOMAINS_TOGGLE } from \"../../../common/const\";\nimport { applyThemesOnElement } from \"../../../common/dom/apply_themes_on_element\";\nimport { computeDomain } from \"../../../common/entity/compute_domain\";\nimport \"../../../components/ha-card\";\nimport { HomeAssistant } from \"../../../types\";\nimport { computeCardSize } from \"../common/compute-card-size\";\nimport { findEntities } from \"../common/find-entities\";\nimport { processConfigEntities } from \"../common/process-config-entities\";\nimport \"../components/hui-entities-toggle\";\nimport { createHeaderFooterElement } from \"../create-element/create-header-footer-element\";\nimport { createRowElement } from \"../create-element/create-row-element\";\nimport {\n  EntityConfig,\n  LovelaceRow,\n  LovelaceRowConfig,\n} from \"../entity-rows/types\";\nimport {\n  LovelaceCard,\n  LovelaceCardEditor,\n  LovelaceHeaderFooter,\n} from \"../types\";\nimport { EntitiesCardConfig } from \"./types\";\n\n@customElement(\"hui-entities-card\")\nclass HuiEntitiesCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(\"../editor/config-elements/hui-entities-card-editor\");\n    return document.createElement(\"hui-entities-card-editor\");\n  }\n\n  public static getStubConfig(\n    hass: HomeAssistant,\n    entities: string[],\n    entitiesFallback: string[]\n  ): EntitiesCardConfig {\n    const maxEntities = 3;\n    const foundEntities = findEntities(\n      hass,\n      maxEntities,\n      entities,\n      entitiesFallback,\n      [\"light\", \"switch\", \"sensor\"]\n    );\n\n    return { type: \"entities\", entities: foundEntities };\n  }\n\n  @state() private _config?: EntitiesCardConfig;\n\n  private _hass?: HomeAssistant;\n\n  private _configEntities?: LovelaceRowConfig[];\n\n  private _showHeaderToggle?: boolean;\n\n  private _headerElement?: LovelaceHeaderFooter;\n\n  private _footerElement?: LovelaceHeaderFooter;\n\n  set hass(hass: HomeAssistant) {\n    this._hass = hass;\n    this.shadowRoot\n      ?.querySelectorAll(\"#states > div > *\")\n      .forEach((element: unknown) => {\n        (element as LovelaceRow).hass = hass;\n      });\n    if (this._headerElement) {\n      this._headerElement.hass = hass;\n    }\n    if (this._footerElement) {\n      this._footerElement.hass = hass;\n    }\n    const entitiesToggle = this.shadowRoot?.querySelector(\n      \"hui-entities-toggle\"\n    );\n    if (entitiesToggle) {\n      (entitiesToggle as any).hass = hass;\n    }\n  }\n\n  public async getCardSize(): Promise<number> {\n    if (!this._config) {\n      return 0;\n    }\n    // +1 for the header\n    let size =\n      (this._config.title || this._showHeaderToggle ? 2 : 0) +\n      (this._config.entities.length || 1);\n    if (this._headerElement) {\n      const headerSize = computeCardSize(this._headerElement);\n      size += headerSize instanceof Promise ? await headerSize : headerSize;\n    }\n    if (this._footerElement) {\n      const footerSize = computeCardSize(this._footerElement);\n      size += footerSize instanceof Promise ? await footerSize : footerSize;\n    }\n\n    return size;\n  }\n\n  public setConfig(config: EntitiesCardConfig): void {\n    if (!config.entities || !Array.isArray(config.entities)) {\n      throw new Error(\"Entities must be specified\");\n    }\n\n    const entities = processConfigEntities(config.entities);\n\n    this._config = config;\n    this._configEntities = entities;\n    if (config.title !== undefined && config.show_header_toggle === undefined) {\n      // Default value is show toggle if we can at least toggle 2 entities.\n      let toggleable = 0;\n      for (const rowConf of entities) {\n        if (!(\"entity\" in rowConf)) {\n          continue;\n        }\n        toggleable += Number(DOMAINS_TOGGLE.has(computeDomain(rowConf.entity)));\n        if (toggleable === 2) {\n          break;\n        }\n      }\n      this._showHeaderToggle = toggleable === 2;\n    } else {\n      this._showHeaderToggle = config.show_header_toggle;\n    }\n\n    if (this._config.header) {\n      this._headerElement = createHeaderFooterElement(\n        this._config.header\n      ) as LovelaceHeaderFooter;\n      this._headerElement.type = \"header\";\n      if (this._hass) {\n        this._headerElement.hass = this._hass;\n      }\n    } else {\n      this._headerElement = undefined;\n    }\n\n    if (this._config.footer) {\n      this._footerElement = createHeaderFooterElement(\n        this._config.footer\n      ) as LovelaceHeaderFooter;\n      this._footerElement.type = \"footer\";\n      if (this._hass) {\n        this._footerElement.hass = this._hass;\n      }\n    } else {\n      this._footerElement = undefined;\n    }\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (!this._config || !this._hass) {\n      return;\n    }\n    const oldHass = changedProps.get(\"_hass\") as HomeAssistant | undefined;\n    const oldConfig = changedProps.get(\"_config\") as\n      | EntitiesCardConfig\n      | undefined;\n\n    if (\n      (changedProps.has(\"_hass\") &&\n        (!oldHass || oldHass.themes !== this._hass.themes)) ||\n      (changedProps.has(\"_config\") &&\n        (!oldConfig || oldConfig.theme !== this._config.theme))\n    ) {\n      applyThemesOnElement(this, this._hass.themes, this._config.theme);\n    }\n  }\n\n  protected render(): TemplateResult {\n    if (!this._config || !this._hass) {\n      return html``;\n    }\n\n    return html`\n      <ha-card>\n        ${this._headerElement\n          ? html`<div class=\"header-footer header\">${this._headerElement}</div>`\n          : \"\"}\n        ${!this._config.title && !this._showHeaderToggle && !this._config.icon\n          ? \"\"\n          : html`\n              <h1 class=\"card-header\">\n                <div class=\"name\">\n                  ${this._config.icon\n                    ? html`\n                        <ha-icon\n                          class=\"icon\"\n                          .icon=${this._config.icon}\n                        ></ha-icon>\n                      `\n                    : \"\"}\n                  ${this._config.title}\n                </div>\n                ${!this._showHeaderToggle\n                  ? html``\n                  : html`\n                      <hui-entities-toggle\n                        .hass=${this._hass}\n                        .entities=${(\n                          this._configEntities!.filter(\n                            (conf) => \"entity\" in conf\n                          ) as EntityConfig[]\n                        ).map((conf) => conf.entity)}\n                      ></hui-entities-toggle>\n                    `}\n              </h1>\n            `}\n        <div id=\"states\" class=\"card-content\">\n          ${this._configEntities!.map((entityConf) =>\n            this.renderEntity(entityConf)\n          )}\n        </div>\n\n        ${this._footerElement\n          ? html`<div class=\"header-footer footer\">${this._footerElement}</div>`\n          : \"\"}\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      ha-card {\n        height: 100%;\n        display: flex;\n        flex-direction: column;\n        justify-content: space-between;\n      }\n      .card-header {\n        display: flex;\n        justify-content: space-between;\n      }\n\n      .card-header .name {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n\n      #states {\n        flex: 1;\n      }\n\n      #states > * {\n        margin: 8px 0;\n      }\n\n      #states > *:first-child {\n        margin-top: 0;\n      }\n\n      #states > *:last-child {\n        margin-bottom: 0;\n      }\n\n      #states > div > * {\n        overflow: clip visible;\n      }\n\n      #states > div {\n        position: relative;\n      }\n\n      .icon {\n        padding: 0px 18px 0px 8px;\n      }\n\n      .header {\n        border-top-left-radius: var(--ha-card-border-radius, 2px);\n        border-top-right-radius: var(--ha-card-border-radius, 2px);\n        margin-bottom: 16px;\n        overflow: hidden;\n      }\n\n      .footer {\n        border-bottom-left-radius: var(--ha-card-border-radius, 2px);\n        border-bottom-right-radius: var(--ha-card-border-radius, 2px);\n        margin-top: -16px;\n        overflow: hidden;\n      }\n    `;\n  }\n\n  private renderEntity(entityConf: LovelaceRowConfig): TemplateResult {\n    const element = createRowElement(\n      (!(\"type\" in entityConf) || entityConf.type === \"conditional\") &&\n        this._config!.state_color\n        ? ({\n            state_color: true,\n            ...(entityConf as EntityConfig),\n          } as EntityConfig)\n        : entityConf\n    );\n    if (this._hass) {\n      element.hass = this._hass;\n    }\n\n    return html`<div>${element}</div>`;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-entities-card\": HuiEntitiesCard;\n  }\n}\n","import {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { ifDefined } from \"lit/directives/if-defined\";\nimport { applyThemesOnElement } from \"../../../common/dom/apply_themes_on_element\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { computeActiveState } from \"../../../common/entity/compute_active_state\";\nimport { computeStateDisplay } from \"../../../common/entity/compute_state_display\";\nimport { computeStateDomain } from \"../../../common/entity/compute_state_domain\";\nimport { computeStateName } from \"../../../common/entity/compute_state_name\";\nimport { isValidEntityId } from \"../../../common/entity/valid_entity_id\";\nimport {\n  formatNumber,\n  isNumericState,\n} from \"../../../common/number/format_number\";\nimport { iconColorCSS } from \"../../../common/style/icon_color_css\";\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\nimport { UNAVAILABLE_STATES } from \"../../../data/entity\";\nimport { HomeAssistant } from \"../../../types\";\nimport { formatAttributeValue } from \"../../../util/hass-attributes-util\";\nimport { computeCardSize } from \"../common/compute-card-size\";\nimport { findEntities } from \"../common/find-entities\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { createEntityNotFoundWarning } from \"../components/hui-warning\";\nimport { createHeaderFooterElement } from \"../create-element/create-header-footer-element\";\nimport {\n  LovelaceCard,\n  LovelaceCardEditor,\n  LovelaceHeaderFooter,\n} from \"../types\";\nimport { HuiErrorCard } from \"./hui-error-card\";\nimport { EntityCardConfig } from \"./types\";\n\n@customElement(\"hui-entity-card\")\nexport class HuiEntityCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(\"../editor/config-elements/hui-entity-card-editor\");\n    return document.createElement(\"hui-entity-card-editor\");\n  }\n\n  public static getStubConfig(\n    hass: HomeAssistant,\n    entities: string[],\n    entitiesFill: string[]\n  ) {\n    const includeDomains = [\"sensor\", \"light\", \"switch\"];\n    const maxEntities = 1;\n    const foundEntities = findEntities(\n      hass,\n      maxEntities,\n      entities,\n      entitiesFill,\n      includeDomains\n    );\n\n    return {\n      entity: foundEntities[0] || \"\",\n    };\n  }\n\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @state() private _config?: EntityCardConfig;\n\n  private _footerElement?: HuiErrorCard | LovelaceHeaderFooter;\n\n  public setConfig(config: EntityCardConfig): void {\n    if (!config.entity) {\n      throw new Error(\"Entity must be specified\");\n    }\n    if (config.entity && !isValidEntityId(config.entity)) {\n      throw new Error(\"Invalid entity\");\n    }\n\n    this._config = config;\n\n    if (this._config.footer) {\n      this._footerElement = createHeaderFooterElement(this._config.footer);\n    } else if (this._footerElement) {\n      this._footerElement = undefined;\n    }\n  }\n\n  public async getCardSize(): Promise<number> {\n    let size = 2;\n    if (this._footerElement) {\n      const footerSize = computeCardSize(this._footerElement);\n      size += footerSize instanceof Promise ? await footerSize : footerSize;\n    }\n    return size;\n  }\n\n  protected render(): TemplateResult {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning>\n          ${createEntityNotFoundWarning(this.hass, this._config.entity)}\n        </hui-warning>\n      `;\n    }\n\n    const domain = computeStateDomain(stateObj);\n    const showUnit = this._config.attribute\n      ? this._config.attribute in stateObj.attributes\n      : !UNAVAILABLE_STATES.includes(stateObj.state);\n\n    const name = this._config.name || computeStateName(stateObj);\n\n    return html`\n      <ha-card @click=${this._handleClick} tabindex=\"0\">\n        <div class=\"header\">\n          <div class=\"name\" .title=${name}>${name}</div>\n          <div class=\"icon\">\n            <ha-state-icon\n              .icon=${this._config.icon}\n              .state=${stateObj}\n              data-domain=${ifDefined(\n                this._config.state_color ||\n                  (domain === \"light\" && this._config.state_color !== false)\n                  ? domain\n                  : undefined\n              )}\n              data-state=${stateObj ? computeActiveState(stateObj) : \"\"}\n            ></ha-state-icon>\n          </div>\n        </div>\n        <div class=\"info\">\n          <span class=\"value\"\n            >${\"attribute\" in this._config\n              ? stateObj.attributes[this._config.attribute!] !== undefined\n                ? formatAttributeValue(\n                    this.hass,\n                    stateObj.attributes[this._config.attribute!]\n                  )\n                : this.hass.localize(\"state.default.unknown\")\n              : isNumericState(stateObj)\n              ? formatNumber(stateObj.state, this.hass.locale)\n              : computeStateDisplay(\n                  this.hass.localize,\n                  stateObj,\n                  this.hass.locale\n                )}</span\n          >${showUnit\n            ? html`\n                <span class=\"measurement\"\n                  >${this._config.unit ||\n                  (this._config.attribute\n                    ? \"\"\n                    : stateObj.attributes.unit_of_measurement)}</span\n                >\n              `\n            : \"\"}\n        </div>\n        ${this._footerElement}\n      </ha-card>\n    `;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    // Side Effect used to update footer hass while keeping optimizations\n    if (this._footerElement) {\n      this._footerElement.hass = this.hass;\n    }\n\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    super.updated(changedProps);\n    if (!this._config || !this.hass) {\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    const oldConfig = changedProps.get(\"_config\") as\n      | EntityCardConfig\n      | undefined;\n\n    if (\n      !oldHass ||\n      !oldConfig ||\n      oldHass.themes !== this.hass.themes ||\n      oldConfig.theme !== this._config.theme\n    ) {\n      applyThemesOnElement(this, this.hass.themes, this._config!.theme);\n    }\n  }\n\n  private _handleClick(): void {\n    fireEvent(this, \"hass-more-info\", { entityId: this._config!.entity });\n  }\n\n  static get styles(): CSSResultGroup {\n    return [\n      iconColorCSS,\n      css`\n        ha-card {\n          height: 100%;\n          display: flex;\n          flex-direction: column;\n          justify-content: space-between;\n          cursor: pointer;\n          outline: none;\n        }\n\n        .header {\n          display: flex;\n          padding: 8px 16px 0;\n          justify-content: space-between;\n        }\n\n        .name {\n          color: var(--secondary-text-color);\n          line-height: 40px;\n          font-weight: 500;\n          font-size: 16px;\n          overflow: hidden;\n          white-space: nowrap;\n          text-overflow: ellipsis;\n        }\n\n        .icon {\n          color: var(--state-icon-color, #44739e);\n          line-height: 40px;\n        }\n\n        .info {\n          padding: 0px 16px 16px;\n          margin-top: -4px;\n          overflow: hidden;\n          white-space: nowrap;\n          text-overflow: ellipsis;\n          line-height: 28px;\n        }\n\n        .value {\n          font-size: 28px;\n          margin-right: 4px;\n        }\n\n        .measurement {\n          font-size: 18px;\n          color: var(--secondary-text-color);\n        }\n      `,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-entity-card\": HuiEntityCard;\n  }\n}\n","import {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { classMap } from \"lit/directives/class-map\";\nimport { ifDefined } from \"lit/directives/if-defined\";\nimport { applyThemesOnElement } from \"../../../common/dom/apply_themes_on_element\";\nimport { computeDomain } from \"../../../common/entity/compute_domain\";\nimport { computeStateDisplay } from \"../../../common/entity/compute_state_display\";\nimport { computeStateName } from \"../../../common/entity/compute_state_name\";\nimport \"../../../components/entity/state-badge\";\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\nimport \"../../../components/ha-relative-time\";\nimport { UNAVAILABLE_STATES } from \"../../../data/entity\";\nimport {\n  ActionHandlerEvent,\n  CallServiceActionConfig,\n  MoreInfoActionConfig,\n} from \"../../../data/lovelace\";\nimport { SENSOR_DEVICE_CLASS_TIMESTAMP } from \"../../../data/sensor\";\nimport { HomeAssistant } from \"../../../types\";\nimport { actionHandler } from \"../common/directives/action-handler-directive\";\nimport { findEntities } from \"../common/find-entities\";\nimport { handleAction } from \"../common/handle-action\";\nimport { hasAction } from \"../common/has-action\";\nimport { processConfigEntities } from \"../common/process-config-entities\";\nimport \"../components/hui-timestamp-display\";\nimport { createEntityNotFoundWarning } from \"../components/hui-warning\";\nimport \"../components/hui-warning-element\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { GlanceCardConfig, GlanceConfigEntity } from \"./types\";\n\n@customElement(\"hui-glance-card\")\nexport class HuiGlanceCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(\"../editor/config-elements/hui-glance-card-editor\");\n    return document.createElement(\"hui-glance-card-editor\");\n  }\n\n  public static getStubConfig(\n    hass: HomeAssistant,\n    entities: string[],\n    entitiesFallback: string[]\n  ): GlanceCardConfig {\n    const includeDomains = [\"sensor\"];\n    const maxEntities = 3;\n    const foundEntities = findEntities(\n      hass,\n      maxEntities,\n      entities,\n      entitiesFallback,\n      includeDomains\n    );\n\n    return { type: \"glance\", entities: foundEntities };\n  }\n\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @state() private _config?: GlanceCardConfig;\n\n  private _configEntities?: GlanceConfigEntity[];\n\n  public getCardSize(): number {\n    const rowHeight =\n      (this._config!.show_icon ? 1 : 0) +\n      (this._config!.show_name ? 1 : 0) +\n      (this._config!.show_state ? 1 : 0);\n\n    const numRows = Math.ceil(\n      this._configEntities!.length / (this._config!.columns || 5)\n    );\n\n    return (this._config!.title ? 2 : 0) + rowHeight * numRows;\n  }\n\n  public setConfig(config: GlanceCardConfig): void {\n    this._config = {\n      show_name: true,\n      show_state: true,\n      show_icon: true,\n      state_color: true,\n      ...config,\n    };\n    const entities = processConfigEntities<GlanceConfigEntity>(\n      config.entities\n    ).map((entityConf) => ({\n      hold_action: { action: \"more-info\" } as MoreInfoActionConfig,\n      ...entityConf,\n    }));\n\n    for (const entity of entities) {\n      if (\n        (entity.tap_action &&\n          entity.tap_action.action === \"call-service\" &&\n          !entity.tap_action.service) ||\n        (entity.hold_action &&\n          entity.hold_action.action === \"call-service\" &&\n          !(entity.hold_action as CallServiceActionConfig).service)\n      ) {\n        throw new Error(\n          'Missing required property \"service\" when tap_action or hold_action is call-service'\n        );\n      }\n    }\n\n    const columns = config.columns || Math.min(config.entities.length, 5);\n    this.style.setProperty(\"--glance-column-width\", `${100 / columns}%`);\n\n    this._configEntities = entities;\n\n    if (this.hass) {\n      this.requestUpdate();\n    }\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (changedProps.has(\"_config\")) {\n      return true;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n\n    if (\n      !this._configEntities ||\n      !oldHass ||\n      oldHass.themes !== this.hass!.themes ||\n      oldHass.locale !== this.hass!.locale\n    ) {\n      return true;\n    }\n\n    for (const entity of this._configEntities) {\n      if (oldHass.states[entity.entity] !== this.hass!.states[entity.entity]) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  protected render(): TemplateResult {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n    const { title } = this._config;\n\n    return html`\n      <ha-card .header=${title}>\n        <div class=${classMap({ entities: true, \"no-header\": !title })}>\n          ${this._configEntities!.map((entityConf) =>\n            this.renderEntity(entityConf)\n          )}\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (!this._config || !this.hass) {\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    const oldConfig = changedProps.get(\"_config\") as\n      | GlanceCardConfig\n      | undefined;\n\n    if (\n      !oldHass ||\n      !oldConfig ||\n      oldHass.themes !== this.hass.themes ||\n      oldConfig.theme !== this._config.theme\n    ) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      ha-card {\n        height: 100%;\n      }\n      .entities {\n        display: flex;\n        padding: 0 16px 4px;\n        flex-wrap: wrap;\n        box-sizing: border-box;\n        align-items: center;\n        align-content: center;\n      }\n      .entities.no-header {\n        padding-top: 16px;\n      }\n      .entity {\n        box-sizing: border-box;\n        padding: 0 4px;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        cursor: pointer;\n        margin-bottom: 12px;\n        width: var(--glance-column-width, 20%);\n      }\n      .entity:focus {\n        outline: none;\n        background: var(--divider-color);\n        border-radius: 14px;\n        padding: 4px;\n        margin: -4px 0;\n      }\n      .entity div {\n        width: 100%;\n        text-align: center;\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n      .name {\n        min-height: var(--paper-font-body1_-_line-height, 20px);\n      }\n      .warning {\n        cursor: default;\n        position: relative;\n        padding: 8px;\n        width: calc(var(--glance-column-width, 20%) - 4px);\n        margin: 0 2px;\n      }\n      .warning::before {\n        position: absolute;\n        top: 0;\n        right: 0;\n        bottom: 0;\n        left: 0;\n        opacity: 0.12;\n        pointer-events: none;\n        content: \"\";\n        border-radius: 4px;\n        background-color: var(--warning-color);\n      }\n      state-badge {\n        margin: 8px 0;\n      }\n      hui-warning-element {\n        padding: 8px;\n      }\n    `;\n  }\n\n  private renderEntity(entityConf): TemplateResult {\n    const stateObj = this.hass!.states[entityConf.entity];\n\n    if (!stateObj) {\n      return html`<div class=\"entity warning\">\n        ${this._config!.show_name\n          ? html`\n              <div class=\"name\">\n                ${createEntityNotFoundWarning(this.hass!, entityConf.entity)}\n              </div>\n            `\n          : \"\"}\n        ${this._config!.show_icon\n          ? html` <hui-warning-element\n              .label=${createEntityNotFoundWarning(\n                this.hass!,\n                entityConf.entity\n              )}\n            ></hui-warning-element>`\n          : \"\"}\n        <div>${this._config!.show_state ? entityConf.entity : \"\"}</div>\n      </div>`;\n    }\n\n    const name = entityConf.name ?? computeStateName(stateObj);\n\n    return html`\n      <div\n        class=\"entity\"\n        .config=${entityConf}\n        @action=${this._handleAction}\n        .actionHandler=${actionHandler({\n          hasHold: hasAction(entityConf.hold_action),\n          hasDoubleClick: hasAction(entityConf.double_tap_action),\n        })}\n        tabindex=${ifDefined(\n          hasAction(entityConf.tap_action) ? \"0\" : undefined\n        )}\n      >\n        ${this._config!.show_name\n          ? html` <div class=\"name\" .title=${name}>${name}</div> `\n          : \"\"}\n        ${this._config!.show_icon\n          ? html`\n              <state-badge\n                .hass=${this.hass}\n                .stateObj=${stateObj}\n                .overrideIcon=${entityConf.icon}\n                .overrideImage=${entityConf.image}\n                .stateColor=${(entityConf.state_color === false ||\n                  entityConf.state_color) ??\n                this._config!.state_color}\n              ></state-badge>\n            `\n          : \"\"}\n        ${this._config!.show_state && entityConf.show_state !== false\n          ? html`\n              <div>\n                ${computeDomain(entityConf.entity) === \"sensor\" &&\n                stateObj.attributes.device_class ===\n                  SENSOR_DEVICE_CLASS_TIMESTAMP &&\n                !UNAVAILABLE_STATES.includes(stateObj.state)\n                  ? html`\n                      <hui-timestamp-display\n                        .hass=${this.hass}\n                        .ts=${new Date(stateObj.state)}\n                        .format=${entityConf.format}\n                        capitalize\n                      ></hui-timestamp-display>\n                    `\n                  : entityConf.show_last_changed\n                  ? html`\n                      <ha-relative-time\n                        .hass=${this.hass}\n                        .datetime=${stateObj.last_changed}\n                        capitalize\n                      ></ha-relative-time>\n                    `\n                  : computeStateDisplay(\n                      this.hass!.localize,\n                      stateObj,\n                      this.hass!.locale\n                    )}\n              </div>\n            `\n          : \"\"}\n      </div>\n    `;\n  }\n\n  private _handleAction(ev: ActionHandlerEvent) {\n    const config = (ev.currentTarget as any).config as GlanceConfigEntity;\n    handleAction(this, this.hass!, config, ev.detail.action!);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-glance-card\": HuiGlanceCard;\n  }\n}\n","import { css, CSSResultGroup } from \"lit\";\nimport { computeCardSize } from \"../common/compute-card-size\";\nimport { LovelaceCardEditor } from \"../types\";\nimport { HuiStackCard } from \"./hui-stack-card\";\nimport { GridCardConfig } from \"./types\";\n\nconst DEFAULT_COLUMNS = 3;\nconst SQUARE_ROW_HEIGHTS_BY_COLUMNS = {\n  1: 5,\n  2: 3,\n  3: 2,\n};\n\nclass HuiGridCard extends HuiStackCard<GridCardConfig> {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(\"../editor/config-elements/hui-grid-card-editor\");\n    return document.createElement(\"hui-grid-card-editor\");\n  }\n\n  public async getCardSize(): Promise<number> {\n    if (!this._cards || !this._config) {\n      return 0;\n    }\n\n    if (this.square) {\n      const rowHeight = SQUARE_ROW_HEIGHTS_BY_COLUMNS[this.columns] || 1;\n      return (\n        (this._cards.length < this.columns\n          ? rowHeight\n          : (this._cards.length / this.columns) * rowHeight) +\n        (this._config.title ? 1 : 0)\n      );\n    }\n\n    const promises: Array<Promise<number> | number> = [];\n\n    for (const element of this._cards) {\n      promises.push(computeCardSize(element));\n    }\n\n    const cardSizes = await Promise.all(promises);\n\n    let totalHeight = this._config.title ? 1 : 0;\n\n    // Each column will adjust to max card size of it's row\n    for (let start = 0; start < cardSizes.length; start += this.columns) {\n      totalHeight += Math.max(...cardSizes.slice(start, start + this.columns));\n    }\n\n    return totalHeight;\n  }\n\n  get columns() {\n    return this._config?.columns || DEFAULT_COLUMNS;\n  }\n\n  get square() {\n    return this._config?.square !== false;\n  }\n\n  setConfig(config: GridCardConfig) {\n    super.setConfig(config);\n    this.style.setProperty(\"--grid-card-column-count\", String(this.columns));\n    if (this.square) {\n      this.setAttribute(\"square\", \"\");\n    } else {\n      this.removeAttribute(\"square\");\n    }\n  }\n\n  static get styles(): CSSResultGroup {\n    return [\n      super.sharedStyles,\n      css`\n        #root {\n          display: grid;\n          grid-template-columns: repeat(\n            var(--grid-card-column-count, ${DEFAULT_COLUMNS}),\n            minmax(0, 1fr)\n          );\n          grid-gap: var(--grid-card-gap, 8px);\n        }\n        :host([square]) #root {\n          grid-auto-rows: 1fr;\n        }\n        :host([square]) #root::before {\n          content: \"\";\n          width: 0;\n          padding-bottom: 100%;\n          grid-row: 1 / 1;\n          grid-column: 1 / 1;\n        }\n\n        :host([square]) #root > *:not([hidden]) {\n          grid-row: 1 / 1;\n          grid-column: 1 / 1;\n        }\n        :host([square]) #root > *:not([hidden]) ~ *:not([hidden]) {\n          /*\n\t       * Remove grid-row and grid-column from every element that comes after\n\t       * the first not-hidden element\n\t       */\n          grid-row: unset;\n          grid-column: unset;\n        }\n      `,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-grid-card\": HuiGridCard;\n  }\n}\n\ncustomElements.define(\"hui-grid-card\", HuiGridCard);\n","import { mdiDotsVertical } from \"@mdi/js\";\nimport \"@thomasloven/round-slider\";\nimport {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { classMap } from \"lit/directives/class-map\";\nimport { styleMap } from \"lit/directives/style-map\";\nimport { applyThemesOnElement } from \"../../../common/dom/apply_themes_on_element\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { computeStateDisplay } from \"../../../common/entity/compute_state_display\";\nimport { computeStateName } from \"../../../common/entity/compute_state_name\";\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon-button\";\nimport \"../../../components/ha-state-icon\";\nimport { UNAVAILABLE, UNAVAILABLE_STATES } from \"../../../data/entity\";\nimport { LightEntity, lightSupportsDimming } from \"../../../data/light\";\nimport { ActionHandlerEvent } from \"../../../data/lovelace\";\nimport { HomeAssistant } from \"../../../types\";\nimport { actionHandler } from \"../common/directives/action-handler-directive\";\nimport { findEntities } from \"../common/find-entities\";\nimport { handleAction } from \"../common/handle-action\";\nimport { hasAction } from \"../common/has-action\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { createEntityNotFoundWarning } from \"../components/hui-warning\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { LightCardConfig } from \"./types\";\n\n@customElement(\"hui-light-card\")\nexport class HuiLightCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(\"../editor/config-elements/hui-light-card-editor\");\n    return document.createElement(\"hui-light-card-editor\");\n  }\n\n  public static getStubConfig(\n    hass: HomeAssistant,\n    entities: string[],\n    entitiesFallback: string[]\n  ): LightCardConfig {\n    const includeDomains = [\"light\"];\n    const maxEntities = 1;\n    const foundEntities = findEntities(\n      hass,\n      maxEntities,\n      entities,\n      entitiesFallback,\n      includeDomains\n    );\n\n    return { type: \"light\", entity: foundEntities[0] || \"\" };\n  }\n\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @state() private _config?: LightCardConfig;\n\n  private _brightnessTimout?: number;\n\n  public getCardSize(): number {\n    return 5;\n  }\n\n  public setConfig(config: LightCardConfig): void {\n    if (!config.entity || config.entity.split(\".\")[0] !== \"light\") {\n      throw new Error(\"Specify an entity from within the light domain\");\n    }\n\n    this._config = {\n      tap_action: { action: \"toggle\" },\n      hold_action: { action: \"more-info\" },\n      ...config,\n    };\n  }\n\n  protected render(): TemplateResult {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config!.entity] as LightEntity;\n\n    if (!stateObj) {\n      return html`\n        <hui-warning>\n          ${createEntityNotFoundWarning(this.hass, this._config.entity)}\n        </hui-warning>\n      `;\n    }\n\n    const brightness =\n      Math.round((stateObj.attributes.brightness / 255) * 100) || 0;\n\n    const name = this._config.name ?? computeStateName(stateObj);\n\n    return html`\n      <ha-card>\n        <ha-icon-button\n          class=\"more-info\"\n          .label=${this.hass!.localize(\n            \"ui.panel.lovelace.cards.show_more_info\"\n          )}\n          .path=${mdiDotsVertical}\n          @click=${this._handleMoreInfo}\n          tabindex=\"0\"\n        ></ha-icon-button>\n\n        <div class=\"content\">\n          <div id=\"controls\">\n            <div id=\"slider\">\n              <round-slider\n                min=\"1\"\n                max=\"100\"\n                .value=${brightness}\n                .disabled=${UNAVAILABLE_STATES.includes(stateObj.state)}\n                @value-changing=${this._dragEvent}\n                @value-changed=${this._setBrightness}\n                style=${styleMap({\n                  visibility: lightSupportsDimming(stateObj)\n                    ? \"visible\"\n                    : \"hidden\",\n                })}\n              ></round-slider>\n              <ha-icon-button\n                class=\"light-button ${classMap({\n                  \"slider-center\": lightSupportsDimming(stateObj),\n                  \"state-on\": stateObj.state === \"on\",\n                  \"state-unavailable\": stateObj.state === UNAVAILABLE,\n                })}\"\n                .disabled=${UNAVAILABLE_STATES.includes(stateObj.state)}\n                style=${styleMap({\n                  filter: this._computeBrightness(stateObj),\n                  color: this._computeColor(stateObj),\n                })}\n                @action=${this._handleAction}\n                .actionHandler=${actionHandler({\n                  hasHold: hasAction(this._config!.hold_action),\n                  hasDoubleClick: hasAction(this._config!.double_tap_action),\n                })}\n                tabindex=\"0\"\n              >\n                <ha-state-icon\n                  .icon=${this._config.icon}\n                  .state=${stateObj}\n                ></ha-state-icon>\n              </ha-icon-button>\n            </div>\n          </div>\n\n          <div id=\"info\" .title=${name}>\n            ${UNAVAILABLE_STATES.includes(stateObj.state)\n              ? html`\n                  <div>\n                    ${computeStateDisplay(\n                      this.hass.localize,\n                      stateObj,\n                      this.hass.locale\n                    )}\n                  </div>\n                `\n              : html` <div class=\"brightness\">%</div> `}\n            ${name}\n          </div>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (!this._config || !this.hass) {\n      return;\n    }\n\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    if (!stateObj) {\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    const oldConfig = changedProps.get(\"_config\") as\n      | LightCardConfig\n      | undefined;\n\n    if (\n      !oldHass ||\n      !oldConfig ||\n      oldHass.themes !== this.hass.themes ||\n      oldConfig.theme !== this._config.theme\n    ) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n  }\n\n  private _dragEvent(e: any): void {\n    this.shadowRoot!.querySelector(\n      \".brightness\"\n    )!.innerHTML = `${e.detail.value} %`;\n    this._showBrightness();\n    this._hideBrightness();\n  }\n\n  private _showBrightness(): void {\n    clearTimeout(this._brightnessTimout);\n    this.shadowRoot!.querySelector(\".brightness\")!.classList.add(\n      \"show_brightness\"\n    );\n  }\n\n  private _hideBrightness(): void {\n    this._brightnessTimout = window.setTimeout(() => {\n      this.shadowRoot!.querySelector(\".brightness\")!.classList.remove(\n        \"show_brightness\"\n      );\n    }, 500);\n  }\n\n  private _setBrightness(e: any): void {\n    this.hass!.callService(\"light\", \"turn_on\", {\n      entity_id: this._config!.entity,\n      brightness_pct: e.detail.value,\n    });\n  }\n\n  private _computeBrightness(stateObj: LightEntity): string {\n    if (stateObj.state === \"off\" || !stateObj.attributes.brightness) {\n      return \"\";\n    }\n    const brightness = stateObj.attributes.brightness;\n    return `brightness(${(brightness + 245) / 5}%)`;\n  }\n\n  private _computeColor(stateObj: LightEntity): string {\n    if (stateObj.state === \"off\") {\n      return \"\";\n    }\n    return stateObj.attributes.rgb_color\n      ? `rgb(${stateObj.attributes.rgb_color.join(\",\")})`\n      : \"\";\n  }\n\n  private _handleAction(ev: ActionHandlerEvent) {\n    handleAction(this, this.hass!, this._config!, ev.detail.action!);\n  }\n\n  private _handleMoreInfo() {\n    fireEvent(this, \"hass-more-info\", {\n      entityId: this._config!.entity,\n    });\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      ha-card {\n        height: 100%;\n        box-sizing: border-box;\n        position: relative;\n        overflow: hidden;\n        text-align: center;\n        --name-font-size: 1.2rem;\n        --brightness-font-size: 1.2rem;\n      }\n\n      .more-info {\n        position: absolute;\n        cursor: pointer;\n        top: 0;\n        right: 0;\n        border-radius: 100%;\n        color: var(--secondary-text-color);\n        z-index: 1;\n      }\n\n      .content {\n        height: 100%;\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n      }\n\n      #controls {\n        display: flex;\n        justify-content: center;\n        padding: 16px;\n        position: relative;\n      }\n\n      #slider {\n        height: 100%;\n        width: 100%;\n        position: relative;\n        max-width: 200px;\n        min-width: 100px;\n      }\n\n      round-slider {\n        --round-slider-path-color: var(--slider-track-color);\n        --round-slider-bar-color: var(--primary-color);\n        padding-bottom: 10%;\n      }\n\n      .light-button {\n        color: var(--paper-item-icon-color, #44739e);\n        width: 60%;\n        height: auto;\n        position: absolute;\n        max-width: calc(100% - 40px);\n        box-sizing: border-box;\n        border-radius: 100%;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n        --mdc-icon-button-size: 100%;\n        --mdc-icon-size: 100%;\n      }\n\n      .light-button.state-on {\n        color: var(--paper-item-icon-active-color, #fdd835);\n      }\n\n      .light-button.state-unavailable {\n        color: var(--state-icon-unavailable-color);\n      }\n\n      #info {\n        text-align: center;\n        margin-top: -56px;\n        padding: 16px;\n        font-size: var(--name-font-size);\n      }\n\n      .brightness {\n        font-size: var(--brightness-font-size);\n        opacity: 0;\n        transition: opacity 0.5s ease-in-out;\n        -moz-transition: opacity 0.5s ease-in-out;\n        -webkit-transition: opacity 0.5s ease-in-out;\n      }\n\n      .show_brightness {\n        opacity: 1;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-light-card\": HuiLightCard;\n  }\n}\n","import {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { property, state } from \"lit/decorators\";\nimport { LovelaceCardConfig } from \"../../../data/lovelace\";\nimport { HomeAssistant } from \"../../../types\";\nimport { createCardElement } from \"../create-element/create-card-element\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { StackCardConfig } from \"./types\";\n\nexport abstract class HuiStackCard<T extends StackCardConfig = StackCardConfig>\n  extends LitElement\n  implements LovelaceCard\n{\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(\"../editor/config-elements/hui-stack-card-editor\");\n    return document.createElement(\"hui-stack-card-editor\");\n  }\n\n  public static getStubConfig(): Record<string, unknown> {\n    return { cards: [] };\n  }\n\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @property() public editMode?: boolean;\n\n  @property() protected _cards?: LovelaceCard[];\n\n  @state() protected _config?: T;\n\n  public getCardSize(): number | Promise<number> {\n    return 1;\n  }\n\n  public setConfig(config: T): void {\n    if (!config || !config.cards || !Array.isArray(config.cards)) {\n      throw new Error(\"Invalid configuration\");\n    }\n    this._config = config;\n    this._cards = config.cards.map((card) => {\n      const element = this._createCardElement(card) as LovelaceCard;\n      return element;\n    });\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    super.updated(changedProps);\n    if (\n      !this._cards ||\n      (!changedProps.has(\"hass\") && !changedProps.has(\"editMode\"))\n    ) {\n      return;\n    }\n\n    for (const element of this._cards) {\n      if (this.hass) {\n        element.hass = this.hass;\n      }\n      if (this.editMode !== undefined) {\n        element.editMode = this.editMode;\n      }\n    }\n  }\n\n  protected render(): TemplateResult {\n    if (!this._config || !this._cards) {\n      return html``;\n    }\n\n    return html`\n      ${this._config.title\n        ? html`<h1 class=\"card-header\">${this._config.title}</h1>`\n        : \"\"}\n      <div id=\"root\">${this._cards}</div>\n    `;\n  }\n\n  static get sharedStyles(): CSSResultGroup {\n    return css`\n      .card-header {\n        color: var(--ha-card-header-color, --primary-text-color);\n        font-family: var(--ha-card-header-font-family, inherit);\n        font-size: var(--ha-card-header-font-size, 24px);\n        font-weight: normal;\n        margin-block-start: 0px;\n        margin-block-end: 0px;\n        letter-spacing: -0.012em;\n        line-height: 32px;\n        display: block;\n        padding: 24px 16px 16px;\n      }\n    `;\n  }\n\n  private _createCardElement(cardConfig: LovelaceCardConfig) {\n    const element = createCardElement(cardConfig) as LovelaceCard;\n    if (this.hass) {\n      element.hass = this.hass;\n    }\n    element.addEventListener(\n      \"ll-rebuild\",\n      (ev) => {\n        ev.stopPropagation();\n        this._rebuildCard(element, cardConfig);\n      },\n      { once: true }\n    );\n    return element;\n  }\n\n  private _rebuildCard(\n    cardElToReplace: LovelaceCard,\n    config: LovelaceCardConfig\n  ): void {\n    const newCardEl = this._createCardElement(config);\n    if (cardElToReplace.parentElement) {\n      cardElToReplace.parentElement.replaceChild(newCardEl, cardElToReplace);\n    }\n    this._cards = this._cards!.map((curCardEl) =>\n      curCardEl === cardElToReplace ? newCardEl : curCardEl\n    );\n  }\n}\n","import {\n  mdiAutorenew,\n  mdiCalendarSync,\n  mdiDotsVertical,\n  mdiFan,\n  mdiFire,\n  mdiPower,\n  mdiSnowflake,\n  mdiWaterPercent,\n} from \"@mdi/js\";\nimport \"@thomasloven/round-slider\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  svg,\n  TemplateResult,\n} from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport { classMap } from \"lit/directives/class-map\";\nimport { UNIT_F } from \"../../../common/const\";\nimport { applyThemesOnElement } from \"../../../common/dom/apply_themes_on_element\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { computeStateName } from \"../../../common/entity/compute_state_name\";\nimport { formatNumber } from \"../../../common/number/format_number\";\nimport \"../../../components/ha-card\";\nimport type { HaCard } from \"../../../components/ha-card\";\nimport \"../../../components/ha-icon-button\";\nimport {\n  ClimateEntity,\n  CLIMATE_PRESET_NONE,\n  compareClimateHvacModes,\n  HvacMode,\n} from \"../../../data/climate\";\nimport { UNAVAILABLE } from \"../../../data/entity\";\nimport { HomeAssistant } from \"../../../types\";\nimport { findEntities } from \"../common/find-entities\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { createEntityNotFoundWarning } from \"../components/hui-warning\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { ThermostatCardConfig } from \"./types\";\n\nconst modeIcons: { [mode in HvacMode]: string } = {\n  auto: mdiCalendarSync,\n  heat_cool: mdiAutorenew,\n  heat: mdiFire,\n  cool: mdiSnowflake,\n  off: mdiPower,\n  fan_only: mdiFan,\n  dry: mdiWaterPercent,\n};\n\n@customElement(\"hui-thermostat-card\")\nexport class HuiThermostatCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(\"../editor/config-elements/hui-thermostat-card-editor\");\n    return document.createElement(\"hui-thermostat-card-editor\");\n  }\n\n  public static getStubConfig(\n    hass: HomeAssistant,\n    entities: string[],\n    entitiesFallback: string[]\n  ): ThermostatCardConfig {\n    const includeDomains = [\"climate\"];\n    const maxEntities = 1;\n    const foundEntities = findEntities(\n      hass,\n      maxEntities,\n      entities,\n      entitiesFallback,\n      includeDomains\n    );\n\n    return { type: \"thermostat\", entity: foundEntities[0] || \"\" };\n  }\n\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @state() private _config?: ThermostatCardConfig;\n\n  @state() private _setTemp?: number | number[];\n\n  @query(\"ha-card\") private _card?: HaCard;\n\n  public getCardSize(): number {\n    return 7;\n  }\n\n  public setConfig(config: ThermostatCardConfig): void {\n    if (!config.entity || config.entity.split(\".\")[0] !== \"climate\") {\n      throw new Error(\"Specify an entity from within the climate domain\");\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n    const stateObj = this.hass.states[this._config.entity] as ClimateEntity;\n\n    if (!stateObj) {\n      return html`\n        <hui-warning>\n          ${createEntityNotFoundWarning(this.hass, this._config.entity)}\n        </hui-warning>\n      `;\n    }\n\n    const mode = stateObj.state in modeIcons ? stateObj.state : \"unknown-mode\";\n    const name =\n      this._config!.name ||\n      computeStateName(this.hass!.states[this._config!.entity]);\n    const targetTemp =\n      stateObj.attributes.temperature !== null &&\n      Number.isFinite(Number(stateObj.attributes.temperature))\n        ? stateObj.attributes.temperature\n        : stateObj.attributes.min_temp;\n\n    const slider =\n      stateObj.state === UNAVAILABLE\n        ? html` <round-slider disabled=\"true\"></round-slider> `\n        : html`\n            <round-slider\n              .value=${targetTemp}\n              .low=${stateObj.attributes.target_temp_low}\n              .high=${stateObj.attributes.target_temp_high}\n              .min=${stateObj.attributes.min_temp}\n              .max=${stateObj.attributes.max_temp}\n              .step=${this._stepSize}\n              @value-changing=${this._dragEvent}\n              @value-changed=${this._setTemperature}\n            ></round-slider>\n          `;\n\n    const currentTemperature = svg`\n        <svg viewBox=\"0 0 40 20\">\n          <text\n            x=\"50%\"\n            dx=\"1\"\n            y=\"60%\"\n            text-anchor=\"middle\"\n            style=\"font-size: 13px;\"\n          >\n            ${\n              stateObj.attributes.current_temperature !== null &&\n              !isNaN(stateObj.attributes.current_temperature)\n                ? svg`${formatNumber(\n                    stateObj.attributes.current_temperature,\n                    this.hass.locale\n                  )}\n            <tspan dx=\"-3\" dy=\"-6.5\" style=\"font-size: 4px;\">\n              ${this.hass.config.unit_system.temperature}\n            </tspan>`\n                : \"\"\n            }\n          </text>\n        </svg>\n      `;\n\n    const setValues = svg`\n      <svg id=\"set-values\">\n        <g>\n          <text text-anchor=\"middle\" class=\"set-value\">\n            ${\n              stateObj.state === UNAVAILABLE\n                ? this.hass.localize(\"state.default.unavailable\")\n                : this._setTemp === undefined || this._setTemp === null\n                ? \"\"\n                : Array.isArray(this._setTemp)\n                ? this._stepSize === 1\n                  ? svg`\n                      ${formatNumber(this._setTemp[0], this.hass.locale, {\n                        maximumFractionDigits: 0,\n                      })} -\n                      ${formatNumber(this._setTemp[1], this.hass.locale, {\n                        maximumFractionDigits: 0,\n                      })}\n                      `\n                  : svg`\n                      ${formatNumber(this._setTemp[0], this.hass.locale, {\n                        minimumFractionDigits: 1,\n                        maximumFractionDigits: 1,\n                      })} -\n                      ${formatNumber(this._setTemp[1], this.hass.locale, {\n                        minimumFractionDigits: 1,\n                        maximumFractionDigits: 1,\n                      })}\n                      `\n                : this._stepSize === 1\n                ? svg`\n                      ${formatNumber(this._setTemp, this.hass.locale, {\n                        maximumFractionDigits: 0,\n                      })}\n                      `\n                : svg`\n                      ${formatNumber(this._setTemp, this.hass.locale, {\n                        minimumFractionDigits: 1,\n                        maximumFractionDigits: 1,\n                      })}\n                      `\n            }\n          </text>\n          <text\n            dy=\"22\"\n            text-anchor=\"middle\"\n            id=\"set-mode\"\n          >\n            ${\n              stateObj.attributes.hvac_action\n                ? this.hass!.localize(\n                    `state_attributes.climate.hvac_action.${stateObj.attributes.hvac_action}`\n                  )\n                : this.hass!.localize(\n                    `component.climate.state._.${stateObj.state}`\n                  )\n            }\n            ${\n              stateObj.attributes.preset_mode &&\n              stateObj.attributes.preset_mode !== CLIMATE_PRESET_NONE\n                ? html`\n                    -\n                    ${this.hass!.localize(\n                      `state_attributes.climate.preset_mode.${stateObj.attributes.preset_mode}`\n                    ) || stateObj.attributes.preset_mode}\n                  `\n                : \"\"\n            }\n          </text>\n        </g>\n      </svg>\n    `;\n\n    return html`\n      <ha-card\n        class=${classMap({\n          [mode]: true,\n        })}\n      >\n        <ha-icon-button\n          class=\"more-info\"\n          .label=${this.hass!.localize(\n            \"ui.panel.lovelace.cards.show_more_info\"\n          )}\n          .path=${mdiDotsVertical}\n          @click=${this._handleMoreInfo}\n          tabindex=\"0\"\n        ></ha-icon-button>\n\n        <div class=\"content\">\n          <div id=\"controls\">\n            <div id=\"slider\">\n              ${slider}\n              <div id=\"slider-center\">\n                <div id=\"temperature\">${currentTemperature} ${setValues}</div>\n              </div>\n            </div>\n          </div>\n          <div id=\"info\" .title=${name}>\n            <div id=\"modes\">\n              ${(stateObj.attributes.hvac_modes || [])\n                .concat()\n                .sort(compareClimateHvacModes)\n                .map((modeItem) => this._renderIcon(modeItem, mode))}\n            </div>\n            ${name}\n          </div>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n\n    if (\n      !this._config ||\n      !this.hass ||\n      (!changedProps.has(\"hass\") && !changedProps.has(\"_config\"))\n    ) {\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    const oldConfig = changedProps.get(\"_config\") as\n      | ThermostatCardConfig\n      | undefined;\n\n    if (\n      !oldHass ||\n      !oldConfig ||\n      oldHass.themes !== this.hass.themes ||\n      oldConfig.theme !== this._config.theme\n    ) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n    if (!stateObj) {\n      return;\n    }\n\n    if (!oldHass || oldHass.states[this._config.entity] !== stateObj) {\n      this._rescale_svg();\n    }\n  }\n\n  public willUpdate(changedProps: PropertyValues) {\n    if (!this.hass || !this._config || !changedProps.has(\"hass\")) {\n      return;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n    if (!stateObj) {\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n\n    if (!oldHass || oldHass.states[this._config.entity] !== stateObj) {\n      this._setTemp = this._getSetTemp(stateObj);\n    }\n  }\n\n  private _rescale_svg() {\n    // Set the viewbox of the SVG containing the set temperature to perfectly\n    // fit the text\n    // That way it will auto-scale correctly\n    // This is not done to the SVG containing the current temperature, because\n    // it should not be centered on the text, but only on the value\n    const card = this._card;\n    if (card) {\n      card.updateComplete.then(() => {\n        const svgRoot = this.shadowRoot!.querySelector(\"#set-values\")!;\n        const box = svgRoot.querySelector(\"g\")!.getBBox()!;\n        svgRoot.setAttribute(\n          \"viewBox\",\n          `${box.x} ${box!.y} ${box.width} ${box.height}`\n        );\n        svgRoot.setAttribute(\"width\", `${box.width}`);\n        svgRoot.setAttribute(\"height\", `${box.height}`);\n      });\n    }\n  }\n\n  private get _stepSize(): number {\n    const stateObj = this.hass!.states[this._config!.entity] as ClimateEntity;\n\n    if (stateObj.attributes.target_temp_step) {\n      return stateObj.attributes.target_temp_step;\n    }\n    return this.hass!.config.unit_system.temperature === UNIT_F ? 1 : 0.5;\n  }\n\n  private _getSetTemp(\n    stateObj: HassEntity\n  ): undefined | number | [number, number] {\n    if (stateObj.state === UNAVAILABLE) {\n      return undefined;\n    }\n\n    if (\n      stateObj.attributes.target_temp_low &&\n      stateObj.attributes.target_temp_high\n    ) {\n      return [\n        stateObj.attributes.target_temp_low,\n        stateObj.attributes.target_temp_high,\n      ];\n    }\n\n    return stateObj.attributes.temperature;\n  }\n\n  private _dragEvent(e): void {\n    const stateObj = this.hass!.states[this._config!.entity] as ClimateEntity;\n\n    if (e.detail.low) {\n      this._setTemp = [e.detail.low, stateObj.attributes.target_temp_high];\n    } else if (e.detail.high) {\n      this._setTemp = [stateObj.attributes.target_temp_low, e.detail.high];\n    } else {\n      this._setTemp = e.detail.value;\n    }\n  }\n\n  private _setTemperature(e): void {\n    const stateObj = this.hass!.states[this._config!.entity] as ClimateEntity;\n\n    if (e.detail.low) {\n      this.hass!.callService(\"climate\", \"set_temperature\", {\n        entity_id: this._config!.entity,\n        target_temp_low: e.detail.low,\n        target_temp_high: stateObj.attributes.target_temp_high,\n      });\n    } else if (e.detail.high) {\n      this.hass!.callService(\"climate\", \"set_temperature\", {\n        entity_id: this._config!.entity,\n        target_temp_low: stateObj.attributes.target_temp_low,\n        target_temp_high: e.detail.high,\n      });\n    } else {\n      this.hass!.callService(\"climate\", \"set_temperature\", {\n        entity_id: this._config!.entity,\n        temperature: e.detail.value,\n      });\n    }\n  }\n\n  private _renderIcon(mode: string, currentMode: string): TemplateResult {\n    if (!modeIcons[mode]) {\n      return html``;\n    }\n    return html`\n      <ha-icon-button\n        class=${classMap({ \"selected-icon\": currentMode === mode })}\n        .mode=${mode}\n        @click=${this._handleAction}\n        tabindex=\"0\"\n        .path=${modeIcons[mode]}\n        .label=${this.hass!.localize(`component.climate.state._.${mode}`)}\n      >\n      </ha-icon-button>\n    `;\n  }\n\n  private _handleMoreInfo() {\n    fireEvent(this, \"hass-more-info\", {\n      entityId: this._config!.entity,\n    });\n  }\n\n  private _handleAction(e: MouseEvent): void {\n    this.hass!.callService(\"climate\", \"set_hvac_mode\", {\n      entity_id: this._config!.entity,\n      hvac_mode: (e.currentTarget as any).mode,\n    });\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      :host {\n        display: block;\n      }\n\n      ha-card {\n        height: 100%;\n        position: relative;\n        overflow: hidden;\n        --name-font-size: 1.2rem;\n        --brightness-font-size: 1.2rem;\n        --rail-border-color: transparent;\n      }\n      .auto,\n      .heat_cool {\n        --mode-color: var(--state-climate-auto-color);\n      }\n      .cool {\n        --mode-color: var(--state-climate-cool-color);\n      }\n      .heat {\n        --mode-color: var(--state-climate-heat-color);\n      }\n      .manual {\n        --mode-color: var(--state-climate-manual-color);\n      }\n      .off {\n        --mode-color: var(--state-climate-off-color);\n      }\n      .fan_only {\n        --mode-color: var(--state-climate-fan_only-color);\n      }\n      .eco {\n        --mode-color: var(--state-climate-eco-color);\n      }\n      .dry {\n        --mode-color: var(--state-climate-dry-color);\n      }\n      .idle {\n        --mode-color: var(--state-climate-idle-color);\n      }\n      .unknown-mode {\n        --mode-color: var(--state-unknown-color);\n      }\n\n      .more-info {\n        position: absolute;\n        cursor: pointer;\n        top: 0;\n        right: 0;\n        border-radius: 100%;\n        color: var(--secondary-text-color);\n        z-index: 1;\n      }\n\n      .content {\n        height: 100%;\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n      }\n\n      #controls {\n        display: flex;\n        justify-content: center;\n        padding: 16px;\n        position: relative;\n      }\n\n      #slider {\n        height: 100%;\n        width: 100%;\n        position: relative;\n        max-width: 250px;\n        min-width: 100px;\n      }\n\n      round-slider {\n        --round-slider-path-color: var(--slider-track-color);\n        --round-slider-bar-color: var(--mode-color);\n        padding-bottom: 10%;\n      }\n\n      #slider-center {\n        position: absolute;\n        width: calc(100% - 40px);\n        height: calc(100% - 40px);\n        box-sizing: border-box;\n        border-radius: 100%;\n        left: 20px;\n        top: 20px;\n        text-align: center;\n        overflow-wrap: break-word;\n        pointer-events: none;\n      }\n\n      #temperature {\n        position: absolute;\n        transform: translate(-50%, -50%);\n        width: 100%;\n        height: 50%;\n        top: 45%;\n        left: 50%;\n      }\n\n      #set-values {\n        max-width: 80%;\n        transform: translate(0, -50%);\n        font-size: 20px;\n      }\n\n      #set-mode {\n        fill: var(--secondary-text-color);\n        font-size: 16px;\n      }\n\n      #info {\n        display: flex-vertical;\n        justify-content: center;\n        text-align: center;\n        padding: 16px;\n        margin-top: -60px;\n        font-size: var(--name-font-size);\n      }\n\n      #modes > * {\n        color: var(--disabled-text-color);\n        cursor: pointer;\n        display: inline-block;\n      }\n\n      #modes .selected-icon {\n        color: var(--mode-color);\n      }\n\n      text {\n        fill: var(--primary-text-color);\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-thermostat-card\": HuiThermostatCard;\n  }\n}\n","import {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { ifDefined } from \"lit/directives/if-defined\";\nimport { formatTime } from \"../../../common/datetime/format_time\";\nimport { applyThemesOnElement } from \"../../../common/dom/apply_themes_on_element\";\nimport { computeStateDisplay } from \"../../../common/entity/compute_state_display\";\nimport { computeStateName } from \"../../../common/entity/compute_state_name\";\nimport { isValidEntityId } from \"../../../common/entity/valid_entity_id\";\nimport { formatNumber } from \"../../../common/number/format_number\";\nimport { debounce } from \"../../../common/util/debounce\";\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-svg-icon\";\nimport { UNAVAILABLE } from \"../../../data/entity\";\nimport { ActionHandlerEvent } from \"../../../data/lovelace\";\nimport {\n  getSecondaryWeatherAttribute,\n  getWeatherStateIcon,\n  getWeatherUnit,\n  getWind,\n  weatherAttrIcons,\n  WeatherEntity,\n  weatherSVGStyles,\n  weatherStateIsImage, // IoB\n} from \"../../../data/weather\";\nimport type { HomeAssistant } from \"../../../types\";\nimport { actionHandler } from \"../common/directives/action-handler-directive\";\nimport { findEntities } from \"../common/find-entities\";\nimport { handleAction } from \"../common/handle-action\";\nimport { hasAction } from \"../common/has-action\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { installResizeObserver } from \"../common/install-resize-observer\";\nimport { createEntityNotFoundWarning } from \"../components/hui-warning\";\nimport type { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport type { WeatherForecastCardConfig } from \"./types\";\n\nconst DAY_IN_MILLISECONDS = 86400000;\n\n@customElement(\"hui-weather-forecast-card\")\nclass HuiWeatherForecastCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(\"../editor/config-elements/hui-weather-forecast-card-editor\");\n    return document.createElement(\"hui-weather-forecast-card-editor\");\n  }\n\n  public static getStubConfig(\n    hass: HomeAssistant,\n    entities: string[],\n    entitiesFallback: string[]\n  ): WeatherForecastCardConfig {\n    const includeDomains = [\"weather\"];\n    const maxEntities = 1;\n    const foundEntities = findEntities(\n      hass,\n      maxEntities,\n      entities,\n      entitiesFallback,\n      includeDomains\n    );\n\n    return { type: \"weather-forecast\", entity: foundEntities[0] || \"\" };\n  }\n\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @state() private _config?: WeatherForecastCardConfig;\n\n  @property({ type: Boolean, reflect: true, attribute: \"veryverynarrow\" })\n  private _veryVeryNarrow = false;\n\n  private _resizeObserver?: ResizeObserver;\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this.updateComplete.then(() => this._attachObserver());\n  }\n\n  public disconnectedCallback(): void {\n    if (this._resizeObserver) {\n      this._resizeObserver.disconnect();\n    }\n  }\n\n  public getCardSize(): number {\n    let cardSize = 0;\n    if (this._config?.show_current !== false) {\n      cardSize += 2;\n    }\n    if (this._config?.show_forecast !== false) {\n      cardSize += 3;\n    }\n    return cardSize;\n  }\n\n  public setConfig(config: WeatherForecastCardConfig): void {\n    if (!config.entity) {\n      throw new Error(\"Entity must be specified\");\n    }\n    if (!isValidEntityId(config.entity)) {\n      throw new Error(\"Invalid entity\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  public willUpdate(): void {\n    if (!this.hasUpdated) {\n      this._measureCard();\n    }\n  }\n\n  protected firstUpdated(): void {\n    this._attachObserver();\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (!this._config || !this.hass) {\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    const oldConfig = changedProps.get(\"_config\") as\n      | WeatherForecastCardConfig\n      | undefined;\n\n    if (\n      (changedProps.has(\"hass\") && !oldHass) ||\n      (changedProps.has(\"_config\") && !oldConfig) ||\n      (changedProps.has(\"hass\") && oldHass!.themes !== this.hass.themes) ||\n      (changedProps.has(\"_config\") && oldConfig!.theme !== this._config.theme)\n    ) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n  }\n\n  protected render(): TemplateResult {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity] as WeatherEntity;\n\n    if (!stateObj) {\n      return html`\n        <hui-warning>\n          ${createEntityNotFoundWarning(this.hass, this._config.entity)}\n        </hui-warning>\n      `;\n    }\n\n    if (stateObj.state === UNAVAILABLE) {\n      return html`\n        <ha-card class=\"unavailable\" @click=${this._handleAction}>\n          ${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_unavailable\",\n            \"entity\",\n            `${computeStateName(stateObj)} (${this._config.entity})`\n          )}\n        </ha-card>\n      `;\n    }\n\n    const forecast =\n      this._config?.show_forecast !== false &&\n      stateObj.attributes.forecast?.length\n        ? stateObj.attributes.forecast.slice(0, this._veryVeryNarrow ? 3 : 5)\n        : undefined;\n    const weather = !forecast || this._config?.show_current !== false;\n\n    let hourly: boolean | undefined;\n    let dayNight: boolean | undefined;\n\n    if (forecast?.length && forecast?.length > 2) {\n      const date1 = new Date(forecast[1].datetime);\n      const date2 = new Date(forecast[2].datetime);\n      const timeDiff = date2.getTime() - date1.getTime();\n\n      hourly = timeDiff < DAY_IN_MILLISECONDS;\n\n      if (hourly) {\n        const dateFirst = new Date(forecast[0].datetime);\n        const datelast = new Date(forecast[forecast.length - 1].datetime);\n        const dayDiff = datelast.getTime() - dateFirst.getTime();\n\n        dayNight = dayDiff > DAY_IN_MILLISECONDS;\n      }\n    }\n\n    // IoB Weather icon start\n    const weatherStateIcon = getWeatherStateIcon(\n      stateObj.state,\n      this,\n      false,\n      this.hass.auth.accessToken // IoB weather icon with auth\n    );\n    const isImage = weatherStateIsImage(stateObj.state);\n    // IoB weather icon end\n    const name = this._config.name ?? computeStateName(stateObj);\n\n    return html`\n      <ha-card\n        @action=${this._handleAction}\n        .actionHandler=${actionHandler({\n          hasHold: hasAction(this._config!.hold_action),\n          hasDoubleClick: hasAction(this._config!.double_tap_action),\n        })}\n        tabindex=${ifDefined(\n          hasAction(this._config.tap_action) ? \"0\" : undefined\n        )}\n      >\n        ${weather\n          ? html`\n              <div class=\"content\">\n                <div class=\"icon-image\">\n                  ${weatherStateIcon ||\n                  html`\n                    <ha-state-icon\n                      class=\"weather-icon\"\n                      .state=${stateObj}\n                    ></ha-state-icon>\n                  `}\n                </div>\n                <div class=\"info\">\n                  <div class=\"name-state\">\n                    <div class=\"state\">\n                      <!-- IoB print name instead of state which is an URL -->\n                      ${isImage ? name || computeStateDisplay(\n                        this.hass.localize,\n                        stateObj,\n                        this.hass.locale\n                      ) : computeStateDisplay(this.hass.localize, stateObj, this.hass.locale)}\n                    </div>\n                    <div class=\"name\" .title=${name}>\n                        <!-- IoB name is already printed once -->\n                        ${isImage ? '' : name}\n                    </div>\n                  </div>\n                  <div class=\"temp-attribute\">\n                    <div class=\"temp\">\n                      ${formatNumber(\n                        stateObj.attributes.temperature,\n                        this.hass.locale\n                      )}&nbsp;<span\n                        >${getWeatherUnit(this.hass, \"temperature\")}</span\n                      >\n                    </div>\n                    <div class=\"attribute\">\n                      ${this._config.secondary_info_attribute !== undefined\n                        ? html`\n                            ${this._config.secondary_info_attribute in\n                            weatherAttrIcons\n                              ? html`\n                                  <ha-svg-icon\n                                    class=\"attr-icon\"\n                                    .path=${weatherAttrIcons[\n                                      this._config.secondary_info_attribute\n                                    ]}\n                                  ></ha-svg-icon>\n                                `\n                              : this.hass!.localize(\n                                  `ui.card.weather.attributes.${this._config.secondary_info_attribute}`\n                                )}\n                            ${this._config.secondary_info_attribute ===\n                            \"wind_speed\"\n                              ? getWind(\n                                  this.hass,\n                                  stateObj.attributes.wind_speed,\n                                  stateObj.attributes.wind_bearing\n                                )\n                              : html`\n                                  ${formatNumber(\n                                    stateObj.attributes[\n                                      this._config.secondary_info_attribute\n                                    ],\n                                    this.hass.locale\n                                  )}\n                                  ${getWeatherUnit(\n                                    this.hass,\n                                    this._config.secondary_info_attribute\n                                  )}\n                                `}\n                          `\n                        : getSecondaryWeatherAttribute(this.hass, stateObj)}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            `\n          : \"\"}\n        ${forecast\n          ? html`\n              <div class=\"forecast\">\n                ${forecast.map(\n                  (item) => html`\n                    <div>\n                      <div>\n                        ${dayNight\n                          ? html`\n                              ${new Date(item.datetime).toLocaleDateString(\n                                this.hass!.language,\n                                { weekday: \"short\" }\n                              )}\n                              <div class=\"daynight\">\n                                ${item.daytime === undefined || item.daytime\n                                  ? this.hass!.localize(\"ui.card.weather.day\")\n                                  : this.hass!.localize(\n                                      \"ui.card.weather.night\"\n                                    )}<br />\n                              </div>\n                            `\n                          : hourly\n                          ? html`\n                              ${formatTime(\n                                new Date(item.datetime),\n                                this.hass!.locale\n                              )}\n                            `\n                          : html`\n                              ${new Date(item.datetime).toLocaleDateString(\n                                this.hass!.language,\n                                { weekday: \"short\" }\n                              )}\n                            `}\n                      </div>\n                      ${item.condition !== undefined && item.condition !== null\n                        ? html`\n                            <div class=\"forecast-image-icon\">\n                              ${getWeatherStateIcon(\n                                item.condition,\n                                this,\n                                !(item.daytime || item.daytime === undefined),\n                                this.hass!.auth.accessToken // IoB - weather icon with auth\n                              )}\n                            </div>\n                          `\n                        : \"\"}\n                      ${item.temperature !== undefined &&\n                      item.temperature !== null\n                        ? html`\n                            <div class=\"temp\">\n                              ${formatNumber(\n                                item.temperature,\n                                this.hass!.locale\n                              )}\n                            </div>\n                          `\n                        : \"\"}\n                      ${item.templow !== undefined && item.templow !== null\n                        ? html`\n                            <div class=\"templow\">\n                              ${formatNumber(item.templow, this.hass!.locale)}\n                            </div>\n                          `\n                        : \"\"}\n                    </div>\n                  `\n                )}\n              </div>\n            `\n          : \"\"}\n      </ha-card>\n    `;\n  }\n\n  private _handleAction(ev: ActionHandlerEvent) {\n    handleAction(this, this.hass!, this._config!, ev.detail.action!);\n  }\n\n  private async _attachObserver(): Promise<void> {\n    if (!this._resizeObserver) {\n      await installResizeObserver();\n      this._resizeObserver = new ResizeObserver(\n        debounce(() => this._measureCard(), 250, false)\n      );\n    }\n    const card = this.shadowRoot!.querySelector(\"ha-card\");\n    // If we show an error or warning there is no ha-card\n    if (!card) {\n      return;\n    }\n    this._resizeObserver.observe(card);\n  }\n\n  private _measureCard() {\n    if (!this.isConnected) {\n      return;\n    }\n\n    const card = this.shadowRoot!.querySelector(\"ha-card\");\n    // If we show an error or warning there is no ha-card\n    if (!card) {\n      return;\n    }\n\n    if (card.offsetWidth < 375) {\n      this.setAttribute(\"narrow\", \"\");\n    } else {\n      this.removeAttribute(\"narrow\");\n    }\n    if (card.offsetWidth < 300) {\n      this.setAttribute(\"verynarrow\", \"\");\n    } else {\n      this.removeAttribute(\"verynarrow\");\n    }\n    this._veryVeryNarrow = card.offsetWidth < 245;\n  }\n\n  static get styles(): CSSResultGroup {\n    return [\n      weatherSVGStyles,\n      css`\n        ha-card {\n          cursor: pointer;\n          outline: none;\n          height: 100%;\n          display: flex;\n          flex-direction: column;\n          justify-content: center;\n          padding: 16px;\n          box-sizing: border-box;\n        }\n\n        .content {\n          display: flex;\n          flex-wrap: nowrap;\n          justify-content: space-between;\n          align-items: center;\n        }\n\n        .icon-image {\n          display: flex;\n          align-items: center;\n          min-width: 64px;\n          margin-right: 16px;\n        }\n\n        .icon-image > * {\n          flex: 0 0 64px;\n          height: 64px;\n        }\n\n        .weather-icon {\n          --mdc-icon-size: 64px;\n        }\n\n        .info {\n          display: flex;\n          justify-content: space-between;\n          flex-grow: 1;\n          overflow: hidden;\n        }\n\n        .temp-attribute {\n          text-align: right;\n        }\n\n        .temp-attribute .temp {\n          position: relative;\n          margin-right: 24px;\n        }\n\n        .temp-attribute .temp span {\n          position: absolute;\n          font-size: 24px;\n          top: 1px;\n        }\n\n        .state,\n        .temp-attribute .temp {\n          font-size: 28px;\n          line-height: 1.2;\n        }\n\n        .name,\n        .attribute {\n          font-size: 14px;\n          line-height: 1;\n        }\n\n        .name-state {\n          overflow: hidden;\n          padding-right: 12px;\n          width: 100%;\n        }\n\n        .name,\n        .state {\n          overflow: hidden;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n        }\n\n        .attribute {\n          white-space: nowrap;\n        }\n\n        .forecast {\n          display: flex;\n          justify-content: space-around;\n          padding-top: 16px;\n        }\n\n        .forecast > div {\n          text-align: center;\n        }\n\n        .forecast .icon,\n        .forecast .temp {\n          margin: 4px 0;\n        }\n\n        .forecast .temp {\n          font-size: 16px;\n        }\n\n        .forecast-image-icon {\n          padding-top: 4px;\n          padding-bottom: 4px;\n          display: flex;\n          justify-content: center;\n        }\n\n        .forecast-image-icon > * {\n          width: 40px;\n          height: 40px;\n          --mdc-icon-size: 40px;\n        }\n\n        .forecast-icon {\n          --mdc-icon-size: 40px;\n        }\n\n        .attr-icon {\n          --mdc-icon-size: 20px;\n        }\n\n        .attribute,\n        .templow,\n        .daynight,\n        .name {\n          color: var(--secondary-text-color);\n        }\n\n        .unavailable {\n          height: 100px;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          font-size: 16px;\n          padding: 10px 20px;\n          text-align: center;\n        }\n\n        /* ============= NARROW ============= */\n\n        :host([narrow]) .icon-image {\n          min-width: 52px;\n        }\n\n        :host([narrow]) .weather-image {\n          flex: 0 0 52px;\n          width: 52px;\n        }\n\n        :host([narrow]) .icon-image .weather-icon {\n          --mdc-icon-size: 52px;\n        }\n\n        :host([narrow]) .state,\n        :host([narrow]) .temp-attribute .temp {\n          font-size: 22px;\n        }\n\n        :host([narrow]) .temp-attribute .temp {\n          margin-right: 16px;\n        }\n\n        :host([narrow]) .temp span {\n          top: 1px;\n          font-size: 16px;\n        }\n\n        /* ============= VERY NARROW ============= */\n\n        :host([veryNarrow]) .name,\n        :host([veryNarrow]) .attribute {\n          display: none;\n        }\n\n        :host([veryNarrow]) .info {\n          flex-direction: column;\n          align-items: flex-start;\n        }\n\n        :host([veryNarrow]) .name-state {\n          padding-right: 0;\n        }\n\n        /* ============= VERY VERY NARROW ============= */\n\n        :host([veryVeryNarrow]) .info {\n          padding-top: 4px;\n          align-items: center;\n        }\n\n        :host([veryVeryNarrow]) .content {\n          flex-wrap: wrap;\n          justify-content: center;\n          flex-direction: column;\n        }\n\n        :host([veryVeryNarrow]) .icon-image {\n          margin-right: 0;\n        }\n      `,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-weather-forecast-card\": HuiWeatherForecastCard;\n  }\n}\n","import {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { DOMAINS_TOGGLE } from \"../../../common/const\";\nimport \"../../../components/ha-switch\";\nimport type { HaSwitch } from \"../../../components/ha-switch\";\nimport { forwardHaptic } from \"../../../data/haptics\";\nimport type { HomeAssistant } from \"../../../types\";\nimport { turnOnOffEntities } from \"../common/entity/turn-on-off-entities\";\n\n@customElement(\"hui-entities-toggle\")\nclass HuiEntitiesToggle extends LitElement {\n  @property({ type: Array }) public entities?: string[];\n\n  @property({ attribute: false }) protected hass?: HomeAssistant;\n\n  @state() private _toggleEntities?: string[];\n\n  public willUpdate(changedProperties: PropertyValues): void {\n    super.willUpdate(changedProperties);\n    if (changedProperties.has(\"entities\")) {\n      this._toggleEntities = this.entities!.filter(\n        (entityId) =>\n          entityId in this.hass!.states &&\n          DOMAINS_TOGGLE.has(entityId.split(\".\", 1)[0])\n      );\n    }\n  }\n\n  protected render(): TemplateResult {\n    if (!this._toggleEntities?.length) {\n      return html``;\n    }\n\n    return html`\n      <ha-switch\n        aria-label=${this.hass!.localize(\n          \"ui.panel.lovelace.card.entities.toggle\"\n        )}\n        .checked=${this._toggleEntities!.some((entityId) => {\n          const stateObj = this.hass!.states[entityId];\n          return stateObj && stateObj.state === \"on\";\n        })}\n        @change=${this._callService}\n      ></ha-switch>\n    `;\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      :host {\n        width: 38px;\n        display: block;\n      }\n      ha-switch {\n        padding: 13px 5px;\n        margin: -4px -8px;\n      }\n    `;\n  }\n\n  private _callService(ev: MouseEvent): void {\n    forwardHaptic(\"light\");\n    const turnOn = (ev.target as HaSwitch).checked;\n    turnOnOffEntities(this.hass!, this._toggleEntities!, turnOn!);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-entities-toggle\": HuiEntitiesToggle;\n  }\n}\n","import { mdiAlertOutline } from \"@mdi/js\";\nimport { css, CSSResultGroup, html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport \"../../../components/ha-svg-icon\";\n\n@customElement(\"hui-warning-element\")\nexport class HuiWarningElement extends LitElement {\n  @property() public label?: string;\n\n  protected render(): TemplateResult {\n    return html`\n      <ha-svg-icon .path=${mdiAlertOutline} .title=${this.label}></ha-svg-icon>\n    `;\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      ha-svg-icon {\n        color: var(--warning-color);\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-warning-element\": HuiWarningElement;\n  }\n}\n"],"names":[],"sourceRoot":""}