"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["6473"],{20451:function(t,e,i){i.d(e,{Z:()=>s});i(23669);const a=(t,e=2)=>{let i=""+t;for(let a=1;a<e;a++)i=parseInt(i)<10**a?`0${i}`:i;return i};function s(t){const e=Math.floor(t/1e3/3600),i=Math.floor(t/1e3%3600/60),s=Math.floor(t/1e3%3600%60),n=Math.floor(t%1e3);return e>0?`${e}:${a(i)}:${a(s)}`:i>0?`${i}:${a(s)}`:s>0||n>0?`${s}${n>0?`.${a(n,3)}`:""}`:null}},31146:function(t,e,i){i.d(e,{i:()=>s});const a=(0,i(93826).P)((t=>{history.replaceState({scrollPosition:t},"")}),300),s=t=>e=>({kind:"method",placement:"prototype",key:e.key,descriptor:{set(t){a(t),this[`__${String(e.key)}`]=t},get(){var t;return this[`__${String(e.key)}`]||(null===(t=history.state)||void 0===t?void 0:t.scrollPosition)},enumerable:!0,configurable:!0},finisher(i){const a=i.prototype.connectedCallback;i.prototype.connectedCallback=function(){a.call(this);const i=this[e.key];i&&this.updateComplete.then((()=>{const e=this.renderRoot.querySelector(t);e&&setTimeout((()=>{e.scrollTop=i}),0)}))}}})},67650:function(t,e,i){i.a(t,(async function(t,e){try{var a=i(61701),s=(i(71695),i(92745),i(9359),i(1331),i(31526),i(52924),i(95078),i(92519),i(42179),i(89256),i(24931),i(88463),i(57449),i(19814),i(47021),i(57243)),n=i(50778),o=i(69634),r=i(50875),h=i(20172),d=i(25179),l=i(64214),c=i(50602),u=i(48066),m=i(36522),y=i(350),p=i(87974),f=t([l,d,c]);[l,d,c]=f.then?(await f)():f;let v,_=t=>t;const k=t=>{const e=parseFloat(t);return isFinite(e)?e:null};let g=(0,a.Z)(null,(function(t,e){return{F:class extends e{constructor(...e){super(...e),t(this)}},d:[{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"data",value(){return[]}},{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"names",value:void 0},{kind:"field",decorators:[(0,n.Cb)()],key:"unit",value:void 0},{kind:"field",decorators:[(0,n.Cb)()],key:"identifier",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:"show-names",type:Boolean})],key:"showNames",value(){return!0}},{kind:"field",decorators:[(0,n.Cb)({attribute:"click-for-more-info",type:Boolean})],key:"clickForMoreInfo",value(){return!0}},{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"startTime",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"endTime",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:!1,type:Number})],key:"paddingYAxis",value(){return 0}},{kind:"field",decorators:[(0,n.Cb)({attribute:!1,type:Number})],key:"chartIndex",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:"logarithmic-scale",type:Boolean})],key:"logarithmicScale",value(){return!1}},{kind:"field",decorators:[(0,n.Cb)({attribute:!1,type:Number})],key:"minYAxis",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:!1,type:Number})],key:"maxYAxis",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:"fit-y-data",type:Boolean})],key:"fitYData",value(){return!1}},{kind:"field",decorators:[(0,n.Cb)({type:String})],key:"height",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:"expand-legend",type:Boolean})],key:"expandLegend",value:void 0},{kind:"field",decorators:[(0,n.SB)()],key:"_chartData",value(){return[]}},{kind:"field",decorators:[(0,n.SB)()],key:"_entityIds",value(){return[]}},{kind:"field",key:"_datasetToDataIndex",value(){return[]}},{kind:"field",decorators:[(0,n.SB)()],key:"_chartOptions",value:void 0},{kind:"field",key:"_hiddenStats",value(){return new Set}},{kind:"field",decorators:[(0,n.SB)()],key:"_yWidth",value(){return 25}},{kind:"field",decorators:[(0,n.SB)()],key:"_visualMap",value:void 0},{kind:"field",key:"_chartTime",value(){return new Date}},{kind:"method",key:"render",value:function(){return(0,s.dy)(v||(v=_` <ha-chart-base .hass="${0}" .data="${0}" .options="${0}" .height="${0}" style="${0}" @dataset-hidden="${0}" @dataset-unhidden="${0}" .expandLegend="${0}"></ha-chart-base> `),this.hass,this._chartData,this._chartOptions,this.height,(0,o.V)({height:this.height}),this._datasetHidden,this._datasetUnhidden,this.expandLegend)}},{kind:"field",key:"_renderTooltip",value(){return t=>{const e=t[0].axisValue,i=(0,l.E8)(new Date(e),this.hass.locale,this.hass.config)+"<br>",a=[];this._chartData.forEach(((i,s)=>{var n;if(!1===(null===(n=i.tooltip)||void 0===n?void 0:n.show)||this._hiddenStats.has(i.name))return;const o=t.find((t=>t.seriesIndex===s));if(o)return void a.push(o);let r;const h=i.data||[];for(let t=h.length-1;t>=0;t--){const i=h[t];if(i&&i[0]<=e&&i[1]){r=i;break}}r&&a.push({seriesName:i.name,seriesIndex:s,value:r,marker:`<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:${i.color};"></span>`})}));const s=this.unit?`${(0,p.L)(this.unit,this.hass.locale)}${this.unit}`:"";return i+a.map((t=>{const e=this._entityIds[t.seriesIndex],i=this.hass.states[e],a=this.hass.entities[e],n=String(t.value[1]);let o=i?this.hass.formatEntityState(i,n):`${(0,c.uf)(n,this.hass.locale,(0,c.l4)(void 0,a))}${s}`;const r=this._datasetToDataIndex[t.seriesIndex],h=this.data[r];if(h.statistics&&h.statistics.length>0){o+="<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";o+=0===h.states.length||t.value[0]<h.states[0].last_changed?`${this.hass.localize("ui.components.history_charts.source_stats")}`:`${this.hass.localize("ui.components.history_charts.source_history")}`}return t.seriesName?`${t.marker} ${t.seriesName}: ${o}`:`${t.marker} ${o}`})).join("<br>")}}},{kind:"method",key:"_datasetHidden",value:function(t){this._hiddenStats.add(t.detail.name)}},{kind:"method",key:"_datasetUnhidden",value:function(t){this._hiddenStats.delete(t.detail.name)}},{kind:"method",key:"willUpdate",value:function(t){if((t.has("data")||t.has("startTime")||t.has("endTime")||this._chartTime<new Date(this.endTime.getTime()-d.Q))&&this._generateData(),!this.hasUpdated||t.has("showNames")||t.has("startTime")||t.has("endTime")||t.has("unit")||t.has("logarithmicScale")||t.has("minYAxis")||t.has("maxYAxis")||t.has("fitYData")||t.has("paddingYAxis")||t.has("_visualMap")||t.has("_yWidth")){const t=(0,h.HE)(this.hass);let e=this.minYAxis,i=this.maxYAxis;"number"==typeof e?this.fitYData&&(e=({min:t})=>Math.min(t,this.minYAxis)):this.logarithmicScale&&(e=({min:t})=>Math.floor(t>0?.95*t:1.05*t)),"number"==typeof i?this.fitYData&&(i=({max:t})=>Math.max(t,this.maxYAxis)):this.logarithmicScale&&(i=({max:t})=>Math.ceil(t>0?1.05*t:.95*t)),this._chartOptions={xAxis:{type:"time",min:this.startTime,max:this.endTime},yAxis:{type:this.logarithmicScale?"log":"value",name:this.unit,min:this._clampYAxis(e),max:this._clampYAxis(i),position:t?"right":"left",scale:!0,nameGap:2,nameTextStyle:{align:"left"},axisLine:{show:!1},axisLabel:{margin:5,formatter:t=>{const e=t>=1||t<=-1?void 0:{maximumFractionDigits:Math.max(2,-Math.floor(Math.log10(Math.abs(t%1||1))))},i=(0,c.uf)(t,this.hass.locale,e),a=(0,u.U)(i,12)+5;return a>this._yWidth&&(this._yWidth=a,(0,m.B)(this,"y-width-changed",{value:this._yWidth,chartIndex:this.chartIndex})),i}}},legend:{show:this.showNames},grid:{top:15,left:t?1:Math.max(this.paddingYAxis,this._yWidth),right:t?Math.max(this.paddingYAxis,this._yWidth):1,bottom:20},visualMap:this._visualMap,tooltip:{trigger:"axis",appendTo:document.body,formatter:this._renderTooltip}}}}},{kind:"method",key:"_generateData",value:function(){let t=0;const e=getComputedStyle(this),i=this.data,a=[],s=[],n=[];if(0===i.length)return;this._chartTime=new Date;const o=this.endTime,h=this.names||{};i.forEach(((i,d)=>{const l=i.domain,c=h[i.entity_id]||i.name;let u=null;const m=[],p=(t,e)=>{e&&(t>o||(m.forEach(((i,a)=>{null===e[a]&&u&&null!==u[a]&&i.data.push([t,u[a]]),i.data.push([t,e[a]])})),u=e))},f=(a,o,h,l=!1)=>{h||(h=(0,r.hZ)(t,e),t++),m.push({id:a,data:[],type:"line",cursor:"default",name:o,color:h,symbol:"circle",symbolSize:1,step:"end",sampling:"minmax",animationDurationUpdate:0,lineStyle:{width:l?0:1.5},areaStyle:l?{color:h+"7F"}:void 0,tooltip:{show:!l}}),s.push(i.entity_id),n.push(d)};if("thermostat"===l||"climate"===l||"water_heater"===l){const t=i.states.some((t=>{var e;return null===(e=t.attributes)||void 0===e?void 0:e.hvac_action})),a="climate"===l&&t?t=>{var e;return"heat"===y.hB[null===(e=t.attributes)||void 0===e?void 0:e.hvac_action]}:t=>"heat"===t.state,s="climate"===l&&t?t=>{var e;return"cool"===y.hB[null===(e=t.attributes)||void 0===e?void 0:e.hvac_action]}:t=>"cool"===t.state,n=i.states.some(a),o=i.states.some(s),r=i.states.some((t=>t.attributes&&t.attributes.target_temp_high!==t.attributes.target_temp_low));f(i.entity_id+"-current_temperature",this.showNames?this.hass.localize("ui.card.climate.current_temperature",{name:c}):this.hass.localize("component.climate.entity_component._.state_attributes.current_temperature.name")),n&&f(i.entity_id+"-heating",this.showNames?this.hass.localize("ui.card.climate.heating",{name:c}):this.hass.localize("component.climate.entity_component._.state_attributes.hvac_action.state.heating"),e.getPropertyValue("--state-climate-heat-color"),!0),o&&f(i.entity_id+"-cooling",this.showNames?this.hass.localize("ui.card.climate.cooling",{name:c}):this.hass.localize("component.climate.entity_component._.state_attributes.hvac_action.state.cooling"),e.getPropertyValue("--state-climate-cool-color"),!0),r?(f(i.entity_id+"-target_temperature_mode",this.showNames?this.hass.localize("ui.card.climate.target_temperature_mode",{name:c,mode:this.hass.localize("ui.card.climate.high")}):this.hass.localize("component.climate.entity_component._.state_attributes.target_temp_high.name")),f(i.entity_id+"-target_temperature_mode_low",this.showNames?this.hass.localize("ui.card.climate.target_temperature_mode",{name:c,mode:this.hass.localize("ui.card.climate.low")}):this.hass.localize("component.climate.entity_component._.state_attributes.target_temp_low.name"))):f(i.entity_id+"-target_temperature",this.showNames?this.hass.localize("ui.card.climate.target_temperature_entity",{name:c}):this.hass.localize("component.climate.entity_component._.state_attributes.temperature.name")),i.states.forEach((t=>{if(!t.attributes)return;const e=k(t.attributes.current_temperature),i=[e];if(n&&i.push(a(t)?e:null),o&&i.push(s(t)?e:null),r){const e=k(t.attributes.target_temp_high),a=k(t.attributes.target_temp_low);i.push(e,a),p(new Date(t.last_changed),i)}else{const e=k(t.attributes.temperature);i.push(e),p(new Date(t.last_changed),i)}}))}else if("humidifier"===l){const t=i.states.some((t=>{var e;return null===(e=t.attributes)||void 0===e?void 0:e.action})),a=i.states.some((t=>{var e;return null===(e=t.attributes)||void 0===e?void 0:e.current_humidity})),s=t&&i.states.some((t=>{var e;return"humidifying"===(null===(e=t.attributes)||void 0===e?void 0:e.action)})),n=t&&i.states.some((t=>{var e;return"drying"===(null===(e=t.attributes)||void 0===e?void 0:e.action)}));f(i.entity_id+"-target_humidity",this.showNames?this.hass.localize("ui.card.humidifier.target_humidity_entity",{name:c}):this.hass.localize("component.humidifier.entity_component._.state_attributes.humidity.name")),a&&f(i.entity_id+"-current_humidity",this.showNames?this.hass.localize("ui.card.humidifier.current_humidity_entity",{name:c}):this.hass.localize("component.humidifier.entity_component._.state_attributes.current_humidity.name")),s?f(i.entity_id+"-humidifying",this.showNames?this.hass.localize("ui.card.humidifier.humidifying",{name:c}):this.hass.localize("component.humidifier.entity_component._.state_attributes.action.state.humidifying"),e.getPropertyValue("--state-humidifier-on-color"),!0):n?f(i.entity_id+"-drying",this.showNames?this.hass.localize("ui.card.humidifier.drying",{name:c}):this.hass.localize("component.humidifier.entity_component._.state_attributes.action.state.drying"),e.getPropertyValue("--state-humidifier-on-color"),!0):f(i.entity_id+"-on",this.showNames?this.hass.localize("ui.card.humidifier.on_entity",{name:c}):this.hass.localize("component.humidifier.entity_component._.state.on"),void 0,!0),i.states.forEach((t=>{var e;if(!t.attributes)return;const i=k(t.attributes.humidity),o=a?k(null===(e=t.attributes)||void 0===e?void 0:e.current_humidity):i,r=[i];var h;if(a&&r.push(o),s)r.push("humidifying"===(null===(h=t.attributes)||void 0===h?void 0:h.action)?o:null);else if(n){var d;r.push("drying"===(null===(d=t.attributes)||void 0===d?void 0:d.action)?o:null)}else r.push("on"===t.state?o:null);p(new Date(t.last_changed),r)}))}else{let t,e;f(i.entity_id,c);let a=null;const s=i=>{const s=k(i.state),n=new Date(i.last_changed);if(null!==s&&a){var o;const i=n.getTime(),r=a.getTime(),h=null===(o=e)||void 0===o?void 0:o.getTime();p(a,[(r-h)/(i-h)*(s-t)+t]),p(new Date(r+1),[null]),p(n,[s]),e=n,t=s,a=null}else null!==s&&null===a?(p(n,[s]),e=n,t=s):null===s&&null===a&&void 0!==t&&(a=n)};if(i.statistics){const t=i.states&&0!==i.states.length?i.states[0].last_changed:0;for(const e of i.statistics){if(t&&e.last_changed>=t)break;s(e)}}i.states.forEach((t=>{s(t)})),null!==a&&p(a,[null])}p(o,u),Array.prototype.push.apply(a,m)})),this._chartData=a,this._entityIds=s,this._datasetToDataIndex=n;const d=[];this._chartData.forEach(((t,e)=>{var i,a;const s=this._datasetToDataIndex[e],n=this.data[s];if(!n.statistics||0===n.statistics.length)return;const o=null!==(i=null===(a=n.states[0])||void 0===a?void 0:a.last_changed)&&void 0!==i?i:this.endTime.getTime();d.push({show:!1,seriesIndex:e,dimension:0,pieces:[{max:o-.01,colorAlpha:.5},{min:o,colorAlpha:1}]})})),this._visualMap=d.length>0?d:void 0}},{kind:"method",key:"_clampYAxis",value:function(t){if(this.logarithmicScale){if("number"==typeof t)return Math.max(t,.1);if("function"==typeof t)return e=>Math.max(t(e),.1)}return t}}]}}),s.oi);customElements.define("state-history-chart-line",g),e()}catch(v){e(v)}}))},15815:function(t,e,i){i.a(t,(async function(t,e){try{var a=i(61701),s=(i(71695),i(92745),i(9359),i(1331),i(31526),i(19423),i(47021),i(57243)),n=i(50778),o=i(64214),r=i(20451),h=i(20172),d=i(25179),l=i(31428),c=i(85803),u=i(37723),m=i(11259),y=i(48066),p=i(36522),f=t([o,d]);[o,d]=f.then?(await f)():f;let v,_,k=t=>t;(0,a.Z)([(0,n.Mo)("state-history-chart-timeline")],(function(t,e){return{F:class extends e{constructor(...e){super(...e),t(this)}},d:[{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"data",value(){return[]}},{kind:"field",decorators:[(0,n.Cb)({type:Boolean})],key:"narrow",value(){return!1}},{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"names",value:void 0},{kind:"field",decorators:[(0,n.Cb)()],key:"unit",value:void 0},{kind:"field",decorators:[(0,n.Cb)()],key:"identifier",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:"show-names",type:Boolean})],key:"showNames",value(){return!0}},{kind:"field",decorators:[(0,n.Cb)({attribute:"click-for-more-info",type:Boolean})],key:"clickForMoreInfo",value(){return!0}},{kind:"field",decorators:[(0,n.Cb)({type:Boolean})],key:"chunked",value(){return!1}},{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"startTime",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"endTime",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:!1,type:Number})],key:"paddingYAxis",value(){return 0}},{kind:"field",decorators:[(0,n.Cb)({attribute:!1,type:Number})],key:"chartIndex",value:void 0},{kind:"field",decorators:[(0,n.SB)()],key:"_chartData",value(){return[]}},{kind:"field",decorators:[(0,n.SB)()],key:"_chartOptions",value:void 0},{kind:"field",decorators:[(0,n.SB)()],key:"_yWidth",value(){return 0}},{kind:"field",key:"_chartTime",value(){return new Date}},{kind:"method",key:"render",value:function(){return(0,s.dy)(v||(v=k` <ha-chart-base .hass="${0}" .options="${0}" .height="${0}" .data="${0}" @chart-click="${0}"></ha-chart-base> `),this.hass,this._chartOptions,30*this.data.length+30+"px",this._chartData,this._handleChartClick)}},{kind:"field",key:"_renderItem",value(){return(t,e)=>{const i=e.value(0),a=e.coord([e.value(1),i]),s=e.coord([e.value(2),i]),n=t.coordSys,o=c.default.graphic.clipRectByRect({x:a[0],y:a[1]-10,width:s[0]-a[0],height:20},{x:n.x,y:n.y,width:n.width,height:n.height});if(!o)return null;const r={type:"rect",transition:"shape",shape:o,style:{fill:e.value(4)}},h=e.value(3);return(0,y.U)(h,12)<o.width-8?{type:"group",children:[r,{type:"text",style:Object.assign(Object.assign({},o),{},{x:o.x+4,text:h,fill:e.value(5),fontSize:12,lineHeight:o.height})}]}:r}}},{kind:"field",key:"_renderTooltip",value(){return t=>{const{value:e,name:i,marker:a,seriesName:s}=Array.isArray(t)?t[0]:t,n=s?`<h4 style="text-align: center; margin: 0;">${s}</h4>`:"",h=e[2]-e[1],d=`${this.hass.localize("ui.components.history_charts.duration")}: ${(0,r.Z)(h)}`;return[n,[a+i,(0,o.E8)(new Date(e[1]),this.hass.locale,this.hass.config),(0,o.E8)(new Date(e[2]),this.hass.locale,this.hass.config),d].join("<br>")].join("")}}},{kind:"method",key:"willUpdate",value:function(t){(t.has("startTime")||t.has("endTime")||t.has("data")||this._chartTime<new Date(this.endTime.getTime()-d.Q))&&this._generateData(),(!this.hasUpdated||t.has("startTime")||t.has("endTime")||t.has("showNames")||t.has("paddingYAxis")||t.has("_yWidth"))&&this._createOptions()}},{kind:"method",key:"_createOptions",value:function(){const t=this.narrow,e=this.chunked||this.showNames,i=t?105:185,a=e?Math.max(this.paddingYAxis,this._yWidth):0,s=(0,h.HE)(this.hass);this._chartOptions={xAxis:{type:"time",min:this.startTime,max:this.endTime,axisTick:{show:!0},splitLine:{show:!1}},yAxis:{type:"category",inverse:!0,position:s?"right":"left",triggerEvent:!0,axisTick:{show:!1},axisLine:{show:!1},axisLabel:{show:e,width:a,overflow:"truncate",margin:5,formatter:t=>{var e;const a=null===(e=this._chartData.find((e=>e.id===t)))||void 0===e?void 0:e.name,s=a?Math.min((0,y.U)(a,12)+5,i):0;return s>this._yWidth&&(this._yWidth=s,(0,p.B)(this,"y-width-changed",{value:this._yWidth,chartIndex:this.chartIndex})),a},hideOverlap:!0}},grid:{top:10,bottom:30,left:s?1:a,right:s?a:1},tooltip:{appendTo:document.body,formatter:this._renderTooltip}}}},{kind:"method",key:"_generateData",value:function(){const t=getComputedStyle(this);let e=this.data;e||(e=[]),this._chartTime=new Date;const i=this.startTime,a=this.endTime,s=[],n=this.names||{};e.forEach((e=>{let o,r=null,h=null,d=i;const c=this.showNames?n[e.entity_id]||e.name||e.entity_id:"",y=[];if(e.data.forEach((i=>{let s=i.state;if(s||(s=null),!(new Date(i.last_changed)>a))if(null===r)r=s,h=i.state_localize,d=new Date(i.last_changed);else if(s!==r){o=new Date(i.last_changed);const a=(0,l.U)(r,t,this.hass.states[e.entity_id]);y.push({value:[e.entity_id,d,o,h,a,(0,u.T2)((0,m.wK)(a))>.5?"#000":"#fff"],itemStyle:{color:a}}),r=s,h=i.state_localize,d=o}})),null!==r){const i=(0,l.U)(r,t,this.hass.states[e.entity_id]);y.push({value:[e.entity_id,d,a,h,i,(0,u.T2)((0,m.wK)(i))>.5?"#000":"#fff"],itemStyle:{color:i}})}s.push({id:e.entity_id,data:y,name:c,dimensions:["id","start","end","name","color","textColor"],type:"custom",encode:{x:[1,2],y:0,itemName:3},renderItem:this._renderItem})})),this._chartData=s}},{kind:"method",key:"_handleChartClick",value:function(t){if("axisLabel"===t.detail.targetType){const e=this._chartData[t.detail.dataIndex];e&&(0,p.B)(this,"hass-more-info",{entityId:e.id})}}},{kind:"field",static:!0,key:"styles",value(){return(0,s.iv)(_||(_=k`ha-chart-base{--chart-max-height:none}`))}}]}}),s.oi);e()}catch(v){e(v)}}))},71489:function(t,e,i){i.a(t,(async function(t,e){try{var a=i(61701),s=(i(19083),i(71695),i(92745),i(52805),i(9359),i(70104),i(48136),i(52924),i(61006),i(47021),i(57243)),n=i(50778),o=i(72344),r=i(31146),h=i(47641),d=i(67650),l=i(15815),c=t([d,l]);[d,l]=c.then?(await c)():c;let u,m,y,p,f,v,_,k,g,b=t=>t;const x=10,w=(t,e)=>t.reduce(((t,i,a)=>{const s=Math.floor(a/e);return t[s]||(t[s]=[]),t[s].push(i),t}),[]);(0,a.Z)([(0,n.Mo)("state-history-charts")],(function(t,e){return{F:class extends e{constructor(...e){super(...e),t(this)}},d:[{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"historyData",value:void 0},{kind:"field",decorators:[(0,n.Cb)({type:Boolean})],key:"narrow",value(){return!1}},{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"names",value:void 0},{kind:"field",decorators:[(0,n.Cb)({type:Boolean,reflect:!0})],key:"virtualize",value(){return!1}},{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"endTime",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"startTime",value:void 0},{kind:"field",decorators:[(0,n.Cb)({type:Boolean,attribute:"up-to-now"})],key:"upToNow",value(){return!1}},{kind:"field",decorators:[(0,n.Cb)({attribute:!1,type:Number})],key:"hoursToShow",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:"show-names",type:Boolean})],key:"showNames",value(){return!0}},{kind:"field",decorators:[(0,n.Cb)({attribute:"click-for-more-info",type:Boolean})],key:"clickForMoreInfo",value(){return!0}},{kind:"field",decorators:[(0,n.Cb)({attribute:"is-loading-data",type:Boolean})],key:"isLoadingData",value(){return!1}},{kind:"field",decorators:[(0,n.Cb)({attribute:"logarithmic-scale",type:Boolean})],key:"logarithmicScale",value(){return!1}},{kind:"field",decorators:[(0,n.Cb)({attribute:!1,type:Number})],key:"minYAxis",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:!1,type:Number})],key:"maxYAxis",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:"fit-y-data",type:Boolean})],key:"fitYData",value(){return!1}},{kind:"field",decorators:[(0,n.Cb)({type:String})],key:"height",value:void 0},{kind:"field",decorators:[(0,n.Cb)({attribute:"expand-legend",type:Boolean})],key:"expandLegend",value:void 0},{kind:"field",key:"_computedStartTime",value:void 0},{kind:"field",key:"_computedEndTime",value:void 0},{kind:"field",decorators:[(0,n.SB)()],key:"_maxYWidth",value(){return 0}},{kind:"field",decorators:[(0,n.SB)()],key:"_childYWidths",value(){return[]}},{kind:"field",decorators:[(0,n.SB)()],key:"_chartCount",value(){return 0}},{kind:"field",decorators:[(0,r.i)(".container")],key:"_savedScrollPos",value:void 0},{kind:"method",key:"render",value:function(){if(!(0,o.p)(this.hass,"history"))return(0,s.dy)(u||(u=b`<div class="info"> ${0} </div>`),this.hass.localize("ui.components.history_charts.history_disabled"));if(this.isLoadingData&&!this.historyData)return(0,s.dy)(m||(m=b`<div class="info"> ${0} </div>`),this.hass.localize("ui.components.history_charts.loading_history"));if(this._isHistoryEmpty())return(0,s.dy)(y||(y=b`<div class="info"> ${0} </div>`),this.hass.localize("ui.components.history_charts.no_history_found"));const t=this.historyData.timeline.length?(this.virtualize?w(this.historyData.timeline,x):[this.historyData.timeline]).concat(this.historyData.line):this.historyData.line;return this._chartCount=t.length,this.virtualize?(0,s.dy)(p||(p=b`<div class="container ha-scrollbar" @scroll="${0}"> <lit-virtualizer scroller class="ha-scrollbar" .items="${0}" .renderItem="${0}"> </lit-virtualizer> </div>`),this._saveScrollPos,t,this._renderHistoryItem):(0,s.dy)(f||(f=b`${0}`),t.map(((t,e)=>this._renderHistoryItem(t,e))))}},{kind:"field",key:"_renderHistoryItem",value(){return(t,e)=>t&&void 0!==e?Array.isArray(t)?(0,s.dy)(k||(k=b`<div class="entry-container timeline"> <state-history-chart-timeline .hass="${0}" .data="${0}" .startTime="${0}" .endTime="${0}" .showNames="${0}" .names="${0}" .narrow="${0}" .chunked="${0}" .paddingYAxis="${0}" .chartIndex="${0}" .clickForMoreInfo="${0}" @y-width-changed="${0}"></state-history-chart-timeline> </div> `),this.hass,t,this._computedStartTime,this._computedEndTime,this.showNames,this.names,this.narrow,this.virtualize,this._maxYWidth,e,this.clickForMoreInfo,this._yWidthChanged):(0,s.dy)(_||(_=b`<div class="entry-container line"> <state-history-chart-line .hass="${0}" .unit="${0}" .data="${0}" .identifier="${0}" .showNames="${0}" .startTime="${0}" .endTime="${0}" .paddingYAxis="${0}" .names="${0}" .chartIndex="${0}" .clickForMoreInfo="${0}" .logarithmicScale="${0}" .minYAxis="${0}" .maxYAxis="${0}" .fitYData="${0}" @y-width-changed="${0}" .height="${0}" .expandLegend="${0}"></state-history-chart-line> </div> `),this.hass,t.unit,t.data,t.identifier,this.showNames,this._computedStartTime,this._computedEndTime,this._maxYWidth,this.names,e,this.clickForMoreInfo,this.logarithmicScale,this.minYAxis,this.maxYAxis,this.fitYData,this._yWidthChanged,this.virtualize?void 0:this.height,this.expandLegend):(0,s.dy)(v||(v=b``))}},{kind:"method",key:"shouldUpdate",value:function(t){return(1!==t.size||!t.has("hass"))&&(1!==t.size||!t.has("_maxYWidth")||t.get("_maxYWidth")!==this._maxYWidth)}},{kind:"method",key:"willUpdate",value:function(t){if(this.hasUpdated||(0,h.o)(),[...t.keys()].some((t=>!["_maxYWidth","_childYWidths","_chartCount"].includes(t)))){const t=new Date;if(this._computedEndTime=this.upToNow||!this.endTime||this.endTime>t?t:this.endTime,this.startTime)this._computedStartTime=this.startTime;else if(this.hoursToShow)this._computedStartTime=new Date((new Date).getTime()-3600*this.hoursToShow*1e3);else{var e,i,a,s;let t=(null!==(e=null===(i=this.historyData)||void 0===i?void 0:i.timeline)&&void 0!==e?e:[]).reduce(((t,e)=>Math.min(t,new Date(e.data[0].last_changed).getTime())),(new Date).getTime());t=(null!==(a=null===(s=this.historyData)||void 0===s?void 0:s.line)&&void 0!==a?a:[]).reduce(((t,e)=>Math.min(t,e.data.reduce(((t,e)=>Math.min(t,new Date(e.states[0].last_changed).getTime())),t))),t),this._computedStartTime=new Date(t)}}}},{kind:"method",key:"updated",value:function(t){t.has("_chartCount")&&this._chartCount<this._childYWidths.length&&(this._childYWidths.length=this._chartCount,this._maxYWidth=Math.max(...Object.values(this._childYWidths),0))}},{kind:"method",key:"_yWidthChanged",value:function(t){this._childYWidths[t.detail.chartIndex]=t.detail.value,this._maxYWidth=Math.max(...Object.values(this._childYWidths),0)}},{kind:"method",key:"_isHistoryEmpty",value:function(){const t=!this.historyData||!this.historyData.timeline||!this.historyData.line||0===this.historyData.timeline.length&&0===this.historyData.line.length;return!this.isLoadingData&&t}},{kind:"method",decorators:[(0,n.hO)({passive:!0})],key:"_saveScrollPos",value:function(t){this._savedScrollPos=t.target.scrollTop}},{kind:"field",static:!0,key:"styles",value(){return(0,s.iv)(g||(g=b`:host{display:flex;flex-direction:column;min-height:60px}:host([virtualize]){height:100%}.info{text-align:center;line-height:60px;color:var(--secondary-text-color)}.container{max-height:var(--history-max-height)}.entry-container{width:100%}.entry-container.line{flex:1;padding-top:8px;overflow:hidden}.entry-container:hover{z-index:1}:host([virtualize]) .entry-container{padding-left:1px;padding-right:1px;padding-inline-start:1px;padding-inline-end:1px}.entry-container.timeline:first-child{margin-top:var(--timeline-top-margin)}.entry-container:not(:first-child){border-top:2px solid var(--divider-color);margin-top:16px}.container,lit-virtualizer{height:100%;width:100%}lit-virtualizer{contain:size layout!important}state-history-chart-line,state-history-chart-timeline{width:100%}`))}}]}}),s.oi);e()}catch(u){e(u)}}))},85803:function(t,e,i){i.r(e),i.d(e,{default:()=>k});var a=i(1420),s=i(88375),n=i(33755),o=i(76504),r=i(86596),h=i(94439),d=i(7521),l=i(39718),c=i(32169),u=i(88232),m=i(84716),y=i(94927),p=i(22394),f=i(40716),v=i(32687),_=i(91475);a.D([n.N,o.N,r.N,h.N,d.N,l.N,c.N,u.N,m.N,y.N,f.T,v.z,_.N,p.N]);const k=s},47641:function(t,e,i){i.d(e,{o:()=>a});i(71695),i(40251),i(47021);const a=async()=>{await Promise.all([i.e("37066"),i.e("24606")]).then(i.bind(i,24700))}},48066:function(t,e,i){let a;function s(t,e,i="Roboto, Noto, sans-serif"){a||(a=document.createElement("canvas"));const s=a.getContext("2d");if(!s)return 0;s.font=`${e}px ${i}`;const n=s.measureText(t);return Math.ceil(Math.max(n.actualBoundingBoxRight+n.actualBoundingBoxLeft,n.width))}i.d(e,{U:()=>s})}}]);
//# sourceMappingURL=6473.32e03069632138c8.js.map