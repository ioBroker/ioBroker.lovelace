"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[88171],{39258:function(t,e,i){i.d(e,{U:function(){return _}});i(51358),i(96043),i(46798),i(5239),i(98490);var s=i(55070),n=i(15838),r=i(89525),a=i(58831),o=i(6229),h=i(56007),u=i(22134),c={media_player:{paused:.5,idle:1},vacuum:{returning:.5}};var d=0,l=new Map;function _(t,e,i){return function(t,e,i){var s;if(!i||t===h.nZ)return(0,u.g)("--history-unavailable-color",e);if(t===h.lz)return(0,u.g)("--history-unknown-color",e);var d=(0,o.tD)(i,t);if(d){var l=(0,u.g)(d,e);if(l){var _=(0,a.M)(i.entity_id),f=null===(s=c[_])||void 0===s?void 0:s[t];return f?(0,n.uO)((0,r.C)((0,n.Rw)((0,n.wK)(l)),f)):l}}}(t,e,i)||function(t,e){if(l.has(t))return l.get(t);var i=(0,s.hZ)(d,e);return d++,l.set(t,i),i}(t,e)}},38026:function(t,e,i){i.r(e),i.d(e,{DEFAULT_HOURS_TO_SHOW:function(){return C},HuiHistoryGraphCard:function(){return T}});var s,n,r,a,o=i(88962),h=i(99312),u=i(81043),c=i(33368),d=i(71650),l=i(82390),_=i(69205),f=i(70906),y=i(91808),v=i(34541),k=i(47838),p=(i(97393),i(51358),i(46798),i(47084),i(5239),i(98490),i(51467),i(9849),i(50289),i(94167),i(36513),i(22859),i(85717),i(68144)),b=i(95260),g=i(83448),m=i(7323),w=(i(51324),i(9381),i(22098),i(58763)),Z=i(41499),H=i(53658),S=i(90271),C=24,T=(0,y.Z)([(0,b.Mo)("hui-history-graph-card")],(function(t,e){var y,T,I=function(e){(0,_.Z)(s,e);var i=(0,f.Z)(s);function s(){var e;(0,d.Z)(this,s);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=i.call.apply(i,[this].concat(r)),t((0,l.Z)(e)),e}return(0,c.Z)(s)}(e);return{F:I,d:[{kind:"method",static:!0,key:"getConfigElement",value:(T=(0,u.Z)((0,h.Z)().mark((function t(){return(0,h.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([i.e(42850),i.e(78133),i.e(50731),i.e(68331),i.e(40163),i.e(74535),i.e(77434),i.e(52524)]).then(i.bind(i,52524));case 2:return t.abrupt("return",document.createElement("hui-history-graph-card-editor"));case 3:case"end":return t.stop()}}),t)}))),function(){return T.apply(this,arguments)})},{kind:"method",static:!0,key:"getStubConfig",value:function(){return{type:"history-graph",entities:["sun.sun"]}}},{kind:"field",decorators:[(0,b.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,b.SB)()],key:"_stateHistory",value:void 0},{kind:"field",decorators:[(0,b.SB)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,b.SB)()],key:"_error",value:void 0},{kind:"field",key:"_names",value:function(){return{}}},{kind:"field",key:"_entityIds",value:function(){return[]}},{kind:"field",key:"_hoursToShow",value:function(){return C}},{kind:"field",key:"_interval",value:void 0},{kind:"field",key:"_subscribed",value:void 0},{kind:"method",key:"getCardSize",value:function(){var t,e;return null!==(t=this._config)&&void 0!==t&&t.title?2:0+2*((null===(e=this._entityIds)||void 0===e?void 0:e.length)||1)}},{kind:"method",key:"setConfig",value:function(t){var e=this;if(!t.entities||!Array.isArray(t.entities))throw new Error("Entities need to be an array");if(!t.entities.length)throw new Error("You must include at least one entity");var i=t.entities?(0,S.A)(t.entities):[];this._entityIds=[],i.forEach((function(t){e._entityIds.push(t.entity),t.name&&(e._names[t.entity]=t.name)})),this._hoursToShow=t.hours_to_show||C,this._config=t}},{kind:"method",key:"connectedCallback",value:function(){(0,v.Z)((0,k.Z)(I.prototype),"connectedCallback",this).call(this),this.hasUpdated&&this._subscribeHistory()}},{kind:"method",key:"disconnectedCallback",value:function(){(0,v.Z)((0,k.Z)(I.prototype),"disconnectedCallback",this).call(this),this._unsubscribeHistory()}},{kind:"method",key:"_subscribeHistory",value:(y=(0,u.Z)((0,h.Z)().mark((function t(){var e,i,s=this;return(0,h.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((0,m.p)(this.hass,"history")&&!this._subscribed){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,(0,Z.ib)(this.hass);case 4:e=t.sent,i=e.numeric_device_classes,this._subscribed=(0,w.xS)(this.hass,(function(t){s._subscribed&&(s._stateHistory=(0,w.Nu)(s.hass,t,s.hass.localize,i))}),this._hoursToShow,this._entityIds).catch((function(t){s._subscribed=void 0,s._error=t})),this._setRedrawTimer();case 8:case"end":return t.stop()}}),t,this)}))),function(){return y.apply(this,arguments)})},{kind:"method",key:"_redrawGraph",value:function(){this._stateHistory&&(this._stateHistory=Object.assign({},this._stateHistory))}},{kind:"method",key:"_setRedrawTimer",value:function(){var t=this;clearInterval(this._interval),this._interval=window.setInterval((function(){return t._redrawGraph()}),6e4)}},{kind:"method",key:"_unsubscribeHistory",value:function(){clearInterval(this._interval),this._subscribed&&(this._subscribed.then((function(t){return null==t?void 0:t()})),this._subscribed=void 0)}},{kind:"method",key:"shouldUpdate",value:function(t){return(0,H.Wh)(this,t)||t.size>1||!t.has("hass")}},{kind:"method",key:"updated",value:function(t){if((0,v.Z)((0,k.Z)(I.prototype),"updated",this).call(this,t),this._config&&this.hass&&this._hoursToShow&&this._entityIds.length&&(t.has("_config")||t.has("hass"))){var e=t.get("_config");!t.has("_config")||(null==e?void 0:e.entities)===this._config.entities&&(null==e?void 0:e.hours_to_show)===this._config.hours_to_show||(this._unsubscribeHistory(),this._subscribeHistory())}}},{kind:"method",key:"render",value:function(){return this.hass&&this._config?(0,p.dy)(s||(s=(0,o.Z)([' <ha-card .header="','"> <div class="content ','"> '," </div> </ha-card> "])),this._config.title,(0,g.$)({"has-header":!!this._config.title}),this._error?(0,p.dy)(n||(n=(0,o.Z)([' <ha-alert alert-type="error"> ',": "," </ha-alert> "])),this.hass.localize("ui.components.history_charts.error"),this._error.message||this._error.code):(0,p.dy)(r||(r=(0,o.Z)([' <state-history-charts .hass="','" .isLoadingData="','" .historyData="','" .names="','" up-to-now .hoursToShow="','" .showNames="','" .logarithmicScale="','"></state-history-charts> '])),this.hass,!this._stateHistory,this._stateHistory,this._names,this._hoursToShow,void 0===this._config.show_names||this._config.show_names,this._config.logarithmic_scale||!1)):p.Ld}},{kind:"get",static:!0,key:"styles",value:function(){return(0,p.iv)(a||(a=(0,o.Z)(["ha-card{height:100%}.content{padding:16px}.has-header{padding-top:0}"])))}}]}}),p.oi)}}]);
//# sourceMappingURL=88171.lmr_9_auSrk.js.map