"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[3876],{25516:function(t,e,i){i.d(e,{i:function(){return n}});var a=(0,i(8330).P)((function(t){history.replaceState({scrollPosition:t},"")}),300),n=function(t){return function(e){return{kind:"method",placement:"prototype",key:e.key,descriptor:{set:function(t){a(t),this["__".concat(String(e.key))]=t},get:function(){var t;return this["__".concat(String(e.key))]||(null===(t=history.state)||void 0===t?void 0:t.scrollPosition)},enumerable:!0,configurable:!0},finisher:function(i){var a=i.prototype.connectedCallback;i.prototype.connectedCallback=function(){var i=this;a.call(this);var n=this[e.key];n&&this.updateComplete.then((function(){var e=i.renderRoot.querySelector(t);e&&setTimeout((function(){e.scrollTop=n}),0)}))}}}}}},62336:function(t,e,i){i.d(e,{Q:function(){return H}});var a,n,r,o,s,d,l,h,c,u=i(53709),v=i(99312),f=i(81043),p=i(93359),y=i(88962),m=i(33368),g=i(71650),k=i(82390),b=i(69205),_=i(70906),w=i(91808),x=i(34541),T=i(47838),C=i(68144),Z=i(79932),D=i(83448),z=i(47501),S=i(50239),O=i(87744),H=3e5;(0,w.Z)([(0,Z.Mo)("ha-chart-base")],(function(t,e){var w,H=function(e){(0,b.Z)(a,e);var i=(0,_.Z)(a);function a(){var e;(0,g.Z)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=i.call.apply(i,[this].concat(r)),t((0,k.Z)(e)),e}return(0,m.Z)(a)}(e);return{F:H,d:[{kind:"field",key:"chart",value:void 0},{kind:"field",decorators:[(0,Z.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,Z.Cb)({attribute:"chart-type",reflect:!0})],key:"chartType",value:function(){return"line"}},{kind:"field",decorators:[(0,Z.Cb)({attribute:!1})],key:"data",value:function(){return{datasets:[]}}},{kind:"field",decorators:[(0,Z.Cb)({attribute:!1})],key:"options",value:void 0},{kind:"field",decorators:[(0,Z.Cb)({attribute:!1})],key:"plugins",value:void 0},{kind:"field",decorators:[(0,Z.Cb)({type:Number})],key:"height",value:void 0},{kind:"field",decorators:[(0,Z.Cb)({type:Number})],key:"paddingYAxis",value:function(){return 0}},{kind:"field",decorators:[(0,Z.SB)()],key:"_chartHeight",value:void 0},{kind:"field",decorators:[(0,Z.SB)()],key:"_tooltip",value:void 0},{kind:"field",decorators:[(0,Z.SB)()],key:"_hiddenDatasets",value:function(){return new Set}},{kind:"method",key:"disconnectedCallback",value:function(){this._releaseCanvas(),(0,x.Z)((0,T.Z)(H.prototype),"disconnectedCallback",this).call(this)}},{kind:"method",key:"connectedCallback",value:function(){(0,x.Z)((0,T.Z)(H.prototype),"connectedCallback",this).call(this),this.hasUpdated&&this._setupChart()}},{kind:"field",key:"updateChart",value:function(){var t=this;return function(e){var i;null===(i=t.chart)||void 0===i||i.update(e)}}},{kind:"field",key:"resize",value:function(){var t=this;return function(e){var i,a,n,r;if(null!=e&&e.aspectRatio&&!e.height)e.height=Math.round((null!==(r=e.width)&&void 0!==r?r:t.clientWidth)/e.aspectRatio);else if(null!=e&&e.aspectRatio&&!e.width){var o;e.width=Math.round((null!==(o=e.height)&&void 0!==o?o:t.clientHeight)*e.aspectRatio)}null===(i=t.chart)||void 0===i||i.resize(null!==(a=null==e?void 0:e.width)&&void 0!==a?a:t.clientWidth,null!==(n=null==e?void 0:e.height)&&void 0!==n?n:t.clientHeight)}}},{kind:"method",key:"firstUpdated",value:function(){var t=this;this._setupChart(),this.data.datasets.forEach((function(e,i){e.hidden&&t._hiddenDatasets.add(i)}))}},{kind:"method",key:"willUpdate",value:function(t){var e=this;if((0,x.Z)((0,T.Z)(H.prototype),"willUpdate",this).call(this,t),this.hasUpdated&&this.chart){if(t.has("plugins")||t.has("chartType"))return this.chart.destroy(),void this._setupChart();t.has("data")&&(this._hiddenDatasets.size&&this.data.datasets.forEach((function(t,i){t.hidden=e._hiddenDatasets.has(i)})),this.chart.data=this.data),t.has("options")&&(this.chart.options=this._createOptions()),this.chart.update("none")}}},{kind:"method",key:"render",value:function(){var t,e,i,c=this;return(0,C.dy)(a||(a=(0,y.Z)([" ",' <div class="animationContainer" style="','"> <div class="chartContainer" style="','"> <canvas></canvas> '," </div> </div> "])),!0===(null===(t=this.options)||void 0===t||null===(t=t.plugins)||void 0===t||null===(t=t.legend)||void 0===t?void 0:t.display)?(0,C.dy)(n||(n=(0,y.Z)(['<div class="chartLegend"> <ul> '," </ul> </div>"])),this.data.datasets.map((function(t,e){return(0,C.dy)(r||(r=(0,y.Z)(['<li .datasetIndex="','" @click="','" class="','" .title="','"> <div class="bullet" style="','"></div> <div class="label">',"</div> </li>"])),e,c._legendClick,(0,D.$)({hidden:c._hiddenDatasets.has(e)}),t.label,(0,z.V)({backgroundColor:t.backgroundColor,borderColor:t.borderColor}),t.label)}))):"",(0,z.V)({height:"".concat(this.height||this._chartHeight||0,"px"),overflow:this._chartHeight?"initial":"hidden"}),(0,z.V)({height:"".concat(null!==(e=null!==(i=this.height)&&void 0!==i?i:this._chartHeight)&&void 0!==e?e:this.clientWidth/2,"px"),"padding-left":"".concat((0,O.HE)(this.hass)?0:this.paddingYAxis,"px"),"padding-right":"".concat((0,O.HE)(this.hass)?this.paddingYAxis:0,"px")}),this._tooltip?(0,C.dy)(o||(o=(0,y.Z)(['<div class="chartTooltip ','" style="','"> <div class="title">',"</div> "," <div> <ul> "," </ul> </div> "," </div>"])),(0,D.$)((0,p.Z)({},this._tooltip.yAlign,!0)),(0,z.V)({top:this._tooltip.top,left:this._tooltip.left}),this._tooltip.title,this._tooltip.beforeBody?(0,C.dy)(s||(s=(0,y.Z)(['<div class="beforeBody"> '," </div>"])),this._tooltip.beforeBody):"",this._tooltip.body.map((function(t,e){return(0,C.dy)(d||(d=(0,y.Z)(['<li> <div class="bullet" style="','"></div> '," </li>"])),(0,z.V)({backgroundColor:c._tooltip.labelColors[e].backgroundColor,borderColor:c._tooltip.labelColors[e].borderColor}),t.lines.join("\n"))})),this._tooltip.footer.length?(0,C.dy)(l||(l=(0,y.Z)(['<div class="footer"> '," </div>"])),this._tooltip.footer.map((function(t){return(0,C.dy)(h||(h=(0,y.Z)(["","<br>"])),t)}))):""):"")}},{kind:"method",key:"_setupChart",value:(w=(0,f.Z)((0,v.Z)().mark((function t(){var e,a,n;return(0,v.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.renderRoot.querySelector("canvas").getContext("2d"),t.next=3,Promise.all([i.e(23254),i.e(7248),i.e(59904),i.e(48324)]).then(i.bind(i,48324));case 3:a=t.sent.Chart,n=getComputedStyle(this),a.defaults.borderColor=n.getPropertyValue("--divider-color"),a.defaults.color=n.getPropertyValue("--secondary-text-color"),a.defaults.font.family=n.getPropertyValue("--mdc-typography-body1-font-family")||n.getPropertyValue("--mdc-typography-font-family")||"Roboto, Noto, sans-serif",this.chart=new a(e,{type:this.chartType,data:this.data,options:this._createOptions(),plugins:this._createPlugins()});case 9:case"end":return t.stop()}}),t,this)}))),function(){return w.apply(this,arguments)})},{kind:"method",key:"_createOptions",value:function(){var t,e,i,a=this;return Object.assign(Object.assign({maintainAspectRatio:!1},this.options),{},{plugins:Object.assign(Object.assign({},null===(t=this.options)||void 0===t?void 0:t.plugins),{},{tooltip:Object.assign(Object.assign({},null===(e=this.options)||void 0===e||null===(e=e.plugins)||void 0===e?void 0:e.tooltip),{},{enabled:!1,external:function(t){return a._handleTooltip(t)}}),legend:Object.assign(Object.assign({},null===(i=this.options)||void 0===i||null===(i=i.plugins)||void 0===i?void 0:i.legend),{},{display:!1})})})}},{kind:"method",key:"_createPlugins",value:function(){var t,e=this;return[].concat((0,u.Z)(this.plugins||[]),[{id:"resizeHook",resize:function(t){var i,a=t.height-(null!==(i=e._chartHeight)&&void 0!==i?i:0);(!e._chartHeight||a>12||a<-12)&&(e._chartHeight=t.height)},legend:Object.assign(Object.assign({},null===(t=this.options)||void 0===t||null===(t=t.plugins)||void 0===t?void 0:t.legend),{},{display:!1})}])}},{kind:"method",key:"_legendClick",value:function(t){if(this.chart){var e=t.currentTarget.datasetIndex;this.chart.isDatasetVisible(e)?(this.chart.setDatasetVisibility(e,!1),this._hiddenDatasets.add(e)):(this.chart.setDatasetVisibility(e,!0),this._hiddenDatasets.delete(e)),this.chart.update("none"),this.requestUpdate("_hiddenDatasets")}}},{kind:"method",key:"_handleTooltip",value:function(t){0!==t.tooltip.opacity?this._tooltip=Object.assign(Object.assign({},t.tooltip),{},{top:this.chart.canvas.offsetTop+t.tooltip.caretY+12+"px",left:this.chart.canvas.offsetLeft+(0,S.u)(t.tooltip.caretX,100,this.clientWidth-100-this.paddingYAxis)-100+"px"}):this._tooltip=void 0}},{kind:"method",key:"_releaseCanvas",value:function(){this.chart&&this.chart.destroy()}},{kind:"get",static:!0,key:"styles",value:function(){return(0,C.iv)(c||(c=(0,y.Z)([":host{display:block;position:var(--chart-base-position,relative)}.animationContainer{overflow:hidden;height:0;transition:height .3s cubic-bezier(.4,0,.2,1)}.chartContainer{position:relative}canvas{max-height:var(--chart-max-height,400px)}.chartLegend{text-align:center}.chartLegend li{cursor:pointer;display:inline-grid;grid-auto-flow:column;padding:0 8px;box-sizing:border-box;align-items:center;color:var(--secondary-text-color)}.chartLegend .hidden{text-decoration:line-through}.chartLegend .label{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.chartLegend .bullet,.chartTooltip .bullet{border-width:1px;border-style:solid;border-radius:50%;display:inline-block;height:16px;margin-right:6px;width:16px;flex-shrink:0;box-sizing:border-box;margin-inline-end:6px;margin-inline-start:initial;direction:var(--direction)}.chartTooltip .bullet{align-self:baseline}:host([rtl]) .chartLegend .bullet,:host([rtl]) .chartTooltip .bullet{margin-right:inherit;margin-left:6px;margin-inline-end:inherit;margin-inline-start:6px;direction:var(--direction)}.chartTooltip{padding:8px;font-size:90%;position:absolute;background:rgba(80,80,80,.9);color:#fff;border-radius:4px;pointer-events:none;z-index:1000;width:200px;box-sizing:border-box}:host([rtl]) .chartTooltip{direction:rtl}.chartLegend ul,.chartTooltip ul{display:inline-block;padding:0 0px;margin:8px 0 0 0;width:100%}.chartTooltip ul{margin:0 4px}.chartTooltip li{display:flex;white-space:pre-line;align-items:center;line-height:16px;padding:4px 0}.chartTooltip .title{text-align:center;font-weight:500;direction:ltr}.chartTooltip .footer{font-weight:500}.chartTooltip .beforeBody{text-align:center;font-weight:300;word-break:break-all}"])))}}]}}),C.oi)},51324:function(t,e,i){var a,n=i(53709),r=i(88962),o=i(33368),s=i(71650),d=i(82390),l=i(69205),h=i(70906),c=i(91808),u=i(68144),v=i(79932),f=i(7323),p=i(25516),y=i(46134),m=i(55070),g=i(47181),k=i(87744),b=i(18457),_=i(62336),w=function(t){var e=parseFloat(t);return isFinite(e)?e:null},x=(0,c.Z)(null,(function(t,e){var i=function(e){(0,l.Z)(a,e);var i=(0,h.Z)(a);function a(){var e;(0,s.Z)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=i.call.apply(i,[this].concat(r)),t((0,d.Z)(e)),e}return(0,o.Z)(a)}(e);return{F:i,d:[{kind:"field",decorators:[(0,v.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,v.Cb)({attribute:!1})],key:"data",value:function(){return[]}},{kind:"field",decorators:[(0,v.Cb)()],key:"names",value:void 0},{kind:"field",decorators:[(0,v.Cb)()],key:"unit",value:void 0},{kind:"field",decorators:[(0,v.Cb)()],key:"identifier",value:void 0},{kind:"field",decorators:[(0,v.Cb)({type:Boolean})],key:"showNames",value:function(){return!0}},{kind:"field",decorators:[(0,v.Cb)({attribute:!1})],key:"startTime",value:void 0},{kind:"field",decorators:[(0,v.Cb)({attribute:!1})],key:"endTime",value:void 0},{kind:"field",decorators:[(0,v.Cb)({type:Number})],key:"paddingYAxis",value:function(){return 0}},{kind:"field",decorators:[(0,v.Cb)({type:Number})],key:"chartIndex",value:void 0},{kind:"field",decorators:[(0,v.SB)()],key:"_chartData",value:void 0},{kind:"field",decorators:[(0,v.SB)()],key:"_chartOptions",value:void 0},{kind:"field",decorators:[(0,v.SB)()],key:"_yWidth",value:function(){return 0}},{kind:"field",key:"_chartTime",value:function(){return new Date}},{kind:"field",decorators:[(0,v.IO)("ha-chart-base")],key:"_chart",value:void 0},{kind:"field",key:"resize",value:function(){var t=this;return function(e){var i;null===(i=t._chart)||void 0===i||i.resize(e)}}},{kind:"method",key:"render",value:function(){return(0,u.dy)(a||(a=(0,r.Z)([' <ha-chart-base .hass="','" .data="','" .options="','" .paddingYAxis="','" chart-type="line"></ha-chart-base> '])),this.hass,this._chartData,this._chartOptions,this.paddingYAxis-this._yWidth)}},{kind:"method",key:"willUpdate",value:function(t){var e=this;(!this.hasUpdated||t.has("showNames")||t.has("startTime")||t.has("endTime"))&&(this._chartOptions={parsing:!1,animation:!1,interaction:{mode:"nearest",axis:"xy"},scales:{x:{type:"time",adapters:{date:{locale:this.hass.locale,config:this.hass.config}},suggestedMin:this.startTime,suggestedMax:this.endTime,ticks:{maxRotation:0,sampleSize:5,autoSkipPadding:20,major:{enabled:!0},font:function(t){return t.tick&&t.tick.major?{weight:"bold"}:{}}},time:{tooltipFormat:"datetimeseconds"}},y:{ticks:{maxTicksLimit:7},title:{display:!0,text:this.unit},afterUpdate:function(t){e._yWidth!==Math.floor(t.width)&&(e._yWidth=Math.floor(t.width),(0,g.B)(e,"y-width-changed",{value:e._yWidth,chartIndex:e.chartIndex}))},position:(0,k.HE)(this.hass)?"right":"left"}},plugins:{tooltip:{callbacks:{label:function(t){var i;return"".concat(t.dataset.label,": ").concat((0,b.uf)(t.parsed.y,e.hass.locale,null!==(i=e.data[t.datasetIndex])&&void 0!==i&&i.entity_id?(0,b.l4)(e.hass.states[e.data[t.datasetIndex].entity_id],e.hass.entities[e.data[t.datasetIndex].entity_id]):void 0)," ").concat(e.unit)}}},filler:{propagate:!0},legend:{display:this.showNames,labels:{usePointStyle:!0}}},elements:{line:{tension:.1,borderWidth:1.5},point:{hitRadius:50}},locale:(0,b.Hd)(this.hass.locale)}),(t.has("data")||t.has("startTime")||t.has("endTime")||this._chartTime<new Date(this.endTime.getTime()-_.Q))&&this._generateData()}},{kind:"method",key:"_generateData",value:function(){var t=this,e=0,i=getComputedStyle(this),a=this.data,n=[];if(0!==a.length){this._chartTime=new Date;var r=this.endTime,o=this.names||{};a.forEach((function(a){var s=a.domain,d=o[a.entity_id]||a.name,l=null,h=[],c=function(t,e){e&&(t>r||(h.forEach((function(i,a){null===e[a]&&l&&null!==l[a]&&i.data.push({x:t.getTime(),y:l[a]}),i.data.push({x:t.getTime(),y:e[a]})})),l=e))},u=function(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;n||(n=(0,m.hZ)(e,i),e++),h.push({label:t,fill:!!a&&"origin",borderColor:n,backgroundColor:n+"7F",stepped:"before",pointRadius:0,data:[]})};if("thermostat"===s||"climate"===s||"water_heater"===s){var v=a.states.some((function(t){var e;return null===(e=t.attributes)||void 0===e?void 0:e.hvac_action})),f="climate"===s&&v?function(t){var e;return"heating"===(null===(e=t.attributes)||void 0===e?void 0:e.hvac_action)}:function(t){return"heat"===t.state},p="climate"===s&&v?function(t){var e;return"cooling"===(null===(e=t.attributes)||void 0===e?void 0:e.hvac_action)}:function(t){return"cool"===t.state},y=a.states.some(f),g=a.states.some(p),k=a.states.some((function(t){return t.attributes&&t.attributes.target_temp_high!==t.attributes.target_temp_low}));u("".concat(t.hass.localize("ui.card.climate.current_temperature",{name:d}))),y&&u("".concat(t.hass.localize("ui.card.climate.heating",{name:d})),!0,i.getPropertyValue("--state-climate-heat-color")),g&&u("".concat(t.hass.localize("ui.card.climate.cooling",{name:d})),!0,i.getPropertyValue("--state-climate-cool-color")),k?(u("".concat(t.hass.localize("ui.card.climate.target_temperature_mode",{name:d,mode:t.hass.localize("ui.card.climate.high")}))),u("".concat(t.hass.localize("ui.card.climate.target_temperature_mode",{name:d,mode:t.hass.localize("ui.card.climate.low")})))):u("".concat(t.hass.localize("ui.card.climate.target_temperature_entity",{name:d}))),a.states.forEach((function(t){if(t.attributes){var e=w(t.attributes.current_temperature),i=[e];if(y&&i.push(f(t)?e:null),g&&i.push(p(t)?e:null),k){var a=w(t.attributes.target_temp_high),n=w(t.attributes.target_temp_low);i.push(a,n),c(new Date(t.last_changed),i)}else{var r=w(t.attributes.temperature);i.push(r),c(new Date(t.last_changed),i)}}}))}else if("humidifier"===s){var b=a.states.some((function(t){var e;return null===(e=t.attributes)||void 0===e?void 0:e.action})),_=a.states.some((function(t){var e;return null===(e=t.attributes)||void 0===e?void 0:e.current_humidity})),x=b&&a.states.some((function(t){var e;return"humidifying"===(null===(e=t.attributes)||void 0===e?void 0:e.action)})),T=b&&a.states.some((function(t){var e;return"drying"===(null===(e=t.attributes)||void 0===e?void 0:e.action)}));u("".concat(t.hass.localize("ui.card.humidifier.target_humidity_entity",{name:d}))),_&&u("".concat(t.hass.localize("ui.card.humidifier.current_humidity_entity",{name:d}))),x?u("".concat(t.hass.localize("ui.card.humidifier.humidifying",{name:d})),!0,i.getPropertyValue("--state-humidifier-on-color")):T?u("".concat(t.hass.localize("ui.card.humidifier.drying",{name:d})),!0,i.getPropertyValue("--state-humidifier-on-color")):u("".concat(t.hass.localize("ui.card.humidifier.on_entity",{name:d})),!0),a.states.forEach((function(t){var e;if(t.attributes){var i,a=w(t.attributes.humidity),n=_?w(null===(e=t.attributes)||void 0===e?void 0:e.current_humidity):a,r=[a];if(_&&r.push(n),x)r.push("humidifying"===(null===(i=t.attributes)||void 0===i?void 0:i.action)?n:null);else if(T){var o;r.push("drying"===(null===(o=t.attributes)||void 0===o?void 0:o.action)?n:null)}else r.push("on"===t.state?n:null);c(new Date(t.last_changed),r)}}))}else{var C,Z;u(d);var D=null;a.states.forEach((function(t){var e=w(t.state),i=new Date(t.last_changed);if(null!==e&&D){var a,n=i.getTime(),r=D.getTime(),o=null===(a=Z)||void 0===a?void 0:a.getTime();c(D,[(r-o)/(n-o)*(e-C)+C]),c(new Date(r+1),[null]),c(i,[e]),Z=i,C=e,D=null}else null!==e&&null===D?(c(i,[e]),Z=i,C=e):null===e&&null===D&&void 0!==C&&(D=i)})),null!==D&&c(D,[null])}c(r,l),Array.prototype.push.apply(n,h)})),this._chartData={datasets:n}}}}]}}),u.oi);customElements.define("state-history-chart-line",x);var T,C,Z,D,z,S,O,H,W,j,B=i(44583),E=i(87367),I=i(39258);(0,c.Z)([(0,v.Mo)("state-history-chart-timeline")],(function(t,e){var i=function(e){(0,l.Z)(a,e);var i=(0,h.Z)(a);function a(){var e;(0,s.Z)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=i.call.apply(i,[this].concat(r)),t((0,d.Z)(e)),e}return(0,o.Z)(a)}(e);return{F:i,d:[{kind:"field",decorators:[(0,v.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,v.Cb)({attribute:!1})],key:"data",value:function(){return[]}},{kind:"field",decorators:[(0,v.Cb)()],key:"narrow",value:void 0},{kind:"field",decorators:[(0,v.Cb)()],key:"names",value:void 0},{kind:"field",decorators:[(0,v.Cb)()],key:"unit",value:void 0},{kind:"field",decorators:[(0,v.Cb)()],key:"identifier",value:void 0},{kind:"field",decorators:[(0,v.Cb)({type:Boolean})],key:"showNames",value:function(){return!0}},{kind:"field",decorators:[(0,v.Cb)({type:Boolean})],key:"chunked",value:function(){return!1}},{kind:"field",decorators:[(0,v.Cb)({attribute:!1})],key:"startTime",value:void 0},{kind:"field",decorators:[(0,v.Cb)({attribute:!1})],key:"endTime",value:void 0},{kind:"field",decorators:[(0,v.Cb)({type:Number})],key:"paddingYAxis",value:function(){return 0}},{kind:"field",decorators:[(0,v.Cb)({type:Number})],key:"chartIndex",value:void 0},{kind:"field",decorators:[(0,v.SB)()],key:"_chartData",value:void 0},{kind:"field",decorators:[(0,v.SB)()],key:"_chartOptions",value:void 0},{kind:"field",decorators:[(0,v.SB)()],key:"_yWidth",value:function(){return 0}},{kind:"field",key:"_chartTime",value:function(){return new Date}},{kind:"field",decorators:[(0,v.IO)("ha-chart-base")],key:"_chart",value:void 0},{kind:"field",key:"resize",value:function(){var t=this;return function(e){var i;null===(i=t._chart)||void 0===i||i.resize(e)}}},{kind:"method",key:"render",value:function(){return(0,u.dy)(T||(T=(0,r.Z)([' <ha-chart-base .hass="','" .data="','" .options="','" .height="','" .paddingYAxis="','" chart-type="timeline"></ha-chart-base> '])),this.hass,this._chartData,this._chartOptions,30*this.data.length+30,this.paddingYAxis-this._yWidth)}},{kind:"method",key:"willUpdate",value:function(t){this.hasUpdated||this._createOptions(),(t.has("startTime")||t.has("endTime")||t.has("data")||this._chartTime<new Date(this.endTime.getTime()-_.Q))&&this._generateData(),(t.has("startTime")||t.has("endTime")||t.has("showNames"))&&this._createOptions()}},{kind:"method",key:"_createOptions",value:function(){var t=this,e=this.narrow;this._chartOptions={maintainAspectRatio:!1,parsing:!1,animation:!1,scales:{x:{type:"timeline",position:"bottom",adapters:{date:{locale:this.hass.locale,config:this.hass.config}},suggestedMin:this.startTime,suggestedMax:this.endTime,ticks:{autoSkip:!0,maxRotation:0,sampleSize:5,autoSkipPadding:20,major:{enabled:!0},font:function(t){return t.tick&&t.tick.major?{weight:"bold"}:{}}},grid:{offset:!1},time:{tooltipFormat:"datetimeseconds"}},y:{type:"category",barThickness:20,offset:!0,grid:{display:!1,drawBorder:!1,drawTicks:!1},ticks:{display:this.chunked||this.showNames},afterSetDimensions:function(t){t.maxWidth=.18*t.chart.width},afterFit:function(i){t.chunked&&(i.width=e?105:185)},afterUpdate:function(e){var i,a,n=t.showNames?null!==(i=e.width)&&void 0!==i?i:0:(0,k.HE)(t.hass)?0:null!==(a=e.left)&&void 0!==a?a:0;t._yWidth!==Math.floor(n)&&e.ticks.length===t.data.length&&(t._yWidth=Math.floor(n),(0,g.B)(t,"y-width-changed",{value:t._yWidth,chartIndex:t.chartIndex}))},position:(0,k.HE)(this.hass)?"right":"left"}},plugins:{tooltip:{mode:"nearest",callbacks:{title:function(t){return t[0].chart.data.labels[t[0].datasetIndex]},beforeBody:function(t){return t[0].dataset.label||""},label:function(e){var i=e.dataset.data[e.dataIndex],a=i.end.getTime()-i.start.getTime(),n="".concat(t.hass.localize("ui.components.history_charts.duration"),": ").concat((0,E.Z)(a));return[i.label||"",(0,B.E8)(i.start,t.hass.locale,t.hass.config),(0,B.E8)(i.end,t.hass.locale,t.hass.config),n]},labelColor:function(t){return{borderColor:t.dataset.data[t.dataIndex].color,backgroundColor:t.dataset.data[t.dataIndex].color}}}},filler:{propagate:!0}},locale:(0,b.Hd)(this.hass.locale)}}},{kind:"method",key:"_generateData",value:function(){var t=this,e=getComputedStyle(this),i=this.data;i||(i=[]),this._chartTime=new Date;var a=this.startTime,n=this.endTime,r=[],o=[],s=this.names||{};i.forEach((function(i){var d,l=null,h=null,c=a,u=s[i.entity_id]||i.name,v=[];i.data.forEach((function(a){var r=a.state;r||(r=null),new Date(a.last_changed)>n||(null===l?(l=r,h=a.state_localize,c=new Date(a.last_changed)):r!==l&&(d=new Date(a.last_changed),v.push({start:c,end:d,label:h,color:(0,I.U)(l,e,t.hass.states[i.entity_id])}),l=r,h=a.state_localize,c=d))})),null!==l&&v.push({start:c,end:n,label:h,color:(0,I.U)(l,e,t.hass.states[i.entity_id])}),o.push({data:v,label:i.entity_id}),r.push(u)})),this._chartData={labels:r,datasets:o}}},{kind:"get",static:!0,key:"styles",value:function(){return(0,u.iv)(C||(C=(0,r.Z)(["ha-chart-base{--chart-max-height:none}"])))}}]}}),u.oi),(0,c.Z)([(0,v.Mo)("state-history-charts")],(function(t,e){var i=function(e){(0,l.Z)(a,e);var i=(0,h.Z)(a);function a(){var e;(0,s.Z)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=i.call.apply(i,[this].concat(r)),t((0,d.Z)(e)),e}return(0,o.Z)(a)}(e);return{F:i,d:[{kind:"field",decorators:[(0,v.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,v.Cb)({attribute:!1})],key:"historyData",value:void 0},{kind:"field",decorators:[(0,v.Cb)()],key:"narrow",value:void 0},{kind:"field",decorators:[(0,v.Cb)()],key:"names",value:void 0},{kind:"field",decorators:[(0,v.Cb)({type:Boolean,attribute:"virtualize",reflect:!0})],key:"virtualize",value:function(){return!1}},{kind:"field",decorators:[(0,v.Cb)({attribute:!1})],key:"endTime",value:void 0},{kind:"field",decorators:[(0,v.Cb)({attribute:!1})],key:"startTime",value:void 0},{kind:"field",decorators:[(0,v.Cb)({type:Boolean,attribute:"up-to-now"})],key:"upToNow",value:function(){return!1}},{kind:"field",decorators:[(0,v.Cb)()],key:"hoursToShow",value:void 0},{kind:"field",decorators:[(0,v.Cb)({type:Boolean})],key:"showNames",value:function(){return!0}},{kind:"field",decorators:[(0,v.Cb)({type:Boolean})],key:"isLoadingData",value:function(){return!1}},{kind:"field",decorators:[(0,v.SB)()],key:"_computedStartTime",value:void 0},{kind:"field",decorators:[(0,v.SB)()],key:"_computedEndTime",value:void 0},{kind:"field",decorators:[(0,v.SB)()],key:"_maxYWidth",value:function(){return 0}},{kind:"field",decorators:[(0,v.SB)()],key:"_childYWidths",value:function(){return[]}},{kind:"field",decorators:[(0,v.SB)()],key:"_chartCount",value:function(){return 0}},{kind:"field",decorators:[(0,p.i)(".container")],key:"_savedScrollPos",value:void 0},{kind:"field",decorators:[(0,v.Kt)("state-history-chart-line")],key:"_charts",value:void 0},{kind:"field",key:"resize",value:function(){var t=this;return function(e){var i;null===(i=t._charts)||void 0===i||i.forEach((function(t){return t.resize(e)}))}}},{kind:"method",key:"render",value:function(){var t=this;if(!(0,f.p)(this.hass,"history"))return(0,u.dy)(Z||(Z=(0,r.Z)(['<div class="info"> '," </div>"])),this.hass.localize("ui.components.history_charts.history_disabled"));if(this.isLoadingData&&!this.historyData)return(0,u.dy)(D||(D=(0,r.Z)(['<div class="info"> '," </div>"])),this.hass.localize("ui.components.history_charts.loading_history"));if(this._isHistoryEmpty())return(0,u.dy)(z||(z=(0,r.Z)(['<div class="info"> '," </div>"])),this.hass.localize("ui.components.history_charts.no_history_found"));var e=new Date;this._computedEndTime=this.upToNow||!this.endTime||this.endTime>e?e:this.endTime,this.startTime?this._computedStartTime=this.startTime:this.hoursToShow?this._computedStartTime=new Date((new Date).getTime()-3600*this.hoursToShow*1e3):this._computedStartTime=new Date(this.historyData.timeline.reduce((function(t,e){return Math.min(t,new Date(e.data[0].last_changed).getTime())}),(new Date).getTime()));var i,a,n=this.historyData.timeline.length?(this.virtualize?(i=this.historyData.timeline,a=10,i.reduce((function(t,e,i){var n=Math.floor(i/a);return t[n]||(t[n]=[]),t[n].push(e),t}),[])):[this.historyData.timeline]).concat(this.historyData.line):this.historyData.line;return this._chartCount=n.length,this.virtualize?(0,u.dy)(S||(S=(0,r.Z)(['<div class="container ha-scrollbar" @scroll="','"> <lit-virtualizer scroller class="ha-scrollbar" .items="','" .renderItem="','"> </lit-virtualizer> </div>'])),this._saveScrollPos,n,this._renderHistoryItem):(0,u.dy)(O||(O=(0,r.Z)(["",""])),n.map((function(e,i){return t._renderHistoryItem(e,i)})))}},{kind:"field",key:"_renderHistoryItem",value:function(){var t=this;return function(e,i){return e&&void 0!==i?Array.isArray(e)?(0,u.dy)(W||(W=(0,r.Z)(['<div class="entry-container"> <state-history-chart-timeline .hass="','" .data="','" .startTime="','" .endTime="','" .showNames="','" .names="','" .narrow="','" .chunked="','" .paddingYAxis="','" .chartIndex="','" @y-width-changed="','"></state-history-chart-timeline> </div> '])),t.hass,e,t._computedStartTime,t._computedEndTime,t.showNames,t.names,t.narrow,t.virtualize,t._maxYWidth,i,t._yWidthChanged):(0,u.dy)(H||(H=(0,r.Z)(['<div class="entry-container"> <state-history-chart-line .hass="','" .unit="','" .data="','" .identifier="','" .showNames="','" .startTime="','" .endTime="','" .paddingYAxis="','" .names="','" .chartIndex="','" @y-width-changed="','"></state-history-chart-line> </div> '])),t.hass,e.unit,e.data,e.identifier,t.showNames,t._computedStartTime,t._computedEndTime,t._maxYWidth,t.names,i,t._yWidthChanged):u.Ld}}},{kind:"method",key:"shouldUpdate",value:function(t){return(1!==t.size||!t.has("hass"))&&(1!==t.size||!t.has("_maxYWidth")||t.get("_maxYWidth")!==this._maxYWidth)}},{kind:"method",key:"willUpdate",value:function(){this.hasUpdated||(0,y.o)()}},{kind:"method",key:"updated",value:function(t){t.has("_chartCount")&&this._chartCount<this._childYWidths.length&&(this._childYWidths.length=this._chartCount,this._maxYWidth=Math.max.apply(Math,(0,n.Z)(Object.values(this._childYWidths)).concat([0])))}},{kind:"method",key:"_yWidthChanged",value:function(t){this._childYWidths[t.detail.chartIndex]=t.detail.value,this._maxYWidth=Math.max.apply(Math,(0,n.Z)(Object.values(this._childYWidths)).concat([0]))}},{kind:"method",key:"_isHistoryEmpty",value:function(){var t=!this.historyData||!this.historyData.timeline||!this.historyData.line||0===this.historyData.timeline.length&&0===this.historyData.line.length;return!this.isLoadingData&&t}},{kind:"method",decorators:[(0,v.hO)({passive:!0})],key:"_saveScrollPos",value:function(t){this._savedScrollPos=t.target.scrollTop}},{kind:"get",static:!0,key:"styles",value:function(){return(0,u.iv)(j||(j=(0,r.Z)([":host{display:block;min-height:60px}:host([virtualize]){height:100%}.info{text-align:center;line-height:60px;color:var(--secondary-text-color)}.container{max-height:var(--history-max-height)}.entry-container{width:100%}.entry-container:hover{z-index:1}:host([virtualize]) .entry-container{padding-left:1px;padding-right:1px}.container,lit-virtualizer{height:100%;width:100%}lit-virtualizer{contain:size layout!important}state-history-chart-line,state-history-chart-timeline{width:100%}"])))}}]}}),u.oi)},58763:function(t,e,i){i.d(e,{Nu:function(){return k},Vk:function(){return f},xS:function(){return y}});var a=i(53709),n=i(40039),r=i(71650),o=i(33368),s=i(58831),d=i(41826),l=i(91741),h=["climate","humidifier","water_heater"],c=["climate","humidifier","input_datetime","thermostat","water_heater","person","device_tracker"],u=["temperature","current_temperature","target_temp_low","target_temp_high","hvac_action","humidity","mode","action","current_humidity"],v=function(t,e){return!t.states[e]||c.includes((0,s.M)(e))},f=function(t,e,i,a,n){var r={type:"history/stream",entity_ids:n,start_time:i.toISOString(),end_time:a.toISOString(),minimal_response:!0,no_attributes:!n.some((function(e){return v(t,e)}))},o=new p(t);return t.connection.subscribeMessage((function(t){return e(o.processMessage(t))}),r)},p=function(){function t(e,i){(0,r.Z)(this,t),this.hass=void 0,this.hoursToShow=void 0,this.combinedHistory=void 0,this.hass=e,this.hoursToShow=i,this.combinedHistory={}}return(0,o.Z)(t,[{key:"processMessage",value:function(t){if(!this.combinedHistory||!Object.keys(this.combinedHistory).length)return this.combinedHistory=t.states,this.combinedHistory;if(!Object.keys(t.states).length)return this.combinedHistory;for(var e=this.hoursToShow?((new Date).getTime()-3600*this.hoursToShow*1e3)/1e3:void 0,i={},a=0,n=Object.keys(this.combinedHistory);a<n.length;a++){i[n[a]]=[]}for(var r=0,o=Object.keys(t.states);r<o.length;r++){i[o[r]]=[]}for(var s=0,d=Object.keys(i);s<d.length;s++){var l=d[s];if(l in this.combinedHistory&&l in t.states){var h=this.combinedHistory[l],c=h[h.length-1];i[l]=h.concat(t.states[l]),t.states[l][0].lu<c.lu&&(i[l]=i[l].sort((function(t,e){return t.lu-e.lu})))}else l in this.combinedHistory?i[l]=this.combinedHistory[l]:i[l]=t.states[l];if(e&&l in this.combinedHistory){var u=i[l].filter((function(t){return t.lu<e}));if(!u.length)continue;if(i[l]=i[l].filter((function(t){return t.lu>=e})),i[l].length&&i[l][0].lu===e)continue;var v=u[u.length-1];v.lu=e,i[l].unshift(v)}}return this.combinedHistory=i,this.combinedHistory}}]),t}(),y=function(t,e,i,a){var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o=arguments.length>6?arguments[6]:void 0,s={type:"history/stream",entity_ids:a,start_time:new Date((new Date).getTime()-3600*i*1e3).toISOString(),minimal_response:n,significant_changes_only:r,no_attributes:null!=o?o:!a.some((function(e){return v(t,e)}))},d=new p(t,i);return t.connection.subscribeMessage((function(t){return e(d.processMessage(t))}),s)},m=function(t,e){return t.state===e.state&&(!t.attributes||!e.attributes||u.every((function(i){return t.attributes[i]===e.attributes[i]})))},g=function(t){return"unit_of_measurement"in t||"state_class"in t},k=function(t,e,i){var r={},o=[];return e?(Object.keys(e).forEach((function(h){var c=e[h];if(0!==c.length){var u,v=h in t.states?t.states[h]:void 0,f=!v&&c.find((function(t){return t.a&&g(t.a)}));if(u=v&&g(v.attributes)?v.attributes.unit_of_measurement||" ":f?f.a.unit_of_measurement||" ":{zone:i("ui.dialogs.more_info_control.zone.graph_unit"),climate:t.config.unit_system.temperature,counter:"#",humidifier:"%",input_number:"#",number:"#",water_heater:t.config.unit_system.temperature}[(0,s.M)(h)])if(u in r&&h in r[u]){var p;(p=r[u][h]).push.apply(p,(0,a.Z)(c))}else u in r||(r[u]={}),r[u][h]=c;else o.push(function(t,e,i,a,r,o,s){var h,c=[],u=o[0],v=(0,n.Z)(o);try{for(v.s();!(h=v.n()).done;){var f=h.value;if(!(c.length>0&&f.s===c[c.length-1].state)){var p={};null!=s&&s.attributes.device_class&&(p.device_class=null==s?void 0:s.attributes.device_class),c.push({state_localize:(0,d.computeStateDisplayFromEntityAttributes)(t,e,i,a[r],r,Object.assign(Object.assign({},f.a||u.a),p),f.s),state:f.s,last_changed:1e3*(f.lc?f.lc:f.lu)})}}}catch(y){v.e(y)}finally{v.f()}return{name:(0,l.a)(r,(null==s?void 0:s.attributes)||u.a),entity_id:r,data:c}}(i,t.locale,t.config,t.entities,h,c,v))}})),{line:Object.keys(r).map((function(e){return function(t,e,i){var a=[];return Object.keys(e).forEach((function(t){var r,o=e[t],d=o[0],c=(0,s.M)(t),v=[],f=(0,n.Z)(o);try{for(f.s();!(r=f.n()).done;){var p=r.value,y=void 0;if(h.includes(c)){y={state:p.s,last_changed:1e3*p.lu,attributes:{}};for(var g=0,k=u;g<k.length;g++){var b=k[g];b in p.a&&(y.attributes[b]=p.a[b])}}else y={state:p.s,last_changed:1e3*(p.lc?p.lc:p.lu),attributes:{}};v.length>1&&m(y,v[v.length-1])&&m(y,v[v.length-2])||v.push(y)}}catch(w){f.e(w)}finally{f.f()}var _=t in i?i[t].attributes:"friendly_name"in d.a?d.a:void 0;a.push({domain:c,name:(0,l.a)(t,_||{}),entity_id:t,states:v})})),{unit:t,identifier:Object.keys(e).join(""),data:a}}(e,r[e],t.states)})),timeline:o}):{line:[],timeline:[]}}},46134:function(t,e,i){i.d(e,{o:function(){return o}});var a=i(99312),n=i(81043),r=i(44281),o=function(){var t=(0,n.Z)((0,a.Z)().mark((function t(){return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,r.j)();case 2:return t.next=4,i.e(68984).then(i.bind(i,68984));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}}]);
//# sourceMappingURL=3876-dYV3IACxmxE.js.map