"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[46653],{85157:function(e,t,i){i.d(t,{t:function(){return o}});var r=i(71650),a=i(33368),n=function(){function e(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.localStorage;(0,r.Z)(this,e),this.storage=void 0,this._storage={},this._listeners={},this.storage=i,i===window.localStorage&&window.addEventListener("storage",(function(e){e.key&&t.hasKey(e.key)&&(t._storage[e.key]=e.newValue?JSON.parse(e.newValue):e.newValue,t._listeners[e.key]&&t._listeners[e.key].forEach((function(i){return i(e.oldValue?JSON.parse(e.oldValue):e.oldValue,t._storage[e.key])})))}))}return(0,a.Z)(e,[{key:"addFromStorage",value:function(e){if(!this._storage[e]){var t=this.storage.getItem(e);t&&(this._storage[e]=JSON.parse(t))}}},{key:"subscribeChanges",value:function(e,t){var i=this;return this._listeners[e]?this._listeners[e].push(t):this._listeners[e]=[t],function(){i.unsubscribeChanges(e,t)}}},{key:"unsubscribeChanges",value:function(e,t){if(e in this._listeners){var i=this._listeners[e].indexOf(t);-1!==i&&this._listeners[e].splice(i,1)}}},{key:"hasKey",value:function(e){return e in this._storage}},{key:"getValue",value:function(e){return this._storage[e]}},{key:"setValue",value:function(e,t){var i=this._storage[e];this._storage[e]=t;try{void 0===t?this.storage.removeItem(e):this.storage.setItem(e,JSON.stringify(t))}catch(r){}finally{this._listeners[e]&&this._listeners[e].forEach((function(e){return e(i,t)}))}}}]),e}(),s={},o=function(e){return function(t){var i,r=e.storage||"localStorage";r&&r in s?i=s[r]:(i=new n(window[r]),s[r]=i);var a=String(t.key),o=e.key||String(t.key),c=t.initializer?t.initializer():void 0;i.addFromStorage(o);var d=!1!==e.subscribe?function(e){return i.subscribeChanges(o,(function(i,r){e.requestUpdate(t.key,i)}))}:void 0,l=function(){return i.hasKey(o)?i.getValue(o):c};return{kind:"method",placement:"prototype",key:t.key,descriptor:{set:function(r){!function(r,a){var n;e.state&&(n=l()),i.setValue(o,a),e.state&&r.requestUpdate(t.key,n)}(this,r)},get:function(){return l()},enumerable:!0,configurable:!0},finisher:function(i){if(e.state&&e.subscribe){var r=i.prototype.connectedCallback,n=i.prototype.disconnectedCallback;i.prototype.connectedCallback=function(){r.call(this),this["__unbsubLocalStorage".concat(a)]=null==d?void 0:d(this)},i.prototype.disconnectedCallback=function(){var e;n.call(this),null===(e=this["__unbsubLocalStorage".concat(a)])||void 0===e||e.call(this),this["__unbsubLocalStorage".concat(a)]=void 0}}e.state&&i.createProperty(t.key,Object.assign({noAccessor:!0},e.stateOptions))}}}}},54531:function(e,t,i){i.d(t,{Qc:function(){return d},Xr:function(){return c},zJ:function(){return o}});var r=["zone","persistent_notification"],a=function(e,t){var i,r,a,n,s,o,c,d;if("call-service"===t.action&&(null!==(i=t.target)&&void 0!==i&&i.entity_id||null!==(r=t.service_data)&&void 0!==r&&r.entity_id||null!==(a=t.data)&&void 0!==a&&a.entity_id)){var l=null!==(n=null!==(s=null===(o=t.service_data)||void 0===o?void 0:o.entity_id)&&void 0!==s?s:null===(c=t.data)||void 0===c?void 0:c.entity_id)&&void 0!==n?n:null===(d=t.target)||void 0===d?void 0:d.entity_id;Array.isArray(l)||(l=[l]);for(var h=0,u=l;h<u.length;h++){var p=u[h];e.add(p)}}},n=function(e,t){"string"!=typeof t?(t.entity&&e.add(t.entity),t.camera_image&&e.add(t.camera_image),t.tap_action&&a(e,t.tap_action),t.hold_action&&a(e,t.hold_action)):e.add(t)},s=function e(t,i){i.entity&&n(t,i.entity),i.entities&&Array.isArray(i.entities)&&i.entities.forEach((function(e){return n(t,e)})),i.card&&e(t,i.card),i.cards&&Array.isArray(i.cards)&&i.cards.forEach((function(i){return e(t,i)})),i.elements&&Array.isArray(i.elements)&&i.elements.forEach((function(i){return e(t,i)})),i.badges&&Array.isArray(i.badges)&&i.badges.forEach((function(e){return n(t,e)}))},o=function(e){var t=new Set;return e.views.forEach((function(e){return s(t,e)})),t},c=function(e,t){for(var i=new Set,a=0,n=Object.keys(e.states);a<n.length;a++){var s=n[a];t.has(s)||r.includes(s.split(".",1)[0])||i.add(s)}return i},d=function(e,t){var i=o(t);return c(e,i)}},46653:function(e,t,i){var r,a,n,s,o,c,d,l=i(99312),h=i(81043),u=i(53709),p=i(88962),v=i(33368),f=i(71650),y=i(82390),g=i(69205),m=i(70906),k=i(91808),_=(i(17333),i(91993),i(81480)),b=i(68144),w=i(79932),E=i(83448),C=i(47501),x=i(62601),S=i(14516),Z=i(85157),z=i(47181),A=(i(31206),i(65040),i(56007)),O=i(9893),V=i(54531),L=i(51153),R=function(){var e=(0,h.Z)((0,l.Z)().mark((function e(t,i,r,a){var n,s,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={type:i},e.next=3,(0,L.Do)(i);case 3:if(!(s=e.sent)||!s.getStubConfig){e.next=9;break}return e.next=7,s.getStubConfig(t,r,a);case 7:o=e.sent,n=Object.assign(Object.assign({},n),o);case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e)})));return function(t,i,r,a){return e.apply(this,arguments)}}(),j=[{type:"alarm-panel",showElement:!0},{type:"button",showElement:!0},{type:"calendar",showElement:!0},{type:"entities",showElement:!0},{type:"entity",showElement:!0},{type:"gauge",showElement:!0},{type:"glance",showElement:!0},{type:"history-graph",showElement:!0},{type:"statistics-graph",showElement:!1},{type:"statistic",showElement:!0},{type:"humidifier",showElement:!0},{type:"light",showElement:!0},{type:"map",showElement:!0},{type:"markdown",showElement:!0},{type:"media-control",showElement:!0},{type:"picture",showElement:!0},{type:"picture-elements",showElement:!0},{type:"picture-entity",showElement:!0},{type:"picture-glance",showElement:!0},{type:"plant-status",showElement:!0},{type:"sensor",showElement:!0},{type:"thermostat",showElement:!0},{type:"weather-forecast",showElement:!0},{type:"area",showElement:!0},{type:"tile",showElement:!0},{type:"conditional"},{type:"entity-filter"},{type:"grid"},{type:"horizontal-stack"},{type:"iframe"},{type:"logbook"},{type:"vertical-stack"},{type:"shopping-list"}];(0,k.Z)([(0,w.Mo)("hui-card-picker")],(function(e,t){var i,k=function(t){(0,g.Z)(r,t);var i=(0,m.Z)(r);function r(){var t;(0,f.Z)(this,r);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];return t=i.call.apply(i,[this].concat(n)),e((0,y.Z)(t)),t}return(0,v.Z)(r)}(t);return{F:k,d:[{kind:"field",decorators:[(0,w.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,Z.t)({key:"lovelaceClipboard",state:!0,subscribe:!0,storage:"sessionStorage"})],key:"_clipboard",value:void 0},{kind:"field",decorators:[(0,w.SB)()],key:"_cards",value:function(){return[]}},{kind:"field",key:"lovelace",value:void 0},{kind:"field",key:"cardPicked",value:void 0},{kind:"field",decorators:[(0,w.SB)()],key:"_filter",value:function(){return""}},{kind:"field",decorators:[(0,w.SB)()],key:"_width",value:void 0},{kind:"field",decorators:[(0,w.SB)()],key:"_height",value:void 0},{kind:"field",key:"_unusedEntities",value:void 0},{kind:"field",key:"_usedEntities",value:void 0},{kind:"field",key:"_filterCards",value:function(){return(0,S.Z)((function(e,t){if(!t)return e;var i=e.map((function(e){return e.card})),r=new _.Z(i,{keys:["type","name","description"],isCaseSensitive:!1,minMatchCharLength:2,threshold:.2});return i=r.search(t).map((function(e){return e.item})),e.filter((function(e){return i.includes(e.card)}))}))}},{kind:"method",key:"render",value:function(){return this.hass&&this.lovelace&&this._unusedEntities&&this._usedEntities?(0,b.dy)(r||(r=(0,p.Z)([' <search-input .hass="','" .filter="','" @value-changed="','" .label="','"></search-input> <div id="content" style="','"> <div class="cards-container"> '," ",' </div> <div class="cards-container"> <div class="card manual" @click="','" .config="','"> <div class="card-header"> ',' </div> <div class="preview description"> '," </div> </div> </div> </div> "])),this.hass,this._filter,this._handleSearchChange,this.hass.localize("ui.panel.lovelace.editor.edit_card.search_cards"),(0,C.V)({width:this._width?"".concat(this._width,"px"):"auto",height:this._height?"".concat(this._height,"px"):"auto"}),this._clipboard&&!this._filter?(0,b.dy)(a||(a=(0,p.Z)([" "," "])),(0,x.C)(this._renderCardElement({type:this._clipboard.type,showElement:!0,isCustom:!1,name:this.hass.localize("ui.panel.lovelace.editor.card.generic.paste"),description:"".concat(this.hass.localize("ui.panel.lovelace.editor.card.generic.paste_description",{type:this._clipboard.type}))},this._clipboard),(0,b.dy)(n||(n=(0,p.Z)([' <div class="card spinner"> <ha-circular-progress active alt="Loading"></ha-circular-progress> </div> ']))))):b.Ld,this._filterCards(this._cards,this._filter).map((function(e){return e.element})),this._cardPicked,{type:""},this.hass.localize("ui.panel.lovelace.editor.card.generic.manual"),this.hass.localize("ui.panel.lovelace.editor.card.generic.manual_description")):b.Ld}},{kind:"method",key:"shouldUpdate",value:function(e){var t=e.get("hass");return!t||t.locale!==this.hass.locale}},{kind:"method",key:"firstUpdated",value:function(){var e=this;if(this.hass&&this.lovelace){var t=(0,V.zJ)(this.lovelace),i=(0,V.Xr)(this.hass,t);this._usedEntities=(0,u.Z)(t).filter((function(t){return e.hass.states[t]&&!(0,A.rk)(e.hass.states[t].state)})),this._unusedEntities=(0,u.Z)(i).filter((function(t){return e.hass.states[t]&&!(0,A.rk)(e.hass.states[t].state)})),this._loadCards()}}},{kind:"method",key:"_loadCards",value:function(){var e=this,t=j.map((function(t){return Object.assign({name:e.hass.localize("ui.panel.lovelace.editor.card.".concat(t.type,".name")),description:e.hass.localize("ui.panel.lovelace.editor.card.".concat(t.type,".description"))},t)}));O.kb.length>0&&(t=t.concat(O.kb.map((function(e){return{type:e.type,name:e.name,description:e.description,showElement:e.preview,isCustom:!0}})))),this._cards=t.map((function(t){return{card:t,element:(0,b.dy)(s||(s=(0,p.Z)(["",""])),(0,x.C)(e._renderCardElement(t),(0,b.dy)(o||(o=(0,p.Z)([' <div class="card spinner"> <ha-circular-progress active alt="Loading"></ha-circular-progress> </div> '])))))}}))}},{kind:"method",key:"_handleSearchChange",value:function(e){var t=e.detail.value;if(t){if(!this._width||!this._height){var i=this.shadowRoot.getElementById("content");if(i&&!this._width){var r=i.clientWidth;r&&(this._width=r)}if(i&&!this._height){var a=i.clientHeight;a&&(this._height=a)}}}else this._width=void 0,this._height=void 0;this._filter=t}},{kind:"method",key:"_cardPicked",value:function(e){var t=e.currentTarget.config;(0,z.B)(this,"config-changed",{config:t})}},{kind:"method",key:"_tryCreateCardElement",value:function(e){var t=this,i=(0,L.l$)(e);return i.hass=this.hass,i.addEventListener("ll-rebuild",(function(r){r.stopPropagation(),t._rebuildCard(i,e)}),{once:!0}),i}},{kind:"method",key:"_rebuildCard",value:function(e,t){var i;try{i=this._tryCreateCardElement(t)}catch(r){return}e.parentElement&&e.parentElement.replaceChild(i,e)}},{kind:"method",key:"_renderCardElement",value:(i=(0,h.Z)((0,l.Z)().mark((function e(t,i){var r,a,n,s,o,d,h,u;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.type,a=t.showElement,n=t.isCustom,s=t.name,o=t.description,d=n?(0,O.cs)(r):void 0,n&&(r="".concat(O.Qo).concat(r)),u=null!=i?i:{type:r},!this.hass||!this.lovelace){e.next=11;break}if(i){e.next=10;break}return e.next=9,R(this.hass,r,this._unusedEntities,this._usedEntities);case 9:u=e.sent;case 10:if(a)try{h=this._tryCreateCardElement(u)}catch(l){h=void 0}case 11:return e.abrupt("return",(0,b.dy)(c||(c=(0,p.Z)([' <div class="card"> <div class="overlay" @click="','" .config="','"></div> <div class="card-header"> ',' </div> <div class="preview ','"> '," </div> </div> "])),this._cardPicked,u,d?"".concat(this.hass.localize("ui.panel.lovelace.editor.cardpicker.custom_card"),": ").concat(d.name||d.type):s,(0,E.$)({description:!h||"HUI-ERROR-CARD"===h.tagName}),h&&"HUI-ERROR-CARD"!==h.tagName?h:d?d.description||this.hass.localize("ui.panel.lovelace.editor.cardpicker.no_description"):o));case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{kind:"get",static:!0,key:"styles",value:function(){return[(0,b.iv)(d||(d=(0,p.Z)(["search-input{display:block;--mdc-shape-small:var(--card-picker-search-shape);margin:var(--card-picker-search-margin)}.cards-container{display:grid;grid-gap:8px 8px;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));margin-top:20px}.card{height:100%;max-width:500px;display:flex;flex-direction:column;border-radius:var(--ha-card-border-radius,12px);background:var(--primary-background-color,#fafafa);cursor:pointer;position:relative;overflow:hidden;border:var(--ha-card-border-width,1px) solid var(--ha-card-border-color,var(--divider-color))}.card-header{color:var(--ha-card-header-color,--primary-text-color);font-family:var(--ha-card-header-font-family,inherit);font-size:16px;font-weight:700;letter-spacing:-.012em;line-height:20px;padding:12px 16px;display:block;text-align:center;background:var(--ha-card-background,var(--card-background-color,#fff));border-bottom:1px solid var(--divider-color)}.preview{pointer-events:none;margin:20px;flex-grow:1;display:flex;align-items:center;justify-content:center}.preview>:first-child{zoom:.6;display:block;width:100%}.description{text-align:center}.spinner{align-items:center;justify-content:center}.overlay{position:absolute;width:100%;height:100%;z-index:1;box-sizing:border-box;border-radius:var(--ha-card-border-radius,12px)}.manual{max-width:none}"])))]}}]}}),b.oi)}}]);
//# sourceMappingURL=46653-dfeL2oaZhW4.js.map