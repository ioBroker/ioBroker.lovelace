"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["5604"],{50875:function(e,t,a){a.d(t,{Eu:()=>r,hZ:()=>o,o9:()=>d});var i=a(27486),s=a(11259);const n=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#9498a0","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#74787f","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#b6bac2","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#d9d9d9","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function r(e){return n[e%n.length]}function o(e,t){const a=t.getPropertyValue(`--graph-color-${e+1}`)||r(e);return(0,s.Rq)(a)}const d=(0,i.Z)((e=>n.map(((t,a)=>o(a,e)))),((e,t)=>e[0].getPropertyValue("--graph-color-1")===t[0].getPropertyValue("--graph-color-1")))},6736:function(e,t,a){a.d(t,{f:()=>r});var i=a(61701),s=a(72621),n=(a(19083),a(71695),a(9359),a(52924),a(40251),a(61006),a(47021),a(50778));const r=e=>(0,i.Z)(null,(function(e,t){class a extends t{constructor(...t){super(...t),e(this)}}return{F:a,d:[{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:void 0},{kind:"field",key:"__unsubs",value:void 0},{kind:"method",key:"connectedCallback",value:function(){(0,s.Z)(a,"connectedCallback",this,3)([]),this._checkSubscribed()}},{kind:"method",key:"disconnectedCallback",value:function(){if((0,s.Z)(a,"disconnectedCallback",this,3)([]),this.__unsubs){for(;this.__unsubs.length;){const e=this.__unsubs.pop();e instanceof Promise?e.then((e=>e())):e()}this.__unsubs=void 0}}},{kind:"method",key:"updated",value:function(e){if((0,s.Z)(a,"updated",this,3)([e]),e.has("hass"))this._checkSubscribed();else if(this.hassSubscribeRequiredHostProps)for(const t of e.keys())if(this.hassSubscribeRequiredHostProps.includes(t))return void this._checkSubscribed()}},{kind:"method",key:"hassSubscribe",value:function(){return[]}},{kind:"method",key:"_checkSubscribed",value:function(){var e;void 0!==this.__unsubs||!this.isConnected||void 0===this.hass||null!==(e=this.hassSubscribeRequiredHostProps)&&void 0!==e&&e.some((e=>void 0===this[e]))||(this.__unsubs=this.hassSubscribe())}}]}}),e)},20548:function(e,t,a){a.d(t,{H:()=>n});a(81804);var i=a(11259),s=a(4643);function n(e,t,a,n,r,o){const d=e.getPropertyValue(r+"-"+o).trim(),c=d.length>0?d:e.getPropertyValue(r).trim();let u=(0,i.Rq)(c);return 0===d.length&&o&&(u=(0,i.CO)((0,i.p3)(t?(0,s.C)((0,i.Rw)((0,i.wK)(u)),o):(0,s.W)((0,i.Rw)((0,i.wK)(u)),o)))),n?u+=a?"32":"7F":a&&(u+="7F"),u}},53259:function(e,t,a){a.a(e,(async function(e,i){try{a.d(t,{J:()=>k,MC:()=>y,Zx:()=>$,b4:()=>_,kT:()=>C});a(28457),a(71695),a(92745),a(61893),a(5509),a(9359),a(56475),a(31526),a(70104),a(19423),a(92519),a(42179),a(89256),a(24931),a(88463),a(57449),a(19814),a(88044),a(47021);var s=a(21893),n=a(13809),r=a(38836),o=a(84775),d=a(80951),c=a(13730),u=a(6542),l=a(83204),h=a(23459),f=a(23711),b=a(50602),v=a(46467),p=a(33570),m=e([v,p,b]);function y(e,t){let a=new Date(t);return e>2&&0===a.getHours()&&(a=(0,s.b)(a,1)),a.setMinutes(0,0,0),e>35&&a.setDate(1),e>2&&a.setHours(0),a.getTime()}function _(e){return e>35?"month":e>2?"day":"hour"}function k(e,t,a,i,s,r,o,d){const c=(0,n.j)(t,e),u=void 0!==r&&void 0!==o;return{xAxis:{type:"time",min:e,max:y(c,t)},yAxis:{type:"value",name:s,nameGap:2,nameTextStyle:{align:"left"},axisLabel:{formatter:e=>(0,b.uf)(Math.abs(e),a)},splitLine:{show:!0}},grid:{top:15,bottom:0,left:1,right:1,containLabel:!0},tooltip:{trigger:"axis",formatter:e=>{if(Array.isArray(e)){const t=[],n=[];return e.forEach((e=>{var a;null!==(a=e.seriesId)&&void 0!==a&&a.startsWith("compare-")?n.push(e):t.push(e)})),[t,n].map((e=>S(e,a,i,c,u,s,d))).filter(Boolean).join("<br><br>")}return S([e],a,i,c,u,s,d)}}}}function S(e,t,a,i,s,n,o){var d,c,u,l;if(null===(d=e[0])||void 0===d||!d.value)return"";const h=new Date(null!==(c=null===(u=e[0].value)||void 0===u?void 0:u[2])&&void 0!==c?c:null===(l=e[0].value)||void 0===l?void 0:l[0]);let f;f=i>89?`${(0,v.NC)(h,t,a)}`:i>0?`${(0,v.ud)(h,t,a)}`:`${s?`${(0,v.ud)(h,t,a)}: `:""}${(0,p.mr)(h,t,a)} â€“ ${(0,p.mr)((0,r.T)(h,1),t,a)}`;const m=`<h4 style="text-align: center; margin: 0;">${f}</h4>`;let g=0,y=0,_=0,k=0;const S=e.map((e=>{var a;const i=null===(a=e.value)||void 0===a?void 0:a[1],s=(0,b.uf)(i,t);return"0"!==s&&("bar"===e.componentSubType&&(i>0?(g+=i,y++):(_+=i,k++)),`${e.marker} ${e.seriesName}: ${s} ${n}`)})).filter(Boolean);let $="";return 0!==g&&y>1&&o&&($+=`<br><b>${o(g)}</b>`),0!==_&&k>1&&o&&($+=`<br><b>${o(_)}</b>`),S.length>0?`${m}${S.join("<br>")}${$}`:""}function $(e){Array.from(new Set(e.map((e=>e.data.map((e=>Number(e[0]))))).flat())).sort(((e,t)=>e-t)).forEach(((t,a)=>{const i={},s={};for(let l=e.length-1;l>=0;l--){var n,r,o,d,c;const h=e[l].data[a],f=h&&"object"==typeof h&&"value"in h?h:{value:h},b=null===(n=f.value)||void 0===n?void 0:n[0],v=null!==(r=e[l].stack)&&void 0!==r?r:"";var u;if(void 0!==b)if(Number(b)!==t)null===(u=e[l].data)||void 0===u||u.splice(a,0,{value:[t,0],itemStyle:{borderWidth:0}});else 0===(null===(o=f.value)||void 0===o?void 0:o[1])?e[l].data[a]=Object.assign(Object.assign({},f),{},{itemStyle:Object.assign(Object.assign({},f.itemStyle),{},{borderWidth:0})}):!i[v]&&(null===(d=f.value)||void 0===d?void 0:d[1])>0?(e[l].data[a]=Object.assign(Object.assign({},f),{},{itemStyle:Object.assign(Object.assign({},f.itemStyle),{},{borderRadius:[4,4,0,0]})}),i[v]=!0):!s[v]&&(null===(c=f.value)||void 0===c?void 0:c[1])<0&&(e[l].data[a]=Object.assign(Object.assign({},f),{},{itemStyle:Object.assign(Object.assign({},f.itemStyle),{},{borderRadius:[0,0,4,4]})}),s[v]=!0)}}))}function C(e,t){if(!t)return e=>e;const a=(0,o.o)(e,t);if(0!==a&&e.getTime()===(0,d.e)(e).getTime())return e=>(0,c.B)(e,a);const i=(0,u.d)(e,t);if(0!==i&&e.getTime()===(0,l.N)(e).getTime())return e=>(0,h.z)(e,i);const s=e.getTime()-t.getTime();return e=>(0,f.n)(e,s)}[v,p,b]=m.then?(await m)():m,i()}catch(g){i(g)}}))},52081:function(e,t,a){a.a(e,(async function(e,i){try{a.r(t),a.d(t,{HuiEnergyWaterGraphCard:()=>x});var s=a(61701),n=(a(71695),a(92745),a(9359),a(56475),a(31526),a(40251),a(47021),a(42625)),r=a(83389),o=a(16444),d=a(57243),c=a(50778),u=a(35359),l=a(27486),h=a(20548),f=a(25179),b=(a(54977),a(1118)),v=a(17705),p=a(6736),m=a(93331),g=a(53259),y=a(50602),_=e([f,y,b,g]);[f,y,b,g]=_.then?(await _)():_;let k,S,$,C,w=e=>e,x=(0,s.Z)([(0,c.Mo)("hui-energy-water-graph-card")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,c.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,c.SB)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,c.SB)()],key:"_chartData",value(){return[]}},{kind:"field",decorators:[(0,c.SB)()],key:"_start",value(){return(0,n.I)()}},{kind:"field",decorators:[(0,c.SB)()],key:"_end",value(){return(0,r.p)()}},{kind:"field",decorators:[(0,c.SB)()],key:"_compareStart",value:void 0},{kind:"field",decorators:[(0,c.SB)()],key:"_compareEnd",value:void 0},{kind:"field",decorators:[(0,c.SB)()],key:"_unit",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value(){return["_config"]}},{kind:"method",key:"hassSubscribe",value:function(){var e;return[(0,b.UB)(this.hass,{key:null===(e=this._config)||void 0===e?void 0:e.collection_key}).subscribe((e=>this._getStatistics(e)))]}},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(e){this._config=e}},{kind:"method",key:"shouldUpdate",value:function(e){return(0,m.SN)(this,e)||e.size>1||!e.has("hass")}},{kind:"method",key:"render",value:function(){return this.hass&&this._config?(0,d.dy)(k||(k=w` <ha-card> ${0} <div class="content ${0}"> <ha-chart-base .hass="${0}" .data="${0}" .options="${0}" chart-type="bar"></ha-chart-base> ${0} </div> </ha-card> `),this._config.title?(0,d.dy)(S||(S=w`<h1 class="card-header">${0}</h1>`),this._config.title):"",(0,u.$)({"has-header":!!this._config.title}),this.hass,this._chartData,this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,this._unit,this._compareStart,this._compareEnd),this._chartData.length?"":(0,d.dy)($||($=w`<div class="no-data"> ${0} </div>`),(0,o.z)(this._start)?this.hass.localize("ui.panel.lovelace.cards.energy.no_data"):this.hass.localize("ui.panel.lovelace.cards.energy.no_data_period"))):d.Ld}},{kind:"field",key:"_formatTotal",value(){return e=>this.hass.localize("ui.panel.lovelace.cards.energy.energy_water_graph.total_consumed",{num:(0,y.uf)(e,this.hass.locale),unit:this._unit})}},{kind:"field",key:"_createOptions",value(){return(0,l.Z)(((e,t,a,i,s,n,r)=>(0,g.J)(e,t,a,i,s,n,r,this._formatTotal)))}},{kind:"method",key:"_getStatistics",value:async function(e){this._start=e.start,this._end=e.end||(0,r.p)(),this._compareStart=e.startCompare,this._compareEnd=e.endCompare;const t=e.prefs.energy_sources.filter((e=>"water"===e.type));this._unit=(0,b.b)(this.hass);const a=[],i=getComputedStyle(this);if(e.statsCompare)a.push(...this._processDataSet(e.statsCompare,e.statsMetadata,t,i,!0));else{var s,n;const e=null!==(s=null===(n=t[0])||void 0===n?void 0:n.stat_energy_from)&&void 0!==s?s:"placeholder";a.push({id:"compare-"+e,type:"bar",stack:"water",data:[]})}a.push(...this._processDataSet(e.stats,e.statsMetadata,t,i)),(0,g.Zx)(a),this._chartData=a}},{kind:"method",key:"_processDataSet",value:function(e,t,a,i,s=!1){const n=[],r=(0,g.kT)(this._start,this._compareStart);return a.forEach(((a,o)=>{let d=null;const c=[];if(a.stat_energy_from in e){const t=e[a.stat_energy_from];for(const e of t){if(null===e.change||void 0===e.change||0===e.change)continue;if(d===e.start)continue;const t=[e.start,e.change];s&&(t[2]=t[0],t[0]=r(new Date(e.start))),c.push(t),d=e.start}}n.push({type:"bar",cursor:"default",id:s?"compare-"+a.stat_energy_from:a.stat_energy_from,name:(0,v.Kd)(this.hass,a.stat_energy_from,t[a.stat_energy_from]),barMaxWidth:50,itemStyle:{borderColor:(0,h.H)(i,this.hass.themes.darkMode,!1,s,"--energy-water-color",o)},color:(0,h.H)(i,this.hass.themes.darkMode,!0,s,"--energy-water-color",o),data:c,stack:s?"compare":"water"})})),n}},{kind:"field",static:!0,key:"styles",value(){return(0,d.iv)(C||(C=w`ha-card{height:100%}.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}.no-data{position:absolute;height:100%;top:0;left:0;right:0;display:flex;justify-content:center;align-items:center;padding:20%;margin-left:32px;margin-inline-start:32px;margin-inline-end:initial;box-sizing:border-box}`))}}]}}),(0,p.f)(d.oi));i()}catch(k){i(k)}}))},41924:function(e,t,a){a.d(t,{y:()=>s});var i=a(53907);function s(e){return(0,i.L)(e,Date.now())}},97836:function(e,t,a){a.d(t,{K:()=>n});a(71695),a(47021);var i=a(18492),s=a(7591);function n(e,t,a){const[n,r]=(0,i.d)(null==a?void 0:a.in,e,t);return+(0,s.b)(n)==+(0,s.b)(r)}},16444:function(e,t,a){a.d(t,{z:()=>r});var i=a(53907),s=a(41924),n=a(97836);function r(e,t){return(0,n.K)((0,i.L)((null==t?void 0:t.in)||e,e),(0,s.y)((null==t?void 0:t.in)||e))}}}]);
//# sourceMappingURL=5604.69bc2bf18a23380f.js.map