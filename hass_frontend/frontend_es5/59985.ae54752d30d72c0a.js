/*! For license information please see 59985.ae54752d30d72c0a.js.LICENSE.txt */
"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["59985"],{16815:function(e,i,t){var n=t(61701),o=(t(71695),t(40251),t(47021),t(50778)),r=t(28421),s=t(6973);(0,n.Z)([(0,o.Mo)("hui-dashboard-strategy-element-editor")],(function(e,i){return{F:class extends i{constructor(...i){super(...i),e(this)}},d:[{kind:"method",key:"getConfigElement",value:async function(){const e=await(0,r.lN)("dashboard",this.configElementType);if(e&&e.getConfigElement)return e.getConfigElement()}}]}}),s.k)},81821:function(e,i,t){t.d(i,{O:()=>S});var n=t(61701),o=t(72621),r=(t(71695),t(9359),t(31526),t(70104),t(19423),t(40251),t(47021),t(57243)),s=t(50778),a=t(67064),d=t(36522),l=t(22381),h=t(41680),u=t(48045);t(99426),t(97206),t(64889),t(52247);class c extends Error{constructor(e,i,t){super(e),this.warnings=void 0,this.errors=void 0,this.name="GUISupportError",this.warnings=i,this.errors=t}}let g,f,m,_,v,p,y,k,E,C,b,w,$=e=>e,S=(0,n.Z)(null,(function(e,i){class n extends i{constructor(...i){super(...i),e(this)}}return{F:n,d:[{kind:"field",decorators:[(0,s.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,s.Cb)({attribute:!1})],key:"lovelace",value:void 0},{kind:"field",decorators:[(0,s.Cb)({attribute:!1})],key:"context",value:void 0},{kind:"field",decorators:[(0,s.SB)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,s.SB)()],key:"_configElement",value:void 0},{kind:"field",decorators:[(0,s.SB)()],key:"_subElementEditorConfig",value:void 0},{kind:"field",decorators:[(0,s.SB)()],key:"_guiMode",value(){return!0}},{kind:"field",decorators:[(0,s.SB)()],key:"_errors",value:void 0},{kind:"field",decorators:[(0,s.SB)()],key:"_pendingYamlError",value:void 0},{kind:"field",decorators:[(0,s.SB)()],key:"_yamlError",value(){return!1}},{kind:"field",decorators:[(0,s.SB)()],key:"_warnings",value:void 0},{kind:"field",decorators:[(0,s.SB)()],key:"_guiSupported",value:void 0},{kind:"field",decorators:[(0,s.SB)()],key:"_loading",value(){return!1}},{kind:"field",decorators:[(0,s.IO)("ha-yaml-editor")],key:"_yamlEditor",value:void 0},{kind:"get",key:"value",value:function(){return this._config}},{kind:"set",key:"value",value:function(e){this._config&&(0,u.v)(e,this._config)||(this._config=e,this._errors=void 0,this._setConfig())}},{kind:"method",key:"_setConfig",value:function(){if(!this._errors)try{this._updateConfigElement()}catch(e){this._errors=[e.message]}this.updateComplete.then((()=>{var e;(0,d.B)(this,"config-changed",{config:this.value,error:null===(e=this._errors)||void 0===e?void 0:e.join(", "),guiModeAvailable:!(this.hasWarning||this.hasError||!1===this._guiSupported)})}))}},{kind:"get",key:"hasWarning",value:function(){return void 0!==this._warnings&&this._warnings.length>0}},{kind:"get",key:"hasError",value:function(){return void 0!==this._errors&&this._errors.length>0}},{kind:"get",key:"GUImode",value:function(){return this._guiMode}},{kind:"set",key:"GUImode",value:function(e){this._guiMode=e,this.updateComplete.then((()=>{(0,d.B)(this,"GUImode-changed",{guiMode:e,guiModeAvailable:!(this.hasWarning||this.hasError||!1===this._guiSupported)})}))}},{kind:"method",key:"toggleMode",value:function(){this.GUImode=!this.GUImode}},{kind:"method",key:"focusYamlEditor",value:function(){var e;null!==(e=this._configElement)&&void 0!==e&&e.focusYamlEditor&&this._configElement.focusYamlEditor(),this._yamlEditor&&this._yamlEditor.focus()}},{kind:"method",key:"getConfigElement",value:async function(){}},{kind:"method",key:"getConfigForm",value:async function(){}},{kind:"method",key:"renderConfigElement",value:function(){return(0,r.dy)(g||(g=$`${0}`),this._configElement)}},{kind:"method",key:"_renderSubElement",value:function(){return(0,r.dy)(f||(f=$` <hui-sub-element-editor .hass="${0}" .config="${0}" @go-back="${0}" @config-changed="${0}"> </hui-sub-element-editor> `),this.hass,this._subElementEditorConfig,this._goBack,this._subElementChanged)}},{kind:"method",key:"_subElementChanged",value:function(e){var i,t;e.stopPropagation();const n=e.detail.config;this._subElementEditorConfig=Object.assign(Object.assign({},this._subElementEditorConfig),{},{elementConfig:n}),null===(i=(t=this._subElementEditorConfig).saveElementConfig)||void 0===i||i.call(t,n)}},{kind:"method",key:"_goBack",value:function(e){e.stopPropagation(),this._subElementEditorConfig=void 0}},{kind:"method",key:"_editSubElement",value:async function(e){e.stopPropagation(),await Promise.all([t.e("91552"),t.e("78456"),t.e("56898"),t.e("35671"),t.e("92139"),t.e("26304"),t.e("32146"),t.e("47877"),t.e("68825"),t.e("44959"),t.e("79931"),t.e("44251"),t.e("3371"),t.e("63556"),t.e("38326"),t.e("10745"),t.e("80809"),t.e("89622"),t.e("95444"),t.e("51768"),t.e("41503")]).then(t.bind(t,50357)),this._subElementEditorConfig={type:e.detail.type,elementConfig:e.detail.config,context:e.detail.context,saveElementConfig:e.detail.saveConfig}}},{kind:"method",key:"render",value:function(){return(0,r.dy)(m||(m=$` <div class="wrapper"> ${0} ${0} ${0} ${0} </div> `),this.GUImode?(0,r.dy)(_||(_=$` <div class="gui-editor" @edit-sub-element="${0}"> ${0} </div> `),this._editSubElement,this._loading?(0,r.dy)(v||(v=$` <ha-circular-progress indeterminate class="center margin-bot"></ha-circular-progress> `)):(0,a.F)(this._subElementEditorConfig?this._renderSubElement():this.renderConfigElement())):(0,r.dy)(p||(p=$` <div class="yaml-editor"> <ha-yaml-editor .defaultValue="${0}" autofocus .hass="${0}" @value-changed="${0}" @blur="${0}" @keydown="${0}" dir="ltr"></ha-yaml-editor> </div> `),this._config,this.hass,this._handleYAMLChanged,this._onBlurYaml,this._ignoreKeydown),!1===this._guiSupported&&!1===this._loading?(0,r.dy)(y||(y=$` <ha-alert alert-type="info" .title="${0}"> ${0} <br> ${0} </ha-alert> `),this.hass.localize("ui.errors.config.visual_editor_not_supported"),this.hass.localize("ui.errors.config.visual_editor_not_supported_reason_type"),this.hass.localize("ui.errors.config.edit_in_yaml_supported")):r.Ld,this.hasError?(0,r.dy)(k||(k=$` <ha-alert alert-type="error" .title="${0}"> <ul> ${0} </ul> </ha-alert> `),this.hass.localize("ui.errors.config.configuration_error"),this._errors.map((e=>(0,r.dy)(E||(E=$`<li>${0}</li>`),e)))):r.Ld,this.hasWarning?(0,r.dy)(C||(C=$` <ha-alert alert-type="warning" .title="${0}"> <ul> ${0} </ul> ${0} </ha-alert> `),this.hass.localize("ui.errors.config.visual_editor_not_supported"),this._warnings.map((e=>(0,r.dy)(b||(b=$`<li>${0}</li>`),e))),this.hass.localize("ui.errors.config.edit_in_yaml_supported")):r.Ld)}},{kind:"method",key:"updated",value:function(e){(0,o.Z)(n,"updated",this,3)([e]),this._configElement&&e.has("hass")&&(this._configElement.hass=this.hass),this._configElement&&"lovelace"in this._configElement&&e.has("lovelace")&&(this._configElement.lovelace=this.lovelace),this._configElement&&e.has("context")&&(this._configElement.context=this.context)}},{kind:"method",key:"_handleUIConfigChanged",value:function(e){if(e.stopPropagation(),!this.GUImode)return;const i=e.detail.config;Object.keys(i).forEach((e=>{void 0===i[e]&&delete i[e]})),this.value=i}},{kind:"method",key:"_handleYAMLChanged",value:function(e){e.stopPropagation();const i=e.detail.value;e.detail.isValid?(this._config=i,this._errors=void 0,this._pendingYamlError=void 0,this._yamlError=!1,this._debounceYamlError.cancel(),this._setConfig()):this._yamlError?this._errors=[e.detail.errorMsg]:(this._pendingYamlError=e.detail.errorMsg,this._debounceYamlError())}},{kind:"field",key:"_debounceYamlError",value(){return(0,l.D)((()=>{this._pendingYamlError&&(this._yamlError=!0,this._errors=[this._pendingYamlError],this._pendingYamlError=void 0,this._setConfig())}),2e3)}},{kind:"method",key:"_onBlurYaml",value:function(){this._debounceYamlError.cancel(),this._pendingYamlError&&(this._yamlError=!0,this._errors=[this._pendingYamlError],this._pendingYamlError=void 0,this._setConfig())}},{kind:"method",key:"unloadConfigElement",value:async function(){this._configElement=void 0,this._guiSupported=void 0}},{kind:"method",key:"loadConfigElement",value:async function(){if(this._configElement)return;let e=await this.getConfigElement();if(!e){const i=await this.getConfigForm();if(i){await t.e("10106").then(t.bind(t,66374)),e=document.createElement("hui-form-editor");const{schema:n,assertConfig:o,computeLabel:r,computeHelper:s}=i;e.schema=n,r&&(e.computeLabel=r),s&&(e.computeHelper=s),o&&(e.assertConfig=o)}}e?(e.hass=this.hass,"lovelace"in e&&(e.lovelace=this.lovelace),e.context=this.context,e.addEventListener("config-changed",(e=>this._handleUIConfigChanged(e))),this._guiSupported=!0):this._guiSupported=!1,this._configElement=e}},{kind:"method",key:"_updateConfigElement",value:async function(){if(this.value)try{if(this._errors=void 0,this._warnings=void 0,await this.loadConfigElement(),this._configElement)try{this._configElement.setConfig(this.value)}catch(i){const e=(0,h.p)(this.hass,i);throw new c("Config is not supported",e.warnings,e.errors)}else this._guiSupported=!1,this.GUImode=!1}catch(i){var e;if(i instanceof c)this._warnings=null!==(e=i.warnings)&&void 0!==e?e:[i.message],this._errors=i.errors||void 0;else this._errors=[i.message];this.GUImode=!1}finally{this._loading=!1}}},{kind:"method",key:"_ignoreKeydown",value:function(e){e.stopPropagation()}},{kind:"field",static:!0,key:"styles",value(){return(0,r.iv)(w||(w=$`:host{display:flex}.wrapper{width:100%}.gui-editor,.yaml-editor{padding:8px 0px}ha-code-editor{--code-mirror-max-height:calc(100vh - 245px)}ha-circular-progress{display:block;margin:auto}`))}}]}}),r.oi)},6973:function(e,i,t){t.d(i,{k:()=>a});var n=t(61701),o=t(72621),r=(t(52247),t(71695),t(40251),t(47021),t(50778)),s=t(81821);let a=(0,n.Z)(null,(function(e,i){class t extends i{constructor(...i){super(...i),e(this)}}return{F:t,d:[{kind:"field",decorators:[(0,r.SB)()],key:"_configElementType",value:void 0},{kind:"get",key:"configElementType",value:function(){return this.value?this.value.type:void 0}},{kind:"method",key:"loadConfigElement",value:async function(){if(this._configElementType!==this.configElementType){if(this.unloadConfigElement(),!this.configElementType)throw new Error(this.hass.localize("ui.errors.config.no_type_provided"));this._configElementType=this.configElementType}return(0,o.Z)(t,"loadConfigElement",this,3)([])}}]}}),s.O)},67064:function(e,i,t){t.d(i,{F:()=>a});t(71695),t(46692),t(47021);var n=t(2841),o=t(45779),r=t(53232);const s=e=>(0,r.dZ)(e)?e._$litType$.h:e.strings,a=(0,o.XM)(class extends o.Xe{constructor(e){super(e),this.tt=new WeakMap}render(e){return[e]}update(e,[i]){const t=(0,r.hN)(this.et)?s(this.et):null,o=(0,r.hN)(i)?s(i):null;if(null!==t&&(null===o||t!==o)){const i=(0,r.i9)(e).pop();let o=this.tt.get(t);if(void 0===o){const e=document.createDocumentFragment();o=(0,n.sY)(n.Ld,e),o.setConnected(!1),this.tt.set(t,o)}(0,r.hl)(o,[i]),(0,r._Y)(o,void 0,i)}if(null!==o){if(null===t||t!==o){const i=this.tt.get(o);if(void 0!==i){const t=(0,r.i9)(i).pop();(0,r.E_)(e),(0,r._Y)(e,void 0,t),(0,r.hl)(e,[t])}}this.et=i}else this.et=void 0;return this.render(i)}})}}]);
//# sourceMappingURL=59985.ae54752d30d72c0a.js.map