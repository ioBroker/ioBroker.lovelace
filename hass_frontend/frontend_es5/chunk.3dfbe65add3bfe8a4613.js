(self.webpackJsonp=self.webpackJsonp||[]).push([[42],{172:function(e,n,t){"use strict";t.r(n);var r=t(12);function o(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var i=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),a(this,"commands",{}),a(this,"cache",{}),a(this,"msgId",0)}var n,t,r;return n=e,(t=[{key:"attach",value:function(){var e,n=this;e=this,window.addEventListener("connection-status",(function(n){return e.fireMessage({type:"connection-status",payload:{event:n.detail}})})),function(e){window.addEventListener("haptic",(function(n){return e.fireMessage({type:"haptic",payload:{hapticType:n.detail}})}))}(this),window.externalBus=function(e){return n.receiveMessage(e)}}},{key:"sendMessage",value:function(e){var n=this,t=++this.msgId;return e.id=t,this.fireMessage(e),new Promise((function(e,r){n.commands[t]={resolve:e,reject:r}}))}},{key:"fireMessage",value:function(e){e.id||(e.id=++this.msgId),this._sendExternal(e)}},{key:"receiveMessage",value:function(e){var n=this.commands[e.id];n?"result"===e.type&&(e.success?n.resolve(e.result):n.reject(e.error)):console.warn("Received unknown msg ID",e.id)}},{key:"_sendExternal",value:function(e){window.externalApp?window.externalApp.externalBus(JSON.stringify(e)):window.webkit.messageHandlers.externalBus.postMessage(e)}}])&&o(n.prototype,t),r&&o(n,r),e}();function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,n){return(f=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}t.d(n,"createExternalAuth",(function(){return w}));if(!window.externalApp&&!window.webkit)throw new Error("External auth requires either externalApp or webkit defined on Window object.");var p=function(e){function n(e){var t,r,o,a;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),t=function(e,n){return!n||"object"!==s(n)&&"function"!=typeof n?l(e):n}(this,c(n).call(this,{hassUrl:e,clientId:"",refresh_token:"",access_token:"",expires_in:0,expires:0})),r=l(t),a=void 0,(o="external")in r?Object.defineProperty(r,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[o]=a,t}var t,r,o;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&f(e,n)}(n,e),t=n,(r=[{key:"refreshAccessToken",value:function(){var e,n,t;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e={callback:"externalAuthSetToken"},n=new Promise((function(e,n){window.externalAuthSetToken=function(t,r){return t?e(r):n(r)}})),r.next=4,regeneratorRuntime.awrap(0);case 4:return window.externalApp?window.externalApp.getExternalAuth(JSON.stringify(e)):window.webkit.messageHandlers.getExternalAuth.postMessage(e),r.next=7,regeneratorRuntime.awrap(n);case 7:t=r.sent,this.data.access_token=t.access_token,this.data.expires=1e3*t.expires_in+Date.now();case 10:case"end":return r.stop()}}),null,this)}},{key:"revoke",value:function(){var e,n;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e={callback:"externalAuthRevokeToken"},n=new Promise((function(e,n){window.externalAuthRevokeToken=function(t,r){return t?e(r):n(r)}})),t.next=4,regeneratorRuntime.awrap(0);case 4:return window.externalApp?window.externalApp.revokeExternalAuth(JSON.stringify(e)):window.webkit.messageHandlers.revokeExternalAuth.postMessage(e),t.next=7,regeneratorRuntime.awrap(n);case 7:case"end":return t.stop()}}))}}])&&u(t.prototype,r),o&&u(t,o),n}(r.a),w=function(e){var n=new p(e);return(window.externalApp&&window.externalApp.externalBus||window.webkit&&window.webkit.messageHandlers.externalBus)&&(n.external=new i,n.external.attach()),n}}}]);
//# sourceMappingURL=chunk.3dfbe65add3bfe8a4613.js.map