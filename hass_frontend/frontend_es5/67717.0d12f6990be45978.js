"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["67717"],{50875:function(t,e,n){n.d(e,{Eu:()=>o,hZ:()=>d,o9:()=>r});var i=n(27486),a=n(11259);const s=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#9498a0","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#74787f","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#b6bac2","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#d9d9d9","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function o(t){return s[t%s.length]}function d(t,e){const n=e.getPropertyValue(`--graph-color-${t+1}`)||o(t);return(0,a.Rq)(n)}const r=(0,i.Z)((t=>s.map(((e,n)=>d(n,t)))),((t,e)=>t[0].getPropertyValue("--graph-color-1")===e[0].getPropertyValue("--graph-color-1")))},6736:function(t,e,n){n.d(e,{f:()=>o});var i=n(61701),a=n(72621),s=(n(19083),n(71695),n(9359),n(52924),n(40251),n(61006),n(47021),n(50778));const o=t=>(0,i.Z)(null,(function(t,e){class n extends e{constructor(...e){super(...e),t(this)}}return{F:n,d:[{kind:"field",decorators:[(0,s.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:void 0},{kind:"field",key:"__unsubs",value:void 0},{kind:"method",key:"connectedCallback",value:function(){(0,a.Z)(n,"connectedCallback",this,3)([]),this._checkSubscribed()}},{kind:"method",key:"disconnectedCallback",value:function(){if((0,a.Z)(n,"disconnectedCallback",this,3)([]),this.__unsubs){for(;this.__unsubs.length;){const t=this.__unsubs.pop();t instanceof Promise?t.then((t=>t())):t()}this.__unsubs=void 0}}},{kind:"method",key:"updated",value:function(t){if((0,a.Z)(n,"updated",this,3)([t]),t.has("hass"))this._checkSubscribed();else if(this.hassSubscribeRequiredHostProps)for(const e of t.keys())if(this.hassSubscribeRequiredHostProps.includes(e))return void this._checkSubscribed()}},{kind:"method",key:"hassSubscribe",value:function(){return[]}},{kind:"method",key:"_checkSubscribed",value:function(){var t;void 0!==this.__unsubs||!this.isConnected||void 0===this.hass||null!==(t=this.hassSubscribeRequiredHostProps)&&void 0!==t&&t.some((t=>void 0===this[t]))||(this.__unsubs=this.hassSubscribe())}}]}}),t)},18709:function(t,e,n){n.a(t,(async function(t,i){try{n.r(e),n.d(e,{HuiEnergyDevicesGraphCard:()=>x});var a=n(61701),s=(n(71695),n(92745),n(61893),n(9359),n(1331),n(31526),n(70104),n(40251),n(47021),n(57243)),o=n(50778),d=n(35359),r=n(27486),u=n(50875),c=n(50602),l=n(25179),h=n(1118),f=n(17705),v=n(6736),b=n(93331),g=(n(54977),n(36522)),p=n(48066),_=t([l,h,c]);[l,h,c]=_.then?(await _)():_;let k,m,y,S=t=>t,x=(0,a.Z)([(0,o.Mo)("hui-energy-devices-graph-card")],(function(t,e){return{F:class extends e{constructor(...e){super(...e),t(this)}},d:[{kind:"field",decorators:[(0,o.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,o.SB)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,o.SB)()],key:"_chartData",value(){return[]}},{kind:"field",decorators:[(0,o.SB)()],key:"_data",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value(){return["_config"]}},{kind:"method",key:"hassSubscribe",value:function(){var t;return[(0,h.UB)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe((t=>{this._data=t,this._getStatistics(t)}))]}},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(t){this._config=t}},{kind:"method",key:"shouldUpdate",value:function(t){return(0,b.SN)(this,t)||t.size>1||!t.has("hass")}},{kind:"method",key:"render",value:function(){var t;return this.hass&&this._config?(0,s.dy)(k||(k=S` <ha-card> ${0} <div class="content ${0}"> <ha-chart-base .hass="${0}" .data="${0}" .options="${0}" .height="${0}" @chart-click="${0}"></ha-chart-base> </div> </ha-card> `),this._config.title?(0,s.dy)(m||(m=S`<h1 class="card-header">${0}</h1>`),this._config.title):"",(0,d.$)({"has-header":!!this._config.title}),this.hass,this._chartData,this._createOptions(this._chartData),28*((null===(t=this._chartData[0])||void 0===t||null===(t=t.data)||void 0===t?void 0:t.length)||0)+50+"px",this._handleChartClick):s.Ld}},{kind:"method",key:"_renderTooltip",value:function(t){const e=`<h4 style="text-align: center; margin: 0;">${this._getDeviceName(t.value[1])}</h4>`,n=`${(0,c.uf)(t.value[0],this.hass.locale,(0,c.l4)(void 0,this.hass.entities[t.value[1]]))} kWh`;return`${e}${t.marker} ${t.seriesName}: ${n}`}},{kind:"field",key:"_createOptions",value(){return(0,r.Z)((t=>{var e,n;const i=window.matchMedia("all and (max-width: 450px), all and (max-height: 500px)").matches;return{xAxis:{type:"value",name:"kWh"},yAxis:{type:"category",inverse:!0,triggerEvent:!0,data:null===(e=t[0])||void 0===e||null===(e=e.data)||void 0===e?void 0:e.map((t=>t.value[1])),axisLabel:{formatter:this._getDeviceName.bind(this),overflow:"truncate",fontSize:12,margin:5,width:Math.min(i?100:200,Math.max(...(null===(n=t[0])||void 0===n||null===(n=n.data)||void 0===n?void 0:n.map((t=>(0,p.U)(this._getDeviceName(t.value[1]),12)+5)))||[]))}},grid:{top:5,left:5,right:40,bottom:0,containLabel:!0},tooltip:{show:!0,formatter:this._renderTooltip.bind(this)}}}))}},{kind:"method",key:"_getDeviceName",value:function(t){var e,n;return(null===(e=this._data)||void 0===e||null===(e=e.prefs.device_consumption.find((e=>e.stat_consumption===t)))||void 0===e?void 0:e.name)||(0,f.Kd)(this.hass,t,null===(n=this._data)||void 0===n?void 0:n.statsMetadata[t])}},{kind:"method",key:"_getStatistics",value:async function(t){var e;const n=t.stats,i=t.statsCompare,a=[],s=[],o=[{type:"bar",name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.energy_usage"),itemStyle:{borderRadius:[0,4,4,0]},data:a,barWidth:i?10:20,cursor:"default"}];i&&o.push({type:"bar",name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.previous_energy_usage"),itemStyle:{borderRadius:[0,4,4,0]},data:s,barWidth:10,cursor:"default"});const d=getComputedStyle(this);t.prefs.device_consumption.forEach(((t,e)=>{const o=t.stat_consumption in n&&(0,f.Kj)(n[t.stat_consumption])||0,r=(0,u.hZ)(e,d);if(a.push({id:e,value:[o,t.stat_consumption],itemStyle:{color:r+"7F",borderColor:r}}),i){const n=t.stat_consumption in i&&(0,f.Kj)(i[t.stat_consumption])||0;s.push({id:e,value:[n,t.stat_consumption],itemStyle:{color:r+"32",borderColor:r+"7F"}})}})),a.sort(((t,e)=>e.value[0]-t.value[0])),a.length=(null===(e=this._config)||void 0===e?void 0:e.max_devices)||a.length,this._chartData=o,await this.updateComplete}},{kind:"method",key:"_handleChartClick",value:function(t){"axisLabel"===t.detail.targetType&&t.detail.value&&!(0,f.Hs)(t.detail.value)&&(0,g.B)(this,"hass-more-info",{entityId:t.detail.value})}},{kind:"field",static:!0,key:"styles",value(){return(0,s.iv)(y||(y=S`.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}ha-chart-base{--chart-max-height:none}`))}}]}}),(0,v.f)(s.oi));i()}catch(k){i(k)}}))},48066:function(t,e,n){let i;function a(t,e,n="Roboto, Noto, sans-serif"){i||(i=document.createElement("canvas"));const a=i.getContext("2d");if(!a)return 0;a.font=`${e}px ${n}`;const s=a.measureText(t);return Math.ceil(Math.max(s.actualBoundingBoxRight+s.actualBoundingBoxLeft,s.width))}n.d(e,{U:()=>a})},32424:function(t,e,n){n.d(e,{E:()=>s});var i=n(53907),a=n(18112);function s(t,e,n){const s=(0,a.Q)(t,null==n?void 0:n.in);return isNaN(e)?(0,i.L)((null==n?void 0:n.in)||t,NaN):e?(s.setDate(s.getDate()+e),s):s}},38836:function(t,e,n){n.d(e,{T:()=>s});var i=n(23711),a=n(76808);function s(t,e,n){return(0,i.n)(t,e*a.vh,n)}},23711:function(t,e,n){n.d(e,{n:()=>s});var i=n(53907),a=n(18112);function s(t,e,n){return(0,i.L)((null==n?void 0:n.in)||t,+(0,a.Q)(t)+e)}},23459:function(t,e,n){n.d(e,{z:()=>s});var i=n(53907),a=n(18112);function s(t,e,n){const s=(0,a.Q)(t,null==n?void 0:n.in);if(isNaN(e))return(0,i.L)((null==n?void 0:n.in)||t,NaN);if(!e)return s;const o=s.getDate(),d=(0,i.L)((null==n?void 0:n.in)||t,s.getTime());d.setMonth(s.getMonth()+e+1,0);return o>=d.getDate()?d:(s.setFullYear(d.getFullYear(),d.getMonth(),o),s)}},2425:function(t,e,n){n.d(e,{U:()=>a});var i=n(18112);function a(t,e){const n=+(0,i.Q)(t)-+(0,i.Q)(e);return n<0?-1:n>0?1:n}},6542:function(t,e,n){n.d(e,{d:()=>d});n(71695),n(47021);var i=n(18492),a=n(2425);function s(t,e,n){const[a,s]=(0,i.d)(null==n?void 0:n.in,t,e);return 12*(a.getFullYear()-s.getFullYear())+(a.getMonth()-s.getMonth())}var o=n(3938);function d(t,e,n){const[d,r,u]=(0,i.d)(null==n?void 0:n.in,t,t,e),c=(0,a.U)(r,u),l=Math.abs(s(r,u));if(l<1)return 0;1===r.getMonth()&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-c*l);let h=(0,a.U)(r,u)===-c;(0,o.h)(d)&&1===l&&1===(0,a.U)(d,u)&&(h=!1);const f=c*(l-+h);return 0===f?0:f}},96500:function(t,e,n){n.d(e,{i:()=>a});var i=n(18112);function a(t,e){const n=(0,i.Q)(t,null==e?void 0:e.in);return n.setHours(23,59,59,999),n}},2621:function(t,e,n){n.d(e,{V:()=>a});var i=n(18112);function a(t,e){const n=(0,i.Q)(t,null==e?void 0:e.in),a=n.getMonth();return n.setFullYear(n.getFullYear(),a+1,0),n.setHours(23,59,59,999),n}},86319:function(t,e,n){n.d(e,{b:()=>a});var i=n(18112);function a(t,e){return 1===(0,i.Q)(t,null==e?void 0:e.in).getDate()}},3938:function(t,e,n){n.d(e,{h:()=>o});var i=n(96500),a=n(2621),s=n(18112);function o(t,e){const n=(0,s.Q)(t,null==e?void 0:e.in);return+(0,i.i)(n,e)==+(0,a.V)(n,e)}}}]);
//# sourceMappingURL=67717.0d12f6990be45978.js.map