{"version":3,"sources":["webpack:///./node_modules/@polymer/iron-input/iron-input.js","webpack:///./node_modules/@polymer/neon-animation/neon-animatable-behavior.js","webpack:///./node_modules/@polymer/neon-animation/neon-animation-runner-behavior.js","webpack:///./node_modules/@polymer/paper-listbox/paper-listbox.js","webpack:///./node_modules/@polymer/iron-dropdown/iron-dropdown.js","webpack:///./node_modules/@polymer/neon-animation/neon-animation-behavior.js","webpack:///./node_modules/@polymer/neon-animation/animations/fade-in-animation.js","webpack:///./node_modules/@polymer/neon-animation/animations/fade-out-animation.js","webpack:///./node_modules/@polymer/paper-menu-button/paper-menu-button-animations.js","webpack:///./node_modules/@polymer/paper-menu-button/paper-menu-button.js","webpack:///./node_modules/@polymer/paper-dropdown-menu/paper-dropdown-menu-icons.js","webpack:///./node_modules/@polymer/paper-dropdown-menu/paper-dropdown-menu-shared-styles.js","webpack:///./src/common/entity/compute_state_name.ts","webpack:///./src/common/entity/domain_icon.ts","webpack:///./src/components/ha-icon.ts","webpack:///./src/common/entity/compute_state_domain.ts","webpack:///./src/components/entity/state-badge.ts","webpack:///./node_modules/@polymer/paper-item/paper-icon-item.js","webpack:///./node_modules/@polymer/paper-dialog-behavior/paper-dialog-behavior.js","webpack:///./src/common/entity/compute_object_id.ts","webpack:///./src/components/entity/ha-entity-picker.ts","webpack:///./node_modules/@polymer/paper-dialog-behavior/paper-dialog-shared-styles.js","webpack:///./src/common/entity/sensor_icon.ts","webpack:///./src/common/entity/state_icon.ts","webpack:///./src/common/entity/binary_sensor_icon.ts","webpack:///./src/common/entity/cover_icon.ts","webpack:///./src/common/entity/input_dateteime_icon.ts","webpack:///./node_modules/@polymer/paper-dialog/paper-dialog.js","webpack:///./src/components/dialog/ha-iron-focusables-helper.js","webpack:///./src/components/dialog/ha-paper-dialog.ts","webpack:///./node_modules/@polymer/paper-dialog-scrollable/paper-dialog-scrollable.js","webpack:///./node_modules/@vaadin/vaadin-overlay/theme/lumo/vaadin-overlay-styles.js","webpack:///./node_modules/@vaadin/vaadin-combo-box/theme/lumo/vaadin-combo-box-dropdown-styles.js","webpack:///./node_modules/@vaadin/vaadin-item/theme/lumo/vaadin-item-styles.js","webpack:///./node_modules/@vaadin/vaadin-item/src/vaadin-item-mixin.js","webpack:///./node_modules/@vaadin/vaadin-item/src/vaadin-item.js","webpack:///./node_modules/@vaadin/vaadin-combo-box/theme/lumo/vaadin-combo-box-item-styles.js","webpack:///./node_modules/@vaadin/vaadin-combo-box/src/vaadin-combo-box-placeholder.js","webpack:///./node_modules/@vaadin/vaadin-combo-box/src/vaadin-combo-box-mixin.js","webpack:///./node_modules/@vaadin/vaadin-combo-box/src/vaadin-combo-box-data-provider-mixin.js","webpack:///./node_modules/@polymer/iron-list/iron-list.js","webpack:///./node_modules/@vaadin/vaadin-combo-box/src/vaadin-combo-box-item.js","webpack:///./node_modules/@vaadin/vaadin-combo-box/src/vaadin-combo-box-dropdown.js","webpack:///./node_modules/@vaadin/vaadin-combo-box/src/vaadin-combo-box-dropdown-wrapper.js","webpack:///./node_modules/@vaadin/vaadin-combo-box/src/vaadin-combo-box-light.js","webpack:///./node_modules/@polymer/paper-dropdown-menu/paper-dropdown-menu-light.js","webpack:///./node_modules/@polymer/iron-scroll-target-behavior/iron-scroll-target-behavior.js","webpack:///./src/common/entity/valid_entity_id.ts","webpack:///./node_modules/@polymer/paper-icon-button/paper-icon-button-light.js","webpack:///./src/components/entity/ha-entities-picker.ts","webpack:///./src/components/user/ha-user-picker.ts","webpack:///./src/panels/config/person/dialog-person-detail.ts","webpack:///./node_modules/@polymer/paper-input/paper-input.js","webpack:///./node_modules/@polymer/iron-a11y-announcer/iron-a11y-announcer.js"],"names":["_template","is","behaviors","properties","bindValue","type","String","value","computed","allowedPattern","autoValidate","Boolean","_inputElement","Object","observers","listeners","created","requestAvailability","this","_previousValidInput","_patternAlreadyChecked","attached","_observer","observeNodes","info","_initSlottedInput","bind","detached","unobserveNodes","getEffectiveChildren","inputElement","fire","pattern","RegExp","_bindValueChanged","undefined","validate","_onInput","_checkPatternValidity","_announceInvalidCharacter","_isPrintable","event","anyNonPrintable","keyCode","mozNonPrintable","charCode","_onKeypress","regexp","_patternRegExp","metaKey","ctrlKey","altKey","thisChar","fromCharCode","test","preventDefault","i","length","invalid","valid","checkValidity","required","hasValidator","call","message","text","_computeValue","NeonAnimatableBehavior","animationConfig","entryAnimation","observer","exitAnimation","_entryAnimationChanged","name","node","_exitAnimationChanged","_copyProperties","config1","config2","property","_cloneConfig","config","clone","isClone","_getAnimationConfigRecursive","map","allConfigs","thisConfig","_warn","_logf","Array","isArray","index","animatable","id","cachedConfig","push","getAnimationConfig","key","NeonAnimationRunnerBehavior","_configureAnimations","configs","results","resultsToPlay","neonAnimation","document","createElement","isNeonAnimation","result","configure","console","warn","cancel","timeline","play","e","animation","_shouldComplete","activeEntries","finished","playState","_complete","complete","playAnimation","cookie","_active","onfinish","bubbles","cancelAnimation","k","entries","j","hostAttributes","role","horizontalAlign","reflectToAttribute","verticalAlign","openAnimationConfig","closeAnimationConfig","focusTarget","noAnimations","allowOutsideScroll","nodes","$","content","getDistributedNodes","l","nodeType","Node","ELEMENT_NODE","ready","scrollAction","_readied","sizingTarget","containedElement","_openedChanged","opened","disabled","_updateAnimationConfig","apply","arguments","_renderOpened","open","contentWrapper","classList","add","_renderClosed","close","_onNeonAnimationFinish","remove","_finishRenderOpened","_finishRenderClosed","animationNode","animations","concat","_updateOverlayPosition","isAttached","notifyResize","_allowOutsideScrollChanged","_applyFocus","noAutoFocus","focus","NeonAnimationBehavior","animationTiming","duration","easing","fill","body","animate","timingFromConfig","timing","setPrefixedProperty","prefix","prefixes","style","_effect","KeyframeEffect","height","getBoundingClientRect","width","transform","ANIMATION_CUBIC_BEZIER","MAX_ANIMATION_TIME_MS","PaperMenuButton","notify","dynamicAlign","horizontalOffset","Number","verticalOffset","noOverlap","ignoreSelect","closeOnActivate","delay","restoreFocusOnClose","_dropdownContent","toggle","dropdown","_onIronSelect","_onIronActivate","oldOpened","contentElement","_disabledChanged","__onIronOverlayCanceled","uiEvent","detail","trigger","path","indexOf","keys","forEach","$_documentContainer","setAttribute","innerHTML","head","appendChild","stateObj","attributes","friendly_name","entity_id","replace","fixedIcons","alert","alexa","automation","calendar","camera","climate","configurator","conversation","device_tracker","fan","google_assistant","group","history_graph","homeassistant","homekit","image_processing","input_boolean","input_datetime","input_number","input_select","input_text","light","mailbox","person","plant","proximity","remote","scene","script","sensor","simple_alarm","sun","switch","timer","updater","vacuum","water_heater","weather","weblink","domainIcon","domain","state","ironIconClass","customElements","get","loaded","HaIcon","eventName","methodName","super","listen","_iconsetName","define","computeStateDomain","StateBadge","overrideIcon","changedProps","has","iconStyle","color","filter","hostStyle","backgroundImage","entity_picture","overrideImage","imageUrl","hass","hassUrl","display","hs_color","hue","sat","brightness","errorMessage","assign","_icon","PaperDialogBehaviorImpl","modal","__readied","__prevNoCancelOnOutsideClick","noCancelOnOutsideClick","__prevNoCancelOnEscKey","noCancelOnEscKey","__prevWithBackdrop","withBackdrop","_modalChanged","readied","_updateClosingReasonConfirmed","confirmed","closingReason","_onDialogClick","target","hasAttribute","stopPropagation","PaperDialogBehavior","computeObjectId","entityId","substr","rowRenderer","root","_owner","model","firstElementChild","querySelector","item","textContent","HaEntityPicker","_getStates","domainFilter","entityFilter","states","entityIds","eid","sort","updated","_opened","_hass","_value","allowCustomEntity","_valueChanged","autofocus","label","localize","ev","setTimeout","attribute","fixedDeviceClassIcons","humidity","illuminance","temperature","pressure","power","signal_strength","domainIcons","binary_sensor","activated","device_class","cover","dclass","battery","isNaN","batteryRound","Math","round","unit","unit_of_measurement","has_date","has_time","stateIcon","icon","HaIronFocusablesHelper","getTabbableNodes","_collectTabbableNodes","_sortByTabIndex","_isVisible","children","element","tabIndex","_normalizedTabIndex","needsSort","localName","shadowRoot","paperDialogClass","haTabFixBehaviorImpl","dialogElement","scrollable","_ensureTarget","requestAnimationFrame","updateScrollState","toggleClass","scrollTarget","scrollTop","offsetHeight","scrollHeight","parentElement","ItemMixin","superClass","_hasVaadinItemMixin","selected","trim","attrValue","getAttribute","addEventListener","_setFocused","_setActive","_mousedown","mouseUpListener","removeEventListener","_onKeydown","_onKeyup","disconnectedCallback","blur","removeAttribute","focused","active","defaultPrevented","click","ComboBoxPlaceholder","ComboBoxMixin","subclass","readonly","renderer","Function","items","allowCustomValue","filteredItems","_lastCommittedValue","loading","_focusedIndex","selectedItem","itemLabelPath","itemValuePath","itemIdPath","_toggleElement","_clearElement","_inputElementValue","_closeOnBlurIsPrevented","_previousDocumentPointerEvents","_itemTemplate","overlay","relatedTarget","composedPath","_overlaySelectedItemChanged","_onOpened","_onKeyDown","_onClick","_onOverlayTouchAction","_clear","_setTemplateFromNodes","addedNodes","_selector","querySelectorAll","_render","template","oldTemplate","oldRenderer","_removeNewRendererOrTemplate","_oldTemplate","_oldRenderer","Error","old","_openedWithFocusRing","focusElement","touchDevice","_onClosed","_isEventKey","_onArrowDown","_onArrowUp","_onEnter","_onEscape","keyboardEventMatchesKeys","getItemLabel","toString","_items","min","_prefillFocusedItemLabel","max","_getItemLabel","_focusedItem","_markAllSelectionRange","start","end","input","_nativeInput","setSelectionRange","ignore","_setSelectionRange","pos","_stopPropagation","_revertInputValue","toggleElement","_detectAndDispatchChange","_revertInputValueToValue","flush","ensureItemsRendered","toggleScrollListener","updateViewportBoundaries","_increasePoolIfNeeded","_resizeDropdown","window","adjustScrollPosition","focusedItem","CustomEvent","composed","cancelable","dispatchEvent","customValue","_selectItemForValue","_clearSelectionRange","dataProvider","_propertyForValue","_filterFromInput","_filterChanged","oldItemLabelPath","error","_filterItems","_filteredItemsChanged","hasValue","_updateHasValue","_getItemValue","_selectedItem","oldVal","_isValidValue","oldItems","_ensureItemsOrDataProvider","slice","valueIndex","_indexOfValue","_setOverlayItems","indexOfLabel","_repositionOverlay","arr","toLowerCase","previouslySelectedItem","_selectedItemChanged","set","__repositionOverlayDebouncer","debounce","after","_TemplateClass","tpl","_getRootTemplate","templatize","instanceProps","_instanceProps","forwardHostProp","prop","prototype","_itemTemplateInstance","notifyPath","elem","tagName","_preventDefault","ComboBoxDataProviderMixin","pageSize","size","_pendingRequests","__placeHolder","clearCache","page","_getPageForIndex","_shouldLoadPage","_loadPage","_forceNextRequest","loadedItem","params","callback","splice","floor","oldPageSize","oldDataProvider","restoreOldValueCallback","IOS","navigator","userAgent","match","IOS_TOUCH_SCROLLING","as","indexAs","selectedAs","grid","selectionEnabled","selectedItems","multiSelection","scrollOffset","_ratio","_scrollerPaddingTop","_scrollPosition","_physicalSize","_physicalAverage","_physicalAverageCount","_physicalTop","_virtualCount","_estScrollHeight","_scrollHeight","_viewportHeight","_viewportWidth","_physicalItems","_physicalSizes","_firstVisibleIndexVal","_lastVisibleIndexVal","_maxPages","_focusedVirtualIndex","_focusedPhysicalIndex","_offscreenFocusedItem","_focusBackfillItem","_itemsPerRow","_itemWidth","_rowHeight","_templateCost","_parentModel","_virtualStart","_physicalCount","_physicalRows","_userTemplate","parentNode","_scrollOffset","virtualCount","_convertIndexToCompleteRow","val","_clamp","_maxVirtualStart","_virtualStartVal","_physicalStartVal","_physicalStart","_physicalCountVal","Infinity","offsetWidth","idx","physicalOffset","_iterateItems","pidx","vidx","_getPhysicalSizeIncrement","firstVisibleIndex","_estRowsInView","_scrollBottom","ceil","_didFocus","_debounce","unlisten","_setOverflow","webkitOverflowScrolling","overflowY","styles","getComputedStyle","parseInt","_isRTL","direction","_scrollTargetHeight","_updateGridMetrics","_scrollHandler","_maxScrollTop","_scrollTop","delta","isScrollingDown","abs","idxAdjustment","_update","reusables","_getReusables","physicalTop","indexes","fromTop","ith","offsetContent","physicalItemHeight","idxs","protectedOffsetContent","_hiddenContentSize","virtualStart","virtualEnd","_virtualEnd","physicalCount","top","bottom","_physicalBottom","scrollBottom","_physicalEnd","itemSet","movingUp","_manageFocus","_assignModels","_updateMetrics","pop","_positionItems","_updateScrollerSize","_createPool","inst","_ensureTemplatized","physicalItems","stamp","_itemsParent","_isClientFull","count","nextPhysicalCount","correction","nextIncrease","ts","performance","now","_isIndexRendered","_getPhysicalIndex","_optPhysicalSize","ctor","queryEffectiveChildren","mutableData","_gridChanged","newGrid","oldGrid","_itemsChanged","change","_physicalIndexForKey","_resetScrollPosition","_removeFocusedItem","_adjustVirtualIndex","indexSplices","some","addedCount","removed","activeElement","_getActiveElement","contains","affectedIndexRendered","_forwardItemPath","isIndexRendered","dot","offscreenInstance","modelForElement","substring","_setPendingPropertyOrPath","_flushProperties","splices","_removeItem","selector","deselect","fn","rtn","_computeVidx","el","__key__","_forwardProperty","isSelected","newPhysicalSize","oldPhysicalSize","prevAvgCount","prevPhysicalAvg","_adjustScrollPosition","y","totalItemWidth","rowOffset","modulus","x","translate3d","_shouldRenderNextRow","deltaHeight","forceUpdate","_virtualRowCount","scrollToItem","scrollToIndex","currentTopItem","currentVirtualItem","targetOffsetTop","hiddenContentSize","_resetAverage","_resizeHandler","selectItem","selectIndex","clearSelection","updateSizeForIndex","deselectItem","deselectIndex","toggleSelectionForItem","toggleSelectionForIndex","isIndexSelected","_selectionEnabledChanged","_selectionHandler","modelTabIndex","activeElTabIndex","activeEl","physicalItem","_multiSelectionChanged","multi","updateSizeForItem","fidx","_restoreFocusedItem","_createFocusBackfillItem","_isIndexVisible","lastVisibleIndex","focusItem","_focusPhysicalItem","focusable","removeChild","fpidx","onScreenItem","onScreenInstance","offScreenInstance","targetModel","focusedModel","hasOffscreenFocusedItem","_keydownHandler","v","cb","asyncModule","_debouncers","_setPendingProperty","_forwardHostPropV2","_notifyInstancePropV2","_getStampedChildren","_forwardInstancePath","_forwardParentPath","_forwardParentProp","itemsHost","domHost","connectedCallback","comboBoxOverlay","getRootNode","host","__dataHost","_comboBox","variable","loader","insertBefore","positionTarget","alignedAbove","theme","_boundSetPosition","_setPosition","_boundOutsideClickListener","_outsideClickListener","oldValue","position","_isPositionFixed","eventPath","offsetParent","_getOffsetParent","assignedSlot","parent","overlayRect","targetRect","innerHeight","hidden","_shouldAlignAbove","_translateX","left","_translateY","_verticalOffset","_devicePixelRatio","devicePixelRatio","clientWidth","justifyContent","TOUCH_DEVICE","createEvent","_itemLabelPath","_itemValuePath","_itemIdPath","sourceEvent","_initDropdown","_templateChanged","_loadingChanged","_fireTouchAction","_scroller","_patchWheelOverScrolling","maxHeight","ShadyCSS","getComputedStyleValue","getPropertyValue","_maxOverlayHeight","focusedIndex","itemIndex","_isItemFocused","_scrollIntoView","visibleItemsCount","_visibleItemsCount","targetIndex","physicalItemRect","scrollerRect","scrollTopAdjust","_viewportTotalPaddingBottom","scroller","scrolledToTop","scrolledToBottom","clientHeight","deltaY","_cachedViewportTotalPaddingBottom","itemsStyle","paddingBottom","borderBottomWidth","reduce","sum","flushDebouncer","itemsChange","attrForValue","Element","readOnly","_boundInputValueChanged","_inputValueChanged","_setInputElement","_preventInputBlur","_restoreInputBlur","selectedItemLabel","placeholder","noLabelFloat","alwaysFloatLabel","hasContent","keyBindings","tabindex","_setSelectedItem","menuButton","_onIronDeselect","_onTap","_setSelectedItemLabel","_computeMenuVerticalOffset","opt_verticalOffset","_getValidity","openState","_computeLabelClass","cls","_setHasContent","IronScrollTargetBehavior","HTMLElement","_defaultScrollTarget","_shouldHaveListener","_scrollTargetChanged","_oldScrollTarget","_toggleScrollListener","_doc","ownerDocument","_isValidScrollTarget","documentElement","pageYOffset","pageXOffset","scrollLeft","scrollTo","scroll","leftOrOptions","innerWidth","yes","eventTarget","_boundScrollHandler","validEntityId","registered","_rippleDown","_rippleUp","button","_rippleContainer","getRipple","uiDownAction","uiUpAction","ensureRipple","var_args","lastRipple","_ripple","center","_entityFilter","includes","currentEntities","_currentEntities","pickedEntityLabel","_entityChanged","pickEntityLabel","_addEntity","entities","curValue","currentTarget","newValue","_updateEntities","ent","toAdd","_sortedUsers","users","sorted","a","b","compare","_userChanged","user","firstUpdated","then","dataset","userId","_submitting","_params","_error","entry","_name","_userId","user_id","_deviceTrackers","device_trackers","updateComplete","nameInvalid","_nameChanged","_deviceTrackersChanged","_deleteEntry","_updateEntry","values","updateEntry","createEntry","err","removeEntry","_onIronInputReady","nativeInput","$$","_typesThatHaveText","container","_handleValueAndAutoValidate","IronA11yAnnouncer","mode","_text","instance","_onIronAnnounce","announce","async"],"mappings":"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","file":"chunk.4e312e0efd6e83021388.js","sourcesContent":["/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\n\nimport {IronA11yAnnouncer} from '@polymer/iron-a11y-announcer/iron-a11y-announcer.js';\nimport {IronValidatableBehavior} from '@polymer/iron-validatable-behavior/iron-validatable-behavior.js';\nimport {Polymer} from '@polymer/polymer/lib/legacy/polymer-fn.js';\nimport {dom} from '@polymer/polymer/lib/legacy/polymer.dom.js';\nimport {html} from '@polymer/polymer/lib/utils/html-tag.js';\n\n/**\n`<iron-input>` is a wrapper to a native `<input>` element, that adds two-way\nbinding and prevention of invalid input. To use it, you must distribute a native\n`<input>` yourself. You can continue to use the native `input` as you would\nnormally:\n\n    <iron-input>\n      <input>\n    </iron-input>\n\n    <iron-input>\n      <input type=\"email\" disabled>\n    </iron-input>\n\n### Two-way binding\n\nBy default you can only get notified of changes to a native `<input>`'s `value`\ndue to user input:\n\n    <input value=\"{{myValue::input}}\">\n\nThis means that if you imperatively set the value (i.e. `someNativeInput.value =\n'foo'`), no events will be fired and this change cannot be observed.\n\n`iron-input` adds the `bind-value` property that mirrors the native `input`'s\n'`value` property; this property can be used for two-way data binding.\n`bind-value` will notify if it is changed either by user input or by script.\n\n    <iron-input bind-value=\"{{myValue}}\">\n      <input>\n    </iron-input>\n\nNote: this means that if you want to imperatively set the native `input`'s, you\n_must_ set `bind-value` instead, so that the wrapper `iron-input` can be\nnotified.\n\n### Validation\n\n`iron-input` uses the native `input`'s validation. For simplicity, `iron-input`\nhas a `validate()` method (which internally just checks the distributed\n`input`'s validity), which sets an `invalid` attribute that can also be used for\nstyling.\n\nTo validate automatically as you type, you can use the `auto-validate`\nattribute.\n\n`iron-input` also fires an `iron-input-validate` event after `validate()` is\ncalled. You can use it to implement a custom validator:\n\n    var CatsOnlyValidator = {\n      validate: function(ironInput) {\n        var valid = !ironInput.bindValue || ironInput.bindValue === 'cat';\n        ironInput.invalid = !valid;\n        return valid;\n      }\n    }\n    ironInput.addEventListener('iron-input-validate', function() {\n      CatsOnly.validate(input2);\n    });\n\nYou can also use an element implementing an\n[`IronValidatorBehavior`](/element/PolymerElements/iron-validatable-behavior).\nThis example can also be found in the demo for this element:\n\n    <iron-input validator=\"cats-only\">\n      <input>\n    </iron-input>\n\n### Preventing invalid input\n\nIt may be desirable to only allow users to enter certain characters. You can use\nthe `allowed-pattern` attribute to accomplish this. This feature is separate\nfrom validation, and `allowed-pattern` does not affect how the input is\nvalidated.\n\n    // Only allow typing digits, but a valid input has exactly 5 digits.\n    <iron-input allowed-pattern=\"[0-9]\">\n      <input pattern=\"\\d{5}\">\n    </iron-input>\n\n@demo demo/index.html\n*/\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: inline-block;\n      }\n    </style>\n    <slot id=\"content\"></slot>\n`,\n\n  is: 'iron-input',\n  behaviors: [IronValidatableBehavior],\n\n  /**\n   * Fired whenever `validate()` is called.\n   *\n   * @event iron-input-validate\n   */\n\n  properties: {\n\n    /**\n     * Use this property instead of `value` for two-way data binding, or to\n     * set a default value for the input. **Do not** use the distributed\n     * input's `value` property to set a default value.\n     */\n    bindValue: {type: String, value: ''},\n\n    /**\n     * Computed property that echoes `bindValue` (mostly used for Polymer 1.0\n     * backcompatibility, if you were one-way binding to the Polymer 1.0\n     * `input is=\"iron-input\"` value attribute).\n     */\n    value: {type: String, computed: '_computeValue(bindValue)'},\n\n    /**\n     * Regex-like list of characters allowed as input; all characters not in the\n     * list will be rejected. The recommended format should be a list of allowed\n     * characters, for example, `[a-zA-Z0-9.+-!;:]`.\n     *\n     * This pattern represents the allowed characters for the field; as the user\n     * inputs text, each individual character will be checked against the\n     * pattern (rather than checking the entire value as a whole). If a\n     * character is not a match, it will be rejected.\n     *\n     * Pasted input will have each character checked individually; if any\n     * character doesn't match `allowedPattern`, the entire pasted string will\n     * be rejected.\n     *\n     * Note: if you were using `iron-input` in 1.0, you were also required to\n     * set `prevent-invalid-input`. This is no longer needed as of Polymer 2.0,\n     * and will be set automatically for you if an `allowedPattern` is provided.\n     *\n     */\n    allowedPattern: {type: String},\n\n    /**\n     * Set to true to auto-validate the input value as you type.\n     */\n    autoValidate: {type: Boolean, value: false},\n\n    /**\n     * The native input element.\n     */\n    _inputElement: Object,\n  },\n\n  observers: ['_bindValueChanged(bindValue, _inputElement)'],\n  listeners: {'input': '_onInput', 'keypress': '_onKeypress'},\n\n  created: function() {\n    IronA11yAnnouncer.requestAvailability();\n    this._previousValidInput = '';\n    this._patternAlreadyChecked = false;\n  },\n\n  attached: function() {\n    // If the input is added at a later time, update the internal reference.\n    this._observer = dom(this).observeNodes(function(info) {\n      this._initSlottedInput();\n    }.bind(this));\n  },\n\n  detached: function() {\n    if (this._observer) {\n      dom(this).unobserveNodes(this._observer);\n      this._observer = null;\n    }\n  },\n\n  /**\n   * Returns the distributed input element.\n   */\n  get inputElement() {\n    return this._inputElement;\n  },\n\n  _initSlottedInput: function() {\n    this._inputElement = this.getEffectiveChildren()[0];\n\n    if (this.inputElement && this.inputElement.value) {\n      this.bindValue = this.inputElement.value;\n    }\n\n    this.fire('iron-input-ready');\n  },\n\n  get _patternRegExp() {\n    var pattern;\n    if (this.allowedPattern) {\n      pattern = new RegExp(this.allowedPattern);\n    } else {\n      switch (this.inputElement.type) {\n        case 'number':\n          pattern = /[0-9.,e-]/;\n          break;\n      }\n    }\n    return pattern;\n  },\n\n  /**\n   * @suppress {checkTypes}\n   */\n  _bindValueChanged: function(bindValue, inputElement) {\n    // The observer could have run before attached() when we have actually\n    // initialized this property.\n    if (!inputElement) {\n      return;\n    }\n\n    if (bindValue === undefined) {\n      inputElement.value = null;\n    } else if (bindValue !== inputElement.value) {\n      this.inputElement.value = bindValue;\n    }\n\n    if (this.autoValidate) {\n      this.validate();\n    }\n\n    // manually notify because we don't want to notify until after setting value\n    this.fire('bind-value-changed', {value: bindValue});\n  },\n\n  _onInput: function() {\n    // Need to validate each of the characters pasted if they haven't\n    // been validated inside `_onKeypress` already.\n    if (this.allowedPattern && !this._patternAlreadyChecked) {\n      var valid = this._checkPatternValidity();\n      if (!valid) {\n        this._announceInvalidCharacter(\n            'Invalid string of characters not entered.');\n        this.inputElement.value = this._previousValidInput;\n      }\n    }\n    this.bindValue = this._previousValidInput = this.inputElement.value;\n    this._patternAlreadyChecked = false;\n  },\n\n  _isPrintable: function(event) {\n    // What a control/printable character is varies wildly based on the browser.\n    // - most control characters (arrows, backspace) do not send a `keypress`\n    // event\n    //   in Chrome, but the *do* on Firefox\n    // - in Firefox, when they do send a `keypress` event, control chars have\n    //   a charCode = 0, keyCode = xx (for ex. 40 for down arrow)\n    // - printable characters always send a keypress event.\n    // - in Firefox, printable chars always have a keyCode = 0. In Chrome, the\n    // keyCode\n    //   always matches the charCode.\n    // None of this makes any sense.\n\n    // For these keys, ASCII code == browser keycode.\n    var anyNonPrintable = (event.keyCode == 8) ||  // backspace\n        (event.keyCode == 9) ||                    // tab\n        (event.keyCode == 13) ||                   // enter\n        (event.keyCode == 27);                     // escape\n\n    // For these keys, make sure it's a browser keycode and not an ASCII code.\n    var mozNonPrintable = (event.keyCode == 19) ||  // pause\n        (event.keyCode == 20) ||                    // caps lock\n        (event.keyCode == 45) ||                    // insert\n        (event.keyCode == 46) ||                    // delete\n        (event.keyCode == 144) ||                   // num lock\n        (event.keyCode == 145) ||                   // scroll lock\n        (event.keyCode > 32 &&\n         event.keyCode < 41) ||  // page up/down, end, home, arrows\n        (event.keyCode > 111 && event.keyCode < 124);  // fn keys\n\n    return !anyNonPrintable && !(event.charCode == 0 && mozNonPrintable);\n  },\n\n  _onKeypress: function(event) {\n    if (!this.allowedPattern && this.inputElement.type !== 'number') {\n      return;\n    }\n    var regexp = this._patternRegExp;\n    if (!regexp) {\n      return;\n    }\n\n    // Handle special keys and backspace\n    if (event.metaKey || event.ctrlKey || event.altKey) {\n      return;\n    }\n\n    // Check the pattern either here or in `_onInput`, but not in both.\n    this._patternAlreadyChecked = true;\n\n    var thisChar = String.fromCharCode(event.charCode);\n    if (this._isPrintable(event) && !regexp.test(thisChar)) {\n      event.preventDefault();\n      this._announceInvalidCharacter(\n          'Invalid character ' + thisChar + ' not entered.');\n    }\n  },\n\n  _checkPatternValidity: function() {\n    var regexp = this._patternRegExp;\n    if (!regexp) {\n      return true;\n    }\n    for (var i = 0; i < this.inputElement.value.length; i++) {\n      if (!regexp.test(this.inputElement.value[i])) {\n        return false;\n      }\n    }\n    return true;\n  },\n\n  /**\n   * Returns true if `value` is valid. The validator provided in `validator`\n   * will be used first, then any constraints.\n   * @return {boolean} True if the value is valid.\n   */\n  validate: function() {\n    if (!this.inputElement) {\n      this.invalid = false;\n      return true;\n    }\n\n    // Use the nested input's native validity.\n    var valid = this.inputElement.checkValidity();\n\n    // Only do extra checking if the browser thought this was valid.\n    if (valid) {\n      // Empty, required input is invalid\n      if (this.required && this.bindValue === '') {\n        valid = false;\n      } else if (this.hasValidator()) {\n        valid = IronValidatableBehavior.validate.call(this, this.bindValue);\n      }\n    }\n\n    this.invalid = !valid;\n    this.fire('iron-input-validate');\n    return valid;\n  },\n\n  _announceInvalidCharacter: function(message) {\n    this.fire('iron-announce', {text: message});\n  },\n\n  _computeValue: function(bindValue) {\n    return bindValue;\n  }\n});\n","/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\n\n/**\n * `NeonAnimatableBehavior` is implemented by elements containing\n * animations for use with elements implementing\n * `NeonAnimationRunnerBehavior`.\n * @polymerBehavior\n */\nexport const NeonAnimatableBehavior = {\n\n  properties: {\n\n    /**\n     * Animation configuration. See README for more info.\n     */\n    animationConfig: {type: Object},\n\n    /**\n     * Convenience property for setting an 'entry' animation. Do not set\n     * `animationConfig.entry` manually if using this. The animated node is set\n     * to `this` if using this property.\n     */\n    entryAnimation: {\n      observer: '_entryAnimationChanged',\n      type: String,\n    },\n\n    /**\n     * Convenience property for setting an 'exit' animation. Do not set\n     * `animationConfig.exit` manually if using this. The animated node is set\n     * to `this` if using this property.\n     */\n    exitAnimation: {\n      observer: '_exitAnimationChanged',\n      type: String,\n    },\n\n  },\n\n  _entryAnimationChanged: function() {\n    this.animationConfig = this.animationConfig || {};\n    this.animationConfig['entry'] = [{name: this.entryAnimation, node: this}];\n  },\n\n  _exitAnimationChanged: function() {\n    this.animationConfig = this.animationConfig || {};\n    this.animationConfig['exit'] = [{name: this.exitAnimation, node: this}];\n  },\n\n  _copyProperties: function(config1, config2) {\n    // shallowly copy properties from config2 to config1\n    for (var property in config2) {\n      config1[property] = config2[property];\n    }\n  },\n\n  _cloneConfig: function(config) {\n    var clone = {isClone: true};\n    this._copyProperties(clone, config);\n    return clone;\n  },\n\n  _getAnimationConfigRecursive: function(type, map, allConfigs) {\n    if (!this.animationConfig) {\n      return;\n    }\n\n    if (this.animationConfig.value &&\n        typeof this.animationConfig.value === 'function') {\n      this._warn(this._logf(\n          'playAnimation',\n          'Please put \\'animationConfig\\' inside of your components \\'properties\\' object instead of outside of it.'));\n      return;\n    }\n\n    // type is optional\n    var thisConfig;\n    if (type) {\n      thisConfig = this.animationConfig[type];\n    } else {\n      thisConfig = this.animationConfig;\n    }\n\n    if (!Array.isArray(thisConfig)) {\n      thisConfig = [thisConfig];\n    }\n\n    // iterate animations and recurse to process configurations from child nodes\n    if (thisConfig) {\n      for (var config, index = 0; config = thisConfig[index]; index++) {\n        if (config.animatable) {\n          config.animatable._getAnimationConfigRecursive(\n              config.type || type, map, allConfigs);\n        } else {\n          if (config.id) {\n            var cachedConfig = map[config.id];\n            if (cachedConfig) {\n              // merge configurations with the same id, making a clone lazily\n              if (!cachedConfig.isClone) {\n                map[config.id] = this._cloneConfig(cachedConfig);\n                cachedConfig = map[config.id];\n              }\n              this._copyProperties(cachedConfig, config);\n            } else {\n              // put any configs with an id into a map\n              map[config.id] = config;\n            }\n          } else {\n            allConfigs.push(config);\n          }\n        }\n      }\n    }\n  },\n\n  /**\n   * An element implementing `NeonAnimationRunnerBehavior` calls this\n   * method to configure an animation with an optional type. Elements\n   * implementing `NeonAnimatableBehavior` should define the property\n   * `animationConfig`, which is either a configuration object or a map of\n   * animation type to array of configuration objects.\n   */\n  getAnimationConfig: function(type) {\n    var map = {};\n    var allConfigs = [];\n    this._getAnimationConfigRecursive(type, map, allConfigs);\n    // append the configurations saved in the map to the array\n    for (var key in map) {\n      allConfigs.push(map[key]);\n    }\n    return allConfigs;\n  }\n\n};\n","/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\n\nimport {NeonAnimatableBehavior} from './neon-animatable-behavior.js';\n\n/**\n * `NeonAnimationRunnerBehavior` adds a method to run animations.\n *\n * @polymerBehavior NeonAnimationRunnerBehavior\n */\nexport const NeonAnimationRunnerBehaviorImpl = {\n\n  _configureAnimations: function(configs) {\n    var results = [];\n    var resultsToPlay = [];\n\n    if (configs.length > 0) {\n      for (let config, index = 0; config = configs[index]; index++) {\n        let neonAnimation = document.createElement(config.name);\n        // is this element actually a neon animation?\n        if (neonAnimation.isNeonAnimation) {\n          let result = null;\n          // Closure compiler does not work well with a try / catch here.\n          // .configure needs to be explicitly defined\n          if (!neonAnimation.configure) {\n            /**\n             * @param {Object} config\n             * @return {AnimationEffectReadOnly}\n             */\n            neonAnimation.configure = function(config) {\n              return null;\n            }\n          }\n\n          result = neonAnimation.configure(config);\n          resultsToPlay.push({\n            result: result,\n            config: config,\n            neonAnimation: neonAnimation,\n          });\n        } else {\n          console.warn(this.is + ':', config.name, 'not found!');\n        }\n      }\n    }\n\n    for (var i = 0; i < resultsToPlay.length; i++) {\n      let result = resultsToPlay[i].result;\n      let config = resultsToPlay[i].config;\n      let neonAnimation = resultsToPlay[i].neonAnimation;\n      // configuration or play could fail if polyfills aren't loaded\n      try {\n        // Check if we have an Effect rather than an Animation\n        if (typeof result.cancel != 'function') {\n          result = document.timeline.play(result);\n        }\n      } catch (e) {\n        result = null;\n        console.warn('Couldnt play', '(', config.name, ').', e);\n      }\n\n      if (result) {\n        results.push({\n          neonAnimation: neonAnimation,\n          config: config,\n          animation: result,\n        });\n      }\n    }\n\n    return results;\n  },\n\n  _shouldComplete: function(activeEntries) {\n    var finished = true;\n    for (var i = 0; i < activeEntries.length; i++) {\n      if (activeEntries[i].animation.playState != 'finished') {\n        finished = false;\n        break;\n      }\n    }\n    return finished;\n  },\n\n  _complete: function(activeEntries) {\n    for (var i = 0; i < activeEntries.length; i++) {\n      activeEntries[i].neonAnimation.complete(activeEntries[i].config);\n    }\n    for (var i = 0; i < activeEntries.length; i++) {\n      activeEntries[i].animation.cancel();\n    }\n  },\n\n  /**\n   * Plays an animation with an optional `type`.\n   * @param {string=} type\n   * @param {!Object=} cookie\n   */\n  playAnimation: function(type, cookie) {\n    var configs = this.getAnimationConfig(type);\n    if (!configs) {\n      return;\n    }\n    this._active = this._active || {};\n    if (this._active[type]) {\n      this._complete(this._active[type]);\n      delete this._active[type];\n    }\n\n    var activeEntries = this._configureAnimations(configs);\n\n    if (activeEntries.length == 0) {\n      this.fire('neon-animation-finish', cookie, {bubbles: false});\n      return;\n    }\n\n    this._active[type] = activeEntries;\n\n    for (var i = 0; i < activeEntries.length; i++) {\n      activeEntries[i].animation.onfinish = function() {\n        if (this._shouldComplete(activeEntries)) {\n          this._complete(activeEntries);\n          delete this._active[type];\n          this.fire('neon-animation-finish', cookie, {bubbles: false});\n        }\n      }.bind(this);\n    }\n  },\n\n  /**\n   * Cancels the currently running animations.\n   */\n  cancelAnimation: function() {\n    for (var k in this._active) {\n      var entries = this._active[k]\n\n                    for (var j in entries) {\n        entries[j].animation.cancel();\n      }\n    }\n\n    this._active = {};\n  }\n};\n\n/** @polymerBehavior */\nexport const NeonAnimationRunnerBehavior =\n    [NeonAnimatableBehavior, NeonAnimationRunnerBehaviorImpl];\n","/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\nimport '@polymer/paper-styles/default-theme.js';\n\nimport {IronMenuBehavior} from '@polymer/iron-menu-behavior/iron-menu-behavior.js';\nimport {Polymer} from '@polymer/polymer/lib/legacy/polymer-fn.js';\nimport {html} from '@polymer/polymer/lib/utils/html-tag.js';\n\n/**\nMaterial design:\n[Menus](https://www.google.com/design/spec/components/menus.html)\n\n`<paper-listbox>` implements an accessible listbox control with Material Design\nstyling. The focused item is highlighted, and the selected item has bolded text.\n\n    <paper-listbox>\n      <paper-item>Item 1</paper-item>\n      <paper-item>Item 2</paper-item>\n    </paper-listbox>\n\nAn initial selection can be specified with the `selected` attribute.\n\n    <paper-listbox selected=\"0\">\n      <paper-item>Item 1</paper-item>\n      <paper-item>Item 2</paper-item>\n    </paper-listbox>\n\nMake a multi-select listbox with the `multi` attribute. Items in a multi-select\nlistbox can be deselected, and multiple item can be selected.\n\n    <paper-listbox multi>\n      <paper-item>Item 1</paper-item>\n      <paper-item>Item 2</paper-item>\n    </paper-listbox>\n\n### Styling\n\nThe following custom properties and mixins are available for styling:\n\nCustom property | Description | Default\n----------------|-------------|----------\n`--paper-listbox-background-color`   | Menu background color |\n`--primary-background-color`\n`--paper-listbox-color`              | Menu foreground color |\n`--primary-text-color`\n`--paper-listbox`                    | Mixin applied to the listbox | `{}`\n\n### Accessibility\n\n`<paper-listbox>` has `role=\"listbox\"` by default. A multi-select listbox will\nalso have `aria-multiselectable` set. It implements key bindings to navigate\nthrough the listbox with the up and down arrow keys, esc to exit the listbox,\nand enter to activate a listbox item. Typing the first letter of a listbox item\nwill also focus it.\n\n@group Paper Elements\n@element paper-listbox\n@demo demo/index.html\n*/\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n        padding: 8px 0;\n\n        background: var(--paper-listbox-background-color, var(--primary-background-color));\n        color: var(--paper-listbox-color, var(--primary-text-color));\n\n        @apply --paper-listbox;\n      }\n    </style>\n\n    <slot></slot>\n`,\n\n  is: 'paper-listbox',\n  behaviors: [IronMenuBehavior],\n\n  /** @private */\n  hostAttributes: {role: 'listbox'}\n});\n","/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\n\nimport {IronA11yKeysBehavior} from '@polymer/iron-a11y-keys-behavior/iron-a11y-keys-behavior.js';\nimport {IronControlState} from '@polymer/iron-behaviors/iron-control-state.js';\nimport {IronOverlayBehavior, IronOverlayBehaviorImpl} from '@polymer/iron-overlay-behavior/iron-overlay-behavior.js';\nimport {NeonAnimationRunnerBehavior} from '@polymer/neon-animation/neon-animation-runner-behavior.js';\nimport {Polymer} from '@polymer/polymer/lib/legacy/polymer-fn.js';\nimport {dom} from '@polymer/polymer/lib/legacy/polymer.dom.js';\nimport {html} from '@polymer/polymer/lib/utils/html-tag.js';\n\n/**\n`<iron-dropdown>` is a generalized element that is useful when you have\nhidden content (`dropdown-content`) that is revealed due to some change in\nstate that should cause it to do so.\n\nNote that this is a low-level element intended to be used as part of other\ncomposite elements that cause dropdowns to be revealed.\n\nExamples of elements that might be implemented using an `iron-dropdown`\ninclude comboboxes, menubuttons, selects. The list goes on.\n\nThe `<iron-dropdown>` element exposes attributes that allow the position\nof the `dropdown-content` relative to the `dropdown-trigger` to be\nconfigured.\n\n    <iron-dropdown horizontal-align=\"right\" vertical-align=\"top\">\n      <div slot=\"dropdown-content\">Hello!</div>\n    </iron-dropdown>\n\nIn the above example, the `<div>` assigned to the `dropdown-content` slot will\nbe hidden until the dropdown element has `opened` set to true, or when the\n`open` method is called on the element.\n\n@demo demo/index.html\n*/\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        position: fixed;\n      }\n\n      #contentWrapper ::slotted(*) {\n        overflow: auto;\n      }\n\n      #contentWrapper.animating ::slotted(*) {\n        overflow: hidden;\n        pointer-events: none;\n      }\n    </style>\n\n    <div id=\"contentWrapper\">\n      <slot id=\"content\" name=\"dropdown-content\"></slot>\n    </div>\n`,\n\n  is: 'iron-dropdown',\n\n  behaviors: [\n    IronControlState,\n    IronA11yKeysBehavior,\n    IronOverlayBehavior,\n    NeonAnimationRunnerBehavior\n  ],\n\n  properties: {\n    /**\n     * The orientation against which to align the dropdown content\n     * horizontally relative to the dropdown trigger.\n     * Overridden from `Polymer.IronFitBehavior`.\n     */\n    horizontalAlign: {type: String, value: 'left', reflectToAttribute: true},\n\n    /**\n     * The orientation against which to align the dropdown content\n     * vertically relative to the dropdown trigger.\n     * Overridden from `Polymer.IronFitBehavior`.\n     */\n    verticalAlign: {type: String, value: 'top', reflectToAttribute: true},\n\n    /**\n     * An animation config. If provided, this will be used to animate the\n     * opening of the dropdown. Pass an Array for multiple animations.\n     * See `neon-animation` documentation for more animation configuration\n     * details.\n     */\n    openAnimationConfig: {type: Object},\n\n    /**\n     * An animation config. If provided, this will be used to animate the\n     * closing of the dropdown. Pass an Array for multiple animations.\n     * See `neon-animation` documentation for more animation configuration\n     * details.\n     */\n    closeAnimationConfig: {type: Object},\n\n    /**\n     * If provided, this will be the element that will be focused when\n     * the dropdown opens.\n     */\n    focusTarget: {type: Object},\n\n    /**\n     * Set to true to disable animations when opening and closing the\n     * dropdown.\n     */\n    noAnimations: {type: Boolean, value: false},\n\n    /**\n     * By default, the dropdown will constrain scrolling on the page\n     * to itself when opened.\n     * Set to true in order to prevent scroll from being constrained\n     * to the dropdown when it opens.\n     * This property is a shortcut to set `scrollAction` to lock or refit.\n     * Prefer directly setting the `scrollAction` property.\n     */\n    allowOutsideScroll:\n        {type: Boolean, value: false, observer: '_allowOutsideScrollChanged'}\n  },\n\n  listeners: {'neon-animation-finish': '_onNeonAnimationFinish'},\n\n  observers: [\n    '_updateOverlayPosition(positionTarget, verticalAlign, horizontalAlign, verticalOffset, horizontalOffset)'\n  ],\n\n  /**\n   * The element that is contained by the dropdown, if any.\n   */\n  get containedElement() {\n    // Polymer 2.x returns slot.assignedNodes which can contain text nodes.\n    var nodes = dom(this.$.content).getDistributedNodes();\n    for (var i = 0, l = nodes.length; i < l; i++) {\n      if (nodes[i].nodeType === Node.ELEMENT_NODE) {\n        return nodes[i];\n      }\n    }\n  },\n\n  ready: function() {\n    // Ensure scrollAction is set.\n    if (!this.scrollAction) {\n      this.scrollAction = this.allowOutsideScroll ? 'refit' : 'lock';\n    }\n    this._readied = true;\n  },\n\n  attached: function() {\n    if (!this.sizingTarget || this.sizingTarget === this) {\n      this.sizingTarget = this.containedElement || this;\n    }\n  },\n\n  detached: function() {\n    this.cancelAnimation();\n  },\n\n  /**\n   * Called when the value of `opened` changes.\n   * Overridden from `IronOverlayBehavior`\n   */\n  _openedChanged: function() {\n    if (this.opened && this.disabled) {\n      this.cancel();\n    } else {\n      this.cancelAnimation();\n      this._updateAnimationConfig();\n      IronOverlayBehaviorImpl._openedChanged.apply(this, arguments);\n    }\n  },\n\n  /**\n   * Overridden from `IronOverlayBehavior`.\n   */\n  _renderOpened: function() {\n    if (!this.noAnimations && this.animationConfig.open) {\n      this.$.contentWrapper.classList.add('animating');\n      this.playAnimation('open');\n    } else {\n      IronOverlayBehaviorImpl._renderOpened.apply(this, arguments);\n    }\n  },\n\n  /**\n   * Overridden from `IronOverlayBehavior`.\n   */\n  _renderClosed: function() {\n    if (!this.noAnimations && this.animationConfig.close) {\n      this.$.contentWrapper.classList.add('animating');\n      this.playAnimation('close');\n    } else {\n      IronOverlayBehaviorImpl._renderClosed.apply(this, arguments);\n    }\n  },\n\n  /**\n   * Called when animation finishes on the dropdown (when opening or\n   * closing). Responsible for \"completing\" the process of opening or\n   * closing the dropdown by positioning it or setting its display to\n   * none.\n   */\n  _onNeonAnimationFinish: function() {\n    this.$.contentWrapper.classList.remove('animating');\n    if (this.opened) {\n      this._finishRenderOpened();\n    } else {\n      this._finishRenderClosed();\n    }\n  },\n\n  /**\n   * Constructs the final animation config from different properties used\n   * to configure specific parts of the opening and closing animations.\n   */\n  _updateAnimationConfig: function() {\n    // Update the animation node to be the containedElement.\n    var animationNode = this.containedElement;\n    var animations = [].concat(this.openAnimationConfig || [])\n                         .concat(this.closeAnimationConfig || []);\n    for (var i = 0; i < animations.length; i++) {\n      animations[i].node = animationNode;\n    }\n    this.animationConfig = {\n      open: this.openAnimationConfig,\n      close: this.closeAnimationConfig\n    };\n  },\n\n  /**\n   * Updates the overlay position based on configured horizontal\n   * and vertical alignment.\n   */\n  _updateOverlayPosition: function() {\n    if (this.isAttached) {\n      // This triggers iron-resize, and iron-overlay-behavior will call refit if\n      // needed.\n      this.notifyResize();\n    }\n  },\n\n  /**\n   * Sets scrollAction according to the value of allowOutsideScroll.\n   * Prefer setting directly scrollAction.\n   */\n  _allowOutsideScrollChanged: function(allowOutsideScroll) {\n    // Wait until initial values are all set.\n    if (!this._readied) {\n      return;\n    }\n    if (!allowOutsideScroll) {\n      this.scrollAction = 'lock';\n    } else if (!this.scrollAction || this.scrollAction === 'lock') {\n      this.scrollAction = 'refit';\n    }\n  },\n\n  /**\n   * Apply focus to focusTarget or containedElement\n   */\n  _applyFocus: function() {\n    var focusTarget = this.focusTarget || this.containedElement;\n    if (focusTarget && this.opened && !this.noAutoFocus) {\n      focusTarget.focus();\n    } else {\n      IronOverlayBehaviorImpl._applyFocus.apply(this, arguments);\n    }\n  }\n});\n","/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\n\n/**\n * Use `NeonAnimationBehavior` to implement an animation.\n * @polymerBehavior\n */\nexport const NeonAnimationBehavior = {\n\n  properties: {\n\n    /**\n     * Defines the animation timing.\n     */\n    animationTiming: {\n      type: Object,\n      value: function() {\n        return {\n          duration: 500, easing: 'cubic-bezier(0.4, 0, 0.2, 1)', fill: 'both'\n        }\n      }\n    }\n\n  },\n\n  /**\n   * Can be used to determine that elements implement this behavior.\n   */\n  isNeonAnimation: true,\n\n  /**\n   * Do any animation configuration here.\n   */\n  // configure: function(config) {\n  // },\n\n  created: function() {\n    if (!document.body.animate) {\n      console.warn(\n          'No web animations detected. This element will not' +\n          ' function without a web animations polyfill.');\n    }\n  },\n\n  /**\n   * Returns the animation timing by mixing in properties from `config` to the\n   * defaults defined by the animation.\n   */\n  timingFromConfig: function(config) {\n    if (config.timing) {\n      for (var property in config.timing) {\n        this.animationTiming[property] = config.timing[property];\n      }\n    }\n    return this.animationTiming;\n  },\n\n  /**\n   * Sets `transform` and `transformOrigin` properties along with the prefixed\n   * versions.\n   */\n  setPrefixedProperty: function(node, property, value) {\n    var map = {\n      'transform': ['webkitTransform'],\n      'transformOrigin': ['mozTransformOrigin', 'webkitTransformOrigin']\n    };\n    var prefixes = map[property];\n    for (var prefix, index = 0; prefix = prefixes[index]; index++) {\n      node.style[prefix] = value;\n    }\n    node.style[property] = value;\n  },\n\n  /**\n   * Called when the animation finishes.\n   */\n  complete: function(config) {}\n\n};\n","/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\n\nimport {Polymer} from '@polymer/polymer/lib/legacy/polymer-fn.js';\nimport {NeonAnimationBehavior} from '../neon-animation-behavior.js';\n/*\n`<fade-in-animation>` animates the opacity of an element from 0 to 1.\n\nConfiguration:\n```\n{\n  name: 'fade-in-animation',\n  node: <node>\n  timing: <animation-timing>\n}\n```\n*/\nPolymer({\n\n  is: 'fade-in-animation',\n\n  behaviors: [NeonAnimationBehavior],\n\n  configure: function(config) {\n    var node = config.node;\n    this._effect = new KeyframeEffect(\n        node,\n        [{'opacity': '0'}, {'opacity': '1'}],\n        this.timingFromConfig(config));\n    return this._effect;\n  }\n\n});\n","/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\n\nimport {Polymer} from '@polymer/polymer/lib/legacy/polymer-fn.js';\nimport {NeonAnimationBehavior} from '../neon-animation-behavior.js';\n/*\n`<fade-out-animation>` animates the opacity of an element from 1 to 0.\n\nConfiguration:\n```\n{\n  name: 'fade-out-animation',\n  node: <node>\n  timing: <animation-timing>\n}\n```\n*/\nPolymer({\n\n  is: 'fade-out-animation',\n\n  behaviors: [NeonAnimationBehavior],\n\n  configure: function(config) {\n    var node = config.node;\n    this._effect = new KeyframeEffect(\n        node,\n        [\n          {'opacity': '1'},\n          {'opacity': '0'},\n        ],\n        this.timingFromConfig(config));\n    return this._effect;\n  }\n\n});\n","/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\n\nimport {NeonAnimationBehavior} from '@polymer/neon-animation/neon-animation-behavior.js';\nimport {Polymer} from '@polymer/polymer/lib/legacy/polymer-fn.js';\nPolymer({\n  is: 'paper-menu-grow-height-animation',\n\n  behaviors: [NeonAnimationBehavior],\n\n  configure: function(config) {\n    var node = config.node;\n    var rect = node.getBoundingClientRect();\n    var height = rect.height;\n\n    this._effect = new KeyframeEffect(\n        node,\n        [{height: (height / 2) + 'px'}, {height: height + 'px'}],\n        this.timingFromConfig(config));\n\n    return this._effect;\n  }\n});\n\nPolymer({\n  is: 'paper-menu-grow-width-animation',\n\n  behaviors: [NeonAnimationBehavior],\n\n  configure: function(config) {\n    var node = config.node;\n    var rect = node.getBoundingClientRect();\n    var width = rect.width;\n\n    this._effect = new KeyframeEffect(\n        node,\n        [{width: (width / 2) + 'px'}, {width: width + 'px'}],\n        this.timingFromConfig(config));\n\n    return this._effect;\n  }\n});\n\nPolymer({\n  is: 'paper-menu-shrink-width-animation',\n\n  behaviors: [NeonAnimationBehavior],\n\n  configure: function(config) {\n    var node = config.node;\n    var rect = node.getBoundingClientRect();\n    var width = rect.width;\n\n    this._effect = new KeyframeEffect(\n        node,\n        [{width: width + 'px'}, {width: width - (width / 20) + 'px'}],\n        this.timingFromConfig(config));\n\n    return this._effect;\n  }\n});\n\nPolymer({\n  is: 'paper-menu-shrink-height-animation',\n\n  behaviors: [NeonAnimationBehavior],\n\n  configure: function(config) {\n    var node = config.node;\n    var rect = node.getBoundingClientRect();\n    var height = rect.height;\n\n    this.setPrefixedProperty(node, 'transformOrigin', '0 0');\n\n    this._effect = new KeyframeEffect(\n        node,\n        [\n          {height: height + 'px', transform: 'translateY(0)'},\n          {height: height / 2 + 'px', transform: 'translateY(-20px)'}\n        ],\n        this.timingFromConfig(config));\n\n    return this._effect;\n  }\n});\n","/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\nimport '@polymer/iron-dropdown/iron-dropdown.js';\nimport '@polymer/neon-animation/animations/fade-in-animation.js';\nimport '@polymer/neon-animation/animations/fade-out-animation.js';\nimport '@polymer/paper-styles/default-theme.js';\nimport '@polymer/paper-styles/shadow.js';\nimport './paper-menu-button-animations.js';\n\nimport {IronA11yKeysBehavior} from '@polymer/iron-a11y-keys-behavior/iron-a11y-keys-behavior.js';\nimport {IronControlState} from '@polymer/iron-behaviors/iron-control-state.js';\nimport {Polymer} from '@polymer/polymer/lib/legacy/polymer-fn.js';\nimport {dom} from '@polymer/polymer/lib/legacy/polymer.dom.js';\nimport {html} from '@polymer/polymer/lib/utils/html-tag.js';\n\nvar config = {\n  ANIMATION_CUBIC_BEZIER: 'cubic-bezier(.3,.95,.5,1)',\n  MAX_ANIMATION_TIME_MS: 400\n};\n\n/**\nMaterial design: [Dropdown\nbuttons](https://www.google.com/design/spec/components/buttons.html#buttons-dropdown-buttons)\n\n`paper-menu-button` allows one to compose a designated \"trigger\" element with\nanother element that represents \"content\", to create a dropdown menu that\ndisplays the \"content\" when the \"trigger\" is clicked.\n\nThe child element assigned to the `dropdown-trigger` slot will be used as the\n\"trigger\" element. The child element assigned to the `dropdown-content` slot\nwill be used as the \"content\" element.\n\nThe `paper-menu-button` is sensitive to its content's `iron-select` events. If\nthe \"content\" element triggers an `iron-select` event, the `paper-menu-button`\nwill close automatically.\n\nExample:\n\n    <paper-menu-button>\n      <paper-icon-button icon=\"menu\"\nslot=\"dropdown-trigger\"></paper-icon-button> <paper-listbox\nslot=\"dropdown-content\"> <paper-item>Share</paper-item>\n        <paper-item>Settings</paper-item>\n        <paper-item>Help</paper-item>\n      </paper-listbox>\n    </paper-menu-button>\n\n### Styling\n\nThe following custom properties and mixins are also available for styling:\n\nCustom property | Description | Default\n----------------|-------------|----------\n`--paper-menu-button-dropdown-background` | Background color of the paper-menu-button dropdown | `--primary-background-color`\n`--paper-menu-button` | Mixin applied to the paper-menu-button | `{}`\n`--paper-menu-button-disabled` | Mixin applied to the paper-menu-button when disabled | `{}`\n`--paper-menu-button-dropdown` | Mixin applied to the paper-menu-button dropdown | `{}`\n`--paper-menu-button-content` | Mixin applied to the paper-menu-button content | `{}`\n\n@hero hero.svg\n@demo demo/index.html\n*/\nexport const PaperMenuButton = Polymer({\n  _template: html`\n    <style>\n      :host {\n        display: inline-block;\n        position: relative;\n        padding: 8px;\n        outline: none;\n\n        @apply --paper-menu-button;\n      }\n\n      :host([disabled]) {\n        cursor: auto;\n        color: var(--disabled-text-color);\n\n        @apply --paper-menu-button-disabled;\n      }\n\n      iron-dropdown {\n        @apply --paper-menu-button-dropdown;\n      }\n\n      .dropdown-content {\n        @apply --shadow-elevation-2dp;\n\n        position: relative;\n        border-radius: 2px;\n        background-color: var(--paper-menu-button-dropdown-background, var(--primary-background-color));\n\n        @apply --paper-menu-button-content;\n      }\n\n      :host([vertical-align=\"top\"]) .dropdown-content {\n        margin-bottom: 20px;\n        margin-top: -10px;\n        top: 10px;\n      }\n\n      :host([vertical-align=\"bottom\"]) .dropdown-content {\n        bottom: 10px;\n        margin-bottom: -10px;\n        margin-top: 20px;\n      }\n\n      #trigger {\n        cursor: pointer;\n      }\n    </style>\n\n    <div id=\"trigger\" on-tap=\"toggle\">\n      <slot name=\"dropdown-trigger\"></slot>\n    </div>\n\n    <iron-dropdown id=\"dropdown\" opened=\"{{opened}}\" horizontal-align=\"[[horizontalAlign]]\" vertical-align=\"[[verticalAlign]]\" dynamic-align=\"[[dynamicAlign]]\" horizontal-offset=\"[[horizontalOffset]]\" vertical-offset=\"[[verticalOffset]]\" no-overlap=\"[[noOverlap]]\" open-animation-config=\"[[openAnimationConfig]]\" close-animation-config=\"[[closeAnimationConfig]]\" no-animations=\"[[noAnimations]]\" focus-target=\"[[_dropdownContent]]\" allow-outside-scroll=\"[[allowOutsideScroll]]\" restore-focus-on-close=\"[[restoreFocusOnClose]]\" on-iron-overlay-canceled=\"__onIronOverlayCanceled\">\n      <div slot=\"dropdown-content\" class=\"dropdown-content\">\n        <slot id=\"content\" name=\"dropdown-content\"></slot>\n      </div>\n    </iron-dropdown>\n`,\n\n  is: 'paper-menu-button',\n\n  /**\n   * Fired when the dropdown opens.\n   *\n   * @event paper-dropdown-open\n   */\n\n  /**\n   * Fired when the dropdown closes.\n   *\n   * @event paper-dropdown-close\n   */\n\n  behaviors: [IronA11yKeysBehavior, IronControlState],\n\n  properties: {\n    /**\n     * True if the content is currently displayed.\n     */\n    opened:\n        {type: Boolean, value: false, notify: true, observer: '_openedChanged'},\n\n    /**\n     * The orientation against which to align the menu dropdown\n     * horizontally relative to the dropdown trigger.\n     */\n    horizontalAlign: {type: String, value: 'left', reflectToAttribute: true},\n\n    /**\n     * The orientation against which to align the menu dropdown\n     * vertically relative to the dropdown trigger.\n     */\n    verticalAlign: {type: String, value: 'top', reflectToAttribute: true},\n\n    /**\n     * If true, the `horizontalAlign` and `verticalAlign` properties will\n     * be considered preferences instead of strict requirements when\n     * positioning the dropdown and may be changed if doing so reduces\n     * the area of the dropdown falling outside of `fitInto`.\n     */\n    dynamicAlign: {type: Boolean},\n\n    /**\n     * A pixel value that will be added to the position calculated for the\n     * given `horizontalAlign`. Use a negative value to offset to the\n     * left, or a positive value to offset to the right.\n     */\n    horizontalOffset: {type: Number, value: 0, notify: true},\n\n    /**\n     * A pixel value that will be added to the position calculated for the\n     * given `verticalAlign`. Use a negative value to offset towards the\n     * top, or a positive value to offset towards the bottom.\n     */\n    verticalOffset: {type: Number, value: 0, notify: true},\n\n    /**\n     * If true, the dropdown will be positioned so that it doesn't overlap\n     * the button.\n     */\n    noOverlap: {type: Boolean},\n\n    /**\n     * Set to true to disable animations when opening and closing the\n     * dropdown.\n     */\n    noAnimations: {type: Boolean, value: false},\n\n    /**\n     * Set to true to disable automatically closing the dropdown after\n     * a selection has been made.\n     */\n    ignoreSelect: {type: Boolean, value: false},\n\n    /**\n     * Set to true to enable automatically closing the dropdown after an\n     * item has been activated, even if the selection did not change.\n     */\n    closeOnActivate: {type: Boolean, value: false},\n\n    /**\n     * An animation config. If provided, this will be used to animate the\n     * opening of the dropdown.\n     */\n    openAnimationConfig: {\n      type: Object,\n      value: function() {\n        return [\n          {name: 'fade-in-animation', timing: {delay: 100, duration: 200}},\n          {\n            name: 'paper-menu-grow-width-animation',\n            timing: {\n              delay: 100,\n              duration: 150,\n              easing: config.ANIMATION_CUBIC_BEZIER\n            }\n          },\n          {\n            name: 'paper-menu-grow-height-animation',\n            timing: {\n              delay: 100,\n              duration: 275,\n              easing: config.ANIMATION_CUBIC_BEZIER\n            }\n          }\n        ];\n      }\n    },\n\n    /**\n     * An animation config. If provided, this will be used to animate the\n     * closing of the dropdown.\n     */\n    closeAnimationConfig: {\n      type: Object,\n      value: function() {\n        return [\n          {name: 'fade-out-animation', timing: {duration: 150}},\n          {\n            name: 'paper-menu-shrink-width-animation',\n            timing: {\n              delay: 100,\n              duration: 50,\n              easing: config.ANIMATION_CUBIC_BEZIER\n            }\n          },\n          {\n            name: 'paper-menu-shrink-height-animation',\n            timing: {duration: 200, easing: 'ease-in'}\n          }\n        ];\n      }\n    },\n\n    /**\n     * By default, the dropdown will constrain scrolling on the page\n     * to itself when opened.\n     * Set to true in order to prevent scroll from being constrained\n     * to the dropdown when it opens.\n     */\n    allowOutsideScroll: {type: Boolean, value: false},\n\n    /**\n     * Whether focus should be restored to the button when the menu closes.\n     */\n    restoreFocusOnClose: {type: Boolean, value: true},\n\n    /**\n     * This is the element intended to be bound as the focus target\n     * for the `iron-dropdown` contained by `paper-menu-button`.\n     */\n    _dropdownContent: {type: Object}\n  },\n\n  hostAttributes: {role: 'group', 'aria-haspopup': 'true'},\n\n  listeners:\n      {'iron-activate': '_onIronActivate', 'iron-select': '_onIronSelect'},\n\n  /**\n   * The content element that is contained by the menu button, if any.\n   */\n  get contentElement() {\n    // Polymer 2.x returns slot.assignedNodes which can contain text nodes.\n    var nodes = dom(this.$.content).getDistributedNodes();\n    for (var i = 0, l = nodes.length; i < l; i++) {\n      if (nodes[i].nodeType === Node.ELEMENT_NODE) {\n        return nodes[i];\n      }\n    }\n  },\n\n  /**\n   * Toggles the dropdown content between opened and closed.\n   */\n  toggle: function() {\n    if (this.opened) {\n      this.close();\n    } else {\n      this.open();\n    }\n  },\n\n  /**\n   * Make the dropdown content appear as an overlay positioned relative\n   * to the dropdown trigger.\n   */\n  open: function() {\n    if (this.disabled) {\n      return;\n    }\n\n    this.$.dropdown.open();\n  },\n\n  /**\n   * Hide the dropdown content.\n   */\n  close: function() {\n    this.$.dropdown.close();\n  },\n\n  /**\n   * When an `iron-select` event is received, the dropdown should\n   * automatically close on the assumption that a value has been chosen.\n   *\n   * @param {CustomEvent} event A CustomEvent instance with type\n   * set to `\"iron-select\"`.\n   */\n  _onIronSelect: function(event) {\n    if (!this.ignoreSelect) {\n      this.close();\n    }\n  },\n\n  /**\n   * Closes the dropdown when an `iron-activate` event is received if\n   * `closeOnActivate` is true.\n   *\n   * @param {CustomEvent} event A CustomEvent of type 'iron-activate'.\n   */\n  _onIronActivate: function(event) {\n    if (this.closeOnActivate) {\n      this.close();\n    }\n  },\n\n  /**\n   * When the dropdown opens, the `paper-menu-button` fires `paper-open`.\n   * When the dropdown closes, the `paper-menu-button` fires `paper-close`.\n   *\n   * @param {boolean} opened True if the dropdown is opened, otherwise false.\n   * @param {boolean} oldOpened The previous value of `opened`.\n   */\n  _openedChanged: function(opened, oldOpened) {\n    if (opened) {\n      // TODO(cdata): Update this when we can measure changes in distributed\n      // children in an idiomatic way.\n      // We poke this property in case the element has changed. This will\n      // cause the focus target for the `iron-dropdown` to be updated as\n      // necessary:\n      this._dropdownContent = this.contentElement;\n      this.fire('paper-dropdown-open');\n    } else if (oldOpened != null) {\n      this.fire('paper-dropdown-close');\n    }\n  },\n\n  /**\n   * If the dropdown is open when disabled becomes true, close the\n   * dropdown.\n   *\n   * @param {boolean} disabled True if disabled, otherwise false.\n   */\n  _disabledChanged: function(disabled) {\n    IronControlState._disabledChanged.apply(this, arguments);\n    if (disabled && this.opened) {\n      this.close();\n    }\n  },\n\n  __onIronOverlayCanceled: function(event) {\n    var uiEvent = event.detail;\n    var trigger = this.$.trigger;\n    var path = dom(uiEvent).path;\n\n    if (path.indexOf(trigger) > -1) {\n      event.preventDefault();\n    }\n  }\n});\n\nObject.keys(config).forEach(function(key) {\n  PaperMenuButton[key] = config[key];\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/iron-iconset-svg/iron-iconset-svg.js';\nconst $_documentContainer = document.createElement('template');\n$_documentContainer.setAttribute('style', 'display: none;');\n\n$_documentContainer.innerHTML =\n    `<iron-iconset-svg name=\"paper-dropdown-menu\" size=\"24\">\n<svg><defs>\n<g id=\"arrow-drop-down\"><path d=\"M7 10l5 5 5-5z\"></path></g>\n</defs></svg>\n</iron-iconset-svg>`;\n\ndocument.head.appendChild($_documentContainer.content);\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/paper-styles/default-theme.js';\nconst $_documentContainer = document.createElement('template');\n$_documentContainer.setAttribute('style', 'display: none;');\n\n$_documentContainer.innerHTML =\n    `<dom-module id=\"paper-dropdown-menu-shared-styles\">\n  <template>\n    <style>\n      :host {\n        display: inline-block;\n        position: relative;\n        text-align: left;\n\n        /* NOTE(cdata): Both values are needed, since some phones require the\n         * value to be \\`transparent\\`.\n         */\n        -webkit-tap-highlight-color: rgba(0,0,0,0);\n        -webkit-tap-highlight-color: transparent;\n\n        --paper-input-container-input: {\n          overflow: hidden;\n          white-space: nowrap;\n          text-overflow: ellipsis;\n          max-width: 100%;\n          box-sizing: border-box;\n          cursor: pointer;\n        };\n\n        @apply --paper-dropdown-menu;\n      }\n\n      :host([disabled]) {\n        @apply --paper-dropdown-menu-disabled;\n      }\n\n      :host([noink]) paper-ripple {\n        display: none;\n      }\n\n      :host([no-label-float]) paper-ripple {\n        top: 8px;\n      }\n\n      paper-ripple {\n        top: 12px;\n        left: 0px;\n        bottom: 8px;\n        right: 0px;\n\n        @apply --paper-dropdown-menu-ripple;\n      }\n\n      paper-menu-button {\n        display: block;\n        padding: 0;\n\n        @apply --paper-dropdown-menu-button;\n      }\n\n      paper-input {\n        @apply --paper-dropdown-menu-input;\n      }\n\n      iron-icon {\n        color: var(--disabled-text-color);\n\n        @apply --paper-dropdown-menu-icon;\n      }\n    </style>\n  </template>\n</dom-module>`;\n\ndocument.head.appendChild($_documentContainer.content);\n","import { HassEntity } from \"home-assistant-js-websocket\";\nimport computeObjectId from \"./compute_object_id\";\n\nexport default (stateObj: HassEntity): string =>\n  stateObj.attributes.friendly_name === undefined\n    ? computeObjectId(stateObj.entity_id).replace(/_/g, \" \")\n    : stateObj.attributes.friendly_name || \"\";\n","/**\n * Return the icon to be used for a domain.\n *\n * Optionally pass in a state to influence the domain icon.\n */\nimport { DEFAULT_DOMAIN_ICON } from \"../const\";\n\nconst fixedIcons = {\n  alert: \"hass:alert\",\n  alexa: \"hass:amazon-alexa\",\n  automation: \"hass:playlist-play\",\n  calendar: \"hass:calendar\",\n  camera: \"hass:video\",\n  climate: \"hass:thermostat\",\n  configurator: \"hass:settings\",\n  conversation: \"hass:text-to-speech\",\n  device_tracker: \"hass:account\",\n  fan: \"hass:fan\",\n  google_assistant: \"hass:google-assistant\",\n  group: \"hass:google-circles-communities\",\n  history_graph: \"hass:chart-line\",\n  homeassistant: \"hass:home-assistant\",\n  homekit: \"hass:home-automation\",\n  image_processing: \"hass:image-filter-frames\",\n  input_boolean: \"hass:drawing\",\n  input_datetime: \"hass:calendar-clock\",\n  input_number: \"hass:ray-vertex\",\n  input_select: \"hass:format-list-bulleted\",\n  input_text: \"hass:textbox\",\n  light: \"hass:lightbulb\",\n  mailbox: \"hass:mailbox\",\n  notify: \"hass:comment-alert\",\n  person: \"hass:account\",\n  plant: \"hass:flower\",\n  proximity: \"hass:apple-safari\",\n  remote: \"hass:remote\",\n  scene: \"hass:google-pages\",\n  script: \"hass:file-document\",\n  sensor: \"hass:eye\",\n  simple_alarm: \"hass:bell\",\n  sun: \"hass:white-balance-sunny\",\n  switch: \"hass:flash\",\n  timer: \"hass:timer\",\n  updater: \"hass:cloud-upload\",\n  vacuum: \"hass:robot-vacuum\",\n  water_heater: \"hass:thermometer\",\n  weather: \"hass:weather-cloudy\",\n  weblink: \"hass:open-in-new\",\n};\n\nexport default function domainIcon(domain: string, state?: string): string {\n  if (domain in fixedIcons) {\n    return fixedIcons[domain];\n  }\n\n  switch (domain) {\n    case \"alarm_control_panel\":\n      switch (state) {\n        case \"armed_home\":\n          return \"hass:bell-plus\";\n        case \"armed_night\":\n          return \"hass:bell-sleep\";\n        case \"disarmed\":\n          return \"hass:bell-outline\";\n        case \"triggered\":\n          return \"hass:bell-ring\";\n        default:\n          return \"hass:bell\";\n      }\n\n    case \"binary_sensor\":\n      return state && state === \"off\"\n        ? \"hass:radiobox-blank\"\n        : \"hass:checkbox-marked-circle\";\n\n    case \"cover\":\n      return state === \"closed\" ? \"hass:window-closed\" : \"hass:window-open\";\n\n    case \"lock\":\n      return state && state === \"unlocked\" ? \"hass:lock-open\" : \"hass:lock\";\n\n    case \"media_player\":\n      return state && state !== \"off\" && state !== \"idle\"\n        ? \"hass:cast-connected\"\n        : \"hass:cast\";\n\n    case \"zwave\":\n      switch (state) {\n        case \"dead\":\n          return \"hass:emoticon-dead\";\n        case \"sleeping\":\n          return \"hass:sleep\";\n        case \"initializing\":\n          return \"hass:timer-sand\";\n        default:\n          return \"hass:z-wave\";\n      }\n\n    default:\n      // tslint:disable-next-line\n      console.warn(\n        \"Unable to find icon for domain \" + domain + \" (\" + state + \")\"\n      );\n      return DEFAULT_DOMAIN_ICON;\n  }\n}\n","import { Constructor } from \"lit-element\";\nimport \"@polymer/iron-icon/iron-icon\";\n// Not duplicate, this is for typing.\n// tslint:disable-next-line\nimport { IronIconElement } from \"@polymer/iron-icon/iron-icon\";\n\nconst ironIconClass = customElements.get(\"iron-icon\") as Constructor<\n  IronIconElement\n>;\n\nlet loaded = false;\n\nexport class HaIcon extends ironIconClass {\n  private _iconsetName?: string;\n\n  public listen(\n    node: EventTarget | null,\n    eventName: string,\n    methodName: string\n  ): void {\n    super.listen(node, eventName, methodName);\n\n    if (!loaded && this._iconsetName === \"mdi\") {\n      loaded = true;\n      import(/* webpackChunkName: \"mdi-icons\" */ \"../resources/mdi-icons\");\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-icon\": HaIcon;\n  }\n}\n\ncustomElements.define(\"ha-icon\", HaIcon);\n","import { HassEntity } from \"home-assistant-js-websocket\";\nimport computeDomain from \"./compute_domain\";\n\nexport default function computeStateDomain(stateObj: HassEntity) {\n  return computeDomain(stateObj.entity_id);\n}\n","import {\n  LitElement,\n  TemplateResult,\n  css,\n  CSSResult,\n  html,\n  property,\n  PropertyValues,\n  query,\n} from \"lit-element\";\nimport \"../ha-icon\";\nimport computeStateDomain from \"../../common/entity/compute_state_domain\";\nimport stateIcon from \"../../common/entity/state_icon\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\n// Not duplicate, this is for typing.\n// tslint:disable-next-line\nimport { HaIcon } from \"../ha-icon\";\nimport { HomeAssistant } from \"../../types\";\n\nclass StateBadge extends LitElement {\n  public hass?: HomeAssistant;\n  @property() public stateObj?: HassEntity;\n  @property() public overrideIcon?: string;\n  @property() public overrideImage?: string;\n  @query(\"ha-icon\") private _icon!: HaIcon;\n\n  protected render(): TemplateResult | void {\n    const stateObj = this.stateObj;\n\n    if (!stateObj) {\n      return html``;\n    }\n\n    return html`\n      <ha-icon\n        id=\"icon\"\n        data-domain=${computeStateDomain(stateObj)}\n        data-state=${stateObj.state}\n        .icon=${this.overrideIcon || stateIcon(stateObj)}\n      ></ha-icon>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    if (!changedProps.has(\"stateObj\") || !this.stateObj) {\n      return;\n    }\n    const stateObj = this.stateObj;\n\n    const iconStyle: Partial<CSSStyleDeclaration> = {\n      color: \"\",\n      filter: \"\",\n    };\n    const hostStyle: Partial<CSSStyleDeclaration> = {\n      backgroundImage: \"\",\n    };\n    if (stateObj) {\n      // hide icon if we have entity picture\n      if (\n        (stateObj.attributes.entity_picture && !this.overrideIcon) ||\n        this.overrideImage\n      ) {\n        let imageUrl = this.overrideImage || stateObj.attributes.entity_picture;\n        if (this.hass) {\n          imageUrl = this.hass.hassUrl(imageUrl);\n        }\n        hostStyle.backgroundImage = `url(${imageUrl})`;\n        iconStyle.display = \"none\";\n      } else {\n        if (stateObj.attributes.hs_color) {\n          const hue = stateObj.attributes.hs_color[0];\n          const sat = stateObj.attributes.hs_color[1];\n          if (sat > 10) {\n            iconStyle.color = `hsl(${hue}, 100%, ${100 - sat / 2}%)`;\n          }\n        }\n        if (stateObj.attributes.brightness) {\n          const brightness = stateObj.attributes.brightness;\n          if (typeof brightness !== \"number\") {\n            const errorMessage = `Type error: state-badge expected number, but type of ${\n              stateObj.entity_id\n            }.attributes.brightness is ${typeof brightness} (${brightness})`;\n            // tslint:disable-next-line\n            console.warn(errorMessage);\n          }\n          // lowest brighntess will be around 50% (that's pretty dark)\n          iconStyle.filter = `brightness(${(brightness + 245) / 5}%)`;\n        }\n      }\n    }\n    Object.assign(this._icon.style, iconStyle);\n    Object.assign(this.style, hostStyle);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        position: relative;\n        display: inline-block;\n        width: 40px;\n        color: var(--paper-item-icon-color, #44739e);\n        border-radius: 50%;\n        height: 40px;\n        text-align: center;\n        background-size: cover;\n        line-height: 40px;\n      }\n\n      ha-icon {\n        transition: color 0.3s ease-in-out, filter 0.3s ease-in-out;\n      }\n\n      /* Color the icon if light or sun is on */\n      ha-icon[data-domain=\"light\"][data-state=\"on\"],\n      ha-icon[data-domain=\"switch\"][data-state=\"on\"],\n      ha-icon[data-domain=\"binary_sensor\"][data-state=\"on\"],\n      ha-icon[data-domain=\"fan\"][data-state=\"on\"],\n      ha-icon[data-domain=\"sun\"][data-state=\"above_horizon\"] {\n        color: var(--paper-item-icon-active-color, #fdd835);\n      }\n\n      /* Color the icon if unavailable */\n      ha-icon[data-state=\"unavailable\"] {\n        color: var(--state-icon-unavailable-color);\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"state-badge\": StateBadge;\n  }\n}\n\ncustomElements.define(\"state-badge\", StateBadge);\n","/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\nimport '@polymer/iron-flex-layout/iron-flex-layout.js';\nimport '@polymer/paper-styles/typography.js';\nimport './paper-item-shared-styles.js';\n\nimport {Polymer} from '@polymer/polymer/lib/legacy/polymer-fn.js';\nimport {html} from '@polymer/polymer/lib/utils/html-tag.js';\n\nimport {PaperItemBehavior} from './paper-item-behavior.js';\n\n/*\n`<paper-icon-item>` is a convenience element to make an item with icon. It is an\ninteractive list item with a fixed-width icon area, according to Material\nDesign. This is useful if the icons are of varying widths, but you want the item\nbodies to line up. Use this like a `<paper-item>`. The child node with the slot\nname `item-icon` is placed in the icon area.\n\n    <paper-icon-item>\n      <iron-icon icon=\"favorite\" slot=\"item-icon\"></iron-icon>\n      Favorite\n    </paper-icon-item>\n    <paper-icon-item>\n      <div class=\"avatar\" slot=\"item-icon\"></div>\n      Avatar\n    </paper-icon-item>\n\n### Styling\n\nThe following custom properties and mixins are available for styling:\n\nCustom property | Description | Default\n----------------|-------------|----------\n`--paper-item-icon-width` | Width of the icon area | `56px`\n`--paper-item-icon` | Mixin applied to the icon area | `{}`\n`--paper-icon-item` | Mixin applied to the item | `{}`\n`--paper-item-selected-weight` | The font weight of a selected item | `bold`\n`--paper-item-selected` | Mixin applied to selected paper-items | `{}`\n`--paper-item-disabled-color` | The color for disabled paper-items | `--disabled-text-color`\n`--paper-item-disabled` | Mixin applied to disabled paper-items | `{}`\n`--paper-item-focused` | Mixin applied to focused paper-items | `{}`\n`--paper-item-focused-before` | Mixin applied to :before focused paper-items | `{}`\n\n*/\nPolymer({\n  _template: html`\n    <style include=\"paper-item-shared-styles\"></style>\n    <style>\n      :host {\n        @apply --layout-horizontal;\n        @apply --layout-center;\n        @apply --paper-font-subhead;\n\n        @apply --paper-item;\n        @apply --paper-icon-item;\n      }\n\n      .content-icon {\n        @apply --layout-horizontal;\n        @apply --layout-center;\n\n        width: var(--paper-item-icon-width, 56px);\n        @apply --paper-item-icon;\n      }\n    </style>\n\n    <div id=\"contentIcon\" class=\"content-icon\">\n      <slot name=\"item-icon\"></slot>\n    </div>\n    <slot></slot>\n`,\n\n  is: 'paper-icon-item',\n  behaviors: [PaperItemBehavior]\n});\n","/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\n\nimport {IronOverlayBehavior} from '@polymer/iron-overlay-behavior/iron-overlay-behavior.js';\nimport {dom} from '@polymer/polymer/lib/legacy/polymer.dom.js';\n\n/**\n  Use `Polymer.PaperDialogBehavior` and `paper-dialog-shared-styles.html` to\n  implement a Material Design dialog.\n\n  For example, if `<paper-dialog-impl>` implements this behavior:\n\n      <paper-dialog-impl>\n          <h2>Header</h2>\n          <div>Dialog body</div>\n          <div class=\"buttons\">\n              <paper-button dialog-dismiss>Cancel</paper-button>\n              <paper-button dialog-confirm>Accept</paper-button>\n          </div>\n      </paper-dialog-impl>\n\n  `paper-dialog-shared-styles.html` provide styles for a header, content area,\n  and an action area for buttons. Use the `<h2>` tag for the header and the\n  `buttons` class for the action area. You can use the `paper-dialog-scrollable`\n  element (in its own repository) if you need a scrolling content area.\n\n  Use the `dialog-dismiss` and `dialog-confirm` attributes on interactive\n  controls to close the dialog. If the user dismisses the dialog with\n  `dialog-confirm`, the `closingReason` will update to include `confirmed:\n  true`.\n\n  ### Accessibility\n\n  This element has `role=\"dialog\"` by default. Depending on the context, it may\n  be more appropriate to override this attribute with `role=\"alertdialog\"`.\n\n  If `modal` is set, the element will prevent the focus from exiting the\n  element. It will also ensure that focus remains in the dialog.\n\n  @hero hero.svg\n  @demo demo/index.html\n  @polymerBehavior PaperDialogBehavior\n */\nexport const PaperDialogBehaviorImpl = {\n\n  hostAttributes: {'role': 'dialog', 'tabindex': '-1'},\n\n  properties: {\n\n    /**\n     * If `modal` is true, this implies `no-cancel-on-outside-click`,\n     * `no-cancel-on-esc-key` and `with-backdrop`.\n     */\n    modal: {type: Boolean, value: false},\n\n    __readied: {type: Boolean, value: false}\n\n  },\n\n  observers: ['_modalChanged(modal, __readied)'],\n\n  listeners: {'tap': '_onDialogClick'},\n\n  /**\n   * @return {void}\n   */\n  ready: function() {\n    // Only now these properties can be read.\n    this.__prevNoCancelOnOutsideClick = this.noCancelOnOutsideClick;\n    this.__prevNoCancelOnEscKey = this.noCancelOnEscKey;\n    this.__prevWithBackdrop = this.withBackdrop;\n    this.__readied = true;\n  },\n\n  _modalChanged: function(modal, readied) {\n    // modal implies noCancelOnOutsideClick, noCancelOnEscKey and withBackdrop.\n    // We need to wait for the element to be ready before we can read the\n    // properties values.\n    if (!readied) {\n      return;\n    }\n\n    if (modal) {\n      this.__prevNoCancelOnOutsideClick = this.noCancelOnOutsideClick;\n      this.__prevNoCancelOnEscKey = this.noCancelOnEscKey;\n      this.__prevWithBackdrop = this.withBackdrop;\n      this.noCancelOnOutsideClick = true;\n      this.noCancelOnEscKey = true;\n      this.withBackdrop = true;\n    } else {\n      // If the value was changed to false, let it false.\n      this.noCancelOnOutsideClick =\n          this.noCancelOnOutsideClick && this.__prevNoCancelOnOutsideClick;\n      this.noCancelOnEscKey =\n          this.noCancelOnEscKey && this.__prevNoCancelOnEscKey;\n      this.withBackdrop = this.withBackdrop && this.__prevWithBackdrop;\n    }\n  },\n\n  _updateClosingReasonConfirmed: function(confirmed) {\n    this.closingReason = this.closingReason || {};\n    this.closingReason.confirmed = confirmed;\n  },\n\n  /**\n   * Will dismiss the dialog if user clicked on an element with dialog-dismiss\n   * or dialog-confirm attribute.\n   */\n  _onDialogClick: function(event) {\n    // Search for the element with dialog-confirm or dialog-dismiss,\n    // from the root target until this (excluded).\n    var path = dom(event).path;\n    for (var i = 0, l = path.indexOf(this); i < l; i++) {\n      var target = path[i];\n      if (target.hasAttribute &&\n          (target.hasAttribute('dialog-dismiss') ||\n           target.hasAttribute('dialog-confirm'))) {\n        this._updateClosingReasonConfirmed(\n            target.hasAttribute('dialog-confirm'));\n        this.close();\n        event.stopPropagation();\n        break;\n      }\n    }\n  }\n\n};\n\n/** @polymerBehavior */\nexport const PaperDialogBehavior =\n    [IronOverlayBehavior, PaperDialogBehaviorImpl];\n","/** Compute the object ID of a state. */\nexport default function computeObjectId(entityId: string): string {\n  return entityId.substr(entityId.indexOf(\".\") + 1);\n}\n","import \"@polymer/paper-icon-button/paper-icon-button\";\nimport \"@polymer/paper-input/paper-input\";\nimport \"@polymer/paper-item/paper-icon-item\";\nimport \"@polymer/paper-item/paper-item-body\";\nimport \"@vaadin/vaadin-combo-box/vaadin-combo-box-light\";\nimport memoizeOne from \"memoize-one\";\n\nimport \"./state-badge\";\n\nimport computeStateName from \"../../common/entity/compute_state_name\";\nimport {\n  LitElement,\n  TemplateResult,\n  html,\n  css,\n  CSSResult,\n  property,\n  PropertyValues,\n} from \"lit-element\";\nimport { HomeAssistant } from \"../../types\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { PolymerChangedEvent } from \"../../polymer-types\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\n\nexport type HaEntityPickerEntityFilterFunc = (entityId: HassEntity) => boolean;\n\nconst rowRenderer = (\n  root: HTMLElement,\n  _owner,\n  model: { item: HassEntity }\n) => {\n  if (!root.firstElementChild) {\n    root.innerHTML = `\n      <style>\n        paper-icon-item {\n          margin: -10px;\n          padding: 0;\n        }\n      </style>\n      <paper-icon-item>\n        <state-badge state-obj=\"[[item]]\" slot=\"item-icon\"></state-badge>\n        <paper-item-body two-line=\"\">\n          <div class='name'>[[_computeStateName(item)]]</div>\n          <div secondary>[[item.entity_id]]</div>\n        </paper-item-body>\n      </paper-icon-item>\n    `;\n  }\n\n  root.querySelector(\"state-badge\")!.stateObj = model.item;\n  root.querySelector(\".name\")!.textContent = computeStateName(model.item);\n  root.querySelector(\"[secondary]\")!.textContent = model.item.entity_id;\n};\n\nclass HaEntityPicker extends LitElement {\n  @property({ type: Boolean }) public autofocus?: boolean;\n  @property({ type: Boolean }) public disabled?: boolean;\n  @property({ type: Boolean, attribute: \"allow-custom-entity\" })\n  public allowCustomEntity;\n  @property() public hass?: HomeAssistant;\n  @property() public label?: string;\n  @property() public value?: string;\n  @property({ attribute: \"domain-filter\" }) public domainFilter?: string;\n  @property() public entityFilter?: HaEntityPickerEntityFilterFunc;\n  @property({ type: Boolean }) private _opened?: boolean;\n  @property() private _hass?: HomeAssistant;\n\n  private _getStates = memoizeOne(\n    (\n      hass: this[\"hass\"],\n      domainFilter: this[\"domainFilter\"],\n      entityFilter: this[\"entityFilter\"]\n    ) => {\n      let states: HassEntity[] = [];\n\n      if (!hass) {\n        return [];\n      }\n      let entityIds = Object.keys(hass.states);\n\n      if (domainFilter) {\n        entityIds = entityIds.filter(\n          (eid) => eid.substr(0, eid.indexOf(\".\")) === domainFilter\n        );\n      }\n\n      states = entityIds.sort().map((key) => hass!.states[key]);\n\n      if (entityFilter) {\n        states = states.filter(\n          (stateObj) =>\n            // We always want to include the entity of the current value\n            stateObj.entity_id === this.value || entityFilter!(stateObj)\n        );\n      }\n      return states;\n    }\n  );\n\n  protected updated(changedProps: PropertyValues) {\n    super.updated(changedProps);\n\n    if (changedProps.has(\"hass\") && !this._opened) {\n      this._hass = this.hass;\n    }\n  }\n\n  protected render(): TemplateResult | void {\n    const states = this._getStates(\n      this._hass,\n      this.domainFilter,\n      this.entityFilter\n    );\n\n    return html`\n      <vaadin-combo-box-light\n        item-value-path=\"entity_id\"\n        item-label-path=\"entity_id\"\n        .items=${states}\n        .value=${this._value}\n        .allowCustomValue=${this.allowCustomEntity}\n        .renderer=${rowRenderer}\n        @opened-changed=${this._openedChanged}\n        @value-changed=${this._valueChanged}\n      >\n        <paper-input\n          .autofocus=${this.autofocus}\n          .label=${this.label === undefined && this._hass\n            ? this._hass.localize(\"ui.components.entity.entity-picker.entity\")\n            : this.label}\n          .value=${this._value}\n          .disabled=${this.disabled}\n          class=\"input\"\n          autocapitalize=\"none\"\n          autocomplete=\"off\"\n          autocorrect=\"off\"\n          spellcheck=\"false\"\n        >\n          ${this.value\n            ? html`\n                <paper-icon-button\n                  aria-label=\"Clear\"\n                  slot=\"suffix\"\n                  class=\"clear-button\"\n                  icon=\"hass:close\"\n                  no-ripple\n                >\n                  Clear\n                </paper-icon-button>\n              `\n            : \"\"}\n          ${states.length > 0\n            ? html`\n                <paper-icon-button\n                  aria-label=\"Show entities\"\n                  slot=\"suffix\"\n                  class=\"toggle-button\"\n                  .icon=${this._opened ? \"hass:menu-up\" : \"hass:menu-down\"}\n                >\n                  Toggle\n                </paper-icon-button>\n              `\n            : \"\"}\n        </paper-input>\n      </vaadin-combo-box-light>\n    `;\n  }\n\n  private get _value() {\n    return this.value || \"\";\n  }\n\n  private _openedChanged(ev: PolymerChangedEvent<boolean>) {\n    this._opened = ev.detail.value;\n  }\n\n  private _valueChanged(ev: PolymerChangedEvent<string>) {\n    const newValue = ev.detail.value;\n    if (newValue !== this._value) {\n      this.value = ev.detail.value;\n      setTimeout(() => {\n        fireEvent(this, \"value-changed\", { value: this.value });\n        fireEvent(this, \"change\");\n      }, 0);\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      paper-input > paper-icon-button {\n        width: 24px;\n        height: 24px;\n        padding: 2px;\n        color: var(--secondary-text-color);\n      }\n      [hidden] {\n        display: none;\n      }\n    `;\n  }\n}\n\ncustomElements.define(\"ha-entity-picker\", HaEntityPicker);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-entity-picker\": HaEntityPicker;\n  }\n}\n","/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\n/*\n### Styling\n\nThe following custom properties and mixins are available for styling.\n\nCustom property | Description | Default\n----------------|-------------|----------\n`--paper-dialog-background-color` | Dialog background color | `--primary-background-color`\n`--paper-dialog-color` | Dialog foreground color | `--primary-text-color`\n`--paper-dialog` | Mixin applied to the dialog | `{}`\n`--paper-dialog-title` | Mixin applied to the title (`<h2>`) element | `{}`\n`--paper-dialog-button-color` | Button area foreground color | `--default-primary-color`\n*/\nimport '@polymer/polymer/polymer-legacy.js';\nimport '@polymer/iron-flex-layout/iron-flex-layout.js';\nimport '@polymer/paper-styles/default-theme.js';\nimport '@polymer/paper-styles/typography.js';\nimport '@polymer/paper-styles/shadow.js';\nconst $_documentContainer = document.createElement('template');\n$_documentContainer.setAttribute('style', 'display: none;');\n\n$_documentContainer.innerHTML = `<dom-module id=\"paper-dialog-shared-styles\">\n  <template>\n    <style>\n      :host {\n        display: block;\n        margin: 24px 40px;\n\n        background: var(--paper-dialog-background-color, var(--primary-background-color));\n        color: var(--paper-dialog-color, var(--primary-text-color));\n\n        @apply --paper-font-body1;\n        @apply --shadow-elevation-16dp;\n        @apply --paper-dialog;\n      }\n\n      :host > ::slotted(*) {\n        margin-top: 20px;\n        padding: 0 24px;\n      }\n\n      :host > ::slotted(.no-padding) {\n        padding: 0;\n      }\n\n      \n      :host > ::slotted(*:first-child) {\n        margin-top: 24px;\n      }\n\n      :host > ::slotted(*:last-child) {\n        margin-bottom: 24px;\n      }\n\n      /* In 1.x, this selector was \\`:host > ::content h2\\`. In 2.x <slot> allows\n      to select direct children only, which increases the weight of this\n      selector, so we have to re-define first-child/last-child margins below. */\n      :host > ::slotted(h2) {\n        position: relative;\n        margin: 0;\n\n        @apply --paper-font-title;\n        @apply --paper-dialog-title;\n      }\n\n      /* Apply mixin again, in case it sets margin-top. */\n      :host > ::slotted(h2:first-child) {\n        margin-top: 24px;\n        @apply --paper-dialog-title;\n      }\n\n      /* Apply mixin again, in case it sets margin-bottom. */\n      :host > ::slotted(h2:last-child) {\n        margin-bottom: 24px;\n        @apply --paper-dialog-title;\n      }\n\n      :host > ::slotted(.paper-dialog-buttons),\n      :host > ::slotted(.buttons) {\n        position: relative;\n        padding: 8px 8px 8px 24px;\n        margin: 0;\n\n        color: var(--paper-dialog-button-color, var(--primary-color));\n\n        @apply --layout-horizontal;\n        @apply --layout-end-justified;\n      }\n    </style>\n  </template>\n</dom-module>`;\n\ndocument.head.appendChild($_documentContainer.content);\n","/** Return an icon representing a sensor state. */\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { UNIT_C, UNIT_F } from \"../const\";\nimport domainIcon from \"./domain_icon\";\n\nconst fixedDeviceClassIcons = {\n  humidity: \"hass:water-percent\",\n  illuminance: \"hass:brightness-5\",\n  temperature: \"hass:thermometer\",\n  pressure: \"hass:gauge\",\n  power: \"hass:flash\",\n  signal_strength: \"hass:wifi\",\n};\n\nexport default function sensorIcon(state: HassEntity) {\n  const dclass = state.attributes.device_class;\n\n  if (dclass && dclass in fixedDeviceClassIcons) {\n    return fixedDeviceClassIcons[dclass];\n  }\n  if (dclass === \"battery\") {\n    const battery = Number(state.state);\n    if (isNaN(battery)) {\n      return \"hass:battery-unknown\";\n    }\n    const batteryRound = Math.round(battery / 10) * 10;\n    if (batteryRound >= 100) {\n      return \"hass:battery\";\n    }\n    if (batteryRound <= 0) {\n      return \"hass:battery-alert\";\n    }\n    // Will return one of the following icons: (listed so extractor picks up)\n    // hass:battery-10\n    // hass:battery-20\n    // hass:battery-30\n    // hass:battery-40\n    // hass:battery-50\n    // hass:battery-60\n    // hass:battery-70\n    // hass:battery-80\n    // hass:battery-90\n    // We obscure 'hass' in iconname so this name does not get picked up\n    return `${\"hass\"}:battery-${batteryRound}`;\n  }\n\n  const unit = state.attributes.unit_of_measurement;\n  if (unit === UNIT_C || unit === UNIT_F) {\n    return \"hass:thermometer\";\n  }\n  return domainIcon(\"sensor\");\n}\n","/** Return an icon representing a state. */\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { DEFAULT_DOMAIN_ICON } from \"../const\";\n\nimport computeDomain from \"./compute_domain\";\nimport domainIcon from \"./domain_icon\";\n\nimport binarySensorIcon from \"./binary_sensor_icon\";\nimport coverIcon from \"./cover_icon\";\nimport sensorIcon from \"./sensor_icon\";\nimport inputDateTimeIcon from \"./input_dateteime_icon\";\n\nconst domainIcons = {\n  binary_sensor: binarySensorIcon,\n  cover: coverIcon,\n  sensor: sensorIcon,\n  input_datetime: inputDateTimeIcon,\n};\n\nexport default function stateIcon(state: HassEntity) {\n  if (!state) {\n    return DEFAULT_DOMAIN_ICON;\n  }\n  if (state.attributes.icon) {\n    return state.attributes.icon;\n  }\n\n  const domain = computeDomain(state.entity_id);\n\n  if (domain in domainIcons) {\n    return domainIcons[domain](state);\n  }\n  return domainIcon(domain, state.state);\n}\n","import { HassEntity } from \"home-assistant-js-websocket\";\n\n/** Return an icon representing a binary sensor state. */\n\nexport default function binarySensorIcon(state: HassEntity) {\n  const activated = state.state && state.state === \"off\";\n  switch (state.attributes.device_class) {\n    case \"battery\":\n      return activated ? \"hass:battery\" : \"hass:battery-outline\";\n    case \"cold\":\n      return activated ? \"hass:thermometer\" : \"hass:snowflake\";\n    case \"connectivity\":\n      return activated ? \"hass:server-network-off\" : \"hass:server-network\";\n    case \"door\":\n      return activated ? \"hass:door-closed\" : \"hass:door-open\";\n    case \"garage_door\":\n      return activated ? \"hass:garage\" : \"hass:garage-open\";\n    case \"gas\":\n    case \"power\":\n    case \"problem\":\n    case \"safety\":\n    case \"smoke\":\n      return activated ? \"hass:shield-check\" : \"hass:alert\";\n    case \"heat\":\n      return activated ? \"hass:thermometer\" : \"hass:fire\";\n    case \"light\":\n      return activated ? \"hass:brightness-5\" : \"hass:brightness-7\";\n    case \"lock\":\n      return activated ? \"hass:lock\" : \"hass:lock-open\";\n    case \"moisture\":\n      return activated ? \"hass:water-off\" : \"hass:water\";\n    case \"motion\":\n      return activated ? \"hass:walk\" : \"hass:run\";\n    case \"occupancy\":\n      return activated ? \"hass:home-outline\" : \"hass:home\";\n    case \"opening\":\n      return activated ? \"hass:square\" : \"hass:square-outline\";\n    case \"plug\":\n      return activated ? \"hass:power-plug-off\" : \"hass:power-plug\";\n    case \"presence\":\n      return activated ? \"hass:home-outline\" : \"hass:home\";\n    case \"sound\":\n      return activated ? \"hass:music-note-off\" : \"hass:music-note\";\n    case \"vibration\":\n      return activated ? \"hass:crop-portrait\" : \"hass:vibrate\";\n    case \"window\":\n      return activated ? \"hass:window-closed\" : \"hass:window-open\";\n    default:\n      return activated ? \"hass:radiobox-blank\" : \"hass:checkbox-marked-circle\";\n  }\n}\n","/** Return an icon representing a cover state. */\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport domainIcon from \"./domain_icon\";\n\nexport default function coverIcon(state: HassEntity): string {\n  const open = state.state !== \"closed\";\n  switch (state.attributes.device_class) {\n    case \"garage\":\n      return open ? \"hass:garage-open\" : \"hass:garage\";\n    case \"door\":\n      return open ? \"hass:door-open\" : \"hass:door-closed\";\n    case \"shutter\":\n      return open ? \"hass:window-shutter-open\" : \"hass:window-shutter\";\n    case \"blind\":\n      return open ? \"hass:blinds-open\" : \"hass:blinds\";\n    case \"window\":\n      return open ? \"hass:window-open\" : \"hass:window-closed\";\n    default:\n      return domainIcon(\"cover\", state.state);\n  }\n}\n","/** Return an icon representing an input datetime state. */\nimport domainIcon from \"./domain_icon\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\n\nexport default function inputDateTimeIcon(state: HassEntity): string {\n  if (!state.attributes.has_date) {\n    return \"hass:clock\";\n  }\n  if (!state.attributes.has_time) {\n    return \"hass:calendar\";\n  }\n  return domainIcon(\"input_datetime\");\n}\n","/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\nimport '@polymer/paper-dialog-behavior/paper-dialog-shared-styles.js';\n\nimport {NeonAnimationRunnerBehavior} from '@polymer/neon-animation/neon-animation-runner-behavior.js';\nimport {PaperDialogBehavior} from '@polymer/paper-dialog-behavior/paper-dialog-behavior.js';\nimport {Polymer} from '@polymer/polymer/lib/legacy/polymer-fn.js';\nimport {html} from '@polymer/polymer/lib/utils/html-tag.js';\n\n/**\nMaterial design:\n[Dialogs](https://www.google.com/design/spec/components/dialogs.html)\n\n`<paper-dialog>` is a dialog with Material Design styling and optional\nanimations when it is opened or closed. It provides styles for a header, content\narea, and an action area for buttons. You can use the\n`<paper-dialog-scrollable>` element (in its own repository) if you need a\nscrolling content area. To autofocus a specific child element after opening the\ndialog, give it the `autofocus` attribute. See `Polymer.PaperDialogBehavior` and\n`Polymer.IronOverlayBehavior` for specifics.\n\nFor example, the following code implements a dialog with a header, scrolling\ncontent area and buttons. Focus will be given to the `dialog-confirm` button\nwhen the dialog is opened.\n\n    <paper-dialog>\n      <h2>Header</h2>\n      <paper-dialog-scrollable>\n        Lorem ipsum...\n      </paper-dialog-scrollable>\n      <div class=\"buttons\">\n        <paper-button dialog-dismiss>Cancel</paper-button>\n        <paper-button dialog-confirm autofocus>Accept</paper-button>\n      </div>\n    </paper-dialog>\n\n### Styling\n\nSee the docs for `Polymer.PaperDialogBehavior` for the custom properties\navailable for styling this element.\n\n### Animations\n\nSet the `entry-animation` and/or `exit-animation` attributes to add an animation\nwhen the dialog is opened or closed. See the documentation in\n[PolymerElements/neon-animation](https://github.com/PolymerElements/neon-animation)\nfor more info.\n\nFor example:\n\n    <script type=\"module\">\n      import '@polymer/neon-animation/animations/fade-out-animation.js';\n      import '@polymer/neon-animation/animations/scale-up-animation.js';\n    </script>\n\n    <paper-dialog entry-animation=\"scale-up-animation\"\n                  exit-animation=\"fade-out-animation\">\n      <h2>Header</h2>\n      <div>Dialog body</div>\n    </paper-dialog>\n\n### Accessibility\n\nSee the docs for `Polymer.PaperDialogBehavior` for accessibility features\nimplemented by this element.\n\n@group Paper Elements\n@element paper-dialog\n@hero hero.svg\n@demo demo/index.html\n*/\nPolymer({\n  _template: html`\n    <style include=\"paper-dialog-shared-styles\"></style>\n    <slot></slot>\n`,\n\n  is: 'paper-dialog',\n  behaviors: [PaperDialogBehavior, NeonAnimationRunnerBehavior],\n  listeners: {'neon-animation-finish': '_onNeonAnimationFinish'},\n\n  _renderOpened: function() {\n    this.cancelAnimation();\n    this.playAnimation('entry');\n  },\n\n  _renderClosed: function() {\n    this.cancelAnimation();\n    this.playAnimation('exit');\n  },\n\n  _onNeonAnimationFinish: function() {\n    if (this.opened) {\n      this._finishRenderOpened();\n    } else {\n      this._finishRenderClosed();\n    }\n  }\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\n/*\n  Fixes issue with not using shadow dom properly in iron-overlay-behavior/icon-focusables-helper.js\n*/\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\n\nimport { IronFocusablesHelper } from \"@polymer/iron-overlay-behavior/iron-focusables-helper.js\";\n\nexport const HaIronFocusablesHelper = {\n  /**\n   * Returns a sorted array of tabbable nodes, including the root node.\n   * It searches the tabbable nodes in the light and shadow dom of the chidren,\n   * sorting the result by tabindex.\n   * @param {!Node} node\n   * @return {!Array<!HTMLElement>}\n   */\n  getTabbableNodes: function(node) {\n    var result = [];\n    // If there is at least one element with tabindex > 0, we need to sort\n    // the final array by tabindex.\n    var needsSortByTabIndex = this._collectTabbableNodes(node, result);\n    if (needsSortByTabIndex) {\n      return IronFocusablesHelper._sortByTabIndex(result);\n    }\n    return result;\n  },\n\n  /**\n   * Searches for nodes that are tabbable and adds them to the `result` array.\n   * Returns if the `result` array needs to be sorted by tabindex.\n   * @param {!Node} node The starting point for the search; added to `result`\n   * if tabbable.\n   * @param {!Array<!HTMLElement>} result\n   * @return {boolean}\n   * @private\n   */\n  _collectTabbableNodes: function(node, result) {\n    // If not an element or not visible, no need to explore children.\n    if (\n      node.nodeType !== Node.ELEMENT_NODE ||\n      !IronFocusablesHelper._isVisible(node)\n    ) {\n      return false;\n    }\n    var element = /** @type {!HTMLElement} */ (node);\n    var tabIndex = IronFocusablesHelper._normalizedTabIndex(element);\n    var needsSort = tabIndex > 0;\n    if (tabIndex >= 0) {\n      result.push(element);\n    }\n\n    // In ShadowDOM v1, tab order is affected by the order of distrubution.\n    // E.g. getTabbableNodes(#root) in ShadowDOM v1 should return [#A, #B];\n    // in ShadowDOM v0 tab order is not affected by the distrubution order,\n    // in fact getTabbableNodes(#root) returns [#B, #A].\n    //  <div id=\"root\">\n    //   <!-- shadow -->\n    //     <slot name=\"a\">\n    //     <slot name=\"b\">\n    //   <!-- /shadow -->\n    //   <input id=\"A\" slot=\"a\">\n    //   <input id=\"B\" slot=\"b\" tabindex=\"1\">\n    //  </div>\n    // TODO(valdrin) support ShadowDOM v1 when upgrading to Polymer v2.0.\n    var children;\n    if (element.localName === \"content\" || element.localName === \"slot\") {\n      children = dom(element).getDistributedNodes();\n    } else {\n      // /////////////////////////\n      // Use shadow root if possible, will check for distributed nodes.\n      // THIS IS THE CHANGED LINE\n      children = dom(element.shadowRoot || element.root || element).children;\n      // /////////////////////////\n    }\n    for (var i = 0; i < children.length; i++) {\n      // Ensure method is always invoked to collect tabbable children.\n      needsSort = this._collectTabbableNodes(children[i], result) || needsSort;\n    }\n    return needsSort;\n  },\n};\n","import \"@polymer/paper-dialog/paper-dialog\";\nimport { mixinBehaviors } from \"@polymer/polymer/lib/legacy/class\";\nimport { HaIronFocusablesHelper } from \"./ha-iron-focusables-helper.js\";\n// tslint:disable-next-line\nimport { PaperDialogElement } from \"@polymer/paper-dialog/paper-dialog\";\n\nconst paperDialogClass = customElements.get(\"paper-dialog\");\n\n// behavior that will override existing iron-overlay-behavior and call the fixed implementation\nconst haTabFixBehaviorImpl = {\n  get _focusableNodes() {\n    return HaIronFocusablesHelper.getTabbableNodes(this);\n  },\n};\n\n// paper-dialog that uses the haTabFixBehaviorImpl behvaior\n// export class HaPaperDialog extends paperDialogClass {}\n// @ts-ignore\nexport class HaPaperDialog\n  extends mixinBehaviors([haTabFixBehaviorImpl], paperDialogClass)\n  implements PaperDialogElement {}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-paper-dialog\": HaPaperDialog;\n  }\n}\ncustomElements.define(\"ha-paper-dialog\", HaPaperDialog);\n","/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\nimport '@polymer/iron-flex-layout/iron-flex-layout.js';\nimport '@polymer/paper-styles/default-theme.js';\n\nimport {PaperDialogBehaviorImpl} from '@polymer/paper-dialog-behavior/paper-dialog-behavior.js';\nimport {Polymer} from '@polymer/polymer/lib/legacy/polymer-fn.js';\nimport {html} from '@polymer/polymer/lib/utils/html-tag.js';\n\n/**\nMaterial design:\n[Dialogs](https://www.google.com/design/spec/components/dialogs.html)\n\n`paper-dialog-scrollable` implements a scrolling area used in a Material Design\ndialog. It shows a divider at the top and/or bottom indicating more content,\ndepending on scroll position. Use this together with elements implementing\n`Polymer.PaperDialogBehavior`.\n\n    <paper-dialog-impl>\n      <h2>Header</h2>\n      <paper-dialog-scrollable>\n        Lorem ipsum...\n      </paper-dialog-scrollable>\n      <div class=\"buttons\">\n        <paper-button>OK</paper-button>\n      </div>\n    </paper-dialog-impl>\n\nIt shows a top divider after scrolling if it is not the first child in its\nparent container, indicating there is more content above. It shows a bottom\ndivider if it is scrollable and it is not the last child in its parent\ncontainer, indicating there is more content below. The bottom divider is hidden\nif it is scrolled to the bottom.\n\nIf `paper-dialog-scrollable` is not a direct child of the element implementing\n`Polymer.PaperDialogBehavior`, remember to set the `dialogElement`:\n\n    <paper-dialog-impl id=\"myDialog\">\n      <h2>Header</h2>\n      <div class=\"my-content-wrapper\">\n        <h4>Sub-header</h4>\n        <paper-dialog-scrollable>\n          Lorem ipsum...\n        </paper-dialog-scrollable>\n      </div>\n      <div class=\"buttons\">\n        <paper-button>OK</paper-button>\n      </div>\n    </paper-dialog-impl>\n\n    <script>\n      var scrollable =\nPolymer.dom(myDialog).querySelector('paper-dialog-scrollable');\n      scrollable.dialogElement = myDialog;\n    </script>\n\n### Styling\nThe following custom properties and mixins are available for styling:\n\nCustom property | Description | Default\n----------------|-------------|----------\n`--paper-dialog-scrollable` | Mixin for the scrollable content | {}\n\n@group Paper Elements\n@element paper-dialog-scrollable\n@demo demo/index.html\n@hero hero.svg\n*/\nPolymer({\n  _template: html`\n    <style>\n\n      :host {\n        display: block;\n        @apply --layout-relative;\n      }\n\n      :host(.is-scrolled:not(:first-child))::before {\n        content: '';\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        height: 1px;\n        background: var(--divider-color);\n      }\n\n      :host(.can-scroll:not(.scrolled-to-bottom):not(:last-child))::after {\n        content: '';\n        position: absolute;\n        bottom: 0;\n        left: 0;\n        right: 0;\n        height: 1px;\n        background: var(--divider-color);\n      }\n\n      .scrollable {\n        padding: 0 24px;\n\n        @apply --layout-scroll;\n        @apply --paper-dialog-scrollable;\n      }\n\n      .fit {\n        @apply --layout-fit;\n      }\n    </style>\n\n    <div id=\"scrollable\" class=\"scrollable\" on-scroll=\"updateScrollState\">\n      <slot></slot>\n    </div>\n`,\n\n  is: 'paper-dialog-scrollable',\n\n  properties: {\n\n    /**\n     * The dialog element that implements `Polymer.PaperDialogBehavior`\n     * containing this element.\n     * @type {?Node}\n     */\n    dialogElement: {type: Object}\n\n  },\n\n  /**\n   * Returns the scrolling element.\n   */\n  get scrollTarget() {\n    return this.$.scrollable;\n  },\n\n  ready: function() {\n    this._ensureTarget();\n    this.classList.add('no-padding');\n  },\n\n  attached: function() {\n    this._ensureTarget();\n    requestAnimationFrame(this.updateScrollState.bind(this));\n  },\n\n  updateScrollState: function() {\n    this.toggleClass('is-scrolled', this.scrollTarget.scrollTop > 0);\n    this.toggleClass(\n        'can-scroll',\n        this.scrollTarget.offsetHeight < this.scrollTarget.scrollHeight);\n    this.toggleClass(\n        'scrolled-to-bottom',\n        this.scrollTarget.scrollTop + this.scrollTarget.offsetHeight >=\n            this.scrollTarget.scrollHeight);\n  },\n\n  _ensureTarget: function() {\n    // Read parentElement instead of parentNode in order to skip shadowRoots.\n    this.dialogElement = this.dialogElement || this.parentElement;\n    // Check if dialog implements paper-dialog-behavior. If not, fit\n    // scrollTarget to host.\n    if (this.dialogElement && this.dialogElement.behaviors &&\n        this.dialogElement.behaviors.indexOf(PaperDialogBehaviorImpl) >= 0) {\n      this.dialogElement.sizingTarget = this.scrollTarget;\n      this.scrollTarget.classList.remove('fit');\n    } else if (this.dialogElement) {\n      this.scrollTarget.classList.add('fit');\n    }\n  }\n});\n","import '@vaadin/vaadin-lumo-styles/mixins/overlay.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\n\nconst $_documentContainer = html`<dom-module id=\"lumo-vaadin-overlay\" theme-for=\"vaadin-overlay\">\n  <template>\n    <style include=\"lumo-overlay\">\n      /* stylelint-disable no-empty-source */\n    </style>\n  </template>\n</dom-module>`;\n\ndocument.head.appendChild($_documentContainer.content);\n","import '@vaadin/vaadin-lumo-styles/color.js';\nimport '@vaadin/vaadin-lumo-styles/spacing.js';\nimport '@vaadin/vaadin-lumo-styles/style.js';\nimport '@vaadin/vaadin-overlay/theme/lumo/vaadin-overlay.js';\nimport '@vaadin/vaadin-lumo-styles/mixins/menu-overlay.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\n\nconst $_documentContainer = html`<dom-module id=\"lumo-combo-box-overlay\" theme-for=\"vaadin-combo-box-overlay\">\n  <template>\n    <style include=\"lumo-overlay lumo-menu-overlay-core\">\n      [part=\"content\"] {\n        padding: 0;\n      }\n\n      :host {\n        /* TODO: using a legacy mixin (unsupported) */\n        --iron-list-items-container: {\n          border-width: var(--lumo-space-xs);\n          border-style: solid;\n          border-color: transparent;\n        };\n      }\n\n      /* TODO: workaround ShadyCSS issue when using inside of the dom-if */\n      :host([opened]) {\n        --iron-list-items-container_-_border-width: var(--lumo-space-xs);\n        --iron-list-items-container_-_border-style: solid;\n        --iron-list-items-container_-_border-color: transparent;\n      }\n\n      /* Loading state */\n\n      /* When items are empty, the sinner needs some room */\n      :host(:not([closing])) [part~=\"content\"] {\n        min-height: calc(2 * var(--lumo-space-s) + var(--lumo-icon-size-s));\n      }\n\n      [part~=\"overlay\"] {\n        position: relative;\n      }\n\n      :host([loading]) [part~=\"loader\"] {\n        box-sizing: border-box;\n        width: var(--lumo-icon-size-s);\n        height: var(--lumo-icon-size-s);\n        position: absolute;\n        z-index: 1;\n        left: var(--lumo-space-s);\n        right: var(--lumo-space-s);\n        top: var(--lumo-space-s);\n        margin-left: auto;\n        margin-inline-start: auto;\n        margin-inline-end: 0;\n        border: 2px solid transparent;\n        border-color:\n          var(--lumo-primary-color-50pct)\n          var(--lumo-primary-color-50pct)\n          var(--lumo-primary-color)\n          var(--lumo-primary-color);\n        border-radius: calc(0.5 * var(--lumo-icon-size-s));\n        opacity: 0;\n        animation:\n          1s linear infinite lumo-combo-box-loader-rotate,\n          .3s .1s lumo-combo-box-loader-fade-in both;\n        pointer-events: none;\n      }\n\n      @keyframes lumo-combo-box-loader-fade-in {\n        0% {\n          opacity: 0;\n        }\n\n        100% {\n          opacity: 1;\n        }\n      }\n\n      @keyframes lumo-combo-box-loader-rotate {\n        0% {\n          transform: rotate(0deg);\n        }\n\n        100% {\n          transform: rotate(360deg);\n        }\n      }\n    </style>\n  </template>\n</dom-module>`;\n\ndocument.head.appendChild($_documentContainer.content);\n","import '@vaadin/vaadin-lumo-styles/font-icons.js';\nimport '@vaadin/vaadin-lumo-styles/sizing.js';\nimport '@vaadin/vaadin-lumo-styles/spacing.js';\nimport '@vaadin/vaadin-lumo-styles/style.js';\nimport '@vaadin/vaadin-lumo-styles/typography.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\n\nconst $_documentContainer = html`<dom-module id=\"lumo-item\" theme-for=\"vaadin-item\">\n  <template>\n    <style>\n      :host {\n        display: flex;\n        align-items: center;\n        box-sizing: border-box;\n        font-family: var(--lumo-font-family);\n        font-size: var(--lumo-font-size-m);\n        line-height: var(--lumo-line-height-xs);\n        padding: 0.5em 1em;\n        min-height: var(--lumo-size-m);\n        -webkit-font-smoothing: antialiased;\n        -moz-osx-font-smoothing: grayscale;\n        -webkit-tap-highlight-color: transparent;\n      }\n\n      /* Selectable items have a checkmark icon */\n      :host([tabindex])::before {\n        display: var(--_lumo-item-selected-icon-display, none);\n        content: var(--lumo-icons-checkmark);\n        font-family: lumo-icons;\n        font-size: var(--lumo-icon-size-m);\n        line-height: 1;\n        font-weight: normal;\n        width: 1em;\n        height: 1em;\n        margin: calc((1 - var(--lumo-line-height-xs)) * var(--lumo-font-size-m) / 2) 0;\n        color: var(--lumo-primary-text-color);\n        flex: none;\n        opacity: 0;\n        transition: transform 0.2s cubic-bezier(.12, .32, .54, 2), opacity 0.1s;\n      }\n\n      :host([selected])::before {\n        opacity: 1;\n      }\n\n      :host([active]:not([selected]))::before {\n        transform: scale(0.8);\n        opacity: 0;\n        transition-duration: 0s;\n      }\n\n      [part=\"content\"] {\n        flex: auto;\n      }\n\n      /* Disabled item */\n\n      :host([disabled]) {\n        color: var(--lumo-disabled-text-color);\n        cursor: default;\n        pointer-events: none;\n      }\n\n      /* Slotted icons */\n\n      :host ::slotted(iron-icon) {\n        width: var(--lumo-icon-size-m);\n        height: var(--lumo-icon-size-m);\n      }\n    </style>\n  </template>\n</dom-module>`;\n\ndocument.head.appendChild($_documentContainer.content);\n","/**\n@license\nCopyright (c) 2017 Vaadin Ltd.\nThis program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n*/\n/**\n * A mixin providing `focused`, `focus-ring`, `active`, `disabled` and `selected`.\n *\n * `focused`, `active` and `focus-ring` are set as only as attributes.\n * @polymerMixin\n */\nexport const ItemMixin = superClass => class VaadinItemMixin extends superClass {\n  static get properties() {\n    return {\n\n      /**\n       * Used for mixin detection because `instanceof` does not work with mixins.\n       * e.g. in VaadinListMixin it filters items by using the\n       * `element._hasVaadinItemMixin` condition.\n       */\n      _hasVaadinItemMixin: {\n        value: true\n      },\n\n      /**\n       * If true, the user cannot interact with this element.\n       */\n      disabled: {\n        type: Boolean,\n        value: false,\n        observer: '_disabledChanged',\n        reflectToAttribute: true\n      },\n\n      /**\n       * If true, the item is in selected state.\n       */\n      selected: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true,\n        observer: '_selectedChanged'\n      },\n\n      _value: String\n    };\n  }\n\n  get value() {\n    return this._value !== undefined ? this._value : this.textContent.trim();\n  }\n\n  set value(value) {\n    this._value = value;\n  }\n\n  ready() {\n    super.ready();\n\n    const attrValue = this.getAttribute('value');\n    if (attrValue !== null) {\n      this.value = attrValue;\n    }\n\n    this.addEventListener('focus', e => this._setFocused(true), true);\n    this.addEventListener('blur', e => this._setFocused(false), true);\n    this.addEventListener('mousedown', e => {\n      this._setActive(this._mousedown = true);\n      const mouseUpListener = () => {\n        this._setActive(this._mousedown = false);\n        document.removeEventListener('mouseup', mouseUpListener);\n      };\n      document.addEventListener('mouseup', mouseUpListener);\n    });\n    this.addEventListener('keydown', e => this._onKeydown(e));\n    this.addEventListener('keyup', e => this._onKeyup(e));\n  }\n\n  /**\n   * @protected\n   */\n  disconnectedCallback() {\n    super.disconnectedCallback();\n\n    // in Firefox and Safari, blur does not fire on the element when it is removed,\n    // especially between keydown and keyup events, being active at the same time.\n    // reproducible in `<vaadin-select>` when closing overlay on select.\n    if (this.hasAttribute('active')) {\n      this._setFocused(false);\n    }\n  }\n\n  _selectedChanged(selected) {\n    this.setAttribute('aria-selected', selected);\n  }\n\n  _disabledChanged(disabled) {\n    if (disabled) {\n      this.selected = false;\n      this.setAttribute('aria-disabled', 'true');\n      this.blur();\n    } else {\n      this.removeAttribute('aria-disabled');\n    }\n  }\n\n  _setFocused(focused) {\n    if (focused) {\n      this.setAttribute('focused', '');\n      if (!this._mousedown) {\n        this.setAttribute('focus-ring', '');\n      }\n    } else {\n      this.removeAttribute('focused');\n      this.removeAttribute('focus-ring');\n      this._setActive(false);\n    }\n  }\n\n  _setActive(active) {\n    if (active) {\n      this.setAttribute('active', '');\n    } else {\n      this.removeAttribute('active');\n    }\n  }\n\n  _onKeydown(event) {\n    if (/^( |SpaceBar|Enter)$/.test(event.key) && !event.defaultPrevented) {\n      event.preventDefault();\n      this._setActive(true);\n    }\n  }\n\n  _onKeyup(event) {\n    if (this.hasAttribute('active')) {\n      this._setActive(false);\n      this.click();\n    }\n  }\n};\n","/**\n@license\nCopyright (c) 2017 Vaadin Ltd.\nThis program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n*/\nimport { PolymerElement } from '@polymer/polymer/polymer-element.js';\n\nimport { ThemableMixin } from '@vaadin/vaadin-themable-mixin/vaadin-themable-mixin.js';\nimport { ItemMixin } from './vaadin-item-mixin.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\n/**\n * `<vaadin-item>` is a Web Component providing layout for items in tabs and menus.\n *\n * ```\n *   <vaadin-item>\n *     Item content\n *   </vaadin-item>\n * ```\n *\n * ### Selectable\n *\n * `<vaadin-item>` has the `selected` property and the corresponding state attribute.\n * Currently, the component sets the `selected` to false, when `disabled` property is set to true.\n * But other than that, the `<vaadin-item>` does not switch selection by itself.\n * In general, it is the wrapper component, like `<vaadin-list-box>`, which should update\n * the `selected` property on the items, e. g. on mousedown or when Enter / Spacebar is pressed.\n *\n * ### Styling\n *\n * The following shadow DOM parts are available for styling:\n *\n * Part name | Description\n * ---|---\n * `content` | The element that wraps the slot\n *\n * The following state attributes are available for styling:\n *\n * Attribute  | Description | Part name\n * -----------|-------------|------------\n * `disabled` | Set to a disabled item | :host\n * `focused` | Set when the element is focused | :host\n * `focus-ring` | Set when the element is keyboard focused | :host\n * `selected` | Set when the item is selected | :host\n * `active` | Set when mousedown or enter/spacebar pressed | :host\n *\n * @memberof Vaadin\n * @mixes Vaadin.ItemMixin\n * @mixes Vaadin.ThemableMixin\n */\nclass ItemElement extends ItemMixin(ThemableMixin(PolymerElement)) {\n  static get template() {\n    return html`\n    <style>\n      :host {\n        display: inline-block;\n      }\n\n      :host([hidden]) {\n        display: none !important;\n      }\n    </style>\n    <div part=\"content\">\n      <slot></slot>\n    </div>\n`;\n  }\n\n  static get is() {\n    return 'vaadin-item';\n  }\n\n  static get version() {\n    return '2.1.1';\n  }\n\n  constructor() {\n    super();\n\n    /**\n     * Submittable string value. The default value is the trimmed text content of the element.\n     * @type {string}\n     */\n    this.value;\n  }\n}\n\ncustomElements.define(ItemElement.is, ItemElement);\n\nexport { ItemElement };\n","import '@vaadin/vaadin-lumo-styles/color.js';\nimport '@vaadin/vaadin-lumo-styles/spacing.js';\nimport '@vaadin/vaadin-lumo-styles/style.js';\nimport '@vaadin/vaadin-item/theme/lumo/vaadin-item.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\n\nconst $_documentContainer = html`<dom-module id=\"lumo-combo-box-item\" theme-for=\"vaadin-combo-box-item\">\n  <template>\n    <style include=\"lumo-item\">\n      /* TODO partly duplicated from vaadin-list-box styles. Should find a way to make it DRY */\n\n      :host {\n        cursor: default;\n        -webkit-tap-highlight-color: var(--lumo-primary-color-10pct);\n        padding-left: calc(var(--lumo-border-radius) / 4);\n        padding-right: calc(var(--lumo-space-l) + var(--lumo-border-radius) / 4);\n        transition: background-color 100ms;\n        border-radius: var(--lumo-border-radius);\n        overflow: hidden;\n        --_lumo-item-selected-icon-display: block;\n      }\n\n      /* ShadyCSS workaround (show the selected item checkmark) */\n      :host::before {\n        display: block;\n      }\n\n      :host(:hover) {\n        background-color: var(--lumo-primary-color-10pct);\n      }\n\n      :host([focused]:not([disabled])) {\n        box-shadow: inset 0 0 0 2px var(--lumo-primary-color-50pct);\n      }\n\n      @media (pointer: coarse) {\n        :host(:hover) {\n          background-color: transparent;\n        }\n\n        :host([focused]:not([disabled])) {\n          box-shadow: none;\n        }\n      }\n    </style>\n  </template>\n</dom-module>`;\n\ndocument.head.appendChild($_documentContainer.content);\n","/**\n@license\nCopyright (c) 2018 Vaadin Ltd.\nThis program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n*/\n/*\n * Placeholder object class representing items being loaded.\n *\n * @private\n */\nexport const ComboBoxPlaceholder = class ComboBoxPlaceholder {\n  toString() {\n    return '';\n  }\n};\n","/**\n@license\nCopyright (c) 2017 Vaadin Ltd.\nThis program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n*/\nimport { timeOut } from '@polymer/polymer/lib/utils/async.js';\n\nimport { Debouncer } from '@polymer/polymer/lib/utils/debounce.js';\nimport { flush } from '@polymer/polymer/lib/utils/flush.js';\nimport { templatize } from '@polymer/polymer/lib/utils/templatize.js';\nimport { IronA11yAnnouncer } from '@polymer/iron-a11y-announcer/iron-a11y-announcer.js';\nimport { IronA11yKeysBehavior } from '@polymer/iron-a11y-keys-behavior/iron-a11y-keys-behavior.js';\nimport { FlattenedNodesObserver } from '@polymer/polymer/lib/utils/flattened-nodes-observer.js';\nimport { ComboBoxPlaceholder } from './vaadin-combo-box-placeholder.js';\n\n/**\n * @polymerMixin\n */\nexport const ComboBoxMixin = subclass => class VaadinComboBoxMixinElement extends subclass {\n\n  static get properties() {\n    return {\n      /**\n       * True if the dropdown is open, false otherwise.\n       */\n      opened: {\n        type: Boolean,\n        notify: true,\n        value: false,\n        reflectToAttribute: true,\n        observer: '_openedChanged'\n      },\n\n      /**\n       * Set to true to disable this element.\n       */\n      disabled: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true\n      },\n\n      /**\n       * When present, it specifies that the element field is read-only.\n       */\n      readonly: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true\n      },\n\n      /**\n       * Custom function for rendering the content of every item.\n       * Receives three arguments:\n       *\n       * - `root` The `<vaadin-combo-box-item>` internal container DOM element.\n       * - `comboBox` The reference to the `<vaadin-combo-box>` element.\n       * - `model` The object with the properties related with the rendered\n       *   item, contains:\n       *   - `model.index` The index of the rendered item.\n       *   - `model.item` The item.\n       */\n      renderer: Function,\n\n      /**\n       * A full set of items to filter the visible options from.\n       * The items can be of either `String` or `Object` type.\n       */\n      items: {\n        type: Array,\n        observer: '_itemsChanged'\n      },\n\n      /**\n       * If `true`, the user can input a value that is not present in the items list.\n       * `value` property will be set to the input value in this case.\n       * Also, when `value` is set programmatically, the input value will be set\n       * to reflect that value.\n       */\n      allowCustomValue: {\n        type: Boolean,\n        value: false\n      },\n\n      /**\n       * A subset of items, filtered based on the user input. Filtered items\n       * can be assigned directly to omit the internal filtering functionality.\n       * The items can be of either `String` or `Object` type.\n       */\n      filteredItems: {\n        type: Array\n      },\n\n      /**\n       * The `String` value for the selected item of the combo box. Provides\n       * the value for `iron-form`.\n       *\n       * When theres no item selected, the value is an empty string.\n       *\n       * Use `selectedItem` property to get the raw selected item from\n       * the `items` array.\n       */\n      value: {\n        type: String,\n        observer: '_valueChanged',\n        notify: true,\n        value: ''\n      },\n\n      /**\n       * Used to detect user value changes and fire `change` events.\n       */\n      _lastCommittedValue: String,\n\n      /*\n       * When set to `true`, \"loading\" attribute is added to host and the overlay element.\n       */\n      loading: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true\n      },\n\n      _focusedIndex: {\n        type: Number,\n        value: -1\n      },\n\n      /**\n       * Filtering string the user has typed into the input field.\n       */\n      filter: {\n        type: String,\n        value: '',\n        notify: true\n      },\n\n      /**\n       * The selected item from the `items` array.\n       */\n      selectedItem: {\n        type: Object,\n        notify: true\n      },\n\n      /**\n       * Path for label of the item. If `items` is an array of objects, the\n       * `itemLabelPath` is used to fetch the displayed string label for each\n       * item.\n       *\n       * The item label is also used for matching items when processing user\n       * input, i.e., for filtering and selecting items.\n       *\n       * When using item templates, the property is still needed because it is used\n       * for filtering, and for displaying the selected item value in the input box.\n       */\n      itemLabelPath: {\n        type: String,\n        value: 'label',\n        observer: '_itemLabelPathChanged'\n      },\n\n      /**\n       * Path for the value of the item. If `items` is an array of objects, the\n       * `itemValuePath:` is used to fetch the string value for the selected\n       * item.\n       *\n       * The item value is used in the `value` property of the combo box,\n       * to provide the form value.\n       */\n      itemValuePath: {\n        type: String,\n        value: 'value'\n      },\n\n      /**\n       * Path for the id of the item. If `items` is an array of objects,\n       * the `itemIdPath` is used to compare and identify the same item\n       * in `selectedItem` and `filteredItems` (items given by the\n       * `dataProvider` callback).\n       */\n      itemIdPath: String,\n\n      /**\n       * The name of this element.\n       */\n      name: {\n        type: String\n      },\n\n      /**\n       * Set to true if the value is invalid.\n       */\n      invalid: {\n        type: Boolean,\n        reflectToAttribute: true,\n        notify: true,\n        value: false\n      },\n\n      _toggleElement: Object,\n      _clearElement: Object,\n\n      _inputElementValue: String,\n\n      _closeOnBlurIsPrevented: Boolean,\n\n      _previousDocumentPointerEvents: String,\n\n      _itemTemplate: Object\n    };\n  }\n\n  static get observers() {\n    return [\n      '_filterChanged(filter, itemValuePath, itemLabelPath)',\n      '_itemsOrPathsChanged(items.*, itemValuePath, itemLabelPath)',\n      '_filteredItemsChanged(filteredItems.*, itemValuePath, itemLabelPath)',\n      '_templateOrRendererChanged(_itemTemplate, renderer)',\n      '_loadingChanged(loading)',\n      '_selectedItemChanged(selectedItem, itemLabelPath)',\n      '_toggleElementChanged(_toggleElement)'\n    ];\n  }\n\n  ready() {\n    super.ready();\n\n    this.addEventListener('focusout', e => {\n      // Fixes the problem with `focusout` happening when clicking on the scroll bar on Edge\n      const dropdown = this.$.overlay.$.dropdown;\n      if (dropdown && dropdown.$ && e.relatedTarget === dropdown.$.overlay) {\n        e.composedPath()[0].focus();\n        return;\n      }\n      if (!this._closeOnBlurIsPrevented) {\n        this.close();\n      }\n    });\n\n    this._lastCommittedValue = this.value;\n    IronA11yAnnouncer.requestAvailability();\n\n    // 2.0 does not support 'overlay.selection-changed' syntax in listeners\n    this.$.overlay.addEventListener('selection-changed', this._overlaySelectedItemChanged.bind(this));\n\n    this.addEventListener('vaadin-combo-box-dropdown-closed', this.close.bind(this));\n    this.addEventListener('vaadin-combo-box-dropdown-opened', this._onOpened.bind(this));\n    this.addEventListener('keydown', this._onKeyDown.bind(this));\n    this.addEventListener('click', this._onClick.bind(this));\n\n    this.$.overlay.addEventListener('vaadin-overlay-touch-action', this._onOverlayTouchAction.bind(this));\n\n    this.addEventListener('touchend', e => {\n      if (!this._clearElement || e.composedPath()[0] !== this._clearElement) {\n        return;\n      }\n\n      e.preventDefault();\n      this._clear();\n    });\n\n    this._observer = new FlattenedNodesObserver(this, info => {\n      this._setTemplateFromNodes(info.addedNodes);\n    });\n  }\n\n\n  /**\n   * Manually invoke existing renderer.\n   */\n  render() {\n    if (this.$.overlay._selector) {\n      this.$.overlay._selector.querySelectorAll('vaadin-combo-box-item').forEach(item => item._render());\n    }\n  }\n\n  _setTemplateFromNodes(nodes) {\n    this._itemTemplate = nodes.filter(node => node.localName && node.localName === 'template')[0] || this._itemTemplate;\n  }\n\n  _removeNewRendererOrTemplate(template, oldTemplate, renderer, oldRenderer) {\n    if (template !== oldTemplate) {\n      this._itemTemplate = undefined;\n    } else if (renderer !== oldRenderer) {\n      this.renderer = undefined;\n    }\n  }\n\n  _templateOrRendererChanged(template, renderer) {\n    if (template && renderer) {\n      this._removeNewRendererOrTemplate(template, this._oldTemplate, renderer, this._oldRenderer);\n      throw new Error('You should only use either a renderer or a template for combo box items');\n    }\n\n    this._oldTemplate = template;\n    this._oldRenderer = renderer;\n  }\n\n  /**\n   * Opens the dropdown list.\n   */\n  open() {\n    // Prevent _open() being called when input is disabled or read-only\n    if (!this.disabled && !this.readonly) {\n      this.opened = true;\n    }\n  }\n\n  /**\n   * Closes the dropdown list.\n   */\n  close() {\n    this.opened = false;\n  }\n\n  _openedChanged(value, old) {\n    // Prevent _close() being called when opened is set to its default value (false).\n    if (old === undefined) {\n      return;\n    }\n\n    if (this.opened) {\n      this._openedWithFocusRing = this.hasAttribute('focus-ring') || (this.focusElement && this.focusElement.hasAttribute('focus-ring'));\n      // For touch devices, we don't want to popup virtual keyboard on touch devices unless input\n      // is explicitly focused by the user.\n      if (!this.$.overlay.touchDevice) {\n        // Check to see if there is a focused property and if it's already true.\n        if (!this.focused) {\n          this.focus();\n        }\n      }\n    } else {\n      this._onClosed();\n      if (this._openedWithFocusRing && this.hasAttribute('focused')) {\n        this.focusElement.setAttribute('focus-ring', '');\n      }\n    }\n  }\n\n  _onOverlayTouchAction(event) {\n    // On touch devices, blur the input on touch start inside the overlay, in order to hide\n    // the virtual keyboard. But don't close the overlay on this blur.\n    this._closeOnBlurIsPrevented = true;\n    this.inputElement.blur();\n    this._closeOnBlurIsPrevented = false;\n  }\n\n  _onClick(e) {\n    this._closeOnBlurIsPrevented = true;\n\n    const path = e.composedPath();\n    if (path.indexOf(this._clearElement) !== -1) {\n      this._clear();\n      this.focus();\n    } else if (path.indexOf(this.inputElement) !== -1) {\n      if (path.indexOf(this._toggleElement) > -1 && this.opened) {\n        this.close();\n      } else {\n        this.open();\n      }\n    }\n\n    this._closeOnBlurIsPrevented = false;\n  }\n\n  /**\n   * Keyboard navigation\n   */\n\n  _onKeyDown(e) {\n    if (this._isEventKey(e, 'down')) {\n      this._closeOnBlurIsPrevented = true;\n      this._onArrowDown();\n      this._closeOnBlurIsPrevented = false;\n\n      // prevent caret from moving\n      e.preventDefault();\n    } else if (this._isEventKey(e, 'up')) {\n      this._closeOnBlurIsPrevented = true;\n      this._onArrowUp();\n      this._closeOnBlurIsPrevented = false;\n\n      // prevent caret from moving\n      e.preventDefault();\n    } else if (this._isEventKey(e, 'enter')) {\n      this._onEnter(e);\n    } else if (this._isEventKey(e, 'esc')) {\n      this._onEscape(e);\n    }\n  }\n\n  _isEventKey(e, k) {\n    return IronA11yKeysBehavior.keyboardEventMatchesKeys(e, k);\n  }\n\n  _getItemLabel(item) {\n    return this.$.overlay.getItemLabel(item);\n  }\n\n  _getItemValue(item) {\n    let value = item && this.itemValuePath ? this.get(this.itemValuePath, item) : undefined;\n    if (value === undefined) {\n      value = item ? item.toString() : '';\n    }\n    return value;\n  }\n\n  _onArrowDown() {\n    if (this.opened) {\n      if (this.$.overlay._items) {\n        this._focusedIndex = Math.min(this.$.overlay._items.length - 1, this._focusedIndex + 1);\n        this._prefillFocusedItemLabel();\n      }\n    } else {\n      this.open();\n    }\n  }\n\n  _onArrowUp() {\n    if (this.opened) {\n      if (this._focusedIndex > -1) {\n        this._focusedIndex = Math.max(0, this._focusedIndex - 1);\n      } else {\n        if (this.$.overlay._items) {\n          this._focusedIndex = this.$.overlay._items.length - 1;\n        }\n      }\n\n      this._prefillFocusedItemLabel();\n    } else {\n      this.open();\n    }\n  }\n\n  _prefillFocusedItemLabel() {\n    if (this._focusedIndex > -1) {\n      // Reset the input value asyncronously to prevent partial value changes\n      // announce. Makes OSX VoiceOver to announce the complete value instead.\n      this._inputElementValue = '';\n      // 1ms delay needed for OSX VoiceOver to realise input value was reset\n      setTimeout(() => {\n        this._inputElementValue = this._getItemLabel(this.$.overlay._focusedItem);\n        this._markAllSelectionRange();\n      }, 1);\n    }\n  }\n\n  _setSelectionRange(start, end) {\n    // vaadin-text-field does not implement setSelectionRange, hence we need the native input\n    const input = this._nativeInput || this.inputElement;\n\n    // Setting selection range focuses and/or moves the caret in some browsers,\n    // and there's no need to modify the selection range if the input isn't focused anyway.\n    // This affects Safari. When the overlay is open, and then hiting tab, browser should focus\n    // the next focusable element instead of the combo-box itself.\n    // Checking the focused property here is enough instead of checking the activeElement.\n    if (this.hasAttribute('focused') && input && input.setSelectionRange) {\n      try {\n        input.setSelectionRange(start, end);\n      } catch (ignore) {\n        // IE11 randomly fails when running tests in Sauce.\n      }\n    }\n  }\n\n  _markAllSelectionRange() {\n    if (this._inputElementValue !== undefined) {\n      this._setSelectionRange(0, this._inputElementValue.length);\n    }\n  }\n\n  _clearSelectionRange() {\n    if (this._inputElementValue !== undefined) {\n      const pos = this._inputElementValue ? this._inputElementValue.length : 0;\n      this._setSelectionRange(pos, pos);\n    }\n  }\n\n  _onEnter(e) {\n    // should close on enter when custom values are allowed, input field is cleared, or when an existing\n    // item is focused with keyboard.\n    if (this.opened && (this.allowCustomValue || this._inputElementValue === '' || this._focusedIndex > -1)) {\n      this.close();\n\n      // Do not submit the surrounding form.\n      e.preventDefault();\n    }\n  }\n\n  _onEscape(e) {\n    if (this.opened) {\n      this._stopPropagation(e);\n\n      if (this._focusedIndex > -1) {\n        this._focusedIndex = -1;\n        this._revertInputValue();\n      } else {\n        this.cancel();\n      }\n    }\n  }\n\n  _toggleElementChanged(toggleElement) {\n    if (toggleElement) {\n      // Don't blur the input on toggle mousedown\n      toggleElement.addEventListener('mousedown', e => e.preventDefault());\n    }\n  }\n\n  /**\n   * Clears the current value.\n   */\n  _clear() {\n    this.selectedItem = null;\n\n    if (this.allowCustomValue) {\n      this.value = '';\n    }\n\n    this._detectAndDispatchChange();\n  }\n\n  /**\n   * Reverts back to original value.\n   */\n  cancel() {\n    this._revertInputValueToValue();\n    // In the next _detectAndDispatchChange() call, the change detection should not pass\n    this._lastCommittedValue = this.value;\n    this.close();\n  }\n\n  _onOpened() {\n    // Pre P2 iron-list used a debouncer to render. Now that we synchronously render items,\n    // we need to flush the DOM to make sure it doesn't get flushed in the middle of _render call\n    // because that will cause problems to say the least.\n    flush();\n\n    // With iron-list v1.3.9, calling `notifyResize()` no longer renders\n    // the items synchronously. It is required to have the items rendered\n    // before we update the overlay and the list positions and sizes.\n    this.$.overlay.ensureItemsRendered();\n    this.$.overlay._selector.toggleScrollListener(true);\n\n    // Ensure metrics are up-to-date\n    this.$.overlay.updateViewportBoundaries();\n    // Force iron-list to create reusable nodes. Otherwise it will only start\n    // doing that in scroll listener, which is especially slow in Edge.\n    this.$.overlay._selector._increasePoolIfNeeded();\n    setTimeout(() => this._resizeDropdown(), 1);\n    // Defer scroll position adjustment to prevent freeze in Edge\n    window.requestAnimationFrame(() => this.$.overlay.adjustScrollPosition());\n\n\n    // _detectAndDispatchChange() should not consider value changes done before opening\n    this._lastCommittedValue = this.value;\n  }\n\n  _onClosed() {\n\n    // Happens when the overlay is closed by clicking outside\n    if (this.opened) {\n      this.close();\n    }\n\n    if (this.$.overlay._items && this._focusedIndex > -1) {\n      const focusedItem = this.$.overlay._items[this._focusedIndex];\n      if (this.selectedItem !== focusedItem) {\n        this.selectedItem = focusedItem;\n      }\n      // make sure input field is updated in case value doesn't change (i.e. FOO -> foo)\n      this._inputElementValue = this._getItemLabel(this.selectedItem);\n    } else if (this._inputElementValue === '' || this._inputElementValue === undefined) {\n      this.selectedItem = null;\n\n      if (this.allowCustomValue) {\n        this.value = '';\n      }\n    } else {\n      if (this.allowCustomValue) {\n        const e = new CustomEvent('custom-value-set', {detail: this._inputElementValue, composed: true, cancelable: true, bubbles: true});\n        this.dispatchEvent(e);\n        if (!e.defaultPrevented) {\n          const customValue = this._inputElementValue;\n          this._selectItemForValue(customValue);\n          this.value = customValue;\n        }\n      } else {\n        this._inputElementValue = this.selectedItem ? this._getItemLabel(this.selectedItem) : '';\n      }\n    }\n\n    this._detectAndDispatchChange();\n\n    this._clearSelectionRange();\n\n    if (!this.dataProvider) {\n      this.filter = '';\n    }\n  }\n\n  get _propertyForValue() {\n    return 'value';\n  }\n\n  /**\n   *  Filtering and items handling\n   */\n  _inputValueChanged(e) {\n    // Handle only input events from our inputElement.\n    if (e.composedPath().indexOf(this.inputElement) !== -1) {\n      this._inputElementValue = this.inputElement[this._propertyForValue];\n      this._filterFromInput();\n    }\n  }\n\n  _filterFromInput(e) {\n    if (!this.opened) {\n      this.open();\n    }\n\n    if (this.filter === this._inputElementValue) {\n      // Filter and input value might get out of sync, while keyboard navigating for example.\n      // Afterwards, input value might be changed to the same value as used in filtering.\n      // In situation like these, we need to make sure all the filter changes handlers are run.\n      this._filterChanged(this.filter, this.itemValuePath, this.itemLabelPath);\n    } else {\n      this.filter = this._inputElementValue;\n    }\n  }\n\n  _itemLabelPathChanged(itemLabelPath, oldItemLabelPath) {\n    if (typeof itemLabelPath !== 'string') {\n      console.error('You should set itemLabelPath to a valid string');\n    }\n  }\n\n  _filterChanged(filter, itemValuePath, itemLabelPath) {\n    if (filter === undefined) {\n      return;\n    }\n    if (this.items) {\n      this.filteredItems = this._filterItems(this.items, filter);\n    } else {\n      // With certain use cases (e. g., external filtering), `items` are\n      // undefined. Filtering is unnecessary per se, but the filteredItems\n      // observer should still be invoked to update focused item.\n      this._filteredItemsChanged({path: 'filteredItems', value: this.filteredItems}, itemValuePath, itemLabelPath);\n    }\n  }\n\n  _loadingChanged(loading) {\n    if (loading) {\n      this._focusedIndex = -1;\n    }\n  }\n\n  _revertInputValue() {\n    if (this.filter !== '') {\n      this._inputElementValue = this.filter;\n    } else {\n      this._revertInputValueToValue();\n    }\n    this._clearSelectionRange();\n  }\n\n  _revertInputValueToValue() {\n    if (this.allowCustomValue && !this.selectedItem) {\n      this._inputElementValue = this.value;\n    } else {\n      this._inputElementValue = this._getItemLabel(this.selectedItem);\n    }\n  }\n\n  _resizeDropdown() {\n    this.$.overlay.$.dropdown.notifyResize();\n  }\n\n  _updateHasValue(hasValue) {\n    if (hasValue) {\n      this.setAttribute('has-value', '');\n    } else {\n      this.removeAttribute('has-value');\n    }\n  }\n\n  _selectedItemChanged(selectedItem, itemLabelPath) {\n    if (selectedItem === null || selectedItem === undefined) {\n      if (this.filteredItems) {\n        if (!this.allowCustomValue) {\n          this.value = '';\n        }\n\n        this._updateHasValue(this.value !== '');\n        this._inputElementValue = this.value;\n      }\n    } else {\n      const value = this._getItemValue(selectedItem);\n      if (this.value !== value) {\n        this.value = value;\n      }\n\n      this._updateHasValue(true);\n      this._inputElementValue = this._getItemLabel(selectedItem);\n\n      // Could not be defined in 1.x because ready is called after all prop-setters\n      if (this.inputElement) {\n        this.inputElement[this._propertyForValue] = this._inputElementValue;\n      }\n    }\n\n    this.$.overlay._selectedItem = selectedItem;\n    if (this.filteredItems && this.$.overlay._items) {\n      this._focusedIndex = this.filteredItems.indexOf(selectedItem);\n    }\n  }\n\n  _valueChanged(value, oldVal) {\n    if (value === '' && oldVal === undefined) { // initializing, no need to do anything (#554)\n      return;\n    }\n\n    if (this._isValidValue(value)) {\n      let item;\n      if (this._getItemValue(this.selectedItem) !== value) {\n        this._selectItemForValue(value);\n      } else {\n        item = this.selectedItem;\n      }\n\n      if (!item && this.allowCustomValue) {\n        this._inputElementValue = value;\n      }\n\n      this._updateHasValue(this.value !== '');\n    } else {\n      this.selectedItem = null;\n    }\n    // In the next _detectAndDispatchChange() call, the change detection should pass\n    this._lastCommittedValue = undefined;\n  }\n\n  _detectAndDispatchChange() {\n    if (this.value !== this._lastCommittedValue) {\n      this.dispatchEvent(new CustomEvent('change', {bubbles: true}));\n      this._lastCommittedValue = this.value;\n    }\n  }\n\n  _itemsChanged(items, oldItems) {\n    this._ensureItemsOrDataProvider(() => {\n      this.items = oldItems;\n    });\n  }\n\n  _itemsOrPathsChanged(e, itemValuePath, itemLabelPath) {\n    if (e.value === undefined) {\n      return;\n    }\n    if (e.path === 'items' || e.path === 'items.splices') {\n      this.filteredItems = this.items ? this.items.slice(0) : this.items;\n\n      const valueIndex = this._indexOfValue(this.value, this.items);\n      this._focusedIndex = valueIndex;\n\n      const item = valueIndex > -1 && this.items[valueIndex];\n      if (item) {\n        this.selectedItem = item;\n      }\n    }\n  }\n\n  _filteredItemsChanged(e, itemValuePath, itemLabelPath) {\n    if (e.value === undefined) {\n      return;\n    }\n    if (e.path === 'filteredItems' || e.path === 'filteredItems.splices') {\n      this._setOverlayItems(this.filteredItems);\n\n      this._focusedIndex = this.opened ?\n        this.$.overlay.indexOfLabel(this.filter) :\n        this._indexOfValue(this.value, this.filteredItems);\n\n      if (this.opened) {\n        this._repositionOverlay();\n      }\n    }\n  }\n\n  _filterItems(arr, filter) {\n    if (!arr) {\n      return arr;\n    }\n\n    return arr.filter(item => {\n      filter = filter ? filter.toString().toLowerCase() : '';\n      // Check if item contains input value.\n      return this._getItemLabel(item).toString().toLowerCase().indexOf(filter) > -1;\n    });\n  }\n\n  _selectItemForValue(value) {\n    const valueIndex = this._indexOfValue(value, this.filteredItems);\n    const previouslySelectedItem = this.selectedItem;\n\n    this.selectedItem = valueIndex >= 0\n      ? this.filteredItems[valueIndex]\n      : (this.dataProvider && this.selectedItem === undefined)\n        ? undefined\n        : null;\n\n    if (this.selectedItem === null && previouslySelectedItem === null) {\n      this._selectedItemChanged(this.selectedItem);\n    }\n  }\n\n  _setOverlayItems(items) {\n    this.$.overlay.set('_items', items);\n  }\n\n  _repositionOverlay() {\n    // async needed to reposition correctly after filtering\n    // (especially when aligned on top of input)\n    this.__repositionOverlayDebouncer = Debouncer.debounce(\n      this.__repositionOverlayDebouncer,\n      // Long debounce: sizing updates invoke multiple styling rounds,\n      // which is very slow in Edge\n      timeOut.after(500),\n      () => {\n        this._resizeDropdown();\n        this.$.overlay.updateViewportBoundaries();\n        this.$.overlay.ensureItemsRendered();\n        this.$.overlay._selector.notifyResize();\n        flush();\n      }\n    );\n  }\n\n  _indexOfValue(value, items) {\n    if (items && this._isValidValue(value)) {\n      for (let i = 0; i < items.length; i++) {\n        if (this._getItemValue(items[i]) === value) {\n          return i;\n        }\n      }\n    }\n\n    return -1;\n  }\n\n  /**\n   * Checks if the value is supported as an item value in this control.\n   *\n   * @return {boolean}\n   */\n  _isValidValue(value) {\n    return value !== undefined && value !== null;\n  }\n\n  _overlaySelectedItemChanged(e) {\n    // stop this private event from leaking outside.\n    e.stopPropagation();\n\n    if (e.detail.item instanceof ComboBoxPlaceholder) {\n      // Placeholder items should not be selectable.\n      return;\n    }\n\n    if (this.opened) {\n      this.close();\n    }\n\n    if (this.selectedItem !== e.detail.item) {\n      this.selectedItem = e.detail.item;\n      this._detectAndDispatchChange();\n    }\n  }\n\n\n  /**\n   * Returns true if `value` is valid, and sets the `invalid` flag appropriately.\n   *\n   * @return {boolean} True if the value is valid and sets the `invalid` flag appropriately\n   */\n  validate() {\n    return !(this.invalid = !this.checkValidity());\n  }\n\n  /**\n   * Returns true if the current input value satisfies all constraints (if any)\n   *\n   * You can override the `checkValidity` method for custom validations.\n   */\n  checkValidity() {\n    if (this.inputElement.validate) {\n      return this.inputElement.validate();\n    }\n  }\n\n  get _instanceProps() {\n    return {\n      item: true,\n      index: true,\n      selected: true,\n      focused: true\n    };\n  }\n\n  _ensureTemplatized() {\n    if (!this._TemplateClass) {\n      const tpl = this._itemTemplate || this._getRootTemplate();\n      if (tpl) {\n        this._TemplateClass = templatize(tpl, this, {\n          instanceProps: this._instanceProps,\n          forwardHostProp: function(prop, value) {\n            const items = this.$.overlay._selector.querySelectorAll('vaadin-combo-box-item');\n            Array.prototype.forEach.call(items, item => {\n              if (item._itemTemplateInstance) {\n                item._itemTemplateInstance.set(prop, value);\n                item._itemTemplateInstance.notifyPath(prop, value, true);\n              }\n            });\n          }\n        });\n      }\n    }\n  }\n\n  _getRootTemplate() {\n    return Array.prototype.filter.call(this.children, elem => elem.tagName === 'TEMPLATE')[0];\n  }\n\n  _preventInputBlur() {\n    if (this._toggleElement) {\n      this._toggleElement.addEventListener('click', this._preventDefault);\n    }\n    if (this._clearElement) {\n      this._clearElement.addEventListener('click', this._preventDefault);\n    }\n  }\n\n  _restoreInputBlur() {\n    if (this._toggleElement) {\n      this._toggleElement.removeEventListener('click', this._preventDefault);\n    }\n    if (this._clearElement) {\n      this._clearElement.removeEventListener('click', this._preventDefault);\n    }\n  }\n\n  _preventDefault(e) {\n    e.preventDefault();\n  }\n\n  _stopPropagation(e) {\n    e.stopPropagation();\n  }\n\n  /**\n   * Fired when the value changes.\n   *\n   * @event value-changed\n   * @param {Object} detail\n   *  @param {String} detail.value the combobox value\n   */\n\n  /**\n   * Fired when selected item changes.\n   *\n   * @event selected-item-changed\n   * @param {Object} detail\n   *  @param {Object|String} detail.value the selected item. Type is the same as the type of `items`.\n   */\n\n  /**\n   * Fired when the user sets a custom value.\n   * @event custom-value-set\n   * @param {String} detail the custom value\n   */\n\n  /**\n   * Fired when value changes.\n   * To comply with https://developer.mozilla.org/en-US/docs/Web/Events/change\n   * @event change\n   */\n};\n","/**\n@license\nCopyright (c) 2018 Vaadin Ltd.\nThis program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n*/\nimport { ComboBoxPlaceholder } from './vaadin-combo-box-placeholder.js';\n\n/**\n * @polymerMixin\n */\nexport const ComboBoxDataProviderMixin = superClass => class DataProviderMixin extends superClass {\n\n  static get properties() {\n    return {\n\n      /**\n       * Number of items fetched at a time from the dataprovider.\n       */\n      pageSize: {\n        type: Number,\n        value: 50,\n        observer: '_pageSizeChanged'\n      },\n\n      /**\n       * Total number of items.\n       */\n      size: {\n        type: Number,\n        observer: '_sizeChanged'\n      },\n\n      /**\n       * Function that provides items lazily. Receives arguments `params`, `callback`\n       *\n       * `params.page` Requested page index\n       *\n       * `params.pageSize` Current page size\n       *\n       * `params.filter` Currently applied filter\n       *\n       * `callback(items, size)` Callback function with arguments:\n       *   - `items` Current page of items\n       *   - `size` Total number of items.\n       */\n      dataProvider: {\n        type: Object,\n        observer: '_dataProviderChanged'\n      },\n\n      _pendingRequests: {\n        value: () => {\n          return {};\n        }\n      },\n\n      __placeHolder: {\n        value: new ComboBoxPlaceholder()\n      }\n\n    };\n  }\n\n  static get observers() {\n    return [\n      '_dataProviderFilterChanged(filter, dataProvider)',\n      '_dataProviderClearFilter(dataProvider, opened, value)',\n      '_warnDataProviderValue(dataProvider, value)',\n      '_ensureFirstPage(opened)',\n    ];\n  }\n\n  _dataProviderClearFilter(dataProvider, opened, value) {\n    // Can't depend on filter in this obsever as we don't want\n    // to clear the filter whenever it's set\n    if (dataProvider && this.filter) {\n      this.size = undefined;\n      this._pendingRequests = {};\n      this.filter = '';\n      this.clearCache();\n    }\n  }\n\n  ready() {\n    super.ready();\n    this.clearCache();\n    this.$.overlay.addEventListener('index-requested', e => {\n      const index = e.detail.index;\n      if (index !== undefined) {\n        const page = this._getPageForIndex(index);\n        if (this._shouldLoadPage(page)) {\n          this._loadPage(page);\n        }\n      }\n    });\n  }\n\n  _dataProviderFilterChanged() {\n    if (this.dataProvider && this.opened) {\n      this.size = undefined;\n      this._pendingRequests = {};\n      this.clearCache();\n    }\n  }\n\n  _ensureFirstPage(opened) {\n    if (opened && this._shouldLoadPage(0)) {\n      this._loadPage(0);\n    }\n  }\n\n  _shouldLoadPage(page) {\n    if (!this.filteredItems || this._forceNextRequest) {\n      this._forceNextRequest = false;\n      return true;\n    }\n\n    const loadedItem = this.filteredItems[page * this.pageSize];\n    if (loadedItem !== undefined) {\n      return loadedItem instanceof ComboBoxPlaceholder;\n    } else {\n      return this.size === undefined;\n    }\n  }\n\n  _loadPage(page) {\n    // make sure same page isn't requested multiple times.\n    if (!this._pendingRequests[page] && this.dataProvider) {\n      this.loading = true;\n\n      const params = {\n        page,\n        pageSize: this.pageSize,\n        filter: this.filter\n      };\n\n      const callback = (items, size) => {\n        if (this._pendingRequests[page] === callback) {\n          if (!this.filteredItems) {\n            const filteredItems = [];\n            filteredItems.splice(params.page * params.pageSize, items.length, ...items);\n            this.filteredItems = filteredItems;\n          } else {\n            this.splice('filteredItems', params.page * params.pageSize, items.length, ...items);\n          }\n          // Update selectedItem from filteredItems if value is set\n          if (this._isValidValue(this.value) && this._getItemValue(this.selectedItem) !== this.value) {\n            this._selectItemForValue(this.value);\n          }\n          this.size = size;\n\n          delete this._pendingRequests[page];\n\n          if (Object.keys(this._pendingRequests).length === 0) {\n            this.loading = false;\n          }\n        }\n      };\n      this._pendingRequests[page] = callback;\n      this.dataProvider(params, callback);\n    }\n  }\n\n  _getPageForIndex(index) {\n    return Math.floor(index / this.pageSize);\n  }\n\n  /**\n   * Clears the cached pages and reloads data from dataprovider when needed.\n   */\n  clearCache() {\n    if (!this.dataProvider) {\n      return;\n    }\n    this._pendingRequests = {};\n    const filteredItems = [];\n    for (let i = 0; i < (this.size || 0); i++) {\n      filteredItems.push(this.__placeHolder);\n    }\n    this.filteredItems = filteredItems;\n    if (this.opened) {\n      this._loadPage(0);\n    } else {\n      this._forceNextRequest = true;\n    }\n  }\n\n  _sizeChanged(size = 0) {\n    const filteredItems = (this.filteredItems || []).slice(0, size);\n    for (let i = 0; i < size; i++) {\n      filteredItems[i] = filteredItems[i] !== undefined ? filteredItems[i] : this.__placeHolder;\n    }\n    this.filteredItems = filteredItems;\n  }\n\n  _pageSizeChanged(pageSize, oldPageSize) {\n    if (Math.floor(pageSize) !== pageSize || pageSize === 0) {\n      this.pageSize = oldPageSize;\n      throw new Error('`pageSize` value must be an integer > 0');\n    }\n    this.clearCache();\n  }\n\n  _dataProviderChanged(dataProvider, oldDataProvider) {\n    this._ensureItemsOrDataProvider(() => {\n      this.dataProvider = oldDataProvider;\n    });\n  }\n\n  _ensureItemsOrDataProvider(restoreOldValueCallback) {\n    if (this.items !== undefined && this.dataProvider !== undefined) {\n      restoreOldValueCallback();\n      throw new Error('Using `items` and `dataProvider` together is not supported');\n    }\n  }\n\n  _warnDataProviderValue(dataProvider, value) {\n    if (dataProvider && value !== '' && (this.selectedItem === undefined || this.selectedItem === null)) {\n      const valueIndex = this._indexOfValue(value, this.filteredItems);\n      if (valueIndex < 0 || !this._getItemLabel(this.filteredItems[valueIndex])) {\n        /* eslint-disable no-console */\n        console.warn(\n          'Warning: unable to determine the label for the provided `value`. ' +\n          'Nothing to display in the text field. This usually happens when ' +\n          'setting an initial `value` before any items are returned from ' +\n          'the `dataProvider` callback. Consider setting `selectedItem` ' +\n          'instead of `value`'\n        );\n        /* eslint-enable no-console */\n      }\n    }\n  }\n\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\nimport '@polymer/iron-a11y-keys-behavior/iron-a11y-keys-behavior.js';\n\nimport {IronResizableBehavior} from '@polymer/iron-resizable-behavior/iron-resizable-behavior.js';\nimport {IronScrollTargetBehavior} from '@polymer/iron-scroll-target-behavior/iron-scroll-target-behavior.js';\nimport {OptionalMutableDataBehavior} from '@polymer/polymer/lib/legacy/mutable-data-behavior.js';\nimport {Polymer as Polymer} from '@polymer/polymer/lib/legacy/polymer-fn.js';\nimport {dom} from '@polymer/polymer/lib/legacy/polymer.dom.js';\nimport {Templatizer} from '@polymer/polymer/lib/legacy/templatizer-behavior.js';\nimport {animationFrame, idlePeriod, microTask} from '@polymer/polymer/lib/utils/async.js';\nimport {Debouncer} from '@polymer/polymer/lib/utils/debounce.js';\nimport {enqueueDebouncer, flush} from '@polymer/polymer/lib/utils/flush.js';\nimport {html} from '@polymer/polymer/lib/utils/html-tag.js';\nimport {matches, translate} from '@polymer/polymer/lib/utils/path.js';\nimport {TemplateInstanceBase} from '@polymer/polymer/lib/utils/templatize.js';\n\nvar IOS = navigator.userAgent.match(/iP(?:hone|ad;(?: U;)? CPU) OS (\\d+)/);\nvar IOS_TOUCH_SCROLLING = IOS && IOS[1] >= 8;\nvar DEFAULT_PHYSICAL_COUNT = 3;\nvar HIDDEN_Y = '-10000px';\nvar SECRET_TABINDEX = -100;\n\n/**\n\n`iron-list` displays a virtual, 'infinite' list. The template inside\nthe iron-list element represents the DOM to create for each list item.\nThe `items` property specifies an array of list item data.\n\nFor performance reasons, not every item in the list is rendered at once;\ninstead a small subset of actual template elements *(enough to fill the\nviewport)* are rendered and reused as the user scrolls. As such, it is important\nthat all state of the list template is bound to the model driving it, since the\nview may be reused with a new model at any time. Particularly, any state that\nmay change as the result of a user interaction with the list item must be bound\nto the model to avoid view state inconsistency.\n\n### Sizing iron-list\n\n`iron-list` must either be explicitly sized, or delegate scrolling to an\nexplicitly sized parent. By \"explicitly sized\", we mean it either has an\nexplicit CSS `height` property set via a class or inline style, or else is sized\nby other layout means (e.g. the `flex` or `fit` classes).\n\n#### Flexbox - [jsbin](https://jsbin.com/vejoni/edit?html,output)\n\n```html\n<template is=\"x-list\">\n  <style>\n    :host {\n      display: block;\n      height: 100vh;\n      display: flex;\n      flex-direction: column;\n    }\n\n    iron-list {\n      flex: 1 1 auto;\n    }\n  </style>\n  <app-toolbar>App name</app-toolbar>\n  <iron-list items=\"[[items]]\">\n    <template>\n      <div>\n        ...\n      </div>\n    </template>\n  </iron-list>\n</template>\n```\n#### Explicit size - [jsbin](https://jsbin.com/vopucus/edit?html,output)\n```html\n<template is=\"x-list\">\n  <style>\n    :host {\n      display: block;\n    }\n\n    iron-list {\n      height: 100vh; /* don't use % values unless the parent element is sized.\n*\\/\n    }\n  </style>\n  <iron-list items=\"[[items]]\">\n    <template>\n      <div>\n        ...\n      </div>\n    </template>\n  </iron-list>\n</template>\n```\n#### Main document scrolling -\n[jsbin](https://jsbin.com/wevirow/edit?html,output)\n```html\n<head>\n  <style>\n    body {\n      height: 100vh;\n      margin: 0;\n      display: flex;\n      flex-direction: column;\n    }\n\n    app-toolbar {\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n    }\n\n    iron-list {\n      /* add padding since the app-toolbar is fixed at the top *\\/\n      padding-top: 64px;\n    }\n  </style>\n</head>\n<body>\n  <app-toolbar>App name</app-toolbar>\n  <iron-list scroll-target=\"document\">\n    <template>\n      <div>\n        ...\n      </div>\n    </template>\n  </iron-list>\n</body>\n```\n\n`iron-list` must be given a `<template>` which contains exactly one element. In\nthe examples above we used a `<div>`, but you can provide any element (including\ncustom elements).\n\n### Template model\n\nList item templates should bind to template models of the following structure:\n\n```js\n{\n  index: 0,        // index in the item array\n  selected: false, // true if the current item is selected\n  tabIndex: -1,    // a dynamically generated tabIndex for focus management\n  item: {}         // user data corresponding to items[index]\n}\n```\n\nAlternatively, you can change the property name used as data index by changing\nthe `indexAs` property. The `as` property defines the name of the variable to\nadd to the binding scope for the array.\n\nFor example, given the following `data` array:\n\n##### data.json\n\n```js\n[\n  {\"name\": \"Bob\"},\n  {\"name\": \"Tim\"},\n  {\"name\": \"Mike\"}\n]\n```\n\nThe following code would render the list (note the name property is bound from\nthe model object provided to the template scope):\n\n```html\n<iron-ajax url=\"data.json\" last-response=\"{{data}}\" auto></iron-ajax>\n<iron-list items=\"[[data]]\" as=\"item\">\n  <template>\n    <div>\n      Name: [[item.name]]\n    </div>\n  </template>\n</iron-list>\n```\n\n### Grid layout\n\n`iron-list` supports a grid layout in addition to linear layout by setting\nthe `grid` attribute.  In this case, the list template item must have both fixed\nwidth and height (e.g. via CSS). Based on this, the number of items\nper row are determined automatically based on the size of the list viewport.\n\n### Accessibility\n\n`iron-list` automatically manages the focus state for the items. It also\nprovides a `tabIndex` property within the template scope that can be used for\nkeyboard navigation. For example, users can press the up and down keys to move\nto previous and next items in the list:\n\n```html\n<iron-list items=\"[[data]]\" as=\"item\">\n  <template>\n    <div tabindex$=\"[[tabIndex]]\">\n      Name: [[item.name]]\n    </div>\n  </template>\n</iron-list>\n```\n\n### Styling\n\nYou can use the `--iron-list-items-container` mixin to style the container of\nitems:\n\n```css\niron-list {\n --iron-list-items-container: {\n    margin: auto;\n  };\n}\n```\n\n### Resizing\n\n`iron-list` lays out the items when it receives a notification via the\n`iron-resize` event. This event is fired by any element that implements\n`IronResizableBehavior`.\n\nBy default, elements such as `iron-pages`, `paper-tabs` or `paper-dialog` will\ntrigger this event automatically. If you hide the list manually (e.g. you use\n`display: none`) you might want to implement `IronResizableBehavior` or fire\nthis event manually right after the list became visible again. For example:\n\n```js\ndocument.querySelector('iron-list').fire('iron-resize');\n```\n\n### When should `<iron-list>` be used?\n\n`iron-list` should be used when a page has significantly more DOM nodes than the\nones visible on the screen. e.g. the page has 500 nodes, but only 20 are visible\nat a time. This is why we refer to it as a `virtual` list. In this case, a\n`dom-repeat` will still create 500 nodes which could slow down the web app, but\n`iron-list` will only create 20.\n\nHowever, having an `iron-list` does not mean that you can load all the data at\nonce. Say you have a million records in the database, you want to split the data\ninto pages so you can bring in a page at the time. The page could contain 500\nitems, and iron-list will only render 20.\n\n@group Iron Element\n@element iron-list\n@demo demo/index.html\n\n*/\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n\n      @media only screen and (-webkit-max-device-pixel-ratio: 1) {\n        :host {\n          will-change: transform;\n        }\n      }\n\n      #items {\n        @apply --iron-list-items-container;\n        position: relative;\n      }\n\n      :host(:not([grid])) #items > ::slotted(*) {\n        width: 100%;\n      }\n\n      #items > ::slotted(*) {\n        box-sizing: border-box;\n        margin: 0;\n        position: absolute;\n        top: 0;\n        will-change: transform;\n      }\n    </style>\n\n    <array-selector id=\"selector\" items=\"{{items}}\" selected=\"{{selectedItems}}\" selected-item=\"{{selectedItem}}\"></array-selector>\n\n    <div id=\"items\">\n      <slot></slot>\n    </div>\n`,\n\n  is: 'iron-list',\n\n  properties: {\n\n    /**\n     * An array containing items determining how many instances of the template\n     * to stamp and that that each template instance should bind to.\n     */\n    items: {type: Array},\n\n    /**\n     * The name of the variable to add to the binding scope for the array\n     * element associated with a given template instance.\n     */\n    as: {type: String, value: 'item'},\n\n    /**\n     * The name of the variable to add to the binding scope with the index\n     * for the row.\n     */\n    indexAs: {type: String, value: 'index'},\n\n    /**\n     * The name of the variable to add to the binding scope to indicate\n     * if the row is selected.\n     */\n    selectedAs: {type: String, value: 'selected'},\n\n    /**\n     * When true, the list is rendered as a grid. Grid items must have\n     * fixed width and height set via CSS. e.g.\n     *\n     * ```html\n     * <iron-list grid>\n     *   <template>\n     *      <div style=\"width: 100px; height: 100px;\"> 100x100 </div>\n     *   </template>\n     * </iron-list>\n     * ```\n     */\n    grid: {\n      type: Boolean,\n      value: false,\n      reflectToAttribute: true,\n      observer: '_gridChanged'\n    },\n\n    /**\n     * When true, tapping a row will select the item, placing its data model\n     * in the set of selected items retrievable via the selection property.\n     *\n     * Note that tapping focusable elements within the list item will not\n     * result in selection, since they are presumed to have their * own action.\n     */\n    selectionEnabled: {type: Boolean, value: false},\n\n    /**\n     * When `multiSelection` is false, this is the currently selected item, or\n     * `null` if no item is selected.\n     */\n    selectedItem: {type: Object, notify: true},\n\n    /**\n     * When `multiSelection` is true, this is an array that contains the\n     * selected items.\n     */\n    selectedItems: {type: Object, notify: true},\n\n    /**\n     * When `true`, multiple items may be selected at once (in this case,\n     * `selected` is an array of currently selected items).  When `false`,\n     * only one item may be selected at a time.\n     */\n    multiSelection: {type: Boolean, value: false},\n\n    /**\n     * The offset top from the scrolling element to the iron-list element.\n     * This value can be computed using the position returned by\n     * `getBoundingClientRect()` although it's preferred to use a constant value\n     * when possible.\n     *\n     * This property is useful when an external scrolling element is used and\n     * there's some offset between the scrolling element and the list. For\n     * example: a header is placed above the list.\n     */\n    scrollOffset: {type: Number, value: 0}\n  },\n\n  observers: [\n    '_itemsChanged(items.*)',\n    '_selectionEnabledChanged(selectionEnabled)',\n    '_multiSelectionChanged(multiSelection)',\n    '_setOverflow(scrollTarget, scrollOffset)'\n  ],\n\n  behaviors: [\n    Templatizer,\n    IronResizableBehavior,\n    IronScrollTargetBehavior,\n    OptionalMutableDataBehavior\n  ],\n\n  /**\n   * The ratio of hidden tiles that should remain in the scroll direction.\n   * Recommended value ~0.5, so it will distribute tiles evenly in both\n   * directions.\n   */\n  _ratio: 0.5,\n\n  /**\n   * The padding-top value for the list.\n   */\n  _scrollerPaddingTop: 0,\n\n  /**\n   * This value is the same as `scrollTop`.\n   */\n  _scrollPosition: 0,\n\n  /**\n   * The sum of the heights of all the tiles in the DOM.\n   */\n  _physicalSize: 0,\n\n  /**\n   * The average `offsetHeight` of the tiles observed till now.\n   */\n  _physicalAverage: 0,\n\n  /**\n   * The number of tiles which `offsetHeight` > 0 observed until now.\n   */\n  _physicalAverageCount: 0,\n\n  /**\n   * The Y position of the item rendered in the `_physicalStart`\n   * tile relative to the scrolling list.\n   */\n  _physicalTop: 0,\n\n  /**\n   * The number of items in the list.\n   */\n  _virtualCount: 0,\n\n  /**\n   * The estimated scroll height based on `_physicalAverage`\n   */\n  _estScrollHeight: 0,\n\n  /**\n   * The scroll height of the dom node\n   */\n  _scrollHeight: 0,\n\n  /**\n   * The height of the list. This is referred as the viewport in the context of\n   * list.\n   */\n  _viewportHeight: 0,\n\n  /**\n   * The width of the list. This is referred as the viewport in the context of\n   * list.\n   */\n  _viewportWidth: 0,\n\n  /**\n   * An array of DOM nodes that are currently in the tree\n   * @type {?Array<!TemplateInstanceBase>}\n   */\n  _physicalItems: null,\n\n  /**\n   * An array of heights for each item in `_physicalItems`\n   * @type {?Array<number>}\n   */\n  _physicalSizes: null,\n\n  /**\n   * A cached value for the first visible index.\n   * See `firstVisibleIndex`\n   * @type {?number}\n   */\n  _firstVisibleIndexVal: null,\n\n  /**\n   * A cached value for the last visible index.\n   * See `lastVisibleIndex`\n   * @type {?number}\n   */\n  _lastVisibleIndexVal: null,\n\n  /**\n   * The max number of pages to render. One page is equivalent to the height of\n   * the list.\n   */\n  _maxPages: 2,\n\n  /**\n   * The currently focused physical item.\n   */\n  _focusedItem: null,\n\n  /**\n   * The virtual index of the focused item.\n   */\n  _focusedVirtualIndex: -1,\n\n  /**\n   * The physical index of the focused item.\n   */\n  _focusedPhysicalIndex: -1,\n\n  /**\n   * The the item that is focused if it is moved offscreen.\n   * @private {?TemplatizerNode}\n   */\n  _offscreenFocusedItem: null,\n\n  /**\n   * The item that backfills the `_offscreenFocusedItem` in the physical items\n   * list when that item is moved offscreen.\n   */\n  _focusBackfillItem: null,\n\n  /**\n   * The maximum items per row\n   */\n  _itemsPerRow: 1,\n\n  /**\n   * The width of each grid item\n   */\n  _itemWidth: 0,\n\n  /**\n   * The height of the row in grid layout.\n   */\n  _rowHeight: 0,\n\n  /**\n   * The cost of stamping a template in ms.\n   */\n  _templateCost: 0,\n\n  /**\n   * Needed to pass event.model property to declarative event handlers -\n   * see polymer/polymer#4339.\n   */\n  _parentModel: true,\n\n  /**\n   * The bottom of the physical content.\n   */\n  get _physicalBottom() {\n    return this._physicalTop + this._physicalSize;\n  },\n\n  /**\n   * The bottom of the scroll.\n   */\n  get _scrollBottom() {\n    return this._scrollPosition + this._viewportHeight;\n  },\n\n  /**\n   * The n-th item rendered in the last physical item.\n   */\n  get _virtualEnd() {\n    return this._virtualStart + this._physicalCount - 1;\n  },\n\n  /**\n   * The height of the physical content that isn't on the screen.\n   */\n  get _hiddenContentSize() {\n    var size =\n        this.grid ? this._physicalRows * this._rowHeight : this._physicalSize;\n    return size - this._viewportHeight;\n  },\n\n  /**\n   * The parent node for the _userTemplate.\n   */\n  get _itemsParent() {\n    return dom(dom(this._userTemplate).parentNode);\n  },\n\n  /**\n   * The maximum scroll top value.\n   */\n  get _maxScrollTop() {\n    return this._estScrollHeight - this._viewportHeight + this._scrollOffset;\n  },\n\n  /**\n   * The largest n-th value for an item such that it can be rendered in\n   * `_physicalStart`.\n   */\n  get _maxVirtualStart() {\n    var virtualCount = this._convertIndexToCompleteRow(this._virtualCount);\n    return Math.max(0, virtualCount - this._physicalCount);\n  },\n\n  set _virtualStart(val) {\n    val = this._clamp(val, 0, this._maxVirtualStart);\n    if (this.grid) {\n      val = val - (val % this._itemsPerRow);\n    }\n    this._virtualStartVal = val;\n  },\n\n  get _virtualStart() {\n    return this._virtualStartVal || 0;\n  },\n\n  /**\n   * The k-th tile that is at the top of the scrolling list.\n   */\n  set _physicalStart(val) {\n    val = val % this._physicalCount;\n    if (val < 0) {\n      val = this._physicalCount + val;\n    }\n    if (this.grid) {\n      val = val - (val % this._itemsPerRow);\n    }\n    this._physicalStartVal = val;\n  },\n\n  get _physicalStart() {\n    return this._physicalStartVal || 0;\n  },\n\n  /**\n   * The k-th tile that is at the bottom of the scrolling list.\n   */\n  get _physicalEnd() {\n    return (this._physicalStart + this._physicalCount - 1) %\n        this._physicalCount;\n  },\n\n  set _physicalCount(val) {\n    this._physicalCountVal = val;\n  },\n\n  get _physicalCount() {\n    return this._physicalCountVal || 0;\n  },\n\n  /**\n   * An optimal physical size such that we will have enough physical items\n   * to fill up the viewport and recycle when the user scrolls.\n   *\n   * This default value assumes that we will at least have the equivalent\n   * to a viewport of physical items above and below the user's viewport.\n   */\n  get _optPhysicalSize() {\n    return this._viewportHeight === 0 ? Infinity :\n                                        this._viewportHeight * this._maxPages;\n  },\n\n  /**\n   * True if the current list is visible.\n   */\n  get _isVisible() {\n    return Boolean(this.offsetWidth || this.offsetHeight);\n  },\n\n  /**\n   * Gets the index of the first visible item in the viewport.\n   *\n   * @type {number}\n   */\n  get firstVisibleIndex() {\n    var idx = this._firstVisibleIndexVal;\n    if (idx == null) {\n      var physicalOffset = this._physicalTop + this._scrollOffset;\n\n      idx = this._iterateItems(function(pidx, vidx) {\n        physicalOffset += this._getPhysicalSizeIncrement(pidx);\n\n        if (physicalOffset > this._scrollPosition) {\n          return this.grid ? vidx - (vidx % this._itemsPerRow) : vidx;\n        }\n        // Handle a partially rendered final row in grid mode\n        if (this.grid && this._virtualCount - 1 === vidx) {\n          return vidx - (vidx % this._itemsPerRow);\n        }\n      }) ||\n          0;\n      this._firstVisibleIndexVal = idx;\n    }\n    return idx;\n  },\n\n  /**\n   * Gets the index of the last visible item in the viewport.\n   *\n   * @type {number}\n   */\n  get lastVisibleIndex() {\n    var idx = this._lastVisibleIndexVal;\n    if (idx == null) {\n      if (this.grid) {\n        idx = Math.min(\n            this._virtualCount,\n            this.firstVisibleIndex + this._estRowsInView * this._itemsPerRow -\n                1);\n      } else {\n        var physicalOffset = this._physicalTop + this._scrollOffset;\n        this._iterateItems(function(pidx, vidx) {\n          if (physicalOffset < this._scrollBottom) {\n            idx = vidx;\n          }\n          physicalOffset += this._getPhysicalSizeIncrement(pidx);\n        });\n      }\n      this._lastVisibleIndexVal = idx;\n    }\n    return idx;\n  },\n\n  get _defaultScrollTarget() {\n    return this;\n  },\n\n  get _virtualRowCount() {\n    return Math.ceil(this._virtualCount / this._itemsPerRow);\n  },\n\n  get _estRowsInView() {\n    return Math.ceil(this._viewportHeight / this._rowHeight);\n  },\n\n  get _physicalRows() {\n    return Math.ceil(this._physicalCount / this._itemsPerRow);\n  },\n\n  get _scrollOffset() {\n    return this._scrollerPaddingTop + this.scrollOffset;\n  },\n\n  ready: function() {\n    this.addEventListener('focus', this._didFocus.bind(this), true);\n  },\n\n  attached: function() {\n    this._debounce('_render', this._render, animationFrame);\n    // `iron-resize` is fired when the list is attached if the event is added\n    // before attached causing unnecessary work.\n    this.listen(this, 'iron-resize', '_resizeHandler');\n    this.listen(this, 'keydown', '_keydownHandler');\n  },\n\n  detached: function() {\n    this.unlisten(this, 'iron-resize', '_resizeHandler');\n    this.unlisten(this, 'keydown', '_keydownHandler');\n  },\n\n  /**\n   * Set the overflow property if this element has its own scrolling region\n   */\n  _setOverflow: function(scrollTarget) {\n    this.style.webkitOverflowScrolling = scrollTarget === this ? 'touch' : '';\n    this.style.overflowY = scrollTarget === this ? 'auto' : '';\n    // Clear cache.\n    this._lastVisibleIndexVal = null;\n    this._firstVisibleIndexVal = null;\n    this._debounce('_render', this._render, animationFrame);\n  },\n\n  /**\n   * Invoke this method if you dynamically update the viewport's\n   * size or CSS padding.\n   *\n   * @method updateViewportBoundaries\n   */\n  updateViewportBoundaries: function() {\n    var styles = window.getComputedStyle(this);\n    this._scrollerPaddingTop =\n        this.scrollTarget === this ? 0 : parseInt(styles['padding-top'], 10);\n    this._isRTL = Boolean(styles.direction === 'rtl');\n    this._viewportWidth = this.$.items.offsetWidth;\n    this._viewportHeight = this._scrollTargetHeight;\n    this.grid && this._updateGridMetrics();\n  },\n\n  /**\n   * Recycles the physical items when needed.\n   */\n  _scrollHandler: function() {\n    var scrollTop = Math.max(0, Math.min(this._maxScrollTop, this._scrollTop));\n    var delta = scrollTop - this._scrollPosition;\n    var isScrollingDown = delta >= 0;\n    // Track the current scroll position.\n    this._scrollPosition = scrollTop;\n    // Clear indexes for first and last visible indexes.\n    this._firstVisibleIndexVal = null;\n    this._lastVisibleIndexVal = null;\n    // Random access.\n    if (Math.abs(delta) > this._physicalSize && this._physicalSize > 0) {\n      delta = delta - this._scrollOffset;\n      var idxAdjustment =\n          Math.round(delta / this._physicalAverage) * this._itemsPerRow;\n      this._virtualStart = this._virtualStart + idxAdjustment;\n      this._physicalStart = this._physicalStart + idxAdjustment;\n      // Estimate new physical offset.\n      this._physicalTop = Math.floor(this._virtualStart / this._itemsPerRow) *\n          this._physicalAverage;\n      this._update();\n    } else if (this._physicalCount > 0) {\n      var reusables = this._getReusables(isScrollingDown);\n      if (isScrollingDown) {\n        this._physicalTop = reusables.physicalTop;\n        this._virtualStart = this._virtualStart + reusables.indexes.length;\n        this._physicalStart = this._physicalStart + reusables.indexes.length;\n      } else {\n        this._virtualStart = this._virtualStart - reusables.indexes.length;\n        this._physicalStart = this._physicalStart - reusables.indexes.length;\n      }\n      this._update(\n          reusables.indexes, isScrollingDown ? null : reusables.indexes);\n      this._debounce(\n          '_increasePoolIfNeeded',\n          this._increasePoolIfNeeded.bind(this, 0),\n          microTask);\n    }\n  },\n\n  /**\n   * Returns an object that contains the indexes of the physical items\n   * that might be reused and the physicalTop.\n   *\n   * @param {boolean} fromTop If the potential reusable items are above the scrolling region.\n   */\n  _getReusables: function(fromTop) {\n    var ith, lastIth, offsetContent, physicalItemHeight;\n    var idxs = [];\n    var protectedOffsetContent = this._hiddenContentSize * this._ratio;\n    var virtualStart = this._virtualStart;\n    var virtualEnd = this._virtualEnd;\n    var physicalCount = this._physicalCount;\n    var top = this._physicalTop + this._scrollOffset;\n    var bottom = this._physicalBottom + this._scrollOffset;\n    var scrollTop = this._scrollTop;\n    var scrollBottom = this._scrollBottom;\n\n    if (fromTop) {\n      ith = this._physicalStart;\n      lastIth = this._physicalEnd;\n      offsetContent = scrollTop - top;\n    } else {\n      ith = this._physicalEnd;\n      lastIth = this._physicalStart;\n      offsetContent = bottom - scrollBottom;\n    }\n    while (true) {\n      physicalItemHeight = this._getPhysicalSizeIncrement(ith);\n      offsetContent = offsetContent - physicalItemHeight;\n      if (idxs.length >= physicalCount ||\n          offsetContent <= protectedOffsetContent) {\n        break;\n      }\n      if (fromTop) {\n        // Check that index is within the valid range.\n        if (virtualEnd + idxs.length + 1 >= this._virtualCount) {\n          break;\n        }\n        // Check that the index is not visible.\n        if (top + physicalItemHeight >= scrollTop - this._scrollOffset) {\n          break;\n        }\n        idxs.push(ith);\n        top = top + physicalItemHeight;\n        ith = (ith + 1) % physicalCount;\n      } else {\n        // Check that index is within the valid range.\n        if (virtualStart - idxs.length <= 0) {\n          break;\n        }\n        // Check that the index is not visible.\n        if (top + this._physicalSize - physicalItemHeight <= scrollBottom) {\n          break;\n        }\n        idxs.push(ith);\n        top = top - physicalItemHeight;\n        ith = (ith === 0) ? physicalCount - 1 : ith - 1;\n      }\n    }\n    return {indexes: idxs, physicalTop: top - this._scrollOffset};\n  },\n\n  /**\n   * Update the list of items, starting from the `_virtualStart` item.\n   * @param {!Array<number>=} itemSet\n   * @param {!Array<number>=} movingUp\n   */\n  _update: function(itemSet, movingUp) {\n    if ((itemSet && itemSet.length === 0) || this._physicalCount === 0) {\n      return;\n    }\n    this._manageFocus();\n    this._assignModels(itemSet);\n    this._updateMetrics(itemSet);\n    // Adjust offset after measuring.\n    if (movingUp) {\n      while (movingUp.length) {\n        var idx = movingUp.pop();\n        this._physicalTop -= this._getPhysicalSizeIncrement(idx);\n      }\n    }\n    this._positionItems();\n    this._updateScrollerSize();\n  },\n\n  /**\n   * Creates a pool of DOM elements and attaches them to the local dom.\n   *\n   * @param {number} size Size of the pool\n   */\n  _createPool: function(size) {\n    this._ensureTemplatized();\n    var i, inst;\n    var physicalItems = new Array(size);\n    for (i = 0; i < size; i++) {\n      inst = this.stamp(null);\n      // TODO(blasten):\n      // First element child is item; Safari doesn't support children[0]\n      // on a doc fragment. Test this to see if it still matters.\n      physicalItems[i] = inst.root.querySelector('*');\n      this._itemsParent.appendChild(inst.root);\n    }\n    return physicalItems;\n  },\n\n  _isClientFull: function() {\n    return this._scrollBottom != 0 &&\n        this._physicalBottom - 1 >= this._scrollBottom &&\n        this._physicalTop <= this._scrollPosition;\n  },\n\n  /**\n   * Increases the pool size.\n   */\n  _increasePoolIfNeeded: function(count) {\n    var nextPhysicalCount = this._clamp(\n        this._physicalCount + count,\n        DEFAULT_PHYSICAL_COUNT,\n        this._virtualCount - this._virtualStart);\n    nextPhysicalCount = this._convertIndexToCompleteRow(nextPhysicalCount);\n    if (this.grid) {\n      var correction = nextPhysicalCount % this._itemsPerRow;\n      if (correction && nextPhysicalCount - correction <= this._physicalCount) {\n        nextPhysicalCount += this._itemsPerRow;\n      }\n      nextPhysicalCount -= correction;\n    }\n    var delta = nextPhysicalCount - this._physicalCount;\n    var nextIncrease = Math.round(this._physicalCount * 0.5);\n\n    if (delta < 0) {\n      return;\n    }\n    if (delta > 0) {\n      var ts = window.performance.now();\n      // Concat arrays in place.\n      [].push.apply(this._physicalItems, this._createPool(delta));\n      // Push 0s into physicalSizes. Can't use Array.fill because IE11 doesn't\n      // support it.\n      for (var i = 0; i < delta; i++) {\n        this._physicalSizes.push(0);\n      }\n      this._physicalCount = this._physicalCount + delta;\n      // Update the physical start if it needs to preserve the model of the\n      // focused item. In this situation, the focused item is currently rendered\n      // and its model would have changed after increasing the pool if the\n      // physical start remained unchanged.\n      if (this._physicalStart > this._physicalEnd &&\n          this._isIndexRendered(this._focusedVirtualIndex) &&\n          this._getPhysicalIndex(this._focusedVirtualIndex) <\n              this._physicalEnd) {\n        this._physicalStart = this._physicalStart + delta;\n      }\n      this._update();\n      this._templateCost = (window.performance.now() - ts) / delta;\n      nextIncrease = Math.round(this._physicalCount * 0.5);\n    }\n    // The upper bounds is not fixed when dealing with a grid that doesn't\n    // fill it's last row with the exact number of items per row.\n    if (this._virtualEnd >= this._virtualCount - 1 || nextIncrease === 0) {\n      // Do nothing.\n    } else if (!this._isClientFull()) {\n      this._debounce(\n          '_increasePoolIfNeeded',\n          this._increasePoolIfNeeded.bind(this, nextIncrease),\n          microTask);\n    } else if (this._physicalSize < this._optPhysicalSize) {\n      // Yield and increase the pool during idle time until the physical size is\n      // optimal.\n      this._debounce(\n          '_increasePoolIfNeeded',\n          this._increasePoolIfNeeded.bind(\n              this,\n              this._clamp(\n                  Math.round(50 / this._templateCost), 1, nextIncrease)),\n          idlePeriod);\n    }\n  },\n\n  /**\n   * Renders the a new list.\n   */\n  _render: function() {\n    if (!this.isAttached || !this._isVisible) {\n      return;\n    }\n    if (this._physicalCount !== 0) {\n      var reusables = this._getReusables(true);\n      this._physicalTop = reusables.physicalTop;\n      this._virtualStart = this._virtualStart + reusables.indexes.length;\n      this._physicalStart = this._physicalStart + reusables.indexes.length;\n      this._update(reusables.indexes);\n      this._update();\n      this._increasePoolIfNeeded(0);\n    } else if (this._virtualCount > 0) {\n      // Initial render\n      this.updateViewportBoundaries();\n      this._increasePoolIfNeeded(DEFAULT_PHYSICAL_COUNT);\n    }\n  },\n\n  /**\n   * Templetizes the user template.\n   */\n  _ensureTemplatized: function() {\n    if (this.ctor) {\n      return;\n    }\n    this._userTemplate = this.queryEffectiveChildren('template');\n    if (!this._userTemplate) {\n      console.warn('iron-list requires a template to be provided in light-dom');\n    }\n    var instanceProps = {};\n    instanceProps.__key__ = true;\n    instanceProps[this.as] = true;\n    instanceProps[this.indexAs] = true;\n    instanceProps[this.selectedAs] = true;\n    instanceProps.tabIndex = true;\n    this._instanceProps = instanceProps;\n    this.templatize(this._userTemplate, this.mutableData);\n  },\n\n  _gridChanged: function(newGrid, oldGrid) {\n    if (typeof oldGrid === 'undefined')\n      return;\n    this.notifyResize();\n    flush();\n    newGrid && this._updateGridMetrics();\n  },\n\n  /**\n   * Called when the items have changed. That is, reassignments\n   * to `items`, splices or updates to a single item.\n   */\n  _itemsChanged: function(change) {\n    if (change.path === 'items') {\n      this._virtualStart = 0;\n      this._physicalTop = 0;\n      this._virtualCount = this.items ? this.items.length : 0;\n      this._physicalIndexForKey = {};\n      this._firstVisibleIndexVal = null;\n      this._lastVisibleIndexVal = null;\n      this._physicalCount = this._physicalCount || 0;\n      this._physicalItems = this._physicalItems || [];\n      this._physicalSizes = this._physicalSizes || [];\n      this._physicalStart = 0;\n      if (this._scrollTop > this._scrollOffset) {\n        this._resetScrollPosition(0);\n      }\n      this._removeFocusedItem();\n      this._debounce('_render', this._render, animationFrame);\n    } else if (change.path === 'items.splices') {\n      this._adjustVirtualIndex(change.value.indexSplices);\n      this._virtualCount = this.items ? this.items.length : 0;\n      // Only blur if at least one item is added or removed.\n      var itemAddedOrRemoved = change.value.indexSplices.some(function(splice) {\n        return splice.addedCount > 0 || splice.removed.length > 0;\n      });\n      if (itemAddedOrRemoved) {\n        // Only blur activeElement if it is a descendant of the list (#505,\n        // #507).\n        var activeElement = this._getActiveElement();\n        if (this.contains(activeElement)) {\n          activeElement.blur();\n        }\n      }\n      // Render only if the affected index is rendered.\n      var affectedIndexRendered =\n          change.value.indexSplices.some(function(splice) {\n            return splice.index + splice.addedCount >= this._virtualStart &&\n                splice.index <= this._virtualEnd;\n          }, this);\n      if (!this._isClientFull() || affectedIndexRendered) {\n        this._debounce('_render', this._render, animationFrame);\n      }\n    } else if (change.path !== 'items.length') {\n      this._forwardItemPath(change.path, change.value);\n    }\n  },\n\n  _forwardItemPath: function(path, value) {\n    path = path.slice(6);  // 'items.'.length == 6\n    var dot = path.indexOf('.');\n    if (dot === -1) {\n      dot = path.length;\n    }\n    var isIndexRendered;\n    var pidx;\n    var inst;\n    var offscreenInstance = this.modelForElement(this._offscreenFocusedItem);\n    var vidx = parseInt(path.substring(0, dot), 10);\n    isIndexRendered = this._isIndexRendered(vidx);\n    if (isIndexRendered) {\n      pidx = this._getPhysicalIndex(vidx);\n      inst = this.modelForElement(this._physicalItems[pidx]);\n    } else if (offscreenInstance) {\n      inst = offscreenInstance;\n    }\n\n    if (!inst || inst[this.indexAs] !== vidx) {\n      return;\n    }\n    path = path.substring(dot + 1);\n    path = this.as + (path ? '.' + path : '');\n    inst._setPendingPropertyOrPath(path, value, false, true);\n    inst._flushProperties && inst._flushProperties(true);\n    // TODO(blasten): V1 doesn't do this and it's a bug\n    if (isIndexRendered) {\n      this._updateMetrics([pidx]);\n      this._positionItems();\n      this._updateScrollerSize();\n    }\n  },\n\n  /**\n   * @param {!Array<!Object>} splices\n   */\n  _adjustVirtualIndex: function(splices) {\n    splices.forEach(function(splice) {\n      // deselect removed items\n      splice.removed.forEach(this._removeItem, this);\n      // We only need to care about changes happening above the current position\n      if (splice.index < this._virtualStart) {\n        var delta = Math.max(\n            splice.addedCount - splice.removed.length,\n            splice.index - this._virtualStart);\n        this._virtualStart = this._virtualStart + delta;\n        if (this._focusedVirtualIndex >= 0) {\n          this._focusedVirtualIndex = this._focusedVirtualIndex + delta;\n        }\n      }\n    }, this);\n  },\n\n  _removeItem: function(item) {\n    this.$.selector.deselect(item);\n    // remove the current focused item\n    if (this._focusedItem &&\n        this.modelForElement(this._focusedItem)[this.as] === item) {\n      this._removeFocusedItem();\n    }\n  },\n\n  /**\n   * Executes a provided function per every physical index in `itemSet`\n   * `itemSet` default value is equivalent to the entire set of physical\n   * indexes.\n   *\n   * @param {!function(number, number)} fn\n   * @param {!Array<number>=} itemSet\n   */\n  _iterateItems: function(fn, itemSet) {\n    var pidx, vidx, rtn, i;\n\n    if (arguments.length === 2 && itemSet) {\n      for (i = 0; i < itemSet.length; i++) {\n        pidx = itemSet[i];\n        vidx = this._computeVidx(pidx);\n        if ((rtn = fn.call(this, pidx, vidx)) != null) {\n          return rtn;\n        }\n      }\n    } else {\n      pidx = this._physicalStart;\n      vidx = this._virtualStart;\n      for (; pidx < this._physicalCount; pidx++, vidx++) {\n        if ((rtn = fn.call(this, pidx, vidx)) != null) {\n          return rtn;\n        }\n      }\n      for (pidx = 0; pidx < this._physicalStart; pidx++, vidx++) {\n        if ((rtn = fn.call(this, pidx, vidx)) != null) {\n          return rtn;\n        }\n      }\n    }\n  },\n\n  /**\n   * Returns the virtual index for a given physical index\n   *\n   * @param {number} pidx Physical index\n   * @return {number}\n   */\n  _computeVidx: function(pidx) {\n    if (pidx >= this._physicalStart) {\n      return this._virtualStart + (pidx - this._physicalStart);\n    }\n    return this._virtualStart + (this._physicalCount - this._physicalStart) +\n        pidx;\n  },\n\n  /**\n   * Assigns the data models to a given set of items.\n   * @param {!Array<number>=} itemSet\n   */\n  _assignModels: function(itemSet) {\n    this._iterateItems(function(pidx, vidx) {\n      var el = this._physicalItems[pidx];\n      var item = this.items && this.items[vidx];\n      if (item != null) {\n        var inst = this.modelForElement(el);\n        inst.__key__ = null;\n        this._forwardProperty(inst, this.as, item);\n        this._forwardProperty(\n            inst, this.selectedAs, this.$.selector.isSelected(item));\n        this._forwardProperty(inst, this.indexAs, vidx);\n        this._forwardProperty(\n            inst, 'tabIndex', this._focusedVirtualIndex === vidx ? 0 : -1);\n        this._physicalIndexForKey[inst.__key__] = pidx;\n        inst._flushProperties && inst._flushProperties(true);\n        el.removeAttribute('hidden');\n      } else {\n        el.setAttribute('hidden', '');\n      }\n    }, itemSet);\n  },\n\n  /**\n   * Updates the height for a given set of items.\n   *\n   * @param {!Array<number>=} itemSet\n   */\n  _updateMetrics: function(itemSet) {\n    // Make sure we distributed all the physical items\n    // so we can measure them.\n    flush();\n\n    var newPhysicalSize = 0;\n    var oldPhysicalSize = 0;\n    var prevAvgCount = this._physicalAverageCount;\n    var prevPhysicalAvg = this._physicalAverage;\n\n    this._iterateItems(function(pidx, vidx) {\n      oldPhysicalSize += this._physicalSizes[pidx];\n      this._physicalSizes[pidx] = this._physicalItems[pidx].offsetHeight;\n      newPhysicalSize += this._physicalSizes[pidx];\n      this._physicalAverageCount += this._physicalSizes[pidx] ? 1 : 0;\n    }, itemSet);\n\n    if (this.grid) {\n      this._updateGridMetrics();\n      this._physicalSize =\n          Math.ceil(this._physicalCount / this._itemsPerRow) * this._rowHeight;\n    } else {\n      oldPhysicalSize = (this._itemsPerRow === 1) ?\n          oldPhysicalSize :\n          Math.ceil(this._physicalCount / this._itemsPerRow) * this._rowHeight;\n      this._physicalSize =\n          this._physicalSize + newPhysicalSize - oldPhysicalSize;\n      this._itemsPerRow = 1;\n    }\n    // Update the average if it measured something.\n    if (this._physicalAverageCount !== prevAvgCount) {\n      this._physicalAverage = Math.round(\n          ((prevPhysicalAvg * prevAvgCount) + newPhysicalSize) /\n          this._physicalAverageCount);\n    }\n  },\n\n  _updateGridMetrics: function() {\n    this._itemWidth = this._physicalCount > 0 ?\n        this._physicalItems[0].getBoundingClientRect().width :\n        200;\n    this._rowHeight =\n        this._physicalCount > 0 ? this._physicalItems[0].offsetHeight : 200;\n    this._itemsPerRow = this._itemWidth ?\n        Math.floor(this._viewportWidth / this._itemWidth) :\n        this._itemsPerRow;\n  },\n\n  /**\n   * Updates the position of the physical items.\n   */\n  _positionItems: function() {\n    this._adjustScrollPosition();\n\n    var y = this._physicalTop;\n\n    if (this.grid) {\n      var totalItemWidth = this._itemsPerRow * this._itemWidth;\n      var rowOffset = (this._viewportWidth - totalItemWidth) / 2;\n\n      this._iterateItems(function(pidx, vidx) {\n        var modulus = vidx % this._itemsPerRow;\n        var x = Math.floor((modulus * this._itemWidth) + rowOffset);\n        if (this._isRTL) {\n          x = x * -1;\n        }\n        this.translate3d(x + 'px', y + 'px', 0, this._physicalItems[pidx]);\n        if (this._shouldRenderNextRow(vidx)) {\n          y += this._rowHeight;\n        }\n      });\n    } else {\n      this._iterateItems(function(pidx, vidx) {\n        this.translate3d(0, y + 'px', 0, this._physicalItems[pidx]);\n        y += this._physicalSizes[pidx];\n      });\n    }\n  },\n\n  _getPhysicalSizeIncrement: function(pidx) {\n    if (!this.grid) {\n      return this._physicalSizes[pidx];\n    }\n    if (this._computeVidx(pidx) % this._itemsPerRow !== this._itemsPerRow - 1) {\n      return 0;\n    }\n    return this._rowHeight;\n  },\n\n  /**\n   * Returns, based on the current index,\n   * whether or not the next index will need\n   * to be rendered on a new row.\n   *\n   * @param {number} vidx Virtual index\n   * @return {boolean}\n   */\n  _shouldRenderNextRow: function(vidx) {\n    return vidx % this._itemsPerRow === this._itemsPerRow - 1;\n  },\n\n  /**\n   * Adjusts the scroll position when it was overestimated.\n   */\n  _adjustScrollPosition: function() {\n    var deltaHeight = this._virtualStart === 0 ?\n        this._physicalTop :\n        Math.min(this._scrollPosition + this._physicalTop, 0);\n    // Note: the delta can be positive or negative.\n    if (deltaHeight !== 0) {\n      this._physicalTop = this._physicalTop - deltaHeight;\n      var scrollTop = this._scrollTop;\n      // juking scroll position during interial scrolling on iOS is no bueno\n      if (!IOS_TOUCH_SCROLLING && scrollTop > 0) {\n        this._resetScrollPosition(scrollTop - deltaHeight);\n      }\n    }\n  },\n\n  /**\n   * Sets the position of the scroll.\n   */\n  _resetScrollPosition: function(pos) {\n    if (this.scrollTarget && pos >= 0) {\n      this._scrollTop = pos;\n      this._scrollPosition = this._scrollTop;\n    }\n  },\n\n  /**\n   * Sets the scroll height, that's the height of the content,\n   *\n   * @param {boolean=} forceUpdate If true, updates the height no matter what.\n   */\n  _updateScrollerSize: function(forceUpdate) {\n    if (this.grid) {\n      this._estScrollHeight = this._virtualRowCount * this._rowHeight;\n    } else {\n      this._estScrollHeight =\n          (this._physicalBottom +\n           Math.max(\n               this._virtualCount - this._physicalCount - this._virtualStart,\n               0) *\n               this._physicalAverage);\n    }\n    forceUpdate = forceUpdate || this._scrollHeight === 0;\n    forceUpdate = forceUpdate ||\n        this._scrollPosition >= this._estScrollHeight - this._physicalSize;\n    forceUpdate = forceUpdate ||\n        this.grid && this.$.items.style.height < this._estScrollHeight;\n    // Amortize height adjustment, so it won't trigger large repaints too often.\n    if (forceUpdate ||\n        Math.abs(this._estScrollHeight - this._scrollHeight) >=\n            this._viewportHeight) {\n      this.$.items.style.height = this._estScrollHeight + 'px';\n      this._scrollHeight = this._estScrollHeight;\n    }\n  },\n\n  /**\n   * Scroll to a specific item in the virtual list regardless\n   * of the physical items in the DOM tree.\n   *\n   * @method scrollToItem\n   * @param {(Object)} item The item to be scrolled to\n   */\n  scrollToItem: function(item) {\n    return this.scrollToIndex(this.items.indexOf(item));\n  },\n\n  /**\n   * Scroll to a specific index in the virtual list regardless\n   * of the physical items in the DOM tree.\n   *\n   * @method scrollToIndex\n   * @param {number} idx The index of the item\n   */\n  scrollToIndex: function(idx) {\n    if (typeof idx !== 'number' || idx < 0 || idx > this.items.length - 1) {\n      return;\n    }\n    flush();\n    // Items should have been rendered prior scrolling to an index.\n    if (this._physicalCount === 0) {\n      return;\n    }\n    idx = this._clamp(idx, 0, this._virtualCount - 1);\n    // Update the virtual start only when needed.\n    if (!this._isIndexRendered(idx) || idx >= this._maxVirtualStart) {\n      this._virtualStart =\n          this.grid ? (idx - this._itemsPerRow * 2) : (idx - 1);\n    }\n    this._manageFocus();\n    this._assignModels();\n    this._updateMetrics();\n    // Estimate new physical offset.\n    this._physicalTop = Math.floor(this._virtualStart / this._itemsPerRow) *\n        this._physicalAverage;\n\n    var currentTopItem = this._physicalStart;\n    var currentVirtualItem = this._virtualStart;\n    var targetOffsetTop = 0;\n    var hiddenContentSize = this._hiddenContentSize;\n    // scroll to the item as much as we can.\n    while (currentVirtualItem < idx && targetOffsetTop <= hiddenContentSize) {\n      targetOffsetTop =\n          targetOffsetTop + this._getPhysicalSizeIncrement(currentTopItem);\n      currentTopItem = (currentTopItem + 1) % this._physicalCount;\n      currentVirtualItem++;\n    }\n    this._updateScrollerSize(true);\n    this._positionItems();\n    this._resetScrollPosition(\n        this._physicalTop + this._scrollOffset + targetOffsetTop);\n    this._increasePoolIfNeeded(0);\n    // clear cached visible index.\n    this._firstVisibleIndexVal = null;\n    this._lastVisibleIndexVal = null;\n  },\n\n  /**\n   * Reset the physical average and the average count.\n   */\n  _resetAverage: function() {\n    this._physicalAverage = 0;\n    this._physicalAverageCount = 0;\n  },\n\n  /**\n   * A handler for the `iron-resize` event triggered by `IronResizableBehavior`\n   * when the element is resized.\n   */\n  _resizeHandler: function() {\n    this._debounce('_render', function() {\n      // clear cached visible index.\n      this._firstVisibleIndexVal = null;\n      this._lastVisibleIndexVal = null;\n      if (this._isVisible) {\n        this.updateViewportBoundaries();\n        // Reinstall the scroll event listener.\n        this.toggleScrollListener(true);\n        this._resetAverage();\n        this._render();\n      } else {\n        // Uninstall the scroll event listener.\n        this.toggleScrollListener(false);\n      }\n    }, animationFrame);\n  },\n\n  /**\n   * Selects the given item.\n   *\n   * @method selectItem\n   * @param {Object} item The item instance.\n   */\n  selectItem: function(item) {\n    return this.selectIndex(this.items.indexOf(item));\n  },\n\n  /**\n   * Selects the item at the given index in the items array.\n   *\n   * @method selectIndex\n   * @param {number} index The index of the item in the items array.\n   */\n  selectIndex: function(index) {\n    if (index < 0 || index >= this._virtualCount) {\n      return;\n    }\n    if (!this.multiSelection && this.selectedItem) {\n      this.clearSelection();\n    }\n    if (this._isIndexRendered(index)) {\n      var model = this.modelForElement(\n          this._physicalItems[this._getPhysicalIndex(index)]);\n      if (model) {\n        model[this.selectedAs] = true;\n      }\n      this.updateSizeForIndex(index);\n    }\n    this.$.selector.selectIndex(index);\n  },\n\n  /**\n   * Deselects the given item.\n   *\n   * @method deselect\n   * @param {Object} item The item instance.\n   */\n  deselectItem: function(item) {\n    return this.deselectIndex(this.items.indexOf(item));\n  },\n\n  /**\n   * Deselects the item at the given index in the items array.\n   *\n   * @method deselectIndex\n   * @param {number} index The index of the item in the items array.\n   */\n  deselectIndex: function(index) {\n    if (index < 0 || index >= this._virtualCount) {\n      return;\n    }\n    if (this._isIndexRendered(index)) {\n      var model = this.modelForElement(\n          this._physicalItems[this._getPhysicalIndex(index)]);\n      model[this.selectedAs] = false;\n      this.updateSizeForIndex(index);\n    }\n    this.$.selector.deselectIndex(index);\n  },\n\n  /**\n   * Selects or deselects a given item depending on whether the item\n   * has already been selected.\n   *\n   * @method toggleSelectionForItem\n   * @param {Object} item The item object.\n   */\n  toggleSelectionForItem: function(item) {\n    return this.toggleSelectionForIndex(this.items.indexOf(item));\n  },\n\n  /**\n   * Selects or deselects the item at the given index in the items array\n   * depending on whether the item has already been selected.\n   *\n   * @method toggleSelectionForIndex\n   * @param {number} index The index of the item in the items array.\n   */\n  toggleSelectionForIndex: function(index) {\n    var isSelected = this.$.selector.isIndexSelected ?\n        this.$.selector.isIndexSelected(index) :\n        this.$.selector.isSelected(this.items[index]);\n    isSelected ? this.deselectIndex(index) : this.selectIndex(index);\n  },\n\n  /**\n   * Clears the current selection in the list.\n   *\n   * @method clearSelection\n   */\n  clearSelection: function() {\n    this._iterateItems(function(pidx, vidx) {\n      this.modelForElement(this._physicalItems[pidx])[this.selectedAs] = false;\n    });\n    this.$.selector.clearSelection();\n  },\n\n  /**\n   * Add an event listener to `tap` if `selectionEnabled` is true,\n   * it will remove the listener otherwise.\n   */\n  _selectionEnabledChanged: function(selectionEnabled) {\n    var handler = selectionEnabled ? this.listen : this.unlisten;\n    handler.call(this, this, 'tap', '_selectionHandler');\n  },\n\n  /**\n   * Select an item from an event object.\n   */\n  _selectionHandler: function(e) {\n    var model = this.modelForElement(e.target);\n    if (!model) {\n      return;\n    }\n    var modelTabIndex, activeElTabIndex;\n    var target = dom(e).path[0];\n    var activeEl = this._getActiveElement();\n    var physicalItem =\n        this._physicalItems[this._getPhysicalIndex(model[this.indexAs])];\n    // Safari does not focus certain form controls via mouse\n    // https://bugs.webkit.org/show_bug.cgi?id=118043\n    if (target.localName === 'input' || target.localName === 'button' ||\n        target.localName === 'select') {\n      return;\n    }\n    // Set a temporary tabindex\n    modelTabIndex = model.tabIndex;\n    model.tabIndex = SECRET_TABINDEX;\n    activeElTabIndex = activeEl ? activeEl.tabIndex : -1;\n    model.tabIndex = modelTabIndex;\n    // Only select the item if the tap wasn't on a focusable child\n    // or the element bound to `tabIndex`\n    if (activeEl && physicalItem !== activeEl &&\n        physicalItem.contains(activeEl) &&\n        activeElTabIndex !== SECRET_TABINDEX) {\n      return;\n    }\n    this.toggleSelectionForItem(model[this.as]);\n  },\n\n  _multiSelectionChanged: function(multiSelection) {\n    this.clearSelection();\n    this.$.selector.multi = multiSelection;\n  },\n\n  /**\n   * Updates the size of a given list item.\n   *\n   * @method updateSizeForItem\n   * @param {Object} item The item instance.\n   */\n  updateSizeForItem: function(item) {\n    return this.updateSizeForIndex(this.items.indexOf(item));\n  },\n\n  /**\n   * Updates the size of the item at the given index in the items array.\n   *\n   * @method updateSizeForIndex\n   * @param {number} index The index of the item in the items array.\n   */\n  updateSizeForIndex: function(index) {\n    if (!this._isIndexRendered(index)) {\n      return null;\n    }\n    this._updateMetrics([this._getPhysicalIndex(index)]);\n    this._positionItems();\n    return null;\n  },\n\n  /**\n   * Creates a temporary backfill item in the rendered pool of physical items\n   * to replace the main focused item. The focused item has tabIndex = 0\n   * and might be currently focused by the user.\n   *\n   * This dynamic replacement helps to preserve the focus state.\n   */\n  _manageFocus: function() {\n    var fidx = this._focusedVirtualIndex;\n\n    if (fidx >= 0 && fidx < this._virtualCount) {\n      // if it's a valid index, check if that index is rendered\n      // in a physical item.\n      if (this._isIndexRendered(fidx)) {\n        this._restoreFocusedItem();\n      } else {\n        this._createFocusBackfillItem();\n      }\n    } else if (this._virtualCount > 0 && this._physicalCount > 0) {\n      // otherwise, assign the initial focused index.\n      this._focusedPhysicalIndex = this._physicalStart;\n      this._focusedVirtualIndex = this._virtualStart;\n      this._focusedItem = this._physicalItems[this._physicalStart];\n    }\n  },\n\n  /**\n   * Converts a random index to the index of the item that completes it's row.\n   * Allows for better order and fill computation when grid == true.\n   */\n  _convertIndexToCompleteRow: function(idx) {\n    // when grid == false _itemPerRow can be unset.\n    this._itemsPerRow = this._itemsPerRow || 1;\n    return this.grid ? Math.ceil(idx / this._itemsPerRow) * this._itemsPerRow :\n                       idx;\n  },\n\n  _isIndexRendered: function(idx) {\n    return idx >= this._virtualStart && idx <= this._virtualEnd;\n  },\n\n  _isIndexVisible: function(idx) {\n    return idx >= this.firstVisibleIndex && idx <= this.lastVisibleIndex;\n  },\n\n  _getPhysicalIndex: function(vidx) {\n    return (this._physicalStart + (vidx - this._virtualStart)) %\n        this._physicalCount;\n  },\n\n  focusItem: function(idx) {\n    this._focusPhysicalItem(idx);\n  },\n\n  _focusPhysicalItem: function(idx) {\n    if (idx < 0 || idx >= this._virtualCount) {\n      return;\n    }\n    this._restoreFocusedItem();\n    // scroll to index to make sure it's rendered\n    if (!this._isIndexRendered(idx)) {\n      this.scrollToIndex(idx);\n    }\n    var physicalItem = this._physicalItems[this._getPhysicalIndex(idx)];\n    var model = this.modelForElement(physicalItem);\n    var focusable;\n    // set a secret tab index\n    model.tabIndex = SECRET_TABINDEX;\n    // check if focusable element is the physical item\n    if (physicalItem.tabIndex === SECRET_TABINDEX) {\n      focusable = physicalItem;\n    }\n    // search for the element which tabindex is bound to the secret tab index\n    if (!focusable) {\n      focusable = dom(physicalItem)\n                      .querySelector('[tabindex=\"' + SECRET_TABINDEX + '\"]');\n    }\n    // restore the tab index\n    model.tabIndex = 0;\n    // focus the focusable element\n    this._focusedVirtualIndex = idx;\n    focusable && focusable.focus();\n  },\n\n  _removeFocusedItem: function() {\n    if (this._offscreenFocusedItem) {\n      this._itemsParent.removeChild(this._offscreenFocusedItem);\n    }\n    this._offscreenFocusedItem = null;\n    this._focusBackfillItem = null;\n    this._focusedItem = null;\n    this._focusedVirtualIndex = -1;\n    this._focusedPhysicalIndex = -1;\n  },\n\n  _createFocusBackfillItem: function() {\n    var fpidx = this._focusedPhysicalIndex;\n\n    if (this._offscreenFocusedItem || this._focusedVirtualIndex < 0) {\n      return;\n    }\n    if (!this._focusBackfillItem) {\n      // Create a physical item.\n      var inst = this.stamp(null);\n      this._focusBackfillItem = inst.root.querySelector('*');\n      this._itemsParent.appendChild(inst.root);\n    }\n    // Set the offcreen focused physical item.\n    this._offscreenFocusedItem = this._physicalItems[fpidx];\n    this.modelForElement(this._offscreenFocusedItem).tabIndex = 0;\n    this._physicalItems[fpidx] = this._focusBackfillItem;\n    this._focusedPhysicalIndex = fpidx;\n    // Hide the focused physical.\n    this.translate3d(0, HIDDEN_Y, 0, this._offscreenFocusedItem);\n  },\n\n  _restoreFocusedItem: function() {\n    if (!this._offscreenFocusedItem || this._focusedVirtualIndex < 0) {\n      return;\n    }\n    // Assign models to the focused index.\n    this._assignModels();\n    // Get the new physical index for the focused index.\n    var fpidx = this._focusedPhysicalIndex =\n        this._getPhysicalIndex(this._focusedVirtualIndex);\n\n    var onScreenItem = this._physicalItems[fpidx];\n    if (!onScreenItem) {\n      return;\n    }\n    var onScreenInstance = this.modelForElement(onScreenItem);\n    var offScreenInstance = this.modelForElement(this._offscreenFocusedItem);\n    // Restores the physical item only when it has the same model\n    // as the offscreen one. Use key for comparison since users can set\n    // a new item via set('items.idx').\n    if (onScreenInstance[this.as] === offScreenInstance[this.as]) {\n      // Flip the focus backfill.\n      this._focusBackfillItem = onScreenItem;\n      onScreenInstance.tabIndex = -1;\n      // Restore the focused physical item.\n      this._physicalItems[fpidx] = this._offscreenFocusedItem;\n      // Hide the physical item that backfills.\n      this.translate3d(0, HIDDEN_Y, 0, this._focusBackfillItem);\n    } else {\n      this._removeFocusedItem();\n      this._focusBackfillItem = null;\n    }\n    this._offscreenFocusedItem = null;\n  },\n\n  _didFocus: function(e) {\n    var targetModel = this.modelForElement(e.target);\n    var focusedModel = this.modelForElement(this._focusedItem);\n    var hasOffscreenFocusedItem = this._offscreenFocusedItem !== null;\n    var fidx = this._focusedVirtualIndex;\n    if (!targetModel) {\n      return;\n    }\n    if (focusedModel === targetModel) {\n      // If the user focused the same item, then bring it into view if it's not\n      // visible.\n      if (!this._isIndexVisible(fidx)) {\n        this.scrollToIndex(fidx);\n      }\n    } else {\n      this._restoreFocusedItem();\n      // Restore tabIndex for the currently focused item.\n      if (focusedModel) {\n        focusedModel.tabIndex = -1;\n      }\n      // Set the tabIndex for the next focused item.\n      targetModel.tabIndex = 0;\n      fidx = targetModel[this.indexAs];\n      this._focusedVirtualIndex = fidx;\n      this._focusedPhysicalIndex = this._getPhysicalIndex(fidx);\n      this._focusedItem = this._physicalItems[this._focusedPhysicalIndex];\n      if (hasOffscreenFocusedItem && !this._offscreenFocusedItem) {\n        this._update();\n      }\n    }\n  },\n\n  _keydownHandler: function(e) {\n    switch (e.keyCode) {\n      case /* ARROW_DOWN */ 40:\n        if (this._focusedVirtualIndex < this._virtualCount - 1)\n          e.preventDefault();\n        this._focusPhysicalItem(\n            this._focusedVirtualIndex + (this.grid ? this._itemsPerRow : 1));\n        break;\n      case /* ARROW_RIGHT */ 39:\n        if (this.grid)\n          this._focusPhysicalItem(\n              this._focusedVirtualIndex + (this._isRTL ? -1 : 1));\n        break;\n      case /* ARROW_UP */ 38:\n        if (this._focusedVirtualIndex > 0)\n          e.preventDefault();\n        this._focusPhysicalItem(\n            this._focusedVirtualIndex - (this.grid ? this._itemsPerRow : 1));\n        break;\n      case /* ARROW_LEFT */ 37:\n        if (this.grid)\n          this._focusPhysicalItem(\n              this._focusedVirtualIndex + (this._isRTL ? 1 : -1));\n        break;\n      case /* ENTER */ 13:\n        this._focusPhysicalItem(this._focusedVirtualIndex);\n        if (this.selectionEnabled)\n          this._selectionHandler(e);\n        break;\n    }\n  },\n\n  _clamp: function(v, min, max) {\n    return Math.min(max, Math.max(min, v));\n  },\n\n  _debounce: function(name, cb, asyncModule) {\n    this._debouncers = this._debouncers || {};\n    this._debouncers[name] =\n        Debouncer.debounce(this._debouncers[name], asyncModule, cb.bind(this));\n    enqueueDebouncer(this._debouncers[name]);\n  },\n\n  _forwardProperty: function(inst, name, value) {\n    inst._setPendingProperty(name, value);\n  },\n\n  /* Templatizer bindings for v2 */\n  _forwardHostPropV2: function(prop, value) {\n    (this._physicalItems || [])\n        .concat([this._offscreenFocusedItem, this._focusBackfillItem])\n        .forEach(function(item) {\n          if (item) {\n            this.modelForElement(item).forwardHostProp(prop, value);\n          }\n        }, this);\n  },\n\n  _notifyInstancePropV2: function(inst, prop, value) {\n    if (matches(this.as, prop)) {\n      var idx = inst[this.indexAs];\n      if (prop == this.as) {\n        this.items[idx] = value;\n      }\n      this.notifyPath(translate(this.as, 'items.' + idx, prop), value);\n    }\n  },\n\n  /* Templatizer bindings for v1 */\n  _getStampedChildren: function() {\n    return this._physicalItems;\n  },\n\n  _forwardInstancePath: function(inst, path, value) {\n    if (path.indexOf(this.as + '.') === 0) {\n      this.notifyPath(\n          'items.' + inst.__key__ + '.' + path.slice(this.as.length + 1),\n          value);\n    }\n  },\n\n  _forwardParentPath: function(path, value) {\n    (this._physicalItems || [])\n        .concat([this._offscreenFocusedItem, this._focusBackfillItem])\n        .forEach(function(item) {\n          if (item) {\n            this.modelForElement(item).notifyPath(path, value, true);\n          }\n        }, this);\n  },\n\n  _forwardParentProp: function(prop, value) {\n    (this._physicalItems || [])\n        .concat([this._offscreenFocusedItem, this._focusBackfillItem])\n        .forEach(function(item) {\n          if (item) {\n            this.modelForElement(item)[prop] = value;\n          }\n        }, this);\n  },\n\n  /* Gets the activeElement of the shadow root/host that contains the list. */\n  _getActiveElement: function() {\n    var itemsHost = this._itemsParent.node.domHost;\n    return dom(itemsHost ? itemsHost.root : document).activeElement;\n  }\n});\n","/**\n@license\nCopyright (c) 2017 Vaadin Ltd.\nThis program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n*/\nimport { PolymerElement } from '@polymer/polymer/polymer-element.js';\n\nimport { ThemableMixin } from '@vaadin/vaadin-themable-mixin/vaadin-themable-mixin.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\n/**\n * The default element used for items in the vaadin-combo-box.\n *\n * ### Styling\n *\n * The following shadow DOM parts are available for styling:\n *\n * Part name | Description\n * ---|---\n * `content` | The element that wraps the item label or template content\n *\n * The following state attributes are exposed for styling:\n *\n * Attribute    | Description | Part name\n * -------------|-------------|------------\n * `selected` | Set when the item is selected | :host\n * `focused` | Set when the item is focused | :host\n *\n * See [ThemableMixin  how to apply styles for shadow parts](https://github.com/vaadin/vaadin-themable-mixin/wiki)\n *\n * @memberof Vaadin\n * @mixes Vaadin.ThemableMixin\n * @private\n */\nclass ComboBoxItemElement extends ThemableMixin(PolymerElement) {\n  static get template() {\n    return html`\n    <style>\n      :host {\n        display: block;\n      }\n\n      :host([hidden]) {\n         display: none;\n      }\n    </style>\n    <div part=\"content\" id=\"content\"></div>\n`;\n  }\n\n  static get is() {\n    return 'vaadin-combo-box-item';\n  }\n\n  static get properties() {\n    return {\n      /**\n       * The index of the item\n       */\n      index: Number,\n\n      /**\n       * The item to render\n       * @type {(String|Object)}\n       */\n      item: Object,\n\n      /**\n       * The text label corresponding to the item\n       */\n      label: String,\n\n      /**\n       * True when item is selected\n       */\n      selected: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true\n      },\n\n      /**\n       * True when item is focused\n       */\n      focused: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true\n      },\n\n      /**\n       * The template instance corresponding to the item\n       */\n      _itemTemplateInstance: Object,\n\n      /**\n       * Custom function for rendering the content of the `<vaadin-combo-box-item>` propagated from the combo box element.\n       */\n      renderer: Function,\n\n      /**\n       * Saved instance of a custom renderer function.\n       */\n      _oldRenderer: Function\n    };\n  }\n\n  static get observers() {\n    return [\n      '_rendererOrItemChanged(renderer, index, item.*)',\n      '_updateLabel(label, _itemTemplateInstance)',\n      '_updateTemplateInstanceVariable(\"index\", index, _itemTemplateInstance)',\n      '_updateTemplateInstanceVariable(\"item\", item, _itemTemplateInstance)',\n      '_updateTemplateInstanceVariable(\"selected\", selected, _itemTemplateInstance)',\n      '_updateTemplateInstanceVariable(\"focused\", focused, _itemTemplateInstance)'\n    ];\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    if (!this._itemTemplateInstance) {\n      // 2.0 has __dataHost. Might want to consider assigning combobox reference directly to item.\n      const overlay = this.getRootNode().host.getRootNode().host;\n      const dropdown = overlay.__dataHost;\n      const comboBoxOverlay = dropdown.getRootNode().host;\n      this._comboBox = comboBoxOverlay.getRootNode().host;\n      this._comboBox._ensureTemplatized();\n      if (this._comboBox._TemplateClass) {\n        this._itemTemplateInstance = new this._comboBox._TemplateClass({});\n        this.$.content.textContent = '';\n        this.$.content.appendChild(this._itemTemplateInstance.root);\n      }\n    }\n  }\n\n  _render() {\n    if (!this.renderer) {\n      return;\n    }\n\n    const model = {\n      index: this.index,\n      item: this.item\n    };\n\n    this.renderer(this.$.content, this._comboBox, model);\n  }\n\n  _rendererOrItemChanged(renderer, index, item) {\n    if (item === undefined || index === undefined) {\n      return;\n    }\n\n    if (this._oldRenderer !== renderer) {\n      this.$.content.innerHTML = '';\n    }\n\n    if (renderer) {\n      this._oldRenderer = renderer;\n      this._render();\n    }\n  }\n\n  _updateLabel(label, _itemTemplateInstance) {\n    if (_itemTemplateInstance === undefined && this.$.content && !this.renderer) {\n      // Only set label to textContent no template\n      this.$.content.textContent = label;\n    }\n  }\n\n  _updateTemplateInstanceVariable(variable, value, _itemTemplateInstance) {\n    if (variable === undefined || value === undefined || _itemTemplateInstance === undefined) {\n      return;\n    }\n    _itemTemplateInstance[variable] = value;\n  }\n}\n\ncustomElements.define(ComboBoxItemElement.is, ComboBoxItemElement);\n","/**\n@license\nCopyright (c) 2017 Vaadin Ltd.\nThis program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n*/\nimport { PolymerElement } from '@polymer/polymer/polymer-element.js';\n\nimport { DisableUpgradeMixin } from '@polymer/polymer/lib/mixins/disable-upgrade-mixin.js';\nimport { OverlayElement } from '@vaadin/vaadin-overlay/src/vaadin-overlay.js';\nimport { IronResizableBehavior } from '@polymer/iron-resizable-behavior/iron-resizable-behavior.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\nimport { mixinBehaviors } from '@polymer/polymer/lib/legacy/class.js';\n/**\n * The overlay element.\n *\n * ### Styling\n *\n * See [`<vaadin-overlay>` documentation](https://github.com/vaadin/vaadin-overlay/blob/master/src/vaadin-overlay.html)\n * for `<vaadin-combo-box-overlay>` parts.\n *\n * See [ThemableMixin  how to apply styles for shadow parts](https://github.com/vaadin/vaadin-themable-mixin/wiki)\n *\n * @memberof Vaadin\n * @private\n */\nclass ComboBoxOverlayElement extends OverlayElement {\n  static get is() {\n    return 'vaadin-combo-box-overlay';\n  }\n\n  ready() {\n    super.ready();\n    const loader = document.createElement('div');\n    loader.setAttribute('part', 'loader');\n    const content = this.shadowRoot.querySelector(['[part~=\"content\"]']);\n    content.parentNode.insertBefore(loader, content);\n  }\n}\n\ncustomElements.define(ComboBoxOverlayElement.is, ComboBoxOverlayElement);\n\n/**\n * Element for internal use only.\n *\n * @memberof Vaadin\n * @private\n */\nclass ComboBoxDropdownElement extends DisableUpgradeMixin(\n  mixinBehaviors(IronResizableBehavior, PolymerElement)) {\n  static get template() {\n    return html`\n    <style>\n      :host {\n        display: block;\n      }\n\n      :host > #overlay {\n        display: none;\n      }\n    </style>\n    <vaadin-combo-box-overlay id=\"overlay\" hidden\\$=\"[[hidden]]\" opened=\"[[opened]]\" template=\"{{template}}\" style=\"align-items: stretch; margin: 0;\" theme\\$=\"[[theme]]\">\n      <slot></slot>\n    </vaadin-combo-box-overlay>\n`;\n  }\n\n  static get is() {\n    return 'vaadin-combo-box-dropdown';\n  }\n\n  static get properties() {\n    return {\n      opened: {\n        type: Boolean,\n        observer: '_openedChanged'\n      },\n\n      template: {\n        type: Object,\n        notify: true\n      },\n\n      /**\n       * The element to position/align the dropdown by.\n       */\n      positionTarget: {\n        type: Object\n      },\n\n      /**\n       * If `true`, overlay is aligned above the `positionTarget`\n       */\n      alignedAbove: {\n        type: Boolean,\n        value: false\n      },\n\n      /**\n       * Used to propagate the `theme` attribute from the host element.\n       */\n      theme: String\n    };\n  }\n\n  constructor() {\n    super();\n    this._boundSetPosition = this._setPosition.bind(this);\n    this._boundOutsideClickListener = this._outsideClickListener.bind(this);\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.addEventListener('iron-resize', this._boundSetPosition);\n  }\n\n  ready() {\n    super.ready();\n\n    // Preventing the default modal behaviour of the overlay on input clicking\n    this.$.overlay.addEventListener('vaadin-overlay-outside-click', e => {\n      e.preventDefault();\n    });\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    this.removeEventListener('iron-resize', this._boundSetPosition);\n\n    // Making sure the overlay is closed and removed from DOM after detaching the dropdown.\n    this.opened = false;\n  }\n\n  notifyResize() {\n    super.notifyResize();\n\n    if (this.positionTarget && this.opened) {\n      this._setPosition();\n      // Schedule another position update (to cover virtual keyboard opening for example)\n      requestAnimationFrame(this._setPosition.bind(this));\n    }\n  }\n\n  /**\n   * Fired after the `vaadin-combo-box-dropdown` opens.\n   *\n   * @event vaadin-combo-box-dropdown-opened\n   */\n  /**\n   * Fired after the `vaadin-combo-box-dropdown` closes.\n   *\n   * @event vaadin-combo-box-dropdown-closed\n   */\n\n  _openedChanged(opened, oldValue) {\n    if (!!opened === !!oldValue) {\n      return;\n    }\n\n    if (opened) {\n      this.$.overlay.style.position = this._isPositionFixed(this.positionTarget) ? 'fixed' : 'absolute';\n      this._setPosition();\n\n      window.addEventListener('scroll', this._boundSetPosition, true);\n      document.addEventListener('click', this._boundOutsideClickListener, true);\n      this.dispatchEvent(new CustomEvent('vaadin-combo-box-dropdown-opened', {bubbles: true, composed: true}));\n    } else {\n      window.removeEventListener('scroll', this._boundSetPosition, true);\n      document.removeEventListener('click', this._boundOutsideClickListener, true);\n      this.dispatchEvent(new CustomEvent('vaadin-combo-box-dropdown-closed', {bubbles: true, composed: true}));\n    }\n  }\n\n\n  // We need to listen on 'click' event and capture it and close the overlay before\n  // propagating the event to the listener in the button. Otherwise, if the clicked button would call\n  // open(), this would happen: https://www.youtube.com/watch?v=Z86V_ICUCD4\n  _outsideClickListener(event) {\n    const eventPath = event.composedPath();\n    if (eventPath.indexOf(this.positionTarget) < 0 && eventPath.indexOf(this.$.overlay) < 0) {\n      this.opened = false;\n    }\n  }\n\n  _isPositionFixed(element) {\n    const offsetParent = this._getOffsetParent(element);\n\n    return window.getComputedStyle(element).position === 'fixed' ||\n      (offsetParent && this._isPositionFixed(offsetParent));\n  }\n\n  _getOffsetParent(element) {\n    if (element.assignedSlot) {\n      return element.assignedSlot.parentElement;\n    } else if (element.parentElement) {\n      return element.offsetParent;\n    }\n\n    const parent = element.parentNode;\n\n    if (parent && parent.nodeType === 11 && parent.host) {\n      return parent.host; // parent is #shadowRoot\n    }\n  }\n\n  _verticalOffset(overlayRect, targetRect) {\n    return this.alignedAbove ? -overlayRect.height : targetRect.height;\n  }\n\n  _shouldAlignAbove(targetRect) {\n    const spaceBelow = (\n      window.innerHeight -\n      targetRect.bottom -\n      Math.min(document.body.scrollTop, 0)\n    ) / window.innerHeight;\n\n    return spaceBelow < 0.30;\n  }\n\n  _setPosition(e) {\n    if (this.hidden) {\n      return;\n    }\n    if (e && e.target) {\n      const target = e.target === document ? document.body : e.target;\n      const parent = this.$.overlay.parentElement;\n      if (!(target.contains(this.$.overlay) || target.contains(this.positionTarget)) || parent !== document.body) {\n        return;\n      }\n    }\n\n    const targetRect = this.positionTarget.getBoundingClientRect();\n    this.alignedAbove = this._shouldAlignAbove(targetRect);\n\n    const overlayRect = this.$.overlay.getBoundingClientRect();\n    this._translateX = targetRect.left - overlayRect.left + (this._translateX || 0);\n    this._translateY = targetRect.top - overlayRect.top + (this._translateY || 0) +\n      this._verticalOffset(overlayRect, targetRect);\n\n    const _devicePixelRatio = window.devicePixelRatio || 1;\n    this._translateX = Math.round(this._translateX * _devicePixelRatio) / _devicePixelRatio;\n    this._translateY = Math.round(this._translateY * _devicePixelRatio) / _devicePixelRatio;\n    this.$.overlay.style.transform = `translate3d(${this._translateX}px, ${this._translateY}px, 0)`;\n\n    this.$.overlay.style.width = this.positionTarget.clientWidth + 'px';\n    this.$.overlay.style.justifyContent = this.alignedAbove ? 'flex-end' : 'flex-start';\n\n    // TODO: fire only when position actually changes changes\n    this.dispatchEvent(new CustomEvent('position-changed'));\n  }\n}\n\ncustomElements.define(ComboBoxDropdownElement.is, ComboBoxDropdownElement);\n","/**\n@license\nCopyright (c) 2017 Vaadin Ltd.\nThis program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n*/\nimport { PolymerElement } from '@polymer/polymer/polymer-element.js';\n\nimport '@polymer/iron-list/iron-list.js';\nimport './vaadin-combo-box-item.js';\nimport './vaadin-combo-box-dropdown.js';\nimport { ComboBoxPlaceholder } from './vaadin-combo-box-placeholder.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\n\nconst TOUCH_DEVICE = (() => {\n  try {\n    document.createEvent('TouchEvent');\n    return true;\n  } catch (e) {\n    return false;\n  }\n})();\n\n/**\n * Element for internal use only.\n *\n * @memberof Vaadin\n * @private\n */\nclass ComboBoxDropdownWrapperElement extends (class extends PolymerElement {}) {\n  static get template() {\n    return html`\n    <vaadin-combo-box-dropdown id=\"dropdown\" hidden=\"[[_hidden(_items.*, loading)]]\" position-target=\"[[positionTarget]]\" on-template-changed=\"_templateChanged\" on-position-changed=\"_setOverlayHeight\" disable-upgrade=\"\" theme=\"[[theme]]\">\n      <template>\n        <style>\n          #scroller {\n            overflow: auto;\n\n            /* Fixes item background from getting on top of scrollbars on Safari */\n            transform: translate3d(0, 0, 0);\n\n            /* Enable momentum scrolling on iOS (iron-list v1.2+ no longer does it for us) */\n            -webkit-overflow-scrolling: touch;\n\n            /* Fixes scrollbar disappearing when 'Show scroll bars: Always' enabled in Safari */\n            box-shadow: 0 0 0 white;\n          }\n        </style>\n        <div id=\"scroller\" on-click=\"_stopPropagation\">\n          <iron-list id=\"selector\" role=\"listbox\" items=\"[[_getItems(opened, _items)]]\" scroll-target=\"[[_scroller]]\">\n            <template>\n              <vaadin-combo-box-item on-click=\"_onItemClick\" index=\"[[__requestItemByIndex(item, index)]]\" item=\"[[item]]\" label=\"[[getItemLabel(item, _itemLabelPath)]]\" selected=\"[[_isItemSelected(item, _selectedItem, _itemIdPath)]]\" renderer=\"[[renderer]]\" role\\$=\"[[_getAriaRole(index)]]\" aria-selected\\$=\"[[_getAriaSelected(_focusedIndex,index)]]\" focused=\"[[_isItemFocused(_focusedIndex,index)]]\" tabindex=\"-1\" theme\\$=\"[[theme]]\">\n              </vaadin-combo-box-item>\n            </template>\n          </iron-list>\n        </div>\n      </template>\n    </vaadin-combo-box-dropdown>\n`;\n  }\n\n  static get is() {\n    return 'vaadin-combo-box-dropdown-wrapper';\n  }\n\n  static get properties() {\n    return {\n      /**\n       * True if the device supports touch events.\n       */\n      touchDevice: {\n        type: Boolean,\n        value: TOUCH_DEVICE\n      },\n\n      opened: Boolean,\n\n      /**\n       * The element to position/align the dropdown by.\n       */\n      positionTarget: {\n        type: Object\n      },\n\n      /**\n       * Custom function for rendering the content of the `<vaadin-combo-box-item>` propagated from the combo box element.\n       */\n      renderer: Function,\n\n      /**\n       * `true` when new items are being loaded.\n       */\n      loading: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true,\n        observer: '_setOverlayHeight'\n      },\n\n      /**\n       * Used to propagate the `theme` attribute from the host element.\n       */\n      theme: String,\n\n      _selectedItem: {\n        type: Object\n      },\n\n      _items: {\n        type: Object\n      },\n\n      _focusedIndex: {\n        type: Number,\n        value: -1,\n        observer: '_focusedIndexChanged'\n      },\n\n      _focusedItem: {\n        type: String,\n        computed: '_getFocusedItem(_focusedIndex)'\n      },\n\n      _itemLabelPath: {\n        type: String,\n        value: 'label'\n      },\n\n      _itemValuePath: {\n        type: String,\n        value: 'value'\n      },\n\n      _selector: Object,\n\n      _itemIdPath: String\n    };\n  }\n\n  static get observers() {\n    return ['_selectorChanged(_selector)', '_loadingChanged(loading)', '_openedChanged(opened, _items, loading)'];\n  }\n\n  _fireTouchAction(sourceEvent) {\n    this.dispatchEvent(new CustomEvent('vaadin-overlay-touch-action', {\n      detail: {sourceEvent: sourceEvent}\n    }));\n  }\n\n  _getItems(opened, items) {\n    return opened ? items : [];\n  }\n\n  _openedChanged(opened, items, loading) {\n    if (this.$.dropdown.hasAttribute('disable-upgrade')) {\n      if (!opened) {\n        return;\n      } else {\n        this._initDropdown();\n      }\n    }\n    // Do not attach if no items\n    // Do not dettach if opened but user types an invalid search\n    this.$.dropdown.opened = !!(opened && (loading || this.$.dropdown.opened || items && items.length));\n  }\n\n  _initDropdown() {\n    this.$.dropdown.removeAttribute('disable-upgrade');\n\n    this._templateChanged();\n    this._loadingChanged(this.loading);\n\n    this.$.dropdown.$.overlay.addEventListener('touchend', e => this._fireTouchAction(e));\n    this.$.dropdown.$.overlay.addEventListener('touchmove', e => this._fireTouchAction(e));\n\n    // Prevent blurring the input when clicking inside the overlay.\n    this.$.dropdown.$.overlay.addEventListener('mousedown', e => e.preventDefault());\n\n    // IE11: when scrolling with mouse, the focus goes to the scroller.\n    // This causes the overlay closing due to defocusing the input field.\n    // Prevent focusing the scroller by setting `unselectable=\"on\"`.\n    if (/Trident/.test(navigator.userAgent)) {\n      this._scroller.setAttribute('unselectable', 'on');\n    }\n  }\n\n  _templateChanged(e) {\n    if (this.$.dropdown.hasAttribute('disable-upgrade')) {\n      return;\n    }\n\n    this._selector = this.$.dropdown.$.overlay.content.querySelector('#selector');\n    this._scroller = this.$.dropdown.$.overlay.content.querySelector('#scroller');\n  }\n\n  _loadingChanged(loading) {\n    if (this.$.dropdown.hasAttribute('disable-upgrade')) {\n      return;\n    }\n\n    if (loading) {\n      this.$.dropdown.$.overlay.setAttribute('loading', '');\n    } else {\n      this.$.dropdown.$.overlay.removeAttribute('loading');\n    }\n  }\n\n  _selectorChanged(selector) {\n    this._patchWheelOverScrolling();\n  }\n\n  _setOverlayHeight() {\n    if (!this.opened || !this.positionTarget || !this._selector) {\n      return;\n    }\n\n    const targetRect = this.positionTarget.getBoundingClientRect();\n\n    this._scroller.style.maxHeight = (window.ShadyCSS ?\n      window.ShadyCSS.getComputedStyleValue(this, '--vaadin-combo-box-overlay-max-height') :\n      getComputedStyle(this).getPropertyValue('--vaadin-combo-box-overlay-max-height')) || '65vh';\n\n    const maxHeight = this._maxOverlayHeight(targetRect);\n\n    // overlay max height is restrained by the #scroller max height which is set to 65vh in CSS.\n    this.$.dropdown.$.overlay.style.maxHeight = maxHeight;\n\n    // we need to set height for iron-list to make its `firstVisibleIndex` work correctly.\n    this._selector.style.maxHeight = maxHeight;\n\n    this.updateViewportBoundaries();\n  }\n\n  _maxOverlayHeight(targetRect) {\n    const margin = 8;\n    const minHeight = 116; // Height of two items in combo-box\n    const bottom = Math.min(window.innerHeight, document.body.scrollHeight - document.body.scrollTop);\n\n    if (this.$.dropdown.alignedAbove) {\n      return Math.max(targetRect.top - margin + Math.min(document.body.scrollTop, 0), minHeight) + 'px';\n    } else {\n      return Math.max(bottom - targetRect.bottom - margin, minHeight) + 'px';\n    }\n  }\n\n  _getFocusedItem(focusedIndex) {\n    if (focusedIndex >= 0) {\n      return this._items[focusedIndex];\n    }\n  }\n\n  _isItemSelected(item, selectedItem, itemIdPath) {\n    if (item instanceof ComboBoxPlaceholder) {\n      return false;\n    } else if (itemIdPath && item !== undefined && selectedItem !== undefined) {\n      return this.get(itemIdPath, item) === this.get(itemIdPath, selectedItem);\n    } else {\n      return item === selectedItem;\n    }\n  }\n\n  _onItemClick(e) {\n    if (e.detail && e.detail.sourceEvent && e.detail.sourceEvent.stopPropagation) {\n      this._stopPropagation(e.detail.sourceEvent);\n    }\n\n    this.dispatchEvent(new CustomEvent('selection-changed', {detail: {item: e.model.item}}));\n  }\n\n  /**\n   * Gets the index of the item with the provided label.\n   * @return {Number}\n   */\n  indexOfLabel(label) {\n    if (this._items && label) {\n      for (let i = 0; i < this._items.length; i++) {\n        if (this.getItemLabel(this._items[i]).toString().toLowerCase() ===\n          label.toString().toLowerCase()) {\n          return i;\n        }\n      }\n    }\n\n    return -1;\n  }\n\n  /**\n   * If dataProvider is used, dispatch a request for the items index if\n   * the item is a placeholder object.\n   *\n   * @return {Number}\n   */\n  __requestItemByIndex(item, index) {\n    if ((item instanceof ComboBoxPlaceholder) && index !== undefined) {\n      this.dispatchEvent(new CustomEvent('index-requested', {detail: {index}}));\n    }\n\n    return index;\n  }\n\n  /**\n   * Gets the label string for the item based on the `_itemLabelPath`.\n   * @return {String}\n   */\n  getItemLabel(item, itemLabelPath) {\n    itemLabelPath = itemLabelPath || this._itemLabelPath;\n    let label = item && itemLabelPath ? this.get(itemLabelPath, item) : undefined;\n    if (label === undefined || label === null) {\n      label = item ? item.toString() : '';\n    }\n    return label;\n  }\n\n  _isItemFocused(focusedIndex, itemIndex) {\n    return focusedIndex == itemIndex;\n  }\n\n  _getAriaSelected(focusedIndex, itemIndex) {\n    return this._isItemFocused(focusedIndex, itemIndex).toString();\n  }\n\n  _getAriaRole(itemIndex) {\n    return itemIndex !== undefined ? 'option' : false;\n  }\n\n  _focusedIndexChanged(index) {\n    if (index >= 0) {\n      this._scrollIntoView(index);\n    }\n  }\n\n  _scrollIntoView(index) {\n    const visibleItemsCount = this._visibleItemsCount();\n    if (visibleItemsCount === undefined) {\n      // Scroller is not visible. Moving is unnecessary.\n      return;\n    }\n\n    let targetIndex = index;\n\n    if (index > this._selector.lastVisibleIndex - 1) {\n      // Index is below the bottom, scrolling down. Make the item appear at the bottom.\n      targetIndex = index - visibleItemsCount + 1;\n    } else if (index > this._selector.firstVisibleIndex) {\n      // The item is already visible, scrolling is unnecessary per se. But we need to trigger iron-list to set\n      // the correct scrollTop on the scrollTarget. Scrolling to firstVisibleIndex.\n      targetIndex = this._selector.firstVisibleIndex;\n    }\n    this._selector.scrollToIndex(Math.max(0, targetIndex));\n\n    // Sometimes the item is partly below the bottom edge, detect and adjust.\n    const pidx = this._selector._getPhysicalIndex(index),\n      physicalItem = this._selector._physicalItems[pidx];\n    if (!physicalItem) {\n      return;\n    }\n    const physicalItemRect = physicalItem.getBoundingClientRect(),\n      scrollerRect = this._scroller.getBoundingClientRect(),\n      scrollTopAdjust = physicalItemRect.bottom - scrollerRect.bottom + this._viewportTotalPaddingBottom;\n    if (scrollTopAdjust > 0) {\n      this._scroller.scrollTop += scrollTopAdjust;\n    }\n  }\n\n  ensureItemsRendered() {\n    this._selector._render();\n  }\n\n  adjustScrollPosition() {\n    if (this.opened && this._items) {\n      this._scrollIntoView(this._focusedIndex);\n    }\n  }\n\n  /**\n   * We want to prevent the kinetic scrolling energy from being transferred from the overlay contents over to the parent.\n   * Further improvement ideas: after the contents have been scrolled to the top or bottom and scrolling has stopped, it could allow\n   * scrolling the parent similarly to touch scrolling.\n   */\n  _patchWheelOverScrolling() {\n    const selector = this._selector;\n    selector.addEventListener('wheel', e => {\n      const scroller = selector._scroller || selector.scrollTarget;\n      const scrolledToTop = scroller.scrollTop === 0;\n      const scrolledToBottom = (scroller.scrollHeight - scroller.scrollTop - scroller.clientHeight) <= 1;\n\n      if (scrolledToTop && e.deltaY < 0) {\n        e.preventDefault();\n      } else if (scrolledToBottom && e.deltaY > 0) {\n        e.preventDefault();\n      }\n    });\n  }\n\n  updateViewportBoundaries() {\n    this._cachedViewportTotalPaddingBottom = undefined;\n    this._selector.updateViewportBoundaries();\n  }\n\n  get _viewportTotalPaddingBottom() {\n    if (this._cachedViewportTotalPaddingBottom === undefined) {\n      const itemsStyle = window.getComputedStyle(this._selector.$.items);\n      this._cachedViewportTotalPaddingBottom = [\n        itemsStyle.paddingBottom,\n        itemsStyle.borderBottomWidth\n      ].map(v => {\n        return parseInt(v, 10);\n      }).reduce((sum, v) => {\n        return sum + v;\n      });\n    }\n\n    return this._cachedViewportTotalPaddingBottom;\n  }\n\n  _visibleItemsCount() {\n    if (!this._selector) {\n      return;\n    }\n\n    // Ensure items are rendered\n    this._selector.flushDebouncer('_debounceTemplate');\n    // Ensure items are positioned\n    this._selector.scrollToIndex(this._selector.firstVisibleIndex);\n    // Ensure viewport boundaries are up-to-date\n    this.updateViewportBoundaries();\n    return this._selector.lastVisibleIndex - this._selector.firstVisibleIndex + 1;\n  }\n\n  _selectItem(item) {\n    item = (typeof item === 'number') ? this._items[item] : item;\n    if (this._selector.selectedItem !== item) {\n      this._selector.selectItem(item);\n    }\n  }\n\n  _preventDefault(e) {\n    if (e.cancelable) {\n      e.preventDefault();\n    }\n  }\n\n  _stopPropagation(e) {\n    e.stopPropagation();\n  }\n\n  _hidden(itemsChange) {\n    return !this.loading && (!this._items || !this._items.length);\n  }\n}\n\ncustomElements.define(ComboBoxDropdownWrapperElement.is, ComboBoxDropdownWrapperElement);\n","/**\n@license\nCopyright (c) 2017 Vaadin Ltd.\nThis program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n*/\nimport { PolymerElement } from '@polymer/polymer/polymer-element.js';\n\nimport { ThemableMixin } from '@vaadin/vaadin-themable-mixin/vaadin-themable-mixin.js';\nimport { ThemePropertyMixin } from '@vaadin/vaadin-themable-mixin/vaadin-theme-property-mixin.js';\nimport { ComboBoxMixin } from './vaadin-combo-box-mixin.js';\nimport { ComboBoxDataProviderMixin } from './vaadin-combo-box-data-provider-mixin.js';\nimport './vaadin-combo-box-dropdown-wrapper.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\nimport { dashToCamelCase } from '@polymer/polymer/lib/utils/case-map.js';\n/**\n * `<vaadin-combo-box-light>` is a customizable version of the `<vaadin-combo-box>` providing\n * only the dropdown functionality and leaving the input field definition to the user.\n *\n * The element has the same API as `<vaadin-combo-box>`.\n *\n * To create a custom input field, you need to add a child element which has a two-way\n * data-bindable property representing the input value. The property name is expected\n * to be `value` by default. See the example below for a simplest possible example\n * using a `<vaadin-text-field>` element.\n *\n * ```html\n * <vaadin-combo-box-light>\n *   <vaadin-text-field>\n *   </vaadin-text-field>\n * </vaadin-combo-box-light>\n * ```\n *\n * If you are using other custom input fields like `<iron-input>`, you\n * need to define the name of the bindable property with the `attrForValue` attribute.\n *\n * ```html\n * <vaadin-combo-box-light attr-for-value=\"bind-value\">\n *   <iron-input>\n *     <input>\n *   </iron-input>\n * </vaadin-combo-box-light>\n * ```\n *\n * In the next example you can see how to create a custom input field based\n * on a `<paper-input>` decorated with a custom `<iron-icon>` and\n * two `<paper-button>`s to act as the clear and toggle controls.\n *\n * ```html\n * <vaadin-combo-box-light>\n *   <paper-input label=\"Elements\" class=\"input\">\n *     <iron-icon icon=\"toll\" slot=\"prefix\"></iron-icon>\n *     <paper-button slot=\"suffix\" class=\"clear-button\">Clear</paper-button>\n *     <paper-button slot=\"suffix\" class=\"toggle-button\">Toggle</paper-button>\n *   </paper-input>\n * </vaadin-combo-box-light>\n * ```\n * @memberof Vaadin\n * @mixes Vaadin.ComboBoxDataProviderMixin\n * @mixes Vaadin.ComboBoxMixin\n * @mixes Vaadin.ThemableMixin\n * @mixes Vaadin.ThemePropertyMixin\n */\nclass ComboBoxLightElement extends\n  ThemePropertyMixin(\n    ThemableMixin(\n      ComboBoxDataProviderMixin(\n        ComboBoxMixin(PolymerElement)))) {\n  static get template() {\n    return html`\n    <slot></slot>\n\n    <vaadin-combo-box-dropdown-wrapper id=\"overlay\" opened=\"[[opened]]\" position-target=\"[[inputElement]]\" renderer=\"[[renderer]]\" _focused-index=\"[[_focusedIndex]]\" _item-id-path=\"[[itemIdPath]]\" _item-label-path=\"[[itemLabelPath]]\" loading=\"[[loading]]\" theme=\"[[theme]]\">\n    </vaadin-combo-box-dropdown-wrapper>\n`;\n  }\n\n  static get is() {\n    return 'vaadin-combo-box-light';\n  }\n\n  static get properties() {\n    return {\n      /**\n       * Name of the two-way data-bindable property representing the\n       * value of the custom input field.\n       */\n      attrForValue: {\n        type: String,\n        value: 'value'\n      },\n\n      inputElement: {\n        type: Element,\n        readOnly: true\n      }\n    };\n  }\n\n  constructor() {\n    super();\n    this._boundInputValueChanged = this._inputValueChanged.bind(this);\n  }\n\n  ready() {\n    super.ready();\n    this._toggleElement = this.querySelector('.toggle-button');\n    this._clearElement = this.querySelector('.clear-button');\n  }\n\n  get focused() {\n    return this.getRootNode().activeElement === this.inputElement;\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    const cssSelector = 'vaadin-text-field,iron-input,paper-input,.paper-input-input,.input';\n    this._setInputElement(this.querySelector(cssSelector));\n    this._revertInputValue();\n    this.inputElement.addEventListener('input', this._boundInputValueChanged);\n    this._preventInputBlur();\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    this.inputElement.removeEventListener('input', this._boundInputValueChanged);\n    this._restoreInputBlur();\n  }\n\n  get _propertyForValue() {\n    return dashToCamelCase(this.attrForValue);\n  }\n\n  get _inputElementValue() {\n    return this.inputElement && this.inputElement[this._propertyForValue];\n  }\n\n  set _inputElementValue(value) {\n    if (this.inputElement) {\n      this.inputElement[this._propertyForValue] = value;\n    }\n  }\n}\n\ncustomElements.define(ComboBoxLightElement.is, ComboBoxLightElement);\n\nexport { ComboBoxLightElement };\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\nimport '@polymer/iron-a11y-keys-behavior/iron-a11y-keys-behavior.js';\nimport '@polymer/iron-icon/iron-icon.js';\nimport '@polymer/paper-menu-button/paper-menu-button.js';\nimport '@polymer/paper-styles/default-theme.js';\nimport './paper-dropdown-menu-icons.js';\nimport './paper-dropdown-menu-shared-styles.js';\n\nimport {IronButtonState} from '@polymer/iron-behaviors/iron-button-state.js';\nimport {IronControlState} from '@polymer/iron-behaviors/iron-control-state.js';\nimport {IronFormElementBehavior} from '@polymer/iron-form-element-behavior/iron-form-element-behavior.js';\nimport {IronValidatableBehavior} from '@polymer/iron-validatable-behavior/iron-validatable-behavior.js';\nimport {PaperRippleBehavior} from '@polymer/paper-behaviors/paper-ripple-behavior.js';\nimport {Polymer} from '@polymer/polymer/lib/legacy/polymer-fn.js';\nimport {dom} from '@polymer/polymer/lib/legacy/polymer.dom.js';\nimport * as gestures from '@polymer/polymer/lib/utils/gestures.js';\nimport {html} from '@polymer/polymer/lib/utils/html-tag.js';\n\n/**\nMaterial design: [Dropdown\nmenus](https://www.google.com/design/spec/components/buttons.html#buttons-dropdown-buttons)\n\nThis is a faster, lighter version of `paper-dropdown-menu`, that does not\nuse a `<paper-input>` internally. Use this element if you're concerned about\nthe performance of this element, i.e., if you plan on using many dropdowns on\nthe same page. Note that this element has a slightly different styling API\nthan `paper-dropdown-menu`.\n\n`paper-dropdown-menu-light` is similar to a native browser select element.\n`paper-dropdown-menu-light` works with selectable content. The currently\nselected item is displayed in the control. If no item is selected, the `label`\nis displayed instead.\n\nExample:\n\n    <paper-dropdown-menu-light label=\"Your favourite pastry\">\n      <paper-listbox slot=\"dropdown-content\">\n        <paper-item>Croissant</paper-item>\n        <paper-item>Donut</paper-item>\n        <paper-item>Financier</paper-item>\n        <paper-item>Madeleine</paper-item>\n      </paper-listbox>\n    </paper-dropdown-menu-light>\n\nThis example renders a dropdown menu with 4 options.\n\nThe child element with the slot `dropdown-content` is used as the dropdown\nmenu. This can be a [`paper-listbox`](paper-listbox), or any other or\nelement that acts like an [`iron-selector`](iron-selector).\n\nSpecifically, the menu child must fire an\n[`iron-select`](iron-selector#event-iron-select) event when one of its\nchildren is selected, and an\n[`iron-deselect`](iron-selector#event-iron-deselect) event when a child is\ndeselected. The selected or deselected item must be passed as the event's\n`detail.item` property.\n\nApplications can listen for the `iron-select` and `iron-deselect` events\nto react when options are selected and deselected.\n\n### Styling\n\nThe following custom properties and mixins are also available for styling:\n\nCustom property | Description | Default\n----------------|-------------|----------\n`--paper-dropdown-menu` | A mixin that is applied to the element host | `{}`\n`--paper-dropdown-menu-disabled` | A mixin that is applied to the element host when disabled | `{}`\n`--paper-dropdown-menu-ripple` | A mixin that is applied to the internal ripple | `{}`\n`--paper-dropdown-menu-button` | A mixin that is applied to the internal menu button | `{}`\n`--paper-dropdown-menu-icon` | A mixin that is applied to the internal icon | `{}`\n`--paper-dropdown-menu-disabled-opacity` | The opacity of the dropdown when disabled  | `0.33`\n`--paper-dropdown-menu-color` | The color of the input/label/underline when the dropdown is unfocused | `--primary-text-color`\n`--paper-dropdown-menu-focus-color` | The color of the label/underline when the dropdown is focused  | `--primary-color`\n`--paper-dropdown-error-color` | The color of the label/underline when the dropdown is invalid  | `--error-color`\n`--paper-dropdown-menu-label` | Mixin applied to the label | `{}`\n`--paper-dropdown-menu-input` | Mixin appled to the input | `{}`\n\nNote that in this element, the underline is just the bottom border of the\n\"input\". To style it:\n\n    <style is=custom-style>\n      paper-dropdown-menu-light.custom {\n        --paper-dropdown-menu-input: {\n          border-bottom: 2px dashed lavender;\n        };\n    </style>\n\n@group Paper Elements\n@element paper-dropdown-menu-light\n@demo demo/index.html\n*/\nPolymer({\n  _template: html`\n    <style include=\"paper-dropdown-menu-shared-styles\">\n      :host(:focus) {\n        outline: none;\n      }\n\n      :host {\n        width: 200px;  /* Default size of an <input> */\n      }\n\n      /**\n       * All of these styles below are for styling the fake-input display\n       */\n      [slot=\"dropdown-trigger\"] {\n        box-sizing: border-box;\n        position: relative;\n        width: 100%;\n        padding: 16px 0 8px 0;\n      }\n\n      :host([disabled]) [slot=\"dropdown-trigger\"] {\n        pointer-events: none;\n        opacity: var(--paper-dropdown-menu-disabled-opacity, 0.33);\n      }\n\n      :host([no-label-float]) [slot=\"dropdown-trigger\"] {\n        padding-top: 8px;   /* If there's no label, we need less space up top. */\n      }\n\n      #input {\n        @apply --paper-font-subhead;\n        @apply --paper-font-common-nowrap;\n        line-height: 1.5;\n        border-bottom: 1px solid var(--paper-dropdown-menu-color, var(--secondary-text-color));\n        color: var(--paper-dropdown-menu-color, var(--primary-text-color));\n        width: 100%;\n        box-sizing: border-box;\n        padding: 12px 20px 0 0;   /* Right padding so that text doesn't overlap the icon */\n        outline: none;\n        @apply --paper-dropdown-menu-input;\n      }\n\n      #input:dir(rtl) {\n        padding-right: 0px;\n        padding-left: 20px;\n      }\n\n      :host([disabled]) #input {\n        border-bottom: 1px dashed var(--paper-dropdown-menu-color, var(--secondary-text-color));\n      }\n\n      :host([invalid]) #input {\n        border-bottom: 2px solid var(--paper-dropdown-error-color, var(--error-color));\n      }\n\n      :host([no-label-float]) #input {\n        padding-top: 0;   /* If there's no label, we need less space up top. */\n      }\n\n      label {\n        @apply --paper-font-subhead;\n        @apply --paper-font-common-nowrap;\n        display: block;\n        position: absolute;\n        bottom: 0;\n        left: 0;\n        right: 0;\n        /**\n         * The container has a 16px top padding, and there's 12px of padding\n         * between the input and the label (from the input's padding-top)\n         */\n        top: 28px;\n        box-sizing: border-box;\n        width: 100%;\n        padding-right: 20px;    /* Right padding so that text doesn't overlap the icon */\n        text-align: left;\n        transition-duration: .2s;\n        transition-timing-function: cubic-bezier(.4,0,.2,1);\n        color: var(--paper-dropdown-menu-color, var(--secondary-text-color));\n        @apply --paper-dropdown-menu-label;\n      }\n\n      label:dir(rtl) {\n        padding-right: 0px;\n        padding-left: 20px;\n      }\n\n      :host([no-label-float]) label {\n        top: 8px;\n        /* Since the label doesn't need to float, remove the animation duration\n        which slows down visibility changes (i.e. when a selection is made) */\n        transition-duration: 0s;\n      }\n\n      label.label-is-floating {\n        font-size: 12px;\n        top: 8px;\n      }\n\n      label.label-is-hidden {\n        visibility: hidden;\n      }\n\n      :host([focused]) label.label-is-floating {\n        color: var(--paper-dropdown-menu-focus-color, var(--primary-color));\n      }\n\n      :host([invalid]) label.label-is-floating {\n        color: var(--paper-dropdown-error-color, var(--error-color));\n      }\n\n      /**\n       * Sets up the focused underline. It's initially hidden, and becomes\n       * visible when it's focused.\n       */\n      label:after {\n        background-color: var(--paper-dropdown-menu-focus-color, var(--primary-color));\n        bottom: 7px;    /* The container has an 8px bottom padding */\n        content: '';\n        height: 2px;\n        left: 45%;\n        position: absolute;\n        transition-duration: .2s;\n        transition-timing-function: cubic-bezier(.4,0,.2,1);\n        visibility: hidden;\n        width: 8px;\n        z-index: 10;\n      }\n\n      :host([invalid]) label:after {\n        background-color: var(--paper-dropdown-error-color, var(--error-color));\n      }\n\n      :host([no-label-float]) label:after {\n        bottom: 7px;    /* The container has a 8px bottom padding */\n      }\n\n      :host([focused]:not([disabled])) label:after {\n        left: 0;\n        visibility: visible;\n        width: 100%;\n      }\n\n      iron-icon {\n        position: absolute;\n        right: 0px;\n        bottom: 8px;    /* The container has an 8px bottom padding */\n        @apply --paper-font-subhead;\n        color: var(--disabled-text-color);\n        @apply --paper-dropdown-menu-icon;\n      }\n\n      iron-icon:dir(rtl) {\n        left: 0;\n        right: auto;\n      }\n\n      :host([no-label-float]) iron-icon {\n        margin-top: 0px;\n      }\n\n      .error {\n        display: inline-block;\n        visibility: hidden;\n        color: var(--paper-dropdown-error-color, var(--error-color));\n        @apply --paper-font-caption;\n        position: absolute;\n        left:0;\n        right:0;\n        bottom: -12px;\n      }\n\n      :host([invalid]) .error {\n        visibility: visible;\n      }\n    </style>\n\n    <!-- this div fulfills an a11y requirement for combobox, do not remove -->\n    <span role=\"button\"></span>\n    <paper-menu-button id=\"menuButton\" vertical-align=\"[[verticalAlign]]\" horizontal-align=\"[[horizontalAlign]]\" vertical-offset=\"[[_computeMenuVerticalOffset(noLabelFloat, verticalOffset)]]\" disabled=\"[[disabled]]\" no-animations=\"[[noAnimations]]\" on-iron-select=\"_onIronSelect\" on-iron-deselect=\"_onIronDeselect\" opened=\"{{opened}}\" close-on-activate allow-outside-scroll=\"[[allowOutsideScroll]]\">\n      <!-- support hybrid mode: user might be using paper-menu-button 1.x which distributes via <content> -->\n      <div class=\"dropdown-trigger\" slot=\"dropdown-trigger\">\n        <label class\\$=\"[[_computeLabelClass(noLabelFloat,alwaysFloatLabel,hasContent)]]\">\n          [[label]]\n        </label>\n        <div id=\"input\" tabindex=\"-1\">&nbsp;</div>\n        <iron-icon icon=\"paper-dropdown-menu:arrow-drop-down\"></iron-icon>\n        <span class=\"error\">[[errorMessage]]</span>\n      </div>\n      <slot id=\"content\" name=\"dropdown-content\" slot=\"dropdown-content\"></slot>\n    </paper-menu-button>\n`,\n\n  is: 'paper-dropdown-menu-light',\n\n  behaviors: [\n    IronButtonState,\n    IronControlState,\n    PaperRippleBehavior,\n    IronFormElementBehavior,\n    IronValidatableBehavior\n  ],\n\n  properties: {\n    /**\n     * The derived \"label\" of the currently selected item. This value\n     * is the `label` property on the selected item if set, or else the\n     * trimmed text content of the selected item.\n     */\n    selectedItemLabel: {type: String, notify: true, readOnly: true},\n\n    /**\n     * The last selected item. An item is selected if the dropdown menu has\n     * a child with class `dropdown-content`, and that child triggers an\n     * `iron-select` event with the selected `item` in the `detail`.\n     *\n     * @type {?Object}\n     */\n    selectedItem: {type: Object, notify: true, readOnly: true},\n\n    /**\n     * The value for this element that will be used when submitting in\n     * a form. It reflects the value of `selectedItemLabel`. If set directly,\n     * it will not update the `selectedItemLabel` value.\n     */\n    value: {\n      type: String,\n      notify: true,\n      observer: '_valueChanged',\n    },\n\n    /**\n     * The label for the dropdown.\n     */\n    label: {type: String},\n\n    /**\n     * The placeholder for the dropdown.\n     */\n    placeholder: {type: String},\n\n    /**\n     * True if the dropdown is open. Otherwise, false.\n     */\n    opened:\n        {type: Boolean, notify: true, value: false, observer: '_openedChanged'},\n\n    /**\n     * By default, the dropdown will constrain scrolling on the page\n     * to itself when opened.\n     * Set to true in order to prevent scroll from being constrained\n     * to the dropdown when it opens.\n     */\n    allowOutsideScroll: {type: Boolean, value: false},\n\n    /**\n     * Set to true to disable the floating label. Bind this to the\n     * `<paper-input-container>`'s `noLabelFloat` property.\n     */\n    noLabelFloat: {type: Boolean, value: false, reflectToAttribute: true},\n\n    /**\n     * Set to true to always float the label. Bind this to the\n     * `<paper-input-container>`'s `alwaysFloatLabel` property.\n     */\n    alwaysFloatLabel: {type: Boolean, value: false},\n\n    /**\n     * Set to true to disable animations when opening and closing the\n     * dropdown.\n     */\n    noAnimations: {type: Boolean, value: false},\n\n    /**\n     * The orientation against which to align the menu dropdown\n     * horizontally relative to the dropdown trigger.\n     */\n    horizontalAlign: {type: String, value: 'right'},\n\n    /**\n     * The orientation against which to align the menu dropdown\n     * vertically relative to the dropdown trigger.\n     */\n    verticalAlign: {type: String, value: 'top'},\n\n    /**\n     * Overrides the vertical offset computed in\n     * _computeMenuVerticalOffset.\n     */\n    verticalOffset: Number,\n\n    hasContent: {type: Boolean, readOnly: true}\n  },\n\n  listeners: {'tap': '_onTap'},\n\n  /**\n   * @type {!Object}\n   */\n  keyBindings: {'up down': 'open', 'esc': 'close'},\n\n  hostAttributes: {\n    tabindex: 0,\n    role: 'combobox',\n    'aria-autocomplete': 'none',\n    'aria-haspopup': 'true'\n  },\n\n  observers: ['_selectedItemChanged(selectedItem)'],\n\n  attached: function() {\n    // NOTE(cdata): Due to timing, a preselected value in a `IronSelectable`\n    // child will cause an `iron-select` event to fire while the element is\n    // still in a `DocumentFragment`. This has the effect of causing\n    // handlers not to fire. So, we double check this value on attached:\n    var contentElement = this.contentElement;\n    if (contentElement && contentElement.selectedItem) {\n      this._setSelectedItem(contentElement.selectedItem);\n    }\n  },\n\n  /**\n   * The content element that is contained by the dropdown menu, if any.\n   */\n  get contentElement() {\n    // Polymer 2.x returns slot.assignedNodes which can contain text nodes.\n    var nodes = dom(this.$.content).getDistributedNodes();\n    for (var i = 0, l = nodes.length; i < l; i++) {\n      if (nodes[i].nodeType === Node.ELEMENT_NODE) {\n        return nodes[i];\n      }\n    }\n  },\n\n  /**\n   * Show the dropdown content.\n   */\n  open: function() {\n    this.$.menuButton.open();\n  },\n\n  /**\n   * Hide the dropdown content.\n   */\n  close: function() {\n    this.$.menuButton.close();\n  },\n\n  /**\n   * A handler that is called when `iron-select` is fired.\n   *\n   * @param {CustomEvent} event An `iron-select` event.\n   */\n  _onIronSelect: function(event) {\n    this._setSelectedItem(event.detail.item);\n  },\n\n  /**\n   * A handler that is called when `iron-deselect` is fired.\n   *\n   * @param {CustomEvent} event An `iron-deselect` event.\n   */\n  _onIronDeselect: function(event) {\n    this._setSelectedItem(null);\n  },\n\n  /**\n   * A handler that is called when the dropdown is tapped.\n   *\n   * @param {CustomEvent} event A tap event.\n   */\n  _onTap: function(event) {\n    if (gestures.findOriginalTarget(event) === this) {\n      this.open();\n    }\n  },\n\n  /**\n   * Compute the label for the dropdown given a selected item.\n   *\n   * @param {Element} selectedItem A selected Element item, with an\n   * optional `label` property.\n   */\n  _selectedItemChanged: function(selectedItem) {\n    var value = '';\n    if (!selectedItem) {\n      value = '';\n    } else {\n      value = selectedItem.label || selectedItem.getAttribute('label') ||\n          selectedItem.textContent.trim();\n    }\n\n    this.value = value;\n    this._setSelectedItemLabel(value);\n  },\n\n  /**\n   * Compute the vertical offset of the menu based on the value of\n   * `noLabelFloat`.\n   *\n   * @param {boolean} noLabelFloat True if the label should not float\n   * @param {number=} opt_verticalOffset Optional offset from the user\n   * above the input, otherwise false.\n   */\n  _computeMenuVerticalOffset: function(noLabelFloat, opt_verticalOffset) {\n    // Override offset if it's passed from the user.\n    if (opt_verticalOffset) {\n      return opt_verticalOffset;\n    }\n\n    // NOTE(cdata): These numbers are somewhat magical because they are\n    // derived from the metrics of elements internal to `paper-input`'s\n    // template. The metrics will change depending on whether or not the\n    // input has a floating label.\n    return noLabelFloat ? -4 : 8;\n  },\n\n  /**\n   * Returns false if the element is required and does not have a selection,\n   * and true otherwise.\n   * @param {*=} _value Ignored.\n   * @return {boolean} true if `required` is false, or if `required` is true\n   * and the element has a valid selection.\n   */\n  _getValidity: function(_value) {\n    return this.disabled || !this.required || (this.required && !!this.value);\n  },\n\n  _openedChanged: function() {\n    var openState = this.opened ? 'true' : 'false';\n    var e = this.contentElement;\n    if (e) {\n      e.setAttribute('aria-expanded', openState);\n    }\n  },\n\n  _computeLabelClass: function(noLabelFloat, alwaysFloatLabel, hasContent) {\n    var cls = '';\n    if (noLabelFloat === true) {\n      return hasContent ? 'label-is-hidden' : '';\n    }\n\n    if (hasContent || alwaysFloatLabel === true) {\n      cls += ' label-is-floating';\n    }\n    return cls;\n  },\n\n  _valueChanged: function() {\n    // Only update if it's actually different.\n    if (this.$.input && this.$.input.textContent !== this.value) {\n      this.$.input.textContent = this.value;\n    }\n    this._setHasContent(!!this.value);\n  }\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\n\nimport {dom} from '@polymer/polymer/lib/legacy/polymer.dom.js';\n\n/**\n * `Polymer.IronScrollTargetBehavior` allows an element to respond to scroll\n * events from a designated scroll target.\n *\n * Elements that consume this behavior can override the `_scrollHandler`\n * method to add logic on the scroll event.\n *\n * @demo demo/scrolling-region.html Scrolling Region\n * @demo demo/document.html Document Element\n * @polymerBehavior\n */\nexport const IronScrollTargetBehavior = {\n\n  properties: {\n\n    /**\n     * Specifies the element that will handle the scroll event\n     * on the behalf of the current element. This is typically a reference to an\n     *element, but there are a few more posibilities:\n     *\n     * ### Elements id\n     *\n     *```html\n     * <div id=\"scrollable-element\" style=\"overflow: auto;\">\n     *  <x-element scroll-target=\"scrollable-element\">\n     *    <!-- Content-->\n     *  </x-element>\n     * </div>\n     *```\n     * In this case, the `scrollTarget` will point to the outer div element.\n     *\n     * ### Document scrolling\n     *\n     * For document scrolling, you can use the reserved word `document`:\n     *\n     *```html\n     * <x-element scroll-target=\"document\">\n     *   <!-- Content -->\n     * </x-element>\n     *```\n     *\n     * ### Elements reference\n     *\n     *```js\n     * appHeader.scrollTarget = document.querySelector('#scrollable-element');\n     *```\n     *\n     * @type {HTMLElement}\n     * @default document\n     */\n    scrollTarget: {\n      type: HTMLElement,\n      value: function() {\n        return this._defaultScrollTarget;\n      }\n    }\n  },\n\n  observers: ['_scrollTargetChanged(scrollTarget, isAttached)'],\n\n  /**\n   * True if the event listener should be installed.\n   */\n  _shouldHaveListener: true,\n\n  _scrollTargetChanged: function(scrollTarget, isAttached) {\n    var eventTarget;\n\n    if (this._oldScrollTarget) {\n      this._toggleScrollListener(false, this._oldScrollTarget);\n      this._oldScrollTarget = null;\n    }\n    if (!isAttached) {\n      return;\n    }\n    // Support element id references\n    if (scrollTarget === 'document') {\n      this.scrollTarget = this._doc;\n\n    } else if (typeof scrollTarget === 'string') {\n      var domHost = this.domHost;\n\n      this.scrollTarget = domHost && domHost.$ ?\n          domHost.$[scrollTarget] :\n          dom(this.ownerDocument).querySelector('#' + scrollTarget);\n\n    } else if (this._isValidScrollTarget()) {\n      this._oldScrollTarget = scrollTarget;\n      this._toggleScrollListener(this._shouldHaveListener, scrollTarget);\n    }\n  },\n\n  /**\n   * Runs on every scroll event. Consumer of this behavior may override this\n   * method.\n   *\n   * @protected\n   */\n  _scrollHandler: function scrollHandler() {},\n\n  /**\n   * The default scroll target. Consumers of this behavior may want to customize\n   * the default scroll target.\n   *\n   * @type {Element}\n   */\n  get _defaultScrollTarget() {\n    return this._doc;\n  },\n\n  /**\n   * Shortcut for the document element\n   *\n   * @type {Element}\n   */\n  get _doc() {\n    return this.ownerDocument.documentElement;\n  },\n\n  /**\n   * Gets the number of pixels that the content of an element is scrolled\n   * upward.\n   *\n   * @type {number}\n   */\n  get _scrollTop() {\n    if (this._isValidScrollTarget()) {\n      return this.scrollTarget === this._doc ? window.pageYOffset :\n                                               this.scrollTarget.scrollTop;\n    }\n    return 0;\n  },\n\n  /**\n   * Gets the number of pixels that the content of an element is scrolled to the\n   * left.\n   *\n   * @type {number}\n   */\n  get _scrollLeft() {\n    if (this._isValidScrollTarget()) {\n      return this.scrollTarget === this._doc ? window.pageXOffset :\n                                               this.scrollTarget.scrollLeft;\n    }\n    return 0;\n  },\n\n  /**\n   * Sets the number of pixels that the content of an element is scrolled\n   * upward.\n   *\n   * @type {number}\n   */\n  set _scrollTop(top) {\n    if (this.scrollTarget === this._doc) {\n      window.scrollTo(window.pageXOffset, top);\n    } else if (this._isValidScrollTarget()) {\n      this.scrollTarget.scrollTop = top;\n    }\n  },\n\n  /**\n   * Sets the number of pixels that the content of an element is scrolled to the\n   * left.\n   *\n   * @type {number}\n   */\n  set _scrollLeft(left) {\n    if (this.scrollTarget === this._doc) {\n      window.scrollTo(left, window.pageYOffset);\n    } else if (this._isValidScrollTarget()) {\n      this.scrollTarget.scrollLeft = left;\n    }\n  },\n\n  /**\n   * Scrolls the content to a particular place.\n   *\n   * @method scroll\n   * @param {number|!{left: number, top: number}} leftOrOptions The left position or scroll options\n   * @param {number=} top The top position\n   * @return {void}\n   */\n  scroll: function(leftOrOptions, top) {\n    var left;\n\n    if (typeof leftOrOptions === 'object') {\n      left = leftOrOptions.left;\n      top = leftOrOptions.top;\n    } else {\n      left = leftOrOptions;\n    }\n\n    left = left || 0;\n    top = top || 0;\n    if (this.scrollTarget === this._doc) {\n      window.scrollTo(left, top);\n    } else if (this._isValidScrollTarget()) {\n      this.scrollTarget.scrollLeft = left;\n      this.scrollTarget.scrollTop = top;\n    }\n  },\n\n  /**\n   * Gets the width of the scroll target.\n   *\n   * @type {number}\n   */\n  get _scrollTargetWidth() {\n    if (this._isValidScrollTarget()) {\n      return this.scrollTarget === this._doc ? window.innerWidth :\n                                               this.scrollTarget.offsetWidth;\n    }\n    return 0;\n  },\n\n  /**\n   * Gets the height of the scroll target.\n   *\n   * @type {number}\n   */\n  get _scrollTargetHeight() {\n    if (this._isValidScrollTarget()) {\n      return this.scrollTarget === this._doc ? window.innerHeight :\n                                               this.scrollTarget.offsetHeight;\n    }\n    return 0;\n  },\n\n  /**\n   * Returns true if the scroll target is a valid HTMLElement.\n   *\n   * @return {boolean}\n   */\n  _isValidScrollTarget: function() {\n    return this.scrollTarget instanceof HTMLElement;\n  },\n\n  _toggleScrollListener: function(yes, scrollTarget) {\n    var eventTarget = scrollTarget === this._doc ? window : scrollTarget;\n    if (yes) {\n      if (!this._boundScrollHandler) {\n        this._boundScrollHandler = this._scrollHandler.bind(this);\n        eventTarget.addEventListener('scroll', this._boundScrollHandler);\n      }\n    } else {\n      if (this._boundScrollHandler) {\n        eventTarget.removeEventListener('scroll', this._boundScrollHandler);\n        this._boundScrollHandler = null;\n      }\n    }\n  },\n\n  /**\n   * Enables or disables the scroll event listener.\n   *\n   * @param {boolean} yes True to add the event, False to remove it.\n   */\n  toggleScrollListener: function(yes) {\n    this._shouldHaveListener = yes;\n    this._toggleScrollListener(yes, this.scrollTarget);\n  }\n\n};\n","const validEntityId = /^(\\w+)\\.(\\w+)$/;\nexport default (entityId: string) => validEntityId.test(entityId);\n","/**\n@license\nCopyright (c) 2018 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\n\nimport {PaperRippleBehavior} from '@polymer/paper-behaviors/paper-ripple-behavior.js';\nimport {Polymer} from '@polymer/polymer/lib/legacy/polymer-fn.js';\nimport {html} from '@polymer/polymer/lib/utils/html-tag.js';\nimport {afterNextRender} from '@polymer/polymer/lib/utils/render-status.js';\n\n/**\nThis is a lighter version of `paper-icon-button`. Its goal is performance, not\ndeveloper ergonomics, so as a result it has fewer features than\n`paper-icon-button` itself. To use it, you must distribute a `button` containing\nthe `iron-icon` you want to use:\n\n<script type=\"module\">\n  import '@polymer/iron-icon/iron-icon.js';\n  import '@polymer/paper-icon-button/paper-icon-button-light.js';\n  import '@polymer/iron-icons/iron-icons.js';\n</script>\n\n<paper-icon-button-light>\n  <button title=\"heart\">\n    <iron-icon icon=\"favorite\"></iron-icon>\n  </button>\n</paper-icon-button-light>\n\nNote that this button is assumed to be distributed at the startup of\n`paper-icon-button-light`. Dynamically adding a `button` to this element is\nnot supported.\n\nThe `title`/`disabled` etc. attributes go on the distributed button, not on the\nwrapper.\n\nThe following custom properties and mixins are also available for styling:\nCustom property | Description | Default\n----------------|-------------|----------\n`--paper-icon-button-light-ripple` | Mixin applied to the paper ripple | `{}`\n\n@group Paper Elements\n@element paper-icon-button-light\n@demo demo/paper-icon-button-light.html\n*/\nPolymer({\n  is: 'paper-icon-button-light',\n\n  _template: html`\n    <style>\n      :host {\n        display: inline-block;\n        position: relative;\n        width: 24px;\n        height: 24px;\n      }\n\n      paper-ripple {\n        opacity: 0.6;\n        color: currentColor;\n        @apply --paper-icon-button-light-ripple;\n      }\n\n      :host > ::slotted(button) {\n        position: relative;\n        width: 100%;\n        height: 100%;\n        margin: 0;\n        padding: 0;\n        background: none;\n        border: none;\n        outline: none;\n        vertical-align: middle;\n        color: inherit;\n        cursor: pointer;\n        /* NOTE: Both values are needed, since some phones require the value to be \\`transparent\\`. */\n        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n        -webkit-tap-highlight-color: transparent;\n      }\n      :host > ::slotted(button[disabled]) {\n        color: #9b9b9b;\n        pointer-events: none;\n        cursor: auto;\n      }\n    </style>\n    <slot></slot>\n  `,\n\n  behaviors: [PaperRippleBehavior],\n\n  registered: function() {\n    this._template.setAttribute('strip-whitespace', '');\n  },\n\n  ready: function() {\n    afterNextRender(this, () => {\n      // Add lazy host listeners\n      this.addEventListener('down', this._rippleDown.bind(this));\n      this.addEventListener('up', this._rippleUp.bind(this));\n\n      // Assume the button has already been distributed.\n      var button = this.getEffectiveChildren()[0];\n      this._rippleContainer = button;\n\n      // We need to set the focus/blur listeners on the distributed button,\n      // not the host, since the host isn't focusable.\n      button.addEventListener('focus', this._rippleDown.bind(this));\n      button.addEventListener('blur', this._rippleUp.bind(this));\n    });\n  },\n  _rippleDown: function() {\n    this.getRipple().uiDownAction();\n  },\n  _rippleUp: function() {\n    this.getRipple().uiUpAction();\n  },\n  /**\n   * @param {...*} var_args\n   */\n  ensureRipple: function(var_args) {\n    var lastRipple = this._ripple;\n    PaperRippleBehavior.ensureRipple.apply(this, arguments);\n    if (this._ripple && this._ripple !== lastRipple) {\n      this._ripple.center = true;\n      this._ripple.classList.add('circle');\n    }\n  }\n});\n","import {\n  LitElement,\n  TemplateResult,\n  property,\n  html,\n  customElement,\n} from \"lit-element\";\nimport \"@polymer/paper-icon-button/paper-icon-button-light\";\n\nimport { HomeAssistant } from \"../../types\";\nimport { PolymerChangedEvent } from \"../../polymer-types\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport isValidEntityId from \"../../common/entity/valid_entity_id\";\n\nimport \"./ha-entity-picker\";\n// Not a duplicate, type import\n// tslint:disable-next-line\nimport { HaEntityPickerEntityFilterFunc } from \"./ha-entity-picker\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\n\n@customElement(\"ha-entities-picker\")\nclass HaEntitiesPickerLight extends LitElement {\n  @property() public hass?: HomeAssistant;\n  @property() public value?: string[];\n  @property({ attribute: \"domain-filter\" }) public domainFilter?: string;\n  @property({ attribute: \"picked-entity-label\" })\n  public pickedEntityLabel?: string;\n  @property({ attribute: \"pick-entity-label\" }) public pickEntityLabel?: string;\n\n  protected render(): TemplateResult | void {\n    if (!this.hass) {\n      return;\n    }\n    const currentEntities = this._currentEntities;\n    return html`\n      ${currentEntities.map(\n        (entityId) => html`\n          <div>\n            <ha-entity-picker\n              allow-custom-entity\n              .curValue=${entityId}\n              .hass=${this.hass}\n              .domainFilter=${this.domainFilter}\n              .entityFilter=${this._entityFilter}\n              .value=${entityId}\n              .label=${this.pickedEntityLabel}\n              @value-changed=${this._entityChanged}\n            ></ha-entity-picker>\n          </div>\n        `\n      )}\n      <div>\n        <ha-entity-picker\n          .hass=${this.hass}\n          .domainFilter=${this.domainFilter}\n          .entityFilter=${this._entityFilter}\n          .label=${this.pickEntityLabel}\n          @value-changed=${this._addEntity}\n        ></ha-entity-picker>\n      </div>\n    `;\n  }\n\n  private _entityFilter: HaEntityPickerEntityFilterFunc = (\n    stateObj: HassEntity\n  ) => !this.value || !this.value.includes(stateObj.entity_id);\n\n  private get _currentEntities() {\n    return this.value || [];\n  }\n\n  private async _updateEntities(entities) {\n    fireEvent(this, \"value-changed\", {\n      value: entities,\n    });\n\n    this.value = entities;\n  }\n\n  private _entityChanged(event: PolymerChangedEvent<string>) {\n    event.stopPropagation();\n    const curValue = (event.currentTarget as any).curValue;\n    const newValue = event.detail.value;\n    if (\n      newValue === curValue ||\n      (newValue !== \"\" && !isValidEntityId(newValue))\n    ) {\n      return;\n    }\n    if (newValue === \"\") {\n      this._updateEntities(\n        this._currentEntities.filter((ent) => ent !== curValue)\n      );\n    } else {\n      this._updateEntities(\n        this._currentEntities.map((ent) => (ent === curValue ? newValue : ent))\n      );\n    }\n  }\n\n  private async _addEntity(event: PolymerChangedEvent<string>) {\n    event.stopPropagation();\n    const toAdd = event.detail.value;\n    (event.currentTarget as any).value = \"\";\n    if (!toAdd) {\n      return;\n    }\n    const currentEntities = this._currentEntities;\n    if (currentEntities.includes(toAdd)) {\n      return;\n    }\n\n    this._updateEntities([...currentEntities, toAdd]);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-entities-picker\": HaEntitiesPickerLight;\n  }\n}\n","import \"@polymer/paper-icon-button/paper-icon-button\";\nimport \"@polymer/paper-input/paper-input\";\nimport \"@polymer/paper-item/paper-icon-item\";\nimport \"@polymer/paper-item/paper-item-body\";\nimport \"@polymer/paper-dropdown-menu/paper-dropdown-menu-light\";\nimport \"@polymer/paper-listbox/paper-listbox\";\nimport memoizeOne from \"memoize-one\";\nimport {\n  LitElement,\n  TemplateResult,\n  html,\n  css,\n  CSSResult,\n  property,\n} from \"lit-element\";\nimport { HomeAssistant } from \"../../types\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { User, fetchUsers } from \"../../data/user\";\nimport { compare } from \"../../common/string/compare\";\n\nclass HaEntityPicker extends LitElement {\n  public hass?: HomeAssistant;\n  @property() public label?: string;\n  @property() public value?: string;\n  @property() public users?: User[];\n\n  private _sortedUsers = memoizeOne((users?: User[]) => {\n    if (!users || users.length === 1) {\n      return users || [];\n    }\n    const sorted = [...users];\n    sorted.sort((a, b) => compare(a.name, b.name));\n    return sorted;\n  });\n\n  protected render(): TemplateResult | void {\n    return html`\n      <paper-dropdown-menu-light .label=${this.label}>\n        <paper-listbox\n          slot=\"dropdown-content\"\n          .selected=${this._value}\n          attr-for-selected=\"data-user-id\"\n          @iron-select=${this._userChanged}\n        >\n          <paper-icon-item data-user-id=\"\">\n            No user\n          </paper-icon-item>\n          ${this._sortedUsers(this.users).map(\n            (user) => html`\n              <paper-icon-item data-user-id=${user.id}>\n                <ha-user-badge .user=${user} slot=\"item-icon\"></ha-user-badge>\n                ${user.name}\n              </paper-icon-item>\n            `\n          )}\n        </paper-listbox>\n      </paper-dropdown-menu-light>\n    `;\n  }\n\n  private get _value() {\n    return this.value || \"\";\n  }\n\n  protected firstUpdated(changedProps) {\n    super.firstUpdated(changedProps);\n    if (this.users === undefined) {\n      fetchUsers(this.hass!).then((users) => {\n        this.users = users;\n      });\n    }\n  }\n\n  private _userChanged(ev) {\n    const newValue = ev.detail.item.dataset.userId;\n\n    if (newValue !== this._value) {\n      this.value = ev.detail.value;\n      setTimeout(() => {\n        fireEvent(this, \"value-changed\", { value: newValue });\n        fireEvent(this, \"change\");\n      }, 0);\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: inline-block;\n      }\n      paper-dropdown-menu-light {\n        display: block;\n      }\n      paper-listbox {\n        min-width: 200px;\n      }\n      paper-icon-item {\n        cursor: pointer;\n      }\n    `;\n  }\n}\n\ncustomElements.define(\"ha-user-picker\", HaEntityPicker);\n","import {\n  LitElement,\n  html,\n  css,\n  CSSResult,\n  TemplateResult,\n  property,\n} from \"lit-element\";\nimport \"@polymer/paper-dialog-scrollable/paper-dialog-scrollable\";\nimport \"@polymer/paper-input/paper-input\";\nimport \"@material/mwc-button\";\n\nimport \"../../../components/dialog/ha-paper-dialog\";\n\nimport \"../../../components/entity/ha-entities-picker\";\nimport \"../../../components/user/ha-user-picker\";\nimport { PersonDetailDialogParams } from \"./show-dialog-person-detail\";\nimport { PolymerChangedEvent } from \"../../../polymer-types\";\nimport { haStyleDialog } from \"../../../resources/styles\";\nimport { HomeAssistant } from \"../../../types\";\nimport { PersonMutableParams } from \"../../../data/person\";\n\nclass DialogPersonDetail extends LitElement {\n  @property() public hass!: HomeAssistant;\n  @property() private _name!: string;\n  @property() private _userId?: string;\n  @property() private _deviceTrackers!: string[];\n  @property() private _error?: string;\n  @property() private _params?: PersonDetailDialogParams;\n  @property() private _submitting: boolean = false;\n\n  public async showDialog(params: PersonDetailDialogParams): Promise<void> {\n    this._params = params;\n    this._error = undefined;\n    if (this._params.entry) {\n      this._name = this._params.entry.name || \"\";\n      this._userId = this._params.entry.user_id || undefined;\n      this._deviceTrackers = this._params.entry.device_trackers || [];\n    } else {\n      this._name = \"\";\n      this._userId = undefined;\n      this._deviceTrackers = [];\n    }\n    await this.updateComplete;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._params) {\n      return html``;\n    }\n    const nameInvalid = this._name.trim() === \"\";\n    return html`\n      <ha-paper-dialog\n        with-backdrop\n        opened\n        @opened-changed=\"${this._openedChanged}\"\n      >\n        <h2>${this._params.entry ? this._params.entry.name : \"New Person\"}</h2>\n        <paper-dialog-scrollable>\n          ${this._error\n            ? html`\n                <div class=\"error\">${this._error}</div>\n              `\n            : \"\"}\n          <div class=\"form\">\n            <paper-input\n              .value=${this._name}\n              @value-changed=${this._nameChanged}\n              label=\"Name\"\n              error-message=\"Name is required\"\n              .invalid=${nameInvalid}\n            ></paper-input>\n            <ha-user-picker\n              label=\"Linked User\"\n              .hass=${this.hass}\n              .value=${this._userId}\n              .users=${this._params.users}\n              @value-changed=${this._userChanged}\n            ></ha-user-picker>\n            <p>\n              ${this.hass.localize(\n                \"ui.panel.config.person.detail.device_tracker_intro\"\n              )}\n            </p>\n            <ha-entities-picker\n              .hass=${this.hass}\n              .value=${this._deviceTrackers}\n              domain-filter=\"device_tracker\"\n              .pickedEntityLabel=${this.hass.localize(\n                \"ui.panel.config.person.detail.device_tracker_picked\"\n              )}\n              .pickEntityLabel=${this.hass.localize(\n                \"ui.panel.config.person.detail.device_tracker_pick\"\n              )}\n              @value-changed=${this._deviceTrackersChanged}\n            ></ha-entities-picker>\n          </div>\n        </paper-dialog-scrollable>\n        <div class=\"paper-dialog-buttons\">\n          ${this._params.entry\n            ? html`\n                <mwc-button\n                  class=\"warning\"\n                  @click=\"${this._deleteEntry}\"\n                  .disabled=${this._submitting}\n                >\n                  DELETE\n                </mwc-button>\n              `\n            : html``}\n          <mwc-button\n            @click=\"${this._updateEntry}\"\n            .disabled=${nameInvalid || this._submitting}\n          >\n            ${this._params.entry ? \"UPDATE\" : \"CREATE\"}\n          </mwc-button>\n        </div>\n      </ha-paper-dialog>\n    `;\n  }\n\n  private _nameChanged(ev: PolymerChangedEvent<string>) {\n    this._error = undefined;\n    this._name = ev.detail.value;\n  }\n\n  private _userChanged(ev: PolymerChangedEvent<string>) {\n    this._error = undefined;\n    this._userId = ev.detail.value;\n  }\n\n  private _deviceTrackersChanged(ev: PolymerChangedEvent<string[]>) {\n    this._error = undefined;\n    this._deviceTrackers = ev.detail.value;\n  }\n\n  private async _updateEntry() {\n    this._submitting = true;\n    try {\n      const values: PersonMutableParams = {\n        name: this._name.trim(),\n        device_trackers: this._deviceTrackers,\n        user_id: this._userId || null,\n      };\n      if (this._params!.entry) {\n        await this._params!.updateEntry(values);\n      } else {\n        await this._params!.createEntry(values);\n      }\n      this._params = undefined;\n    } catch (err) {\n      this._error = err ? err.message : \"Unknown error\";\n    } finally {\n      this._submitting = false;\n    }\n  }\n\n  private async _deleteEntry() {\n    this._submitting = true;\n    try {\n      if (await this._params!.removeEntry()) {\n        this._params = undefined;\n      }\n    } finally {\n      this._submitting = false;\n    }\n  }\n\n  private _openedChanged(ev: PolymerChangedEvent<boolean>): void {\n    if (!(ev.detail as any).value) {\n      this._params = undefined;\n    }\n  }\n\n  static get styles(): CSSResult[] {\n    return [\n      haStyleDialog,\n      css`\n        ha-paper-dialog {\n          min-width: 400px;\n        }\n        .form {\n          padding-bottom: 24px;\n        }\n        ha-user-picker {\n          margin-top: 16px;\n        }\n        mwc-button.warning {\n          margin-right: auto;\n        }\n        .error {\n          color: var(--google-red-500);\n        }\n      `,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"dialog-person-detail\": DialogPersonDetail;\n  }\n}\n\ncustomElements.define(\"dialog-person-detail\", DialogPersonDetail);\n","/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\nimport '@polymer/iron-input/iron-input.js';\nimport './paper-input-char-counter.js';\nimport './paper-input-container.js';\nimport './paper-input-error.js';\n\nimport {IronFormElementBehavior} from '@polymer/iron-form-element-behavior/iron-form-element-behavior.js';\nimport {DomModule} from '@polymer/polymer/lib/elements/dom-module.js';\nimport {Polymer} from '@polymer/polymer/lib/legacy/polymer-fn.js';\nimport {html} from '@polymer/polymer/lib/utils/html-tag.js';\nimport {PaperInputBehavior} from './paper-input-behavior.js';\n\n/**\nMaterial design: [Text\nfields](https://www.google.com/design/spec/components/text-fields.html)\n\n`<paper-input>` is a single-line text field with Material Design styling.\n\n    <paper-input label=\"Input label\"></paper-input>\n\nIt may include an optional error message or character counter.\n\n    <paper-input error-message=\"Invalid input!\" label=\"Input\n    label\"></paper-input> <paper-input char-counter label=\"Input\n    label\"></paper-input>\n\nIt can also include custom prefix or suffix elements, which are displayed\nbefore or after the text input itself. In order for an element to be\nconsidered as a prefix, it must have the `prefix` attribute (and similarly\nfor `suffix`).\n\n    <paper-input label=\"total\">\n      <div prefix>$</div>\n      <paper-icon-button slot=\"suffix\" icon=\"clear\"></paper-icon-button>\n    </paper-input>\n\nA `paper-input` can use the native `type=search` or `type=file` features.\nHowever, since we can't control the native styling of the input (search icon,\nfile button, date placeholder, etc.), in these cases the label will be\nautomatically floated. The `placeholder` attribute can still be used for\nadditional informational text.\n\n    <paper-input label=\"search!\" type=\"search\"\n        placeholder=\"search for cats\" autosave=\"test\" results=\"5\">\n    </paper-input>\n\nSee `Polymer.PaperInputBehavior` for more API docs.\n\n### Focus\n\nTo focus a paper-input, you can call the native `focus()` method as long as the\npaper input has a tab index. Similarly, `blur()` will blur the element.\n\n### Styling\n\nSee `Polymer.PaperInputContainer` for a list of custom properties used to\nstyle this element.\n\nThe following custom properties and mixins are available for styling:\n\nCustom property | Description | Default\n----------------|-------------|----------\n`--paper-input-container-ms-clear` | Mixin applied to the Internet Explorer reveal button (the eyeball) | {}\n\n@group Paper Elements\n@element paper-input\n@hero hero.svg\n@demo demo/index.html\n*/\nPolymer({\n  is: 'paper-input',\n\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n\n      :host([focused]) {\n        outline: none;\n      }\n\n      :host([hidden]) {\n        display: none !important;\n      }\n\n      input {\n        /* Firefox sets a min-width on the input, which can cause layout issues */\n        min-width: 0;\n      }\n\n      /* In 1.x, the <input> is distributed to paper-input-container, which styles it.\n      In 2.x the <iron-input> is distributed to paper-input-container, which styles\n      it, but in order for this to work correctly, we need to reset some\n      of the native input's properties to inherit (from the iron-input) */\n      iron-input > input {\n        @apply --paper-input-container-shared-input-style;\n        font-family: inherit;\n        font-weight: inherit;\n        font-size: inherit;\n        letter-spacing: inherit;\n        word-spacing: inherit;\n        line-height: inherit;\n        text-shadow: inherit;\n        color: inherit;\n        cursor: inherit;\n      }\n\n      input:disabled {\n        @apply --paper-input-container-input-disabled;\n      }\n\n      input::-webkit-outer-spin-button,\n      input::-webkit-inner-spin-button {\n        @apply --paper-input-container-input-webkit-spinner;\n      }\n\n      input::-webkit-clear-button {\n        @apply --paper-input-container-input-webkit-clear;\n      }\n\n      input::-webkit-calendar-picker-indicator {\n        @apply --paper-input-container-input-webkit-calendar-picker-indicator;\n      }\n\n      input::-webkit-input-placeholder {\n        color: var(--paper-input-container-color, var(--secondary-text-color));\n      }\n\n      input:-moz-placeholder {\n        color: var(--paper-input-container-color, var(--secondary-text-color));\n      }\n\n      input::-moz-placeholder {\n        color: var(--paper-input-container-color, var(--secondary-text-color));\n      }\n\n      input::-ms-clear {\n        @apply --paper-input-container-ms-clear;\n      }\n\n      input::-ms-reveal {\n        @apply --paper-input-container-ms-reveal;\n      }\n\n      input:-ms-input-placeholder {\n        color: var(--paper-input-container-color, var(--secondary-text-color));\n      }\n\n      label {\n        pointer-events: none;\n      }\n    </style>\n\n    <paper-input-container id=\"container\" no-label-float=\"[[noLabelFloat]]\" always-float-label=\"[[_computeAlwaysFloatLabel(alwaysFloatLabel,placeholder)]]\" auto-validate$=\"[[autoValidate]]\" disabled$=\"[[disabled]]\" invalid=\"[[invalid]]\">\n\n      <slot name=\"prefix\" slot=\"prefix\"></slot>\n\n      <label hidden$=\"[[!label]]\" aria-hidden=\"true\" for$=\"[[_inputId]]\" slot=\"label\">[[label]]</label>\n\n      <!-- Need to bind maxlength so that the paper-input-char-counter works correctly -->\n      <iron-input bind-value=\"{{value}}\" slot=\"input\" class=\"input-element\" id$=\"[[_inputId]]\" maxlength$=\"[[maxlength]]\" allowed-pattern=\"[[allowedPattern]]\" invalid=\"{{invalid}}\" validator=\"[[validator]]\">\n        <input aria-labelledby$=\"[[_ariaLabelledBy]]\" aria-describedby$=\"[[_ariaDescribedBy]]\" disabled$=\"[[disabled]]\" title$=\"[[title]]\" type$=\"[[type]]\" pattern$=\"[[pattern]]\" required$=\"[[required]]\" autocomplete$=\"[[autocomplete]]\" autofocus$=\"[[autofocus]]\" inputmode$=\"[[inputmode]]\" minlength$=\"[[minlength]]\" maxlength$=\"[[maxlength]]\" min$=\"[[min]]\" max$=\"[[max]]\" step$=\"[[step]]\" name$=\"[[name]]\" placeholder$=\"[[placeholder]]\" readonly$=\"[[readonly]]\" list$=\"[[list]]\" size$=\"[[size]]\" autocapitalize$=\"[[autocapitalize]]\" autocorrect$=\"[[autocorrect]]\" on-change=\"_onChange\" tabindex$=\"[[tabIndex]]\" autosave$=\"[[autosave]]\" results$=\"[[results]]\" accept$=\"[[accept]]\" multiple$=\"[[multiple]]\">\n      </iron-input>\n\n      <slot name=\"suffix\" slot=\"suffix\"></slot>\n\n      <template is=\"dom-if\" if=\"[[errorMessage]]\">\n        <paper-input-error aria-live=\"assertive\" slot=\"add-on\">[[errorMessage]]</paper-input-error>\n      </template>\n\n      <template is=\"dom-if\" if=\"[[charCounter]]\">\n        <paper-input-char-counter slot=\"add-on\"></paper-input-char-counter>\n      </template>\n\n    </paper-input-container>\n  `,\n\n  behaviors: [PaperInputBehavior, IronFormElementBehavior],\n\n  properties: {\n    value: {\n      // Required for the correct TypeScript type-generation\n      type: String\n    }\n  },\n\n  /**\n   * Returns a reference to the focusable element. Overridden from\n   * PaperInputBehavior to correctly focus the native input.\n   *\n   * @return {!HTMLElement}\n   */\n  get _focusableElement() {\n    return this.inputElement._inputElement;\n  },\n\n  // Note: This event is only available in the 1.0 version of this element.\n  // In 2.0, the functionality of `_onIronInputReady` is done in\n  // PaperInputBehavior::attached.\n  listeners: {'iron-input-ready': '_onIronInputReady'},\n\n  _onIronInputReady: function() {\n    // Even though this is only used in the next line, save this for\n    // backwards compatibility, since the native input had this ID until 2.0.5.\n    if (!this.$.nativeInput) {\n      this.$.nativeInput = this.$$('input');\n    }\n    if (this.inputElement &&\n        this._typesThatHaveText.indexOf(this.$.nativeInput.type) !== -1) {\n      this.alwaysFloatLabel = true;\n    }\n\n    // Only validate when attached if the input already has a value.\n    if (!!this.inputElement.bindValue) {\n      this.$.container._handleValueAndAutoValidate(this.inputElement);\n    }\n  },\n});\n","/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\n\nimport {Polymer} from '@polymer/polymer/lib/legacy/polymer-fn.js';\nimport {html} from '@polymer/polymer/lib/utils/html-tag.js';\n\n/**\n`iron-a11y-announcer` is a singleton element that is intended to add a11y\nto features that require on-demand announcement from screen readers. In\norder to make use of the announcer, it is best to request its availability\nin the announcing element.\n\nExample:\n\n    Polymer({\n\n      is: 'x-chatty',\n\n      attached: function() {\n        // This will create the singleton element if it has not\n        // been created yet:\n        Polymer.IronA11yAnnouncer.requestAvailability();\n      }\n    });\n\nAfter the `iron-a11y-announcer` has been made available, elements can\nmake announces by firing bubbling `iron-announce` events.\n\nExample:\n\n    this.fire('iron-announce', {\n      text: 'This is an announcement!'\n    }, { bubbles: true });\n\nNote: announcements are only audible if you have a screen reader enabled.\n\n@group Iron Elements\n@demo demo/index.html\n*/\nexport const IronA11yAnnouncer = Polymer({\n  _template: html`\n    <style>\n      :host {\n        display: inline-block;\n        position: fixed;\n        clip: rect(0px,0px,0px,0px);\n      }\n    </style>\n    <div aria-live$=\"[[mode]]\">[[_text]]</div>\n`,\n\n  is: 'iron-a11y-announcer',\n\n  properties: {\n\n    /**\n     * The value of mode is used to set the `aria-live` attribute\n     * for the element that will be announced. Valid values are: `off`,\n     * `polite` and `assertive`.\n     */\n    mode: {type: String, value: 'polite'},\n\n    _text: {type: String, value: ''}\n  },\n\n  created: function() {\n    if (!IronA11yAnnouncer.instance) {\n      IronA11yAnnouncer.instance = this;\n    }\n\n    document.body.addEventListener(\n        'iron-announce', this._onIronAnnounce.bind(this));\n  },\n\n  /**\n   * Cause a text string to be announced by screen readers.\n   *\n   * @param {string} text The text that should be announced.\n   */\n  announce: function(text) {\n    this._text = '';\n    this.async(function() {\n      this._text = text;\n    }, 100);\n  },\n\n  _onIronAnnounce: function(event) {\n    if (event.detail && event.detail.text) {\n      this.announce(event.detail.text);\n    }\n  }\n});\n\nIronA11yAnnouncer.instance = null;\n\nIronA11yAnnouncer.requestAvailability = function() {\n  if (!IronA11yAnnouncer.instance) {\n    IronA11yAnnouncer.instance = document.createElement('iron-a11y-announcer');\n  }\n\n  document.body.appendChild(IronA11yAnnouncer.instance);\n};\n"],"sourceRoot":""}