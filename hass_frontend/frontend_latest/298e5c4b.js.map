{"version":3,"file":"298e5c4b.js","mappings":";;;;AAaA;AAWA;;;;;AAXA;;ACuDA;AACA;AAEA;;AAEA;AACA;AACA;AACA;;;;;AAMA;AApCA;;AAEA;AACA;AAEA;;AAEA;AACA;AACA;AACA;;;;;AAMA;AAwBA;;AAMA;;AAIA;;;;AAKA;AACA;;;;;;;;;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;;AAKA;;;;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAKA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;;AAEA;AAEA;AACA;;;;AAnJA;;;;;;;;;AAAA","sources":["webpack://home-assistant-frontend/./src/components/ha-chip-set.ts","webpack://home-assistant-frontend/./src/components/ha-selector/ha-selector-select.ts"],"sourcesContent":["// @ts-ignore\nimport chipStyles from \"@material/chips/dist/mdc.chips.min.css\";\nimport {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  TemplateResult,\n  unsafeCSS,\n} from \"lit\";\nimport { customElement } from \"lit/decorators\";\n\n@customElement(\"ha-chip-set\")\nexport class HaChipSet extends LitElement {\n  protected render(): TemplateResult {\n    return html`\n      <div class=\"mdc-chip-set\">\n        <slot></slot>\n      </div>\n    `;\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      ${unsafeCSS(chipStyles)}\n\n      slot::slotted(ha-chip) {\n        margin: 4px 4px 4px 0;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-chip-set\": HaChipSet;\n  }\n}\n","import \"@material/mwc-list/mwc-list-item\";\nimport { mdiClose } from \"@mdi/js\";\nimport { css, html, LitElement } from \"lit\";\nimport { customElement, property, query } from \"lit/decorators\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { stopPropagation } from \"../../common/dom/stop_propagation\";\nimport type { SelectOption, SelectSelector } from \"../../data/selector\";\nimport type { HomeAssistant } from \"../../types\";\nimport \"../ha-checkbox\";\nimport \"../ha-chip\";\nimport \"../ha-chip-set\";\nimport \"../ha-combo-box\";\nimport type { HaComboBox } from \"../ha-combo-box\";\nimport \"../ha-formfield\";\nimport \"../ha-radio\";\nimport \"../ha-select\";\nimport \"../ha-input-helper-text\";\n\n@customElement(\"ha-selector-select\")\nexport class HaSelectSelector extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ attribute: false }) public selector!: SelectSelector;\n\n  @property() public value?: string | string[];\n\n  @property() public label?: string;\n\n  @property() public helper?: string;\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public required = true;\n\n  @query(\"ha-combo-box\", true) private comboBox!: HaComboBox;\n\n  private _filter = \"\";\n\n  protected render() {\n    const options =\n      this.selector.select?.options.map((option) =>\n        typeof option === \"object\" ? option : { value: option, label: option }\n      ) || [];\n\n    if (!this.selector.select?.custom_value && this._mode === \"list\") {\n      if (!this.selector.select?.multiple) {\n        return html`\n          <div>\n            ${this.label}\n            ${options.map(\n              (item: SelectOption) => html`\n                <ha-formfield .label=${item.label}>\n                  <ha-radio\n                    .checked=${item.value === this.value}\n                    .value=${item.value}\n                    .disabled=${item.disabled || this.disabled}\n                    @change=${this._valueChanged}\n                  ></ha-radio>\n                </ha-formfield>\n              `\n            )}\n          </div>\n          ${this._renderHelper()}\n        `;\n      }\n\n      return html`\n        <div>\n          ${this.label}\n          ${options.map(\n            (item: SelectOption) => html`\n              <ha-formfield .label=${item.label}>\n                <ha-checkbox\n                  .checked=${this.value?.includes(item.value)}\n                  .value=${item.value}\n                  .disabled=${item.disabled || this.disabled}\n                  @change=${this._checkboxChanged}\n                ></ha-checkbox>\n              </ha-formfield>\n            `\n          )}\n        </div>\n        ${this._renderHelper()}\n      `;\n    }\n\n    if (this.selector.select?.multiple) {\n      const value =\n        !this.value || this.value === \"\" ? [] : (this.value as string[]);\n\n      return html`\n        <ha-chip-set>\n          ${value?.map(\n            (item, idx) =>\n              html`\n                <ha-chip hasTrailingIcon>\n                  ${options.find((option) => option.value === item)?.label ||\n                  item}\n                  <ha-svg-icon\n                    slot=\"trailing-icon\"\n                    .path=${mdiClose}\n                    .idx=${idx}\n                    @click=${this._removeItem}\n                  ></ha-svg-icon>\n                </ha-chip>\n              `\n          )}\n        </ha-chip-set>\n\n        <ha-combo-box\n          item-value-path=\"value\"\n          item-label-path=\"label\"\n          .hass=${this.hass}\n          .label=${this.label}\n          .helper=${this.helper}\n          .disabled=${this.disabled}\n          .required=${this.required && !value.length}\n          .value=${this._filter}\n          .items=${options.filter(\n            (option) => !option.disabled && !value?.includes(option.value)\n          )}\n          @filter-changed=${this._filterChanged}\n          @value-changed=${this._comboBoxValueChanged}\n        ></ha-combo-box>\n      `;\n    }\n\n    if (this.selector.select?.custom_value) {\n      if (\n        this.value !== undefined &&\n        !options.find((option) => option.value === this.value)\n      ) {\n        options.unshift({ value: this.value, label: this.value });\n      }\n\n      return html`\n        <ha-combo-box\n          item-value-path=\"value\"\n          item-label-path=\"label\"\n          .hass=${this.hass}\n          .label=${this.label}\n          .helper=${this.helper}\n          .disabled=${this.disabled}\n          .required=${this.required}\n          .items=${options.filter((item) => !item.disabled)}\n          .value=${this.value}\n          @filter-changed=${this._filterChanged}\n          @value-changed=${this._comboBoxValueChanged}\n        ></ha-combo-box>\n      `;\n    }\n\n    return html`\n      <ha-select\n        fixedMenuPosition\n        naturalMenuWidth\n        .label=${this.label}\n        .value=${this.value}\n        .helper=${this.helper}\n        .disabled=${this.disabled}\n        @closed=${stopPropagation}\n        @selected=${this._valueChanged}\n      >\n        ${options.map(\n          (item: SelectOption) => html`\n            <mwc-list-item .value=${item.value} .disabled=${item.disabled}\n              >${item.label}</mwc-list-item\n            >\n          `\n        )}\n      </ha-select>\n    `;\n  }\n\n  private _renderHelper() {\n    return this.helper\n      ? html`<ha-input-helper-text>${this.helper}</ha-input-helper-text>`\n      : \"\";\n  }\n\n  private get _mode(): \"list\" | \"dropdown\" {\n    return (\n      this.selector.select?.mode ||\n      ((this.selector.select?.options?.length || 0) < 6 ? \"list\" : \"dropdown\")\n    );\n  }\n\n  private _valueChanged(ev) {\n    ev.stopPropagation();\n    const value = ev.detail?.value || ev.target.value;\n    if (this.disabled || !value) {\n      return;\n    }\n    fireEvent(this, \"value-changed\", {\n      value: value,\n    });\n  }\n\n  private _checkboxChanged(ev) {\n    ev.stopPropagation();\n    if (this.disabled) {\n      return;\n    }\n\n    let newValue: string[];\n    const value: string = ev.target.value;\n    const checked = ev.target.checked;\n\n    if (checked) {\n      if (!this.value) {\n        newValue = [value];\n      } else if (this.value.includes(value)) {\n        return;\n      } else {\n        newValue = [...this.value, value];\n      }\n    } else {\n      if (!this.value?.includes(value)) {\n        return;\n      }\n      newValue = (this.value as string[]).filter((v) => v !== value);\n    }\n\n    fireEvent(this, \"value-changed\", {\n      value: newValue,\n    });\n  }\n\n  private async _removeItem(ev) {\n    const value: string[] = [...(this.value! as string[])];\n    value.splice(ev.target.idx, 1);\n\n    fireEvent(this, \"value-changed\", {\n      value,\n    });\n    await this.updateComplete;\n    this._filterChanged();\n  }\n\n  private _comboBoxValueChanged(ev: CustomEvent): void {\n    ev.stopPropagation();\n    const newValue = ev.detail.value;\n\n    if (this.disabled || newValue === \"\") {\n      return;\n    }\n\n    if (!this.selector.select?.multiple) {\n      fireEvent(this, \"value-changed\", {\n        value: newValue,\n      });\n      return;\n    }\n\n    if (newValue !== undefined && this.value?.includes(newValue)) {\n      return;\n    }\n\n    setTimeout(() => {\n      this._filterChanged();\n      this.comboBox.setInputValue(\"\");\n    }, 0);\n\n    const currentValue =\n      !this.value || this.value === \"\" ? [] : (this.value as string[]);\n\n    fireEvent(this, \"value-changed\", {\n      value: [...currentValue, newValue],\n    });\n  }\n\n  private _filterChanged(ev?: CustomEvent): void {\n    this._filter = ev?.detail.value || \"\";\n\n    const filteredItems = this.comboBox.items?.filter((item) => {\n      if (this.selector.select?.multiple && this.value?.includes(item.value)) {\n        return false;\n      }\n      const label = item.label || item.value;\n      return label.toLowerCase().includes(this._filter?.toLowerCase());\n    });\n\n    if (this._filter && this.selector.select?.custom_value) {\n      filteredItems?.unshift({ label: this._filter, value: this._filter });\n    }\n\n    this.comboBox.filteredItems = filteredItems;\n  }\n\n  static styles = css`\n    ha-select,\n    mwc-formfield,\n    ha-formfield {\n      display: block;\n    }\n    mwc-list-item[disabled] {\n      --mdc-theme-text-primary-on-background: var(--disabled-text-color);\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-selector-select\": HaSelectSelector;\n  }\n}\n"],"names":[],"sourceRoot":""}