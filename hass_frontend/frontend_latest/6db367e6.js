"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[41614],{80508:(t,e,r)=>{r.d(e,{wQ:()=>ct,xi:()=>ht,at:()=>at});var n=r(74075),i=r(51686),s=r(91643),o=r(25070),l=r(97248);const a="()[]{}";function h(t,e,r){let n=t.prop(e<0?l.md.openedBy:l.md.closedBy);if(n)return n;if(1==t.name.length){let n=r.indexOf(t.name);if(n>-1&&n%2==(e<0?1:0))return[r[n+e]]}return null}function c(t,e,r,n={}){let i,s=n.maxScanDistance||1e4,l=n.brackets||a,c=(0,o.qz)(t),u=c.resolve(e,r);return(i=h(u.type,r,l))?function(t,e,r,n,i,s){let o=n.parent,l={from:n.from,to:n.to},a=0,c=null==o?void 0:o.cursor;if(c&&(r<0?c.childBefore(n.from):c.childAfter(n.to)))do{if(r<0?c.to<=n.from:c.from>=n.to){if(0==a&&i.indexOf(c.type.name)>-1)return{start:l,end:{from:c.from,to:c.to},matched:!0};if(h(c.type,r,s))a++;else if(h(c.type,-r,s)&&(a--,0==a))return{start:l,end:{from:c.from,to:c.to},matched:!1}}}while(r<0?c.prevSibling():c.nextSibling());return{start:l,matched:!1}}(0,0,r,u,i,l):function(t,e,r,n,i,s,o){let l=r<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),a=o.indexOf(l);if(a<0||a%2==0!=r>0)return null;let h={from:r<0?e-1:e,to:r>0?e+1:e},c=t.doc.iterRange(e,r>0?t.doc.length:0),u=0;for(let t=0;!c.next().done&&t<=s;){let s=c.value;r<0&&(t+=s.length);let l=e+t*r;for(let t=r>0?0:s.length-1,e=r>0?s.length:-1;t!=e;t+=r){let e=o.indexOf(s[t]);if(!(e<0||n.resolve(l+t,1).type!=i))if(e%2==0==r>0)u++;else{if(1==u)return{start:h,end:{from:l+t,to:l+t+1},matched:e>>1==a>>1};u--}}r>0&&(t+=s.length)}return c.done?{start:h,matched:!1}:null}(t,e,r,c,u.type,s,l)}function u(t,e){return n.jT.create(t.ranges.map(e),t.mainIndex)}function f(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function d({state:t,dispatch:e},r){let n=u(t.selection,r);return!n.eq(t.selection)&&(e(f(t,n)),!0)}function p(t,e){return n.jT.cursor(e?t.to:t.from)}function m(t,e){return d(t,(r=>r.empty?t.moveByChar(r,e):p(r,e)))}const g=t=>m(t,t.textDirection!=s.Nm.LTR),y=t=>m(t,t.textDirection==s.Nm.LTR);function b(t,e){return d(t,(r=>r.empty?t.moveByGroup(r,e):p(r,e)))}function x(t,e,r){if(e.type.prop(r))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}function v(t,e,r){let i,s,a=(0,o.qz)(t).resolveInner(e.head),h=r?l.md.closedBy:l.md.openedBy;for(let n=e.head;;){let e=r?a.childAfter(n):a.childBefore(n);if(!e)break;x(t,e,h)?a=e:n=r?e.to:e.from}return s=a.type.prop(h)&&(i=r?c(t,a.from,1):c(t,a.to,-1))&&i.matched?r?i.end.to:i.end.from:r?a.to:a.from,n.jT.cursor(s,r?-1:1)}function k(t,e){return d(t,(r=>{if(!r.empty)return p(r,e);let n=t.moveVertically(r,e);return n.head!=r.head?n:t.moveToLineBoundary(r,e)}))}const w=t=>k(t,!1),C=t=>k(t,!0);function A(t,e){return d(t,(r=>r.empty?t.moveVertically(r,e,t.dom.clientHeight):p(r,e)))}const S=t=>A(t,!1),M=t=>A(t,!0);function T(t,e,r){let i=t.visualLineAt(e.head),s=t.moveToLineBoundary(e,r);if(s.head==e.head&&s.head!=(r?i.to:i.from)&&(s=t.moveToLineBoundary(e,r,!1)),!r&&s.head==i.from&&i.length){let r=/^\s*/.exec(t.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;r&&e.head!=i.from+r&&(s=n.jT.cursor(i.from+r))}return s}const L=t=>d(t,(e=>T(t,e,!0))),P=t=>d(t,(e=>T(t,e,!1)));function N(t,e,r){let i=!1,s=u(t.selection,(e=>{let s=c(t,e.head,-1)||c(t,e.head,1)||e.head>0&&c(t,e.head-1,1)||e.head<t.doc.length&&c(t,e.head+1,-1);if(!s||!s.end)return e;i=!0;let o=s.start.from==e.head?s.end.to:s.end.from;return r?n.jT.range(e.anchor,o):n.jT.cursor(o)}));return!!i&&(e(f(t,s)),!0)}function D(t,e){let r=u(t.state.selection,(t=>{let r=e(t);return n.jT.range(t.anchor,r.head,r.goalColumn)}));return!r.eq(t.state.selection)&&(t.dispatch(f(t.state,r)),!0)}function B(t,e){return D(t,(r=>t.moveByChar(r,e)))}const O=t=>B(t,t.textDirection!=s.Nm.LTR),E=t=>B(t,t.textDirection==s.Nm.LTR);function R(t,e){return D(t,(r=>t.moveByGroup(r,e)))}function I(t,e){return D(t,(r=>t.moveVertically(r,e)))}const _=t=>I(t,!1),j=t=>I(t,!0);function q(t,e){return D(t,(r=>t.moveVertically(r,e,t.dom.clientHeight)))}const z=t=>q(t,!1),$=t=>q(t,!0),V=t=>D(t,(e=>T(t,e,!0))),W=t=>D(t,(e=>T(t,e,!1))),G=({state:t,dispatch:e})=>(e(f(t,{anchor:0})),!0),H=({state:t,dispatch:e})=>(e(f(t,{anchor:t.doc.length})),!0),U=({state:t,dispatch:e})=>(e(f(t,{anchor:t.selection.main.anchor,head:0})),!0),J=({state:t,dispatch:e})=>(e(f(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0);function Q({state:t,dispatch:e},r){if(t.readOnly)return!1;let i="delete.selection",s=t.changeByRange((t=>{let{from:e,to:s}=t;if(e==s){let t=r(e);t<e?i="delete.backward":t>e&&(i="delete.forward"),e=Math.min(e,t),s=Math.max(s,t)}return e==s?{range:t}:{changes:{from:e,to:s},range:n.jT.cursor(e)}}));return!s.changes.empty&&(e(t.update(s,{scrollIntoView:!0,userEvent:i})),!0)}function F(t,e,r){if(t instanceof s.tk)for(let n of t.pluginField(s.BF.atomicRanges))n.between(e,e,((t,n)=>{t<e&&n>e&&(e=r?n:t)}));return e}const K=(t,e)=>Q(t,(r=>{let n,s,{state:l}=t,a=l.doc.lineAt(r);if(!e&&r>a.from&&r<a.from+200&&!/[^ \t]/.test(n=a.text.slice(0,r-a.from))){if("\t"==n[n.length-1])return r-1;let t=(0,i.IS)(n,l.tabSize)%(0,o.y1)(l)||(0,o.y1)(l);for(let e=0;e<t&&" "==n[n.length-1-e];e++)r--;s=r}else s=(0,i.cp)(a.text,r-a.from,e)+a.from,s==r&&a.number!=(e?l.doc.lines:1)&&(s+=e?1:-1);return F(t,s,e)})),X=t=>K(t,!1),Y=t=>K(t,!0),Z=(t,e)=>Q(t,(r=>{let n=r,{state:s}=t,o=s.doc.lineAt(n),l=s.charCategorizer(n);for(let t=null;;){if(n==(e?o.to:o.from)){n==r&&o.number!=(e?s.doc.lines:1)&&(n+=e?1:-1);break}let a=(0,i.cp)(o.text,n-o.from,e)+o.from,h=o.text.slice(Math.min(n,a)-o.from,Math.max(n,a)-o.from),c=l(h);if(null!=t&&c!=t)break;" "==h&&n==r||(t=c),n=a}return F(t,n,e)})),tt=t=>Z(t,!1),et=t=>Q(t,(e=>{let r=t.visualLineAt(e).to;return F(t,e<r?r:Math.min(t.state.doc.length,e+1),!0)}));function rt(t){let e=[],r=-1;for(let n of t.selection.ranges){let i=t.doc.lineAt(n.from),s=t.doc.lineAt(n.to);if(n.empty||n.to!=s.from||(s=t.doc.lineAt(n.to-1)),r>=i.number){let t=e[e.length-1];t.to=s.to,t.ranges.push(n)}else e.push({from:i.from,to:s.to,ranges:[n]});r=s.number+1}return e}function nt(t,e,r){if(t.readOnly)return!1;let i=[],s=[];for(let e of rt(t)){if(r?e.to==t.doc.length:0==e.from)continue;let o=t.doc.lineAt(r?e.to+1:e.from-1),l=o.length+1;if(r){i.push({from:e.to,to:o.to},{from:e.from,insert:o.text+t.lineBreak});for(let r of e.ranges)s.push(n.jT.range(Math.min(t.doc.length,r.anchor+l),Math.min(t.doc.length,r.head+l)))}else{i.push({from:o.from,to:e.from},{from:e.to,insert:t.lineBreak+o.text});for(let t of e.ranges)s.push(n.jT.range(t.anchor-l,t.head-l))}}return!!i.length&&(e(t.update({changes:i,scrollIntoView:!0,selection:n.jT.create(s,t.selection.mainIndex),userEvent:"move.line"})),!0)}function it(t,e,r){if(t.readOnly)return!1;let n=[];for(let e of rt(t))r?n.push({from:e.from,insert:t.doc.slice(e.from,e.to)+t.lineBreak}):n.push({from:e.to,insert:t.lineBreak+t.doc.slice(e.from,e.to)});return e(t.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const st=ot(!1);function ot(t){return({state:e,dispatch:r})=>{if(e.readOnly)return!1;let s=e.changeByRange((r=>{let{from:s,to:a}=r,h=e.doc.lineAt(s),c=!t&&s==a&&function(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let r,n=(0,o.qz)(t).resolveInner(e),i=n.childBefore(e),s=n.childAfter(e);return i&&s&&i.to<=e&&s.from>=e&&(r=i.type.prop(l.md.closedBy))&&r.indexOf(s.name)>-1&&t.doc.lineAt(i.to).from==t.doc.lineAt(s.from).from?{from:i.to,to:s.from}:null}(e,s);t&&(s=a=(a<=h.to?h:e.doc.lineAt(a)).to);let u=new o.Gn(e,{simulateBreak:s,simulateDoubleBreak:!!c}),f=(0,o.K0)(u,s);for(null==f&&(f=/^\s*/.exec(e.doc.lineAt(s).text)[0].length);a<h.to&&/\s/.test(h.text[a-h.from]);)a++;c?({from:s,to:a}=c):s>h.from&&s<h.from+100&&!/\S/.test(h.text.slice(0,s))&&(s=h.from);let d=["",(0,o.SS)(e,f)];return c&&d.push((0,o.SS)(e,u.lineIndent(h.from,-1))),{changes:{from:s,to:a,insert:i.xv.of(d)},range:n.jT.cursor(s+1+d[1].length)}}));return r(e.update(s,{scrollIntoView:!0,userEvent:"input"})),!0}}function lt(t,e){let r=-1;return t.changeByRange((i=>{let s=[];for(let n=i.from;n<=i.to;){let o=t.doc.lineAt(n);o.number>r&&(i.empty||i.to>o.from)&&(e(o,s,i),r=o.number),n=o.to+1}let o=t.changes(s);return{changes:s,range:n.jT.range(o.mapPos(i.anchor,1),o.mapPos(i.head,1))}}))}const at=({state:t,dispatch:e})=>!t.readOnly&&(e(t.update(lt(t,((e,r)=>{r.push({from:e.from,insert:t.facet(o.c)})})),{userEvent:"input.indent"})),!0),ht=({state:t,dispatch:e})=>!t.readOnly&&(e(t.update(lt(t,((e,r)=>{let n=/^\s*/.exec(e.text)[0];if(!n)return;let s=(0,i.IS)(n,t.tabSize),l=0,a=(0,o.SS)(t,Math.max(0,s-(0,o.y1)(t)));for(;l<n.length&&l<a.length&&n.charCodeAt(l)==a.charCodeAt(l);)l++;r.push({from:e.from+l,to:e.from+n.length,insert:a.slice(l)})})),{userEvent:"delete.dedent"})),!0),ct=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:t=>d(t,(e=>v(t.state,e,t.textDirection!=s.Nm.LTR))),shift:t=>D(t,(e=>v(t.state,e,t.textDirection!=s.Nm.LTR)))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:t=>d(t,(e=>v(t.state,e,t.textDirection==s.Nm.LTR))),shift:t=>D(t,(e=>v(t.state,e,t.textDirection==s.Nm.LTR)))},{key:"Alt-ArrowUp",run:({state:t,dispatch:e})=>nt(t,e,!1)},{key:"Shift-Alt-ArrowUp",run:({state:t,dispatch:e})=>it(t,e,!1)},{key:"Alt-ArrowDown",run:({state:t,dispatch:e})=>nt(t,e,!0)},{key:"Shift-Alt-ArrowDown",run:({state:t,dispatch:e})=>it(t,e,!0)},{key:"Escape",run:({state:t,dispatch:e})=>{let r=t.selection,i=null;return r.ranges.length>1?i=n.jT.create([r.main]):r.main.empty||(i=n.jT.create([n.jT.cursor(r.main.head)])),!!i&&(e(f(t,i)),!0)}},{key:"Mod-Enter",run:ot(!0)},{key:"Alt-l",mac:"Ctrl-l",run:({state:t,dispatch:e})=>{let r=rt(t).map((({from:e,to:r})=>n.jT.range(e,Math.min(r+1,t.doc.length))));return e(t.update({selection:n.jT.create(r),userEvent:"select"})),!0}},{key:"Mod-i",run:({state:t,dispatch:e})=>{let r=u(t.selection,(e=>{var r;let i=(0,o.qz)(t).resolveInner(e.head,1);for(;!(i.from<e.from&&i.to>=e.to||i.to>e.to&&i.from<=e.from)&&(null===(r=i.parent)||void 0===r?void 0:r.parent);)i=i.parent;return n.jT.range(i.to,i.from)}));return e(f(t,r)),!0},preventDefault:!0},{key:"Mod-[",run:ht},{key:"Mod-]",run:at},{key:"Mod-Alt-\\",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=Object.create(null),n=new o.Gn(t,{overrideIndentation:t=>{let e=r[t];return null==e?-1:e}}),i=lt(t,((e,i,s)=>{let l=(0,o.K0)(n,e.from);if(null==l)return;/\S/.test(e.text)||(l=0);let a=/^\s*/.exec(e.text)[0],h=(0,o.SS)(t,l);(a!=h||s.from<e.from+a.length)&&(r[e.from]=l,i.push({from:e.from,to:e.from+a.length,insert:h}))}));return i.changes.empty||e(t.update(i,{userEvent:"indent"})),!0}},{key:"Shift-Mod-k",run:t=>{if(t.state.readOnly)return!1;let{state:e}=t,r=e.changes(rt(e).map((({from:t,to:r})=>(t>0?t--:r<e.doc.length&&r++,{from:t,to:r})))),n=u(e.selection,(e=>t.moveVertically(e,!0))).map(r);return t.dispatch({changes:r,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0}},{key:"Shift-Mod-\\",run:({state:t,dispatch:e})=>N(t,e,!1)}].concat([{key:"ArrowLeft",run:g,shift:O,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:t=>b(t,t.textDirection!=s.Nm.LTR),shift:t=>R(t,t.textDirection!=s.Nm.LTR)},{mac:"Cmd-ArrowLeft",run:P,shift:W},{key:"ArrowRight",run:y,shift:E,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:t=>b(t,t.textDirection==s.Nm.LTR),shift:t=>R(t,t.textDirection==s.Nm.LTR)},{mac:"Cmd-ArrowRight",run:L,shift:V},{key:"ArrowUp",run:w,shift:_,preventDefault:!0},{mac:"Cmd-ArrowUp",run:G,shift:U},{mac:"Ctrl-ArrowUp",run:S,shift:z},{key:"ArrowDown",run:C,shift:j,preventDefault:!0},{mac:"Cmd-ArrowDown",run:H,shift:J},{mac:"Ctrl-ArrowDown",run:M,shift:$},{key:"PageUp",run:S,shift:z},{key:"PageDown",run:M,shift:$},{key:"Home",run:P,shift:W},{key:"Mod-Home",run:G,shift:U},{key:"End",run:L,shift:V},{key:"Mod-End",run:H,shift:J},{key:"Enter",run:st},{key:"Mod-a",run:({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0)},{key:"Backspace",run:X,shift:X},{key:"Delete",run:Y,shift:Y},{key:"Mod-Backspace",mac:"Alt-Backspace",run:tt},{key:"Mod-Delete",mac:"Alt-Delete",run:t=>Z(t,!0)},{mac:"Mod-Backspace",run:t=>Q(t,(e=>{let r=t.visualLineAt(e).from;return F(t,e>r?r:Math.max(0,e-1),!1)}))},{mac:"Mod-Delete",run:et}].concat([{key:"Ctrl-b",run:g,shift:O,preventDefault:!0},{key:"Ctrl-f",run:y,shift:E},{key:"Ctrl-p",run:w,shift:_},{key:"Ctrl-n",run:C,shift:j},{key:"Ctrl-a",run:t=>d(t,(e=>n.jT.cursor(t.visualLineAt(e.head).from,1))),shift:t=>D(t,(e=>n.jT.cursor(t.visualLineAt(e.head).from)))},{key:"Ctrl-e",run:t=>d(t,(e=>n.jT.cursor(t.visualLineAt(e.head).to,-1))),shift:t=>D(t,(e=>n.jT.cursor(t.visualLineAt(e.head).to)))},{key:"Ctrl-d",run:Y},{key:"Ctrl-h",run:X},{key:"Ctrl-k",run:et},{key:"Ctrl-Alt-h",run:tt},{key:"Ctrl-o",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=t.changeByRange((t=>({changes:{from:t.from,to:t.to,insert:i.xv.of(["",""])},range:n.jT.cursor(t.from)})));return e(t.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=t.changeByRange((e=>{if(!e.empty||0==e.from||e.from==t.doc.length)return{range:e};let r=e.from,s=t.doc.lineAt(r),o=r==s.from?r-1:(0,i.cp)(s.text,r-s.from,!1)+s.from,l=r==s.to?r+1:(0,i.cp)(s.text,r-s.from,!0)+s.from;return{changes:{from:o,to:l,insert:t.doc.slice(r,l).append(t.doc.slice(o,r))},range:n.jT.cursor(l)}}));return!r.changes.empty&&(e(t.update(r,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Alt-<",run:G},{key:"Alt->",run:H},{key:"Ctrl-v",run:M},{key:"Alt-v",run:S}].map((t=>({mac:t.key,run:t.run,shift:t.shift})))))},55987:(t,e,r)=>{r.d(e,{Eu:()=>C});var n=r(91643),i=r(67037),s=r(74075);class o extends i.uU{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}}o.prototype.elementClass="",o.prototype.toDOM=void 0,o.prototype.mapMode=s.gc.TrackBefore,o.prototype.startSide=o.prototype.endSide=-1,o.prototype.point=!0;const l=s.r$.define(),a=s.r$.define();const h=n.tk.baseTheme({".cm-gutters":{display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#999",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"}}),c=s.r$.define({combine:t=>t.some((t=>t))});function u(t){let e=[f,h];return t&&!1===t.fixed&&e.push(c.of(!0)),e}const f=n.lg.fromClass(class{constructor(t){this.view=t,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.gutters=t.state.facet(a).map((e=>new g(t,e)));for(let t of this.gutters)this.dom.appendChild(t.dom);this.fixed=!t.state.facet(c),this.fixed&&(this.dom.style.position="sticky"),t.scrollDOM.insertBefore(this.dom,t.contentDOM),this.syncGutters()}update(t){this.updateGutters(t)&&this.syncGutters(),t.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(c)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"")}syncGutters(){let t=i.Xs.iter(this.view.state.facet(l),this.view.viewport.from),e=[],r=this.gutters.map((t=>new m(t,this.view.viewport)));this.view.viewportLines((i=>{let s;if(Array.isArray(i.type)){for(let t of i.type)if(t.type==n.kH.Text){s=t;break}}else s=i.type==n.kH.Text?i:void 0;if(s){e.length&&(e=[]),p(t,e,i.from);for(let t of r)t.line(this.view,s,e)}}),0);for(let t of r)t.finish()}updateGutters(t){let e=t.startState.facet(a),r=t.state.facet(a),n=t.docChanged||t.heightChanged||t.viewportChanged||!i.Xs.eq(t.startState.facet(l),t.state.facet(l),t.view.viewport.from,t.view.viewport.to);if(e==r)for(let e of this.gutters)e.update(t)&&(n=!0);else{n=!0;let i=[];for(let n of r){let r=e.indexOf(n);r<0?i.push(new g(this.view,n)):(this.gutters[r].update(t),i.push(this.gutters[r]))}for(let t of this.gutters)t.dom.remove();for(let t of i)this.dom.appendChild(t.dom);this.gutters=i}return n}destroy(){this.dom.remove()}},{provide:n.BF.scrollMargins.from((t=>0!=t.gutters.length&&t.fixed?t.view.textDirection==n.Nm.LTR?{left:t.dom.offsetWidth}:{right:t.dom.offsetWidth}:null))});function d(t){return Array.isArray(t)?t:[t]}function p(t,e,r){for(;t.value&&t.from<=r;)t.from==r&&e.push(t.value),t.next()}class m{constructor(t,e){this.gutter=t,this.localMarkers=[],this.i=0,this.height=0,this.cursor=i.Xs.iter(t.markers,e.from)}line(t,e,r){this.localMarkers.length&&(this.localMarkers=[]),p(this.cursor,this.localMarkers,e.from);let n=r.length?this.localMarkers.concat(r):this.localMarkers,i=this.gutter.config.lineMarker(t,e,n);i&&n.unshift(i);let s=this.gutter;if(0==n.length&&!s.config.renderEmptyElements)return;let o=e.top-this.height;if(this.i==s.elements.length){let r=new y(t,e.height,o,n);s.elements.push(r),s.dom.appendChild(r.dom)}else{let r=s.elements[this.i];(function(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].compare(e[r]))return!1;return!0})(n,r.markers)&&(n=r.markers),r.update(t,e.height,o,n)}this.height=e.bottom,this.i++}finish(){let t=this.gutter;for(;t.elements.length>this.i;)t.dom.removeChild(t.elements.pop().dom)}}class g{constructor(t,e){this.view=t,this.config=e,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let r in e.domEventHandlers)this.dom.addEventListener(r,(n=>{let i=t.visualLineAtHeight(n.clientY,t.contentDOM.getBoundingClientRect().top);e.domEventHandlers[r](t,i,n)&&n.preventDefault()}));this.markers=d(e.markers(t)),e.initialSpacer&&(this.spacer=new y(t,0,0,[e.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(t){let e=this.markers;if(this.markers=d(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let e=this.config.updateSpacer(this.spacer.markers[0],t);e!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[e])}let r=t.view.viewport;return!i.Xs.eq(this.markers,e,r.from,r.to)}}class y{constructor(t,e,r,n){this.height=-1,this.above=0,this.dom=document.createElement("div"),this.update(t,e,r,n)}update(t,e,r,n){if(this.height!=e&&(this.dom.style.height=(this.height=e)+"px"),this.above!=r&&(this.dom.style.marginTop=(this.above=r)?r+"px":""),this.markers!=n){this.markers=n;for(let t;t=this.dom.lastChild;)t.remove();let e="cm-gutterElement";for(let r of n){r.toDOM&&this.dom.appendChild(r.toDOM(t));let n=r.elementClass;n&&(e+=" "+n)}this.dom.className=e}}}const b=s.r$.define(),x=s.r$.define({combine:t=>(0,s.BO)(t,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(t,e){let r=Object.assign({},t);for(let t in e){let n=r[t],i=e[t];r[t]=n?(t,e,r)=>n(t,e,r)||i(t,e,r):i}return r}})});class v extends o{constructor(t){super(),this.number=t}eq(t){return this.number==t.number}toDOM(t){return document.createTextNode(this.number)}}function k(t,e){return t.state.facet(x).formatNumber(e,t.state)}const w=a.compute([x],(t=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers:t=>t.state.facet(b),lineMarker:(t,e,r)=>r.some((t=>t.toDOM))?null:new v(k(t,t.state.doc.lineAt(e.from).number)),initialSpacer:t=>new v(k(t,A(t.state.doc.lines))),updateSpacer(t,e){let r=k(e.view,A(e.view.state.doc.lines));return r==t.number?t:new v(r)},domEventHandlers:t.facet(x).domEventHandlers})));function C(t={}){return[x.of(t),u(),w]}function A(t){let e=9;for(;e<t;)e=10*e+9;return e}},42484:(t,e,r)=>{r.d(e,{Qf:()=>v,Gv:()=>p,pJ:()=>V});var n=r(97248),i=r(28450),s=r(91643),o=r(74075),l=r(25070),a=r(67037);let h=0;class c{constructor(t,e,r){this.set=t,this.base=e,this.modified=r,this.id=h++}static define(t){if(null==t?void 0:t.base)throw new Error("Can not derive from a modified tag");let e=new c([],null,[]);if(e.set.push(e),t)for(let r of t.set)e.set.push(r);return e}static defineModifier(){let t=new f;return e=>e.modified.indexOf(t)>-1?e:f.get(e.base||e,e.modified.concat(t).sort(((t,e)=>t.id-e.id)))}}let u=0;class f{constructor(){this.instances=[],this.id=u++}static get(t,e){if(!e.length)return t;let r=e[0].instances.find((r=>{return r.base==t&&(n=e,i=r.modified,n.length==i.length&&n.every(((t,e)=>t==i[e])));var n,i}));if(r)return r;let n=[],i=new c(n,t,e);for(let t of e)t.instances.push(i);let s=d(e);for(let e of t.set)for(let t of s)n.push(f.get(e,t));return i}}function d(t){let e=[t];for(let r=0;r<t.length;r++)for(let n of d(t.slice(0,r).concat(t.slice(r+1))))e.push(n);return e}function p(t){let e=Object.create(null);for(let r in t){let n=t[r];Array.isArray(n)||(n=[n]);for(let t of r.split(" "))if(t){let r=[],i=2,s=t;for(let e=0;;){if("..."==s&&e>0&&e+3==t.length){i=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(s);if(!n)throw new RangeError("Invalid path: "+t);if(r.push("*"==n[0]?null:'"'==n[0][0]?JSON.parse(n[0]):n[0]),e+=n[0].length,e==t.length)break;let o=t[e++];if(e==t.length&&"!"==o){i=0;break}if("/"!=o)throw new RangeError("Invalid path: "+t);s=t.slice(e)}let o=r.length-1,l=r[o];if(!l)throw new RangeError("Invalid path: "+t);let a=new x(n,i,o>0?r.slice(0,o):null);e[l]=a.sort(e[l])}}return m.add(e)}const m=new n.md,g=o.r$.define({combine:t=>t.length?v.combinedMatch(t):null}),y=o.r$.define({combine:t=>t.length?t[0].match:null});function b(t){return t.facet(g)||t.facet(y)}class x{constructor(t,e,r,n){this.tags=t,this.mode=e,this.context=r,this.next=n}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}class v{constructor(t,e){let r;function n(t){let e=i.V.newName();return(r||(r=Object.create(null)))["."+e]=t,e}this.map=Object.create(null),this.all="string"==typeof e.all?e.all:e.all?n(e.all):null;for(let e of t){let t=(e.class||n(Object.assign({},e,{tag:null})))+(this.all?" "+this.all:""),r=e.tag;if(Array.isArray(r))for(let e of r)this.map[e.id]=t;else this.map[r.id]=t}this.module=r?new i.V(r):null,this.scope=e.scope||null,this.match=this.match.bind(this);let o=[w];this.module&&o.push(s.tk.styleModule.of(this.module)),this.extension=o.concat(g.of(this)),this.fallback=o.concat(y.of(this))}match(t,e){if(this.scope&&e!=this.scope)return null;for(let e of t.set){let r=this.map[e.id];if(void 0!==r)return e!=t&&(this.map[t.id]=r),r}return this.map[t.id]=this.all}static combinedMatch(t){if(1==t.length)return t[0].match;let e=t.some((t=>t.scope))?void 0:Object.create(null);return(r,n)=>{let i=e&&e[r.id];if(void 0!==i)return i;let s=null;for(let e of t){let t=e.match(r,n);t&&(s=s?s+" "+t:t)}return e&&(e[r.id]=s),s}}static define(t,e){return new v(t,e||{})}static get(t,e,r){let i=b(t);return i&&i(e,r||n.Jq.none)}}class k{constructor(t){this.markCache=Object.create(null),this.tree=(0,l.qz)(t.state),this.decorations=this.buildDeco(t,b(t.state))}update(t){let e=(0,l.qz)(t.state),r=b(t.state),n=r!=t.startState.facet(g);e.length<t.view.viewport.to&&!n&&e.type==this.tree.type?this.decorations=this.decorations.map(t.changes):(e!=this.tree||t.viewportChanged||n)&&(this.tree=e,this.decorations=this.buildDeco(t.view,r))}buildDeco(t,e){if(!e||!this.tree.length)return s.p.none;let r=new a.f_;for(let{from:n,to:i}of t.visibleRanges)S(this.tree,n,i,e,((t,e,n)=>{r.add(t,e,this.markCache[n]||(this.markCache[n]=s.p.mark({class:n})))}));return r.finish()}}const w=o.Wl.extend(s.lg.fromClass(k,{decorations:t=>t.decorations})),C=[""];class A{constructor(t,e,r){this.at=t,this.style=e,this.span=r,this.class=""}startSpan(t,e){e!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=e)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,e,r,i,s,o){let{type:l,from:a,to:h}=t;if(a>=r||h<=e)return;C[s]=l.name,l.isTop&&(o=l);let c=i,u=l.prop(m),f=!1;for(;u;){if(!u.context||M(u.context,C,s)){for(let t of u.tags){let e=this.style(t,o);e&&(c&&(c+=" "),c+=e,1==u.mode?i+=(i?" ":"")+e:0==u.mode&&(f=!0))}break}u=u.next}if(this.startSpan(t.from,c),f)return;let d=t.tree&&t.tree.prop(n.md.mounted);if(d&&d.overlay){let n=t.node.enter(d.overlay[0].from+a,1),l=t.firstChild();for(let u=0,f=a;;u++){let p=u<d.overlay.length?d.overlay[u]:null,m=p?p.from+a:h,g=Math.max(e,f),y=Math.min(r,m);if(g<y&&l)for(;t.from<y&&(this.highlightRange(t,g,y,i,s+1,o),this.startSpan(Math.min(r,t.to),c),!(t.to>=m)&&t.nextSibling()););if(!p||m>r)break;f=p.to+a,f>e&&(this.highlightRange(n.cursor,Math.max(e,p.from+a),Math.min(r,f),i,s,d.tree.type),this.startSpan(f,c))}l&&t.parent()}else if(t.firstChild()){do{if(!(t.to<=e)){if(t.from>=r)break;this.highlightRange(t,e,r,i,s+1,o),this.startSpan(Math.min(r,t.to),c)}}while(t.nextSibling());t.parent()}}}function S(t,e,r,n,i){let s=new A(e,n,i);s.highlightRange(t.cursor(),e,r,"",0,t.type),s.flush(r)}function M(t,e,r){if(t.length>r-1)return!1;for(let n=r-1,i=t.length-1;i>=0;i--,n--){let r=t[i];if(r&&r!=e[n])return!1}return!0}const T=c.define,L=T(),P=T(),N=T(P),D=T(P),B=T(),O=T(B),E=T(B),R=T(),I=T(R),_=T(),j=T(),q=T(),z=T(q),$=T(),V={comment:L,lineComment:T(L),blockComment:T(L),docComment:T(L),name:P,variableName:T(P),typeName:N,tagName:T(N),propertyName:D,attributeName:T(D),className:T(P),labelName:T(P),namespace:T(P),macroName:T(P),literal:B,string:O,docString:T(O),character:T(O),attributeValue:T(O),number:E,integer:T(E),float:T(E),bool:T(B),regexp:T(B),escape:T(B),color:T(B),url:T(B),keyword:_,self:T(_),null:T(_),atom:T(_),unit:T(_),modifier:T(_),operatorKeyword:T(_),controlKeyword:T(_),definitionKeyword:T(_),operator:j,derefOperator:T(j),arithmeticOperator:T(j),logicOperator:T(j),bitwiseOperator:T(j),compareOperator:T(j),updateOperator:T(j),definitionOperator:T(j),typeOperator:T(j),controlOperator:T(j),punctuation:q,separator:T(q),bracket:z,angleBracket:T(z),squareBracket:T(z),paren:T(z),brace:T(z),content:R,heading:I,heading1:T(I),heading2:T(I),heading3:T(I),heading4:T(I),heading5:T(I),heading6:T(I),contentSeparator:T(R),list:T(R),quote:T(R),emphasis:T(R),strong:T(R),link:T(R),monospace:T(R),strikethrough:T(R),inserted:T(),deleted:T(),changed:T(),invalid:T(),meta:$,documentMeta:T($),annotation:T($),processingInstruction:T($),definition:c.defineModifier(),constant:c.defineModifier(),function:c.defineModifier(),standard:c.defineModifier(),local:c.defineModifier(),special:c.defineModifier()};V.link,V.heading,V.emphasis,V.strong,V.strikethrough,V.keyword,V.atom,V.bool,V.url,V.contentSeparator,V.labelName,V.literal,V.inserted,V.string,V.deleted,V.regexp,V.escape,V.string,V.variableName,V.variableName,V.typeName,V.namespace,V.className,V.variableName,V.macroName,V.propertyName,V.comment,V.meta,V.invalid,V.link,V.heading,V.emphasis,V.strong,V.keyword,V.atom,V.bool,V.url,V.labelName,V.inserted,V.deleted,V.literal,V.string,V.number,V.regexp,V.escape,V.string,V.variableName,V.variableName,V.variableName,V.variableName,V.typeName,V.namespace,V.macroName,V.propertyName,V.operator,V.comment,V.meta,V.invalid,V.punctuation},25070:(t,e,r)=>{r.d(e,{Gn:()=>M,SQ:()=>h,Be:()=>p,kU:()=>a,y1:()=>C,K0:()=>S,tK:()=>k,SS:()=>A,c:()=>w,mi:()=>l,qz:()=>u});var n=r(97248),i=r(74075),s=r(91643),o=r(51686);const l=new n.md;function a(t){return i.r$.define({combine:t?e=>e.concat(t):void 0})}class h{constructor(t,e,r,n=[]){this.data=t,this.topNode=r,i.yy.prototype.hasOwnProperty("tree")||Object.defineProperty(i.yy.prototype,"tree",{get(){return u(this)}}),this.parser=e,this.extension=[v.of(this),i.yy.languageData.of(((t,e,r)=>t.facet(c(t,e,r))))].concat(n)}isActiveAt(t,e,r=-1){return c(t,e,r)==this.data}findRegions(t){let e=t.facet(v);if((null==e?void 0:e.data)==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let r=[],i=(t,e)=>{if(t.prop(l)==this.data)return void r.push({from:e,to:e+t.length});let s=t.prop(n.md.mounted);if(s){if(s.tree.prop(l)==this.data){if(s.overlay)for(let t of s.overlay)r.push({from:t.from+e,to:t.to+e});else r.push({from:e,to:e+t.length});return}if(s.overlay){let t=r.length;if(i(s.tree,s.overlay[0].from+e),r.length>t)return}}for(let r=0;r<t.children.length;r++){let s=t.children[r];s instanceof n.mp&&i(s,t.positions[r]+e)}};return i(u(t),0),r}get allowsNesting(){return!0}}function c(t,e,r){let n=t.facet(v);if(!n)return null;let i=n.data;if(n.allowsNesting)for(let n=u(t).topNode;n;n=n.enter(e,r,!0,!1))i=n.type.prop(l)||i;return i}h.setState=i.Py.define();function u(t){let e=t.field(h.state,!1);return e?e.tree:n.mp.empty}class f{constructor(t,e=t.length){this.doc=t,this.length=e,this.cursorPos=0,this.string="",this.cursor=t.iter()}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let r=this.cursorPos-this.string.length;return t<r||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-r,e-r)}}let d=null;class p{constructor(t,e,r=[],n,i,s,o,l){this.parser=t,this.state=e,this.fragments=r,this.tree=n,this.treeLen=i,this.viewport=s,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}startParse(){return this.parser.startParse(new f(this.state.doc),this.fragments)}work(t,e){return null!=e&&e>=this.state.doc.length&&(e=void 0),this.tree!=n.mp.empty&&(null==e?this.treeLen==this.state.doc.length:this.treeLen>=e)?(this.takeTree(),!0):this.withContext((()=>{var r;this.parse||(this.parse=this.startParse()),null!=e&&(null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);let i=Date.now()+t;for(;;){let t=this.parse.advance();if(t){if(this.fragments=this.withoutTempSkipped(n.i9.addTree(t,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(r=this.parse.stoppedAt)&&void 0!==r?r:this.state.doc.length,this.tree=t,this.parse=null,!(this.treeLen<(null!=e?e:this.state.doc.length)))return!0;this.parse=this.startParse()}if(Date.now()>i)return!1}}))}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext((()=>{for(;!(e=this.parse.advance()););})),this.tree=e,this.fragments=this.withoutTempSkipped(n.i9.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=d;d=this;try{return t()}finally{d=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=m(t,e.from,e.to);return t}changes(t,e){let{fragments:r,tree:i,treeLen:s,viewport:o,skipped:l}=this;if(this.takeTree(),!t.empty){let e=[];if(t.iterChangedRanges(((t,r,n,i)=>e.push({fromA:t,toA:r,fromB:n,toB:i}))),r=n.i9.applyChanges(r,e),i=n.mp.empty,s=0,o={from:t.mapPos(o.from,-1),to:t.mapPos(o.to,1)},this.skipped.length){l=[];for(let e of this.skipped){let r=t.mapPos(e.from,1),n=t.mapPos(e.to,-1);r<n&&l.push({from:r,to:n})}}}return new p(this.parser,e,r,i,s,o,l,this.scheduleOn)}updateViewport(t){this.viewport=t;let e=this.skipped.length;for(let e=0;e<this.skipped.length;e++){let{from:r,to:n}=this.skipped[e];r<t.to&&n>t.from&&(this.fragments=m(this.fragments,r,n),this.skipped.splice(e--,1))}return this.skipped.length<e}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends n._b{createParse(e,r,i){let s=i[0].from,o=i[i.length-1].to;return{parsedPos:s,advance(){let e=d;if(e){for(let t of i)e.tempSkipped.push(t);t&&(e.scheduleOn=e.scheduleOn?Promise.all([e.scheduleOn,t]):t)}return this.parsedPos=o,new n.mp(n.Jq.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}movedPast(t){return this.treeLen<t&&this.parse&&this.parse.parsedPos>=t}static get(){return d}}function m(t,e,r){return n.i9.applyChanges(t,[{fromA:e,toA:r,fromB:e,toB:r}])}class g{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged)return this;let e=this.context.changes(t.changes,t.state),r=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(25,r)||e.takeTree(),new g(e)}static init(t){let e=new p(t.facet(v).parser,t,[],n.mp.empty,0,{from:0,to:t.doc.length},[],null);return e.work(25)||e.takeTree(),new g(e)}}h.state=i.QQ.define({create:g.init,update(t,e){for(let t of e.effects)if(t.is(h.setState))return t.value;return e.startState.facet(v)!=e.state.facet(v)?g.init(e.state):t.apply(e)}});let y="undefined"!=typeof window&&window.requestIdleCallback||((t,{timeout:e})=>setTimeout(t,e)),b="undefined"!=typeof window&&window.cancelIdleCallback||clearTimeout;const x=s.lg.fromClass(class{constructor(t){this.view=t,this.working=-1,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(h.state).context;t.viewportChanged&&(e.updateViewport(t.view.viewport)&&e.reset(),this.view.viewport.to>e.treeLen&&this.scheduleWork()),t.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working>-1)return;let{state:t}=this.view,e=t.field(h.state),r=e.context.fragments;e.tree==e.context.tree&&e.context.treeLen>=t.doc.length&&r.length&&0==r[0].from&&r[0].to>=t.doc.length||(this.working=y(this.work,{timeout:500}))}work(t){this.working=-1;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:r,viewport:{to:n}}=this.view,i=r.field(h.state);if(i.tree==i.context.tree&&i.context.treeLen>=n+1e6)return;let s=Math.min(this.chunkBudget,t?Math.max(25,t.timeRemaining()):100),o=i.context.work(s,n+1e6);this.chunkBudget-=Date.now()-e,(o||this.chunkBudget<=0||i.context.movedPast(n))&&(i.context.takeTree(),this.view.dispatch({effects:h.setState.of(new g(i.context))})),!o&&this.chunkBudget>0&&this.scheduleWork(),this.checkAsyncSchedule(i.context)}checkAsyncSchedule(t){t.scheduleOn&&(t.scheduleOn.then((()=>this.scheduleWork())),t.scheduleOn=null)}destroy(){this.working>=0&&b(this.working)}},{eventHandlers:{focus(){this.scheduleWork()}}}),v=i.r$.define({combine:t=>t.length?t[0]:null,enables:[h.state,x]});const k=i.r$.define(),w=i.r$.define({combine:t=>{if(!t.length)return"  ";if(!/^(?: +|\t+)$/.test(t[0]))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return t[0]}});function C(t){let e=t.facet(w);return 9==e.charCodeAt(0)?t.tabSize*e.length:e.length}function A(t,e){let r="",n=t.tabSize;if(9==t.facet(w).charCodeAt(0))for(;e>=n;)r+="\t",e-=n;for(let t=0;t<e;t++)r+=" ";return r}function S(t,e){t instanceof i.yy&&(t=new M(t));for(let r of t.state.facet(k)){let n=r(t,e);if(null!=n)return n}let r=u(t.state);return r?function(t,e,r){let n=e.resolveInner(r);for(let t=n,e=r;;){let r=t.childBefore(e);if(!r)break;r.type.isError&&r.from==r.to?(n=t,e=r.from):(t=r,e=t.to+1)}return P(n,r,t)}(t,r,e):null}class M{constructor(t,e={}){this.state=t,this.options=e,this.unit=C(t)}lineAt(t,e=1){let r=this.state.doc.lineAt(t),{simulateBreak:n}=this.options;return null!=n&&n>=r.from&&n<=r.to?(e<0?n<t:n<=t)?{text:r.text.slice(n-r.from),from:n}:{text:r.text.slice(0,n-r.from),from:r.from}:r}textAfterPos(t,e=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:r,from:n}=this.lineAt(t,e);return r.slice(t-n,Math.min(r.length,t+100-n))}column(t,e=1){let{text:r,from:n}=this.lineAt(t,e),i=this.countColumn(r,t-n),s=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return s>-1&&(i+=s-this.countColumn(r,r.search(/\S|$/))),i}countColumn(t,e=t.length){return(0,o.IS)(t,this.state.tabSize,e)}lineIndent(t,e=1){let{text:r,from:n}=this.lineAt(t,e),i=this.options.overrideIndentation;if(i){let t=i(n);if(t>-1)return t}return this.countColumn(r,r.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const T=new n.md;function L(t){let e=t.type.prop(T);if(e)return e;let r,i=t.firstChild;if(i&&(r=i.type.prop(n.md.closedBy))){let e=t.lastChild,n=e&&r.indexOf(e.name)>-1;return t=>O(t,!0,1,void 0,n&&!function(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}(t)?e.from:void 0)}return null==t.parent?N:null}function P(t,e,r){for(;t;t=t.parent){let n=L(t);if(n)return n(new D(r,e,t))}return null}function N(){return 0}class D extends M{constructor(t,e,r){super(t.state,t.options),this.base=t,this.pos=e,this.node=r}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let t=this.state.doc.lineAt(this.node.from);for(;;){let e=this.node.resolve(t.from);for(;e.parent&&e.parent.from==e.from;)e=e.parent;if(B(e,this.node))break;t=this.state.doc.lineAt(e.from)}return this.lineIndent(t.from)}continue(){let t=this.node.parent;return t?P(t,this.pos,this.base):0}}function B(t,e){for(let r=e;r;r=r.parent)if(t==r)return!0;return!1}function O(t,e,r,n,i){let s=t.textAfter,o=s.match(/^\s*/)[0].length,l=n&&s.slice(o,o+n.length)==n||i==t.pos+o,a=e?function(t){let e=t.node,r=e.childAfter(e.from),n=e.lastChild;if(!r)return null;let i=t.options.simulateBreak,s=t.state.doc.lineAt(r.from),o=null==i||i<=s.from?s.to:Math.min(s.to,i);for(let t=r.to;;){let i=e.childAfter(t);if(!i||i==n)return null;if(!i.type.isSkipped)return i.from<o?r:null;t=i.to}}(t):null;return a?l?t.column(a.from):t.column(a.to):t.baseIndent+(l?0:t.unit*r)}},17429:(t,e,r)=>{r.d(e,{b:()=>h});var n=["and","as","block","endblock","by","cycle","debug","else","elif","extends","filter","endfilter","firstof","for","endfor","if","endif","ifchanged","endifchanged","ifequal","endifequal","ifnotequal","endifnotequal","in","include","load","not","now","or","parsed","regroup","reversed","spaceless","endspaceless","ssi","templatetag","openblock","closeblock","openvariable","closevariable","openbrace","closebrace","opencomment","closecomment","widthratio","url","with","endwith","get_current_language","trans","endtrans","noop","blocktrans","endblocktrans","get_available_languages","get_current_language_bidi","plural"],i=/^[+\-*&%=<>!?|~^]/,s=/^[:\[\(\{]/,o=["true","false"],l=/^(\d[+\-\*\/])?\d+(\.\d+)?/;function a(t,e){var r=t.peek();if(e.incomment)return t.skipTo("#}")?(t.eatWhile(/\#|}/),e.incomment=!1):t.skipToEnd(),"comment";if(e.intag){if(e.operator){if(e.operator=!1,t.match(o))return"atom";if(t.match(l))return"number"}if(e.sign){if(e.sign=!1,t.match(o))return"atom";if(t.match(l))return"number"}if(e.instring)return r==e.instring&&(e.instring=!1),t.next(),"string";if("'"==r||'"'==r)return e.instring=r,t.next(),"string";if(t.match(e.intag+"}")||t.eat("-")&&t.match(e.intag+"}"))return e.intag=!1,"tag";if(t.match(i))return e.operator=!0,"operator";if(t.match(s))e.sign=!0;else if(t.eat(" ")||t.sol()){if(t.match(n))return"keyword";if(t.match(o))return"atom";if(t.match(l))return"number";t.sol()&&t.next()}else t.next();return"variable"}if(t.eat("{")){if(t.eat("#"))return e.incomment=!0,t.skipTo("#}")?(t.eatWhile(/\#|}/),e.incomment=!1):t.skipToEnd(),"comment";if(r=t.eat(/\{|%/))return e.intag=r,"{"==r&&(e.intag="}"),t.eat("-"),"tag"}t.next()}n=new RegExp("(("+n.join(")|(")+"))\\b"),o=new RegExp("(("+o.join(")|(")+"))\\b");const h={startState:function(){return{tokenize:a}},token:function(t,e){return e.tokenize(t,e)},languageData:{commentTokens:{block:{open:"{#",close:"#}"}}}}},76697:(t,e,r)=>{r.d(e,{r:()=>i});var n=new RegExp("\\b(("+["true","false","on","off","yes","no"].join(")|(")+"))$","i");const i={token:function(t,e){var r=t.peek(),i=e.escaped;if(e.escaped=!1,"#"==r&&(0==t.pos||/\s/.test(t.string.charAt(t.pos-1))))return t.skipToEnd(),"comment";if(t.match(/^('([^']|\\.)*'?|"([^"]|\\.)*"?)/))return"string";if(e.literal&&t.indentation()>e.keyCol)return t.skipToEnd(),"string";if(e.literal&&(e.literal=!1),t.sol()){if(e.keyCol=0,e.pair=!1,e.pairStart=!1,t.match("---"))return"def";if(t.match("..."))return"def";if(t.match(/^\s*-\s+/))return"meta"}if(t.match(/^(\{|\}|\[|\])/))return"{"==r?e.inlinePairs++:"}"==r?e.inlinePairs--:"["==r?e.inlineList++:e.inlineList--,"meta";if(e.inlineList>0&&!i&&","==r)return t.next(),"meta";if(e.inlinePairs>0&&!i&&","==r)return e.keyCol=0,e.pair=!1,e.pairStart=!1,t.next(),"meta";if(e.pairStart){if(t.match(/^\s*(\||\>)\s*/))return e.literal=!0,"meta";if(t.match(/^\s*(\&|\*)[a-z0-9\._-]+\b/i))return"variable";if(0==e.inlinePairs&&t.match(/^\s*-?[0-9\.\,]+\s?$/))return"number";if(e.inlinePairs>0&&t.match(/^\s*-?[0-9\.\,]+\s?(?=(,|}))/))return"number";if(t.match(n))return"keyword"}return!e.pair&&t.match(/^\s*(?:[,\[\]{}&*!|>'"%@`][^\s'":]|[^,\[\]{}#&*!|>'"%@`])[^#]*?(?=\s*:($|\s))/)?(e.pair=!0,e.keyCol=t.indentation(),"atom"):e.pair&&t.match(/^:\s*/)?(e.pairStart=!0,"meta"):(e.pairStart=!1,e.escaped="\\"==r,t.next(),null)},startState:function(){return{pair:!1,pairStart:!1,keyCol:0,inlinePairs:0,inlineList:0,literal:!1,escaped:!1}},languageData:{commentTokens:{line:"#"}}}},42454:(t,e,r)=>{r.d(e,{Z:()=>h});var n=r(74075),i=r(91643),s=r(51686);const o=2e3;function l(t,e){let r=t.posAtCoords({x:e.clientX,y:e.clientY},!1),n=t.state.doc.lineAt(r),i=r-n.from,l=i>o?-1:i==n.length?function(t,e){let r=t.coordsAtPos(t.viewport.from);return r?Math.round(Math.abs((r.left-e)/t.defaultCharacterWidth)):-1}(t,e.clientX):(0,s.IS)(n.text,t.state.tabSize,r-n.from);return{line:n.number,col:l,off:i}}function a(t,e){let r=l(t,e),i=t.state.selection;return r?{update(t){if(t.docChanged){let e=t.changes.mapPos(t.startState.doc.line(r.line).from),n=t.state.doc.lineAt(e);r={line:n.number,col:r.col,off:Math.min(r.off,n.length)},i=i.map(t.changes)}},get(e,a,h){let c=l(t,e);if(!c)return i;let u=function(t,e,r){let i=Math.min(e.line,r.line),l=Math.max(e.line,r.line),a=[];if(e.off>o||r.off>o||e.col<0||r.col<0){let s=Math.min(e.off,r.off),o=Math.max(e.off,r.off);for(let e=i;e<=l;e++){let r=t.doc.line(e);r.length<=o&&a.push(n.jT.range(r.from+s,r.to+o))}}else{let o=Math.min(e.col,r.col),h=Math.max(e.col,r.col);for(let e=i;e<=l;e++){let r=t.doc.line(e),i=(0,s.Gz)(r.text,o,t.tabSize,!0);if(i>-1){let e=(0,s.Gz)(r.text,h,t.tabSize);a.push(n.jT.range(r.from+i,r.from+e))}}}return a}(t.state,r,c);return u.length?h?n.jT.create(u.concat(i.ranges)):n.jT.create(u):i}}:null}function h(t){let e=(null==t?void 0:t.eventFilter)||(t=>t.altKey&&0==t.button);return i.tk.mouseSelectionStyle.of(((t,r)=>e(r)?a(t,r):null))}},86315:(t,e,r)=>{r.d(e,{sW:()=>N,Lp:()=>rt});var n=r(91643),i=r(74075);const s=i.r$.define({combine(t){let e,r;for(let n of t)e=e||n.topContainer,r=r||n.bottomContainer;return{topContainer:e,bottomContainer:r}}});function o(t,e){let r=t.plugin(l),n=r?r.specs.indexOf(e):-1;return n>-1?r.panels[n]:null}const l=n.lg.fromClass(class{constructor(t){this.input=t.state.facet(u),this.specs=this.input.filter((t=>t)),this.panels=this.specs.map((e=>e(t)));let e=t.state.facet(s);this.top=new a(t,!0,e.topContainer),this.bottom=new a(t,!1,e.bottomContainer),this.top.sync(this.panels.filter((t=>t.top))),this.bottom.sync(this.panels.filter((t=>!t.top)));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(t){let e=t.state.facet(s);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new a(t.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new a(t.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let r=t.state.facet(u);if(r!=this.input){let e=r.filter((t=>t)),n=[],i=[],s=[],o=[];for(let r of e){let e,l=this.specs.indexOf(r);l<0?(e=r(t.view),o.push(e)):(e=this.panels[l],e.update&&e.update(t)),n.push(e),(e.top?i:s).push(e)}this.specs=e,this.panels=n,this.top.sync(i),this.bottom.sync(s);for(let t of o)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}else for(let e of this.panels)e.update&&e.update(t)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n.BF.scrollMargins.from((t=>({top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()})))});class a{constructor(t,e,r){this.view=t,this.top=e,this.container=r,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(t){this.panels=t,this.syncDOM()}syncDOM(){if(0==this.panels.length)return void(this.dom&&(this.dom.remove(),this.dom=void 0));if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let t=this.dom.firstChild;for(let e of this.panels)if(e.dom.parentNode==this.dom){for(;t!=e.dom;)t=h(t);t=t.nextSibling}else this.dom.insertBefore(e.dom,t);for(;t;)t=h(t)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(this.container&&this.classes!=this.view.themeClasses){for(let t of this.classes.split(" "))t&&this.container.classList.remove(t);for(let t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function h(t){let e=t.nextSibling;return t.remove(),e}const c=n.tk.baseTheme({".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"}}),u=i.r$.define({enables:[l,c]});var f=r(67037);function d(){var t=arguments[0];"string"==typeof t&&(t=document.createElement(t));var e=1,r=arguments[1];if(r&&"object"==typeof r&&null==r.nodeType&&!Array.isArray(r)){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var i=r[n];"string"==typeof i?t.setAttribute(n,i):null!=i&&(t[n]=i)}e++}for(;e<arguments.length;e++)p(t,arguments[e]);return t}function p(t,e){if("string"==typeof e)t.appendChild(document.createTextNode(e));else if(null==e);else if(null!=e.nodeType)t.appendChild(e);else{if(!Array.isArray(e))throw new RangeError("Unsupported child node: "+e);for(var r=0;r<e.length;r++)p(t,e[r])}}var m=r(51686);const g="function"==typeof String.prototype.normalize?t=>t.normalize("NFKD"):t=>t;class y{constructor(t,e,r=0,n=t.length,i){this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=t.iterRange(r,n),this.bufferStart=r,this.normalize=i?t=>i(g(t)):g,this.query=this.normalize(e)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return(0,m.gm)(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let t=this.peek();if(t<0)return this.done=!0,this;let e=(0,m.bg)(t),r=this.bufferStart+this.bufferPos;this.bufferPos+=(0,m.nZ)(t);let n=this.normalize(e);for(let t=0,i=r;;t++){let s=n.charCodeAt(t),o=this.match(s,i);if(o)return this.value=o,this;if(t==n.length-1)break;i==r&&t<e.length&&e.charCodeAt(t)==s&&i++}}}match(t,e){let r=null;for(let n=0;n<this.matches.length;n+=2){let i=this.matches[n],s=!1;this.query.charCodeAt(i)==t&&(i==this.query.length-1?r={from:this.matches[n+1],to:e+1}:(this.matches[n]++,s=!0)),s||(this.matches.splice(n,2),n-=2)}return this.query.charCodeAt(0)==t&&(1==this.query.length?r={from:e,to:e+1}:this.matches.push(1,e)),r}}const b={from:-1,to:-1,match:/.*/.exec("")},x="gm"+(null==/x/.unicode?"":"u");class v{constructor(t,e,r,n=0,i=t.length){if(this.to=i,this.curLine="",this.done=!1,this.value=b,/\\[sWDnr]|\n|\r|\[\^/.test(e))return new C(t,e,r,n,i);this.re=new RegExp(e,x+((null==r?void 0:r.ignoreCase)?"i":"")),this.iter=t.iter();let s=t.lineAt(n);this.curLineStart=s.from,this.matchPos=n,this.getLine(this.curLineStart)}getLine(t){this.iter.next(t),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let t=this.matchPos-this.curLineStart;;){this.re.lastIndex=t;let e=this.matchPos<=this.to&&this.re.exec(this.curLine);if(e){let r=this.curLineStart+e.index,n=r+e[0].length;if(this.matchPos=n+(r==n?1:0),r==this.curLine.length&&this.nextLine(),r<n||r>this.value.to)return this.value={from:r,to:n,match:e},this;t=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),t=0}}}}const k=new WeakMap;class w{constructor(t,e){this.from=t,this.text=e}get to(){return this.from+this.text.length}static get(t,e,r){let n=k.get(t);if(!n||n.from>=r||n.to<=e){let n=new w(e,t.sliceString(e,r));return k.set(t,n),n}if(n.from==e&&n.to==r)return n;let{text:i,from:s}=n;return s>e&&(i=t.sliceString(e,s)+i,s=e),n.to<r&&(i+=t.sliceString(n.to,r)),k.set(t,new w(s,i)),new w(e,i.slice(e-s,r-s))}}class C{constructor(t,e,r,n,i){this.text=t,this.to=i,this.done=!1,this.value=b,this.matchPos=n,this.re=new RegExp(e,x+((null==r?void 0:r.ignoreCase)?"i":"")),this.flat=w.get(t,n,this.chunkEnd(n+5e3))}chunkEnd(t){return t>=this.to?this.to:this.text.lineAt(t).to}next(){for(;;){let t=this.re.lastIndex=this.matchPos-this.flat.from,e=this.re.exec(this.flat.text);if(e&&!e[0]&&e.index==t&&(this.re.lastIndex=t+1,e=this.re.exec(this.flat.text)),e&&this.flat.to<this.to&&e.index+e[0].length>this.flat.text.length-10&&(e=null),e){let t=this.flat.from+e.index,r=t+e[0].length;return this.value={from:t,to:r,match:e},this.matchPos=r+(t==r?1:0),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=w.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}}function A(t){let e=d("input",{class:"cm-textfield",name:"line"});function r(){let r=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(e.value);if(!r)return;let{state:n}=t,s=n.doc.lineAt(n.selection.main.head),[,o,l,a,h]=r,c=a?+a.slice(1):0,u=l?+l:s.number;if(l&&h){let t=u/100;o&&(t=t*("-"==o?-1:1)+s.number/n.doc.lines),u=Math.round(n.doc.lines*t)}else l&&o&&(u=u*("-"==o?-1:1)+s.number);let f=n.doc.line(Math.max(1,Math.min(n.doc.lines,u)));t.dispatch({effects:S.of(!1),selection:i.jT.cursor(f.from+Math.max(0,Math.min(c,f.length))),scrollIntoView:!0}),t.focus()}return{dom:d("form",{class:"cm-gotoLine",onkeydown:e=>{27==e.keyCode?(e.preventDefault(),t.dispatch({effects:S.of(!1)}),t.focus()):13==e.keyCode&&(e.preventDefault(),r())},onsubmit:t=>{t.preventDefault(),r()}},d("label",t.state.phrase("Go to line"),": ",e)," ",d("button",{class:"cm-button",type:"submit"},t.state.phrase("go"))),pos:-10}}const S=i.Py.define(),M=i.QQ.define({create:()=>!0,update(t,e){for(let r of e.effects)r.is(S)&&(t=r.value);return t},provide:t=>u.from(t,(t=>t?A:null))}),T=n.tk.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),L={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100},P=i.r$.define({combine:t=>(0,i.BO)(t,L,{highlightWordAroundCursor:(t,e)=>t||e,minSelectionLength:Math.min,maxMatches:Math.min})});function N(t){let e=[E,O];return t&&e.push(P.of(t)),e}const D=n.p.mark({class:"cm-selectionMatch"}),B=n.p.mark({class:"cm-selectionMatch cm-selectionMatch-main"}),O=n.lg.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.selectionSet||t.docChanged||t.viewportChanged)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=t.state.facet(P),{state:r}=t,s=r.selection;if(s.ranges.length>1)return n.p.none;let o,l=s.main,a=null;if(l.empty){if(!e.highlightWordAroundCursor)return n.p.none;let t=r.wordAt(l.head);if(!t)return n.p.none;a=r.charCategorizer(l.head),o=r.sliceDoc(t.from,t.to)}else{let t=l.to-l.from;if(t<e.minSelectionLength||t>200)return n.p.none;if(o=r.sliceDoc(l.from,l.to).trim(),!o)return n.p.none}let h=[];for(let s of t.visibleRanges){let t=new y(r.doc,o,s.from,s.to);for(;!t.next().done;){let{from:s,to:o}=t.value;if((!a||(0==s||a(r.sliceDoc(s-1,s))!=i.D0.Word)&&(o==r.doc.length||a(r.sliceDoc(o,o+1))!=i.D0.Word))&&(a&&s<=l.from&&o>=l.to?h.push(B.range(s,o)):(s>=l.to||o<=l.from)&&h.push(D.range(s,o)),h.length>e.maxMatches))return n.p.none}}return n.p.set(h)}},{decorations:t=>t.decorations}),E=n.tk.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}});const R=i.r$.define({combine(t){let e=t.some((t=>t.matchCase));return{top:t.some((t=>t.top)),matchCase:void 0===e||e}}});class I{constructor(t,e,r){this.search=t,this.replace=e,this.caseInsensitive=r}eq(t){return this.search==t.search&&this.replace==t.replace&&this.caseInsensitive==t.caseInsensitive&&this.constructor==t.constructor}}class _ extends I{constructor(t,e,r){super(t,e,r),this.unquoted=t.replace(/\\([nrt\\])/g,((t,e)=>"n"==e?"\n":"r"==e?"\r":"t"==e?"\t":"\\"))}cursor(t,e=0,r=t.length){return new y(t,this.unquoted,e,r,this.caseInsensitive?t=>t.toLowerCase():void 0)}nextMatch(t,e,r){let n=this.cursor(t,r).nextOverlapping();return n.done&&(n=this.cursor(t,0,e).nextOverlapping()),n.done?null:n.value}prevMatchInRange(t,e,r){for(let n=r;;){let r=Math.max(e,n-1e4-this.unquoted.length),i=this.cursor(t,r,n),s=null;for(;!i.nextOverlapping().done;)s=i.value;if(s)return s;if(r==e)return null;n-=1e4}}prevMatch(t,e,r){return this.prevMatchInRange(t,0,e)||this.prevMatchInRange(t,r,t.length)}getReplacement(t){return this.replace}matchAll(t,e){let r=this.cursor(t),n=[];for(;!r.next().done;){if(n.length>=e)return null;n.push(r.value)}return n}highlight(t,e,r,n){let i=this.cursor(t,Math.max(0,e-this.unquoted.length),Math.min(r+this.unquoted.length,t.length));for(;!i.next().done;)n(i.value.from,i.value.to)}get valid(){return!!this.search}}class j extends I{constructor(t,e,r){super(t,e,r),this.valid=!!t&&function(t){try{return new RegExp(t,x),!0}catch(t){return!1}}(t)}cursor(t,e=0,r=t.length){return new v(t,this.search,this.caseInsensitive?{ignoreCase:!0}:void 0,e,r)}nextMatch(t,e,r){let n=this.cursor(t,r).next();return n.done&&(n=this.cursor(t,0,e).next()),n.done?null:n.value}prevMatchInRange(t,e,r){for(let n=1;;n++){let i=Math.max(e,r-1e4*n),s=this.cursor(t,i,r),o=null;for(;!s.next().done;)o=s.value;if(o&&(i==e||o.from>i+10))return o;if(i==e)return null}}prevMatch(t,e,r){return this.prevMatchInRange(t,0,e)||this.prevMatchInRange(t,r,t.length)}getReplacement(t){return this.replace.replace(/\$([$&\d+])/g,((e,r)=>"$"==r?"$":"&"==r?t.match[0]:"0"!=r&&+r<t.match.length?t.match[r]:e))}matchAll(t,e){let r=this.cursor(t),n=[];for(;!r.next().done;){if(n.length>=e)return null;n.push(r.value)}return n}highlight(t,e,r,n){let i=this.cursor(t,Math.max(0,e-250),Math.min(r+250,t.length));for(;!i.next().done;)n(i.value.from,i.value.to)}}const q=i.Py.define(),z=i.Py.define(),$=i.QQ.define({create:t=>new V(Z(t),Y),update(t,e){for(let r of e.effects)r.is(q)?t=new V(r.value,t.panel):r.is(z)&&(t=new V(t.query,r.value?Y:null));return t},provide:t=>u.from(t,(t=>t.panel))});class V{constructor(t,e){this.query=t,this.panel=e}}const W=n.p.mark({class:"cm-searchMatch"}),G=n.p.mark({class:"cm-searchMatch cm-searchMatch-selected"}),H=n.lg.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field($))}update(t){let e=t.state.field($);(e!=t.startState.field($)||t.docChanged||t.selectionSet)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.valid)return n.p.none;let{view:r}=this,i=new f.f_;for(let e=0,n=r.visibleRanges,s=n.length;e<s;e++){let{from:o,to:l}=n[e];for(;e<s-1&&l>n[e+1].from-500;)l=n[++e].to;t.highlight(r.state.doc,o,l,((t,e)=>{let n=r.state.selection.ranges.some((r=>r.from==t&&r.to==e));i.add(t,e,n?G:W)}))}return i.finish()}},{decorations:t=>t.decorations});function U(t){return e=>{let r=e.state.field($,!1);return r&&r.query.valid?t(e,r):tt(e)}}const J=U(((t,{query:e})=>{let{from:r,to:n}=t.state.selection.main,i=e.nextMatch(t.state.doc,r,n);return!(!i||i.from==r&&i.to==n)&&(t.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:st(t,i)}),!0)})),Q=U(((t,{query:e})=>{let{state:r}=t,{from:n,to:i}=r.selection.main,s=e.prevMatch(r.doc,n,i);return!!s&&(t.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0,effects:st(t,s)}),!0)})),F=U(((t,{query:e})=>{let r=e.matchAll(t.state.doc,1e3);return!(!r||!r.length)&&(t.dispatch({selection:i.jT.create(r.map((t=>i.jT.range(t.from,t.to))))}),!0)})),K=U(((t,{query:e})=>{let{state:r}=t,{from:n,to:i}=r.selection.main;if(r.readOnly)return!1;let s=e.nextMatch(r.doc,n,n);if(!s)return!1;let o,l,a=[];if(s.from==n&&s.to==i&&(l=r.toText(e.getReplacement(s)),a.push({from:s.from,to:s.to,insert:l}),s=e.nextMatch(r.doc,s.from,s.to)),s){let t=0==a.length||a[0].from>=s.to?0:s.to-s.from-l.length;o={anchor:s.from-t,head:s.to-t}}return t.dispatch({changes:a,selection:o,scrollIntoView:!!o,effects:s?st(t,s):void 0}),!0})),X=U(((t,{query:e})=>{if(t.state.readOnly)return!1;let r=e.matchAll(t.state.doc,1e9).map((t=>{let{from:r,to:n}=t;return{from:r,to:n,insert:e.getReplacement(t)}}));return!!r.length&&(t.dispatch({changes:r}),!0)}));function Y(t){let{query:e}=t.state.field($);return{dom:nt({view:t,query:e,updateQuery(r){e.eq(r)||(e=r,t.dispatch({effects:q.of(e)}))}}),mount(){this.dom.querySelector("[name=search]").select()},pos:80,top:t.state.facet(R).top}}function Z(t,e){var r;let n=t.selection.main,i=n.empty||n.to>n.from+100?"":t.sliceDoc(n.from,n.to),s=null!==(r=null==e?void 0:e.caseInsensitive)&&void 0!==r?r:!t.facet(R).matchCase;return e&&!i?e:new _(i.replace(/\n/g,"\\n"),"",s)}const tt=t=>{let e=t.state.field($,!1);if(e&&e.panel){let e=o(t,Y);if(!e)return!1;let r=e.dom.querySelector("[name=search]");r.focus(),r.select()}else t.dispatch({effects:[z.of(!0),e?q.of(Z(t.state,e.query)):i.Py.appendConfig.of(lt)]});return!0},et=t=>{let e=t.state.field($,!1);if(!e||!e.panel)return!1;let r=o(t,Y);return r&&r.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:z.of(!1)}),!0},rt=[{key:"Mod-f",run:tt,scope:"editor search-panel"},{key:"F3",run:J,shift:Q,scope:"editor search-panel"},{key:"Mod-g",run:J,shift:Q,scope:"editor search-panel"},{key:"Escape",run:et,scope:"editor search-panel"},{key:"Mod-Shift-l",run:({state:t,dispatch:e})=>{let r=t.selection;if(r.ranges.length>1||r.main.empty)return!1;let{from:n,to:s}=r.main,o=[],l=0;for(let e=new y(t.doc,t.sliceDoc(n,s));!e.next().done;){if(o.length>1e3)return!1;e.value.from==n&&(l=o.length),o.push(i.jT.range(e.value.from,e.value.to))}return e(t.update({selection:i.jT.create(o,l)})),!0}},{key:"Alt-g",run:t=>{let e=o(t,A);if(!e){let r=[S.of(!0)];null==t.state.field(M,!1)&&r.push(i.Py.appendConfig.of([M,T])),t.dispatch({effects:r}),e=o(t,A)}return e&&e.dom.querySelector("input").focus(),!0}},{key:"Mod-d",run:({state:t,dispatch:e})=>{let{ranges:r}=t.selection;if(r.some((t=>t.from===t.to)))return(({state:t,dispatch:e})=>{let{selection:r}=t,n=i.jT.create(r.ranges.map((e=>t.wordAt(e.head)||i.jT.cursor(e.head))),r.mainIndex);return!n.eq(r)&&(e(t.update({selection:n})),!0)})({state:t,dispatch:e});let n=t.sliceDoc(r[0].from,r[0].to);if(t.selection.ranges.some((e=>t.sliceDoc(e.from,e.to)!=n)))return!1;let s=function(t,e){let{main:r,ranges:n}=t.selection,i=t.wordAt(r.head),s=i&&i.from==r.from&&i.to==r.to;for(let r=!1,i=new y(t.doc,e,n[n.length-1].to);;){if(i.next(),!i.done){if(r&&n.some((t=>t.from==i.value.from)))continue;if(s){let e=t.wordAt(i.value.from);if(!e||e.from!=i.value.from||e.to!=i.value.to)continue}return i.value}if(r)return null;i=new y(t.doc,e,0,Math.max(0,n[n.length-1].from-1)),r=!0}}(t,n);return!!s&&(e(t.update({selection:t.selection.addRange(i.jT.range(s.from,s.to),!1),scrollIntoView:!0})),!0)},preventDefault:!0}];function nt(t){function e(e){return t.view.state.phrase(e)}let r=d("input",{value:t.query.search,placeholder:e("Find"),"aria-label":e("Find"),class:"cm-textfield",name:"search",onchange:l,onkeyup:l}),i=d("input",{value:t.query.replace,placeholder:e("Replace"),"aria-label":e("Replace"),class:"cm-textfield",name:"replace",onchange:l,onkeyup:l}),s=d("input",{type:"checkbox",name:"case",checked:!t.query.caseInsensitive,onchange:l}),o=d("input",{type:"checkbox",name:"re",checked:t.query instanceof j,onchange:l});function l(){t.updateQuery(new(o.checked?j:_)(r.value,i.value,!s.checked))}function a(t,e,r){return d("button",{class:"cm-button",name:t,onclick:e,type:"button"},r)}return d("div",{onkeydown:function(e){(0,n.$1)(t.view,e,"search-panel")?e.preventDefault():13==e.keyCode&&e.target==r?(e.preventDefault(),(e.shiftKey?Q:J)(t.view)):13==e.keyCode&&e.target==i&&(e.preventDefault(),K(t.view))},class:"cm-search"},[r,a("next",(()=>J(t.view)),[e("next")]),a("prev",(()=>Q(t.view)),[e("previous")]),a("select",(()=>F(t.view)),[e("all")]),d("label",null,[s,e("match case")]),d("label",null,[o,e("regexp")]),d("br"),i,a("replace",(()=>K(t.view)),[e("replace")]),a("replaceAll",(()=>X(t.view)),[e("replace all")]),d("button",{name:"close",onclick:()=>et(t.view),"aria-label":e("close"),type:"button"},[""])])}const it=/[\s\.,:;?!]/;function st(t,{from:e,to:r}){let i=t.state.doc.lineAt(e).from,s=t.state.doc.lineAt(r).to,o=Math.max(i,e-30),l=Math.min(s,r+30),a=t.state.sliceDoc(o,l);if(o!=i)for(let t=0;t<30;t++)if(!it.test(a[t+1])&&it.test(a[t])){a=a.slice(t);break}if(l!=s)for(let t=a.length-1;t>a.length-30;t--)if(!it.test(a[t-1])&&it.test(a[t])){a=a.slice(0,t);break}return n.tk.announce.of(`${t.state.phrase("current match")}. ${a} ${t.state.phrase("on line")} ${t.state.doc.lineAt(e).number}`)}const ot=n.tk.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),lt=[$,i.Wl.fallback(H),ot]},67545:(t,e,r)=>{r.d(e,{i:()=>h});var n=r(97248),i=r(42484),s=r(25070);function o(t,e,r,n=0,i=0){null==e&&-1==(e=t.search(/[^\s\u00a0]/))&&(e=t.length);let s=i;for(let i=n;i<e;i++)9==t.charCodeAt(i)?s+=r-s%r:s++;return s}class l{constructor(t,e,r){this.string=t,this.tabSize=e,this.indentUnit=r,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return 0==this.pos}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(t){let e,r=this.string.charAt(this.pos);if(e="string"==typeof t?r==t:r&&(t instanceof RegExp?t.test(r):t(r)),e)return++this.pos,r}eatWhile(t){let e=this.pos;for(;this.eat(t););return this.pos>e}eatSpace(){let t=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t}skipToEnd(){this.pos=this.string.length}skipTo(t){let e=this.string.indexOf(t,this.pos);if(e>-1)return this.pos=e,!0}backUp(t){this.pos-=t}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=o(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){return o(this.string,null,this.tabSize)}match(t,e,r){if("string"==typeof t){let n=t=>r?t.toLowerCase():t;return n(this.string.substr(this.pos,t.length))==n(t)?(!1!==e&&(this.pos+=t.length),!0):null}{let r=this.string.slice(this.pos).match(t);return r&&r.index>0?null:(r&&!1!==e&&(this.pos+=r[0].length),r)}}current(){return this.string.slice(this.start,this.pos)}}function a(t){if("object"!=typeof t)return t;let e={};for(let r in t){let n=t[r];e[r]=n instanceof Array?n.slice():n}return e}class h extends s.SQ{constructor(t){let e,r=(0,s.kU)(t.languageData),i={token:(o=t).token,blankLine:o.blankLine||(()=>{}),startState:o.startState||(()=>!0),copyState:o.copyState||a,indent:o.indent||(()=>null),languageData:o.languageData||{}};var o;super(r,new class extends n._b{createParse(t,r,n){return new f(e,t,r,n)}},function(t){let e=n.Jq.define({id:m.length,name:"Document",props:[s.mi.add((()=>t))]});return m.push(e),e}(r),[s.tK.of(((t,e)=>this.getIndent(t,e)))]),e=this,this.streamParser=i,this.stateAfter=new n.md({perNode:!0})}static define(t){return new h(t)}getIndent(t,e){let r=(0,s.qz)(t.state),n=r.resolve(e);for(;n&&n.type!=this.topNode;)n=n.parent;if(!n)return null;let i,o,a=c(this,r,0,n.from,e);if(a?(o=a.state,i=a.pos+1):(o=this.streamParser.startState(t.unit),i=0),e-i>1e4)return null;for(;i<e;){let r=t.state.doc.lineAt(i),n=Math.min(e,r.to);if(r.length){let e=new l(r.text,t.state.tabSize,t.unit);for(;e.pos<n-r.from;)d(this.streamParser.token,e,o)}else this.streamParser.blankLine(o,t.unit);if(n==e)break;i=r.to+1}let{text:h}=t.state.doc.lineAt(e);return this.streamParser.indent(o,/^\s*(.*)/.exec(h)[1],t)}get allowsNesting(){return!1}}function c(t,e,r,i,s){let o=r>=i&&r+e.length<=s&&e.prop(t.stateAfter);if(o)return{state:t.streamParser.copyState(o),pos:r+e.length};for(let o=e.children.length-1;o>=0;o--){let l=e.children[o],a=r+e.positions[o],h=l instanceof n.mp&&a<s&&c(t,l,a,i,s);if(h)return h}return null}function u(t,e,r,i,s){if(s&&r<=0&&i>=e.length)return e;s||e.type!=t.topNode||(s=!0);for(let o=e.children.length-1;o>=0;o--){let l,a=e.positions[o]+r,h=e.children[o];if(a<i&&h instanceof n.mp){if(!(l=u(t,h,r-a,i-a,s)))break;return s?new n.mp(e.type,e.children.slice(0,o).concat(l),e.positions.slice(0,o+1),a+l.length):l}}return null}class f{constructor(t,e,r,i){this.lang=t,this.input=e,this.fragments=r,this.ranges=i,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=i[i.length-1].to;let o=s.Be.get(),l=i[0].from,{state:a,tree:h}=function(t,e,r,i){for(let n of e){let e,i=n.from+(n.openStart?25:0),s=n.to-(n.openEnd?25:0),o=i<=r&&s>r&&c(t,n.tree,0-n.offset,r,s);if(o&&(e=u(t,n.tree,r+n.offset,o.pos+n.offset,!1)))return{state:o.state,tree:e}}return{state:t.streamParser.startState(i?(0,s.y1)(i):4),tree:n.mp.empty}}(t,r,l,null==o?void 0:o.state);this.state=a,this.parsedPos=this.chunkStart=l+h.length,h.length&&(this.chunks.push(h),this.chunkPos.push(0)),o&&this.parsedPos<o.viewport.from-1e5&&(this.state=this.lang.streamParser.startState((0,s.y1)(o.state)),o.skipUntilInView(this.parsedPos,o.viewport.from),this.parsedPos=o.viewport.from)}advance(){let t=s.Be.get(),e=null==this.stoppedAt?this.to:this.stoppedAt,r=Math.min(e,this.chunkStart+2048);for(t&&(r=Math.min(r,t.viewport.to));this.parsedPos<r;)this.parseLine(t);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=e?this.finish():t&&this.parsedPos>t.viewport.to?(t.skipUntilInView(this.parsedPos,e),this.finish()):null}stopAt(t){this.stoppedAt=t}lineAfter(t){let e=this.input.chunk(t);if(this.input.lineChunks)"\n"==e&&(e="");else{let t=e.indexOf("\n");t>-1&&(e=e.slice(0,t))}return t+e.length<=this.to?e:e.slice(0,this.to-t)}nextLine(){let t=this.parsedPos,e=this.lineAfter(t),r=t+e.length;for(let t=this.rangeIndex;;){let n=this.ranges[t].to;if(n>=r)break;if(e=e.slice(0,n-(r-e.length)),t++,t==this.ranges.length)break;let i=this.ranges[t].from,s=this.lineAfter(i);e+=s,r=i+s.length}return{line:e,end:r}}skipGapsTo(t,e,r){for(;;){let n=this.ranges[this.rangeIndex].to,i=t+e;if(r>0?n>i:n>=i)break;e+=this.ranges[++this.rangeIndex].from-n}return e}emitToken(t,e,r,n,i){if(this.ranges.length>1){e+=i=this.skipGapsTo(e,i,1);let t=this.chunk.length;r+=i=this.skipGapsTo(r,i,-1),n+=this.chunk.length-t}return this.chunk.push(t,e,r,n),i}parseLine(t){let{line:e,end:r}=this.nextLine(),n=0,{streamParser:i}=this.lang,o=new l(e,t?t.state.tabSize:4,t?(0,s.y1)(t.state):2);if(o.eol())i.blankLine(this.state,o.indentUnit);else for(;!o.eol();){let t=d(i.token,o,this.state);t&&(n=this.emitToken(b(t),this.parsedPos+o.start,this.parsedPos+o.pos,4,n))}this.parsedPos=r,this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let t=n.mp.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:g,topID:0,maxBufferLength:2048,reused:this.chunkReused});t=new n.mp(t.type,t.children,t.positions,t.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(t),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new n.mp(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function d(t,e,r){e.start=e.pos;for(let n=0;n<10;n++){let n=t(e,r);if(e.pos>e.start)return n}throw new Error("Stream parser failed to advance stream.")}const p=Object.create(null),m=[n.Jq.none],g=new n.Lj(m),y=[];function b(t){return t?p[t]||(p[t]=function(t){let e=null;for(let r of t.split(".")){let t=i.pJ[r];t?"function"==typeof t?e?e=t(e):x(r,`Modifier ${r} used at start of tag`):e?x(r,`Tag ${r} used as modifier`):e=t:x(r,`Unknown highlighting tag ${r}`)}if(!e)return 0;let r=t.replace(/ /g,"_"),s=n.Jq.define({id:m.length,name:r,props:[(0,i.Gv)({[r]:e})]});return m.push(s),s.id}(t)):0}for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","typeName"],["attribute","propertyName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])p[t]=b(e);function x(t,e){y.indexOf(t)>-1||(y.push(t),console.warn(e))}},97248:(t,e,r)=>{r.d(e,{md:()=>o,Lj:()=>h,Jq:()=>a,_b:()=>S,mp:()=>u,i9:()=>A});const n=1024;let i=0;class s{constructor(t,e){this.from=t,this.to=e}}class o{constructor(t={}){this.id=i++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof t&&(t=a.match(t)),e=>{let r=t(e);return void 0===r?null:[this,r]}}}o.closedBy=new o({deserialize:t=>t.split(" ")}),o.openedBy=new o({deserialize:t=>t.split(" ")}),o.group=new o({deserialize:t=>t.split(" ")}),o.contextHash=new o({perNode:!0}),o.lookAhead=new o({perNode:!0}),o.mounted=new o({perNode:!0});const l=Object.create(null);class a{constructor(t,e,r,n=0){this.name=t,this.props=e,this.id=r,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):l,r=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(null==t.name?8:0),n=new a(t.name||"",e,t.id,r);if(t.props)for(let r of t.props)if(Array.isArray(r)||(r=r(n)),r){if(r[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[r[0].id]=r[1]}return n}prop(t){return this.props[t.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(t){if("string"==typeof t){if(this.name==t)return!0;let e=this.prop(o.group);return!!e&&e.indexOf(t)>-1}return this.id==t}static match(t){let e=Object.create(null);for(let r in t)for(let n of r.split(" "))e[n]=t[r];return t=>{for(let r=t.prop(o.group),n=-1;n<(r?r.length:0);n++){let i=e[n<0?t.name:r[n]];if(i)return i}}}}a.none=new a("",Object.create(null),0,8);class h{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let r of this.types){let n=null;for(let e of t){let t=e(r);t&&(n||(n=Object.assign({},r.props)),n[t[0].id]=t[1])}e.push(n?new a(r.name,n,r.id,r.flags):r)}return new h(e)}}const c=new WeakMap;class u{constructor(t,e,r,n,i){if(this.type=t,this.children=e,this.positions=r,this.length=n,this.props=null,i&&i.length){this.props=Object.create(null);for(let[t,e]of i)this.props["number"==typeof t?t:t.id]=e}}toString(){let t=this.prop(o.mounted);if(t&&!t.overlay)return t.tree.toString();let e="";for(let t of this.children){let r=t.toString();r&&(e&&(e+=","),e+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t,e=0){let r=null!=t&&c.get(this)||this.topNode,n=new x(r);return null!=t&&(n.moveTo(t,e),c.set(this,n._tree)),n}fullCursor(){return new x(this.topNode,1)}get topNode(){return new m(this,0,0,null)}resolve(t,e=0){return this.cursor(t,e).node}resolveInner(t,e=0){let r=this.topNode;for(;;){let n=r.enter(t,e);if(!n)return r;r=n}}iterate(t){let{enter:e,leave:r,from:n=0,to:i=this.length}=t;for(let t=this.cursor(),s=()=>t.node;;){let o=!1;if(t.from<=i&&t.to>=n&&(t.type.isAnonymous||!1!==e(t.type,t.from,t.to,s))){if(t.firstChild())continue;t.type.isAnonymous||(o=!0)}for(;o&&r&&r(t.type,t.from,t.to,s),o=t.type.isAnonymous,!t.nextSibling();){if(!t.parent())return;o=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:C(this.type,this.children,this.positions,0,this.children.length,0,this.length,((t,e,r)=>new u(this.type,t,e,r,this.propValues)),t.makeTree||((t,e,r)=>new u(a.none,t,e,r)))}static build(t){return function(t){var e;let{buffer:r,nodeSet:i,maxBufferLength:s=n,reused:l=[],minRepeatType:a=i.types.length}=t,h=Array.isArray(r)?new f(r,r.length):r,c=i.types,p=0,m=0;function g(t,e,r,n,o){let{id:u,start:f,end:w,size:A}=h,S=m;for(;A<0;){if(h.next(),-1==A){let e=l[u];return r.push(e),void n.push(f-t)}if(-3==A)return void(p=u);if(-4==A)return void(m=u);throw new RangeError(`Unrecognized record size: ${A}`)}let M,T,L=c[u],P=f-t;if(w-f<=s&&(T=v(h.pos-e,o))){let e=new Uint16Array(T.size-T.skip),r=h.pos-T.size,n=e.length;for(;h.pos>r;)n=k(T.start,e,n);M=new d(e,w-T.start,i),P=T.start-t}else{let t=h.pos-A;h.next();let e=[],r=[],n=u>=a?u:-1,i=0,o=w;for(;h.pos>t;)n>=0&&h.id==n&&h.size>=0?(h.end<=o-s&&(b(e,r,f,i,h.end,o,n,S),i=e.length,o=h.end),h.next()):g(f,t,e,r,n);if(n>=0&&i>0&&i<e.length&&b(e,r,f,i,f,o,n,S),e.reverse(),r.reverse(),n>-1&&i>0){let t=y(L);M=C(L,e,r,0,e.length,0,w-f,t,t)}else M=x(L,e,r,w-f,S-w)}r.push(M),n.push(P)}function y(t){return(e,r,n)=>{let i,s,l=0,a=e.length-1;if(a>=0&&(i=e[a])instanceof u){if(!a&&i.type==t&&i.length==n)return i;(s=i.prop(o.lookAhead))&&(l=r[a]+i.length+s)}return x(t,e,r,n,l)}}function b(t,e,r,n,s,o,l,a){let h=[],c=[];for(;t.length>n;)h.push(t.pop()),c.push(e.pop()+r-s);t.push(x(i.types[l],h,c,o-s,a-o)),e.push(s-r)}function x(t,e,r,n,i=0,s){if(p){let t=[o.contextHash,p];s=s?[t].concat(s):[t]}if(i>25){let t=[o.lookAhead,i];s=s?[t].concat(s):[t]}return new u(t,e,r,n,s)}function v(t,e){let r=h.fork(),n=0,i=0,o=0,l=r.end-s,c={size:0,start:0,skip:0};t:for(let s=r.pos-t;r.pos>s;){let t=r.size;if(r.id==e&&t>=0){c.size=n,c.start=i,c.skip=o,o+=4,n+=4,r.next();continue}let h=r.pos-t;if(t<0||h<s||r.start<l)break;let u=r.id>=a?4:0,f=r.start;for(r.next();r.pos>h;){if(r.size<0){if(-3!=r.size)break t;u+=4}else r.id>=a&&(u+=4);r.next()}i=f,n+=t,o+=u}return(e<0||n==t)&&(c.size=n,c.start=i,c.skip=o),c.size>4?c:void 0}function k(t,e,r){let{id:n,start:i,end:s,size:o}=h;if(h.next(),o>=0&&n<a){let l=r;if(o>4){let n=h.pos-(o-4);for(;h.pos>n;)r=k(t,e,r)}e[--r]=l,e[--r]=s-t,e[--r]=i-t,e[--r]=n}else-3==o?p=n:-4==o&&(m=n);return r}let w=[],A=[];for(;h.pos>0;)g(t.start||0,t.bufferStart||0,w,A,-1);let S=null!==(e=t.length)&&void 0!==e?e:w.length?A[0]+w[0].length:0;return new u(c[t.topID],w.reverse(),A.reverse(),S)}(t)}}u.empty=new u(a.none,[],[],0);class f{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new f(this.buffer,this.index)}}class d{constructor(t,e,r){this.buffer=t,this.length=e,this.set=r}get type(){return a.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],r=this.buffer[t+3],n=this.set.types[e],i=n.name;if(/\W/.test(i)&&!n.isError&&(i=JSON.stringify(i)),r==(t+=4))return i;let s=[];for(;t<r;)s.push(this.childString(t)),t=this.buffer[t+3];return i+"("+s.join(",")+")"}findChild(t,e,r,n,i){let{buffer:s}=this,o=-1;for(let l=t;l!=e&&!(p(i,n,s[l+1],s[l+2])&&(o=l,r>0));l=s[l+3]);return o}slice(t,e,r,n){let i=this.buffer,s=new Uint16Array(e-t);for(let n=t,o=0;n<e;)s[o++]=i[n++],s[o++]=i[n++]-r,s[o++]=i[n++]-r,s[o++]=i[n++]-t;return new d(s,n-r,this.set)}}function p(t,e,r,n){switch(t){case-2:return r<e;case-1:return n>=e&&r<e;case 0:return r<e&&n>e;case 1:return r<=e&&n>e;case 2:return n>e;case 4:return!0}}class m{constructor(t,e,r,n){this.node=t,this._from=e,this.index=r,this._parent=n}get type(){return this.node.type}get name(){return this.node.type.name}get from(){return this._from}get to(){return this._from+this.node.length}nextChild(t,e,r,n,i=0){for(let s=this;;){for(let{children:l,positions:a}=s.node,h=e>0?l.length:-1;t!=h;t+=e){let h=l[t],c=a[t]+s._from;if(p(n,r,c,c+h.length))if(h instanceof d){if(2&i)continue;let o=h.findChild(0,h.buffer.length,e,r-c,n);if(o>-1)return new b(new y(s,h,t,c),null,o)}else if(1&i||!h.type.isAnonymous||v(h)){let l;if(h.props&&(l=h.prop(o.mounted))&&!l.overlay)return new m(l.tree,c,t,s);let a=new m(h,c,t,s);return 1&i||!a.type.isAnonymous?a:a.nextChild(e<0?h.children.length-1:0,e,r,n)}}if(1&i||!s.type.isAnonymous)return null;if(t=s.index>=0?s.index+e:e<0?-1:s._parent.node.children.length,s=s._parent,!s)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this.node.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this.node.children.length-1,-1,t,-2)}enter(t,e,r=!0,n=!0){let i;if(r&&(i=this.node.prop(o.mounted))&&i.overlay){let r=t-this.from;for(let{from:t,to:n}of i.overlay)if((e>0?t<=r:t<r)&&(e<0?n>=r:n>r))return new m(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,n?0:2)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get cursor(){return new x(this)}get tree(){return this.node}toTree(){return this.node}resolve(t,e=0){return this.cursor.moveTo(t,e).node}getChild(t,e=null,r=null){let n=g(this,t,e,r);return n.length?n[0]:null}getChildren(t,e=null,r=null){return g(this,t,e,r)}toString(){return this.node.toString()}}function g(t,e,r,n){let i=t.cursor,s=[];if(!i.firstChild())return s;if(null!=r)for(;!i.type.is(r);)if(!i.nextSibling())return s;for(;;){if(null!=n&&i.type.is(n))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return null==n?s:[]}}class y{constructor(t,e,r,n){this.parent=t,this.buffer=e,this.index=r,this.start=n}}class b{constructor(t,e,r){this.context=t,this._parent=e,this.index=r,this.type=t.buffer.set.types[t.buffer.buffer[r]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(t,e,r){let{buffer:n}=this.context,i=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,r);return i<0?null:new b(this.context,this,i)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,r,n=!0){if(!n)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return s<0?null:new b(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new b(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new b(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}get cursor(){return new x(this)}get tree(){return null}toTree(){let t=[],e=[],{buffer:r}=this.context,n=this.index+4,i=r.buffer[this.index+3];if(i>n){let s=r.buffer[this.index+1],o=r.buffer[this.index+2];t.push(r.slice(n,i,s,o)),e.push(0)}return new u(this.type,t,e,this.to-this.from)}resolve(t,e=0){return this.cursor.moveTo(t,e).node}toString(){return this.context.buffer.childString(this.index)}getChild(t,e=null,r=null){let n=g(this,t,e,r);return n.length?n[0]:null}getChildren(t,e=null,r=null){return g(this,t,e,r)}}class x{constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof m)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let e=t._parent;e;e=e._parent)this.stack.unshift(e.index);this.bufferNode=t,this.yieldBuf(t.index)}}get name(){return this.type.name}yieldNode(t){return!!t&&(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0)}yieldBuf(t,e){this.index=t;let{start:r,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=r+n.buffer[t+1],this.to=r+n.buffer[t+2],!0}yield(t){return!!t&&(t instanceof m?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,r){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree.node.children.length-1:0,t,e,r,this.mode));let{buffer:n}=this.buffer,i=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,r);return!(i<0)&&(this.stack.push(this.index),this.yieldBuf(i))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,r=!0,n=!0){return this.buffer?!!n&&this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,r,n))}parent(){if(!this.buffer)return this.yieldNode(1&this.mode?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=1&this.mode?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode));let{buffer:e}=this.buffer,r=this.stack.length-1;if(t<0){let t=r<0?0:this.stack[r]+4;if(this.index!=t)return this.yieldBuf(e.findChild(t,this.index,-1,0,4))}else{let t=e.buffer[this.index+3];if(t<(r<0?e.buffer.length:e.buffer[this.stack[r]+3]))return this.yieldBuf(t)}return r<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,r,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let t=0;t<this.index;t++)if(n.buffer.buffer[t+3]<this.index)return!1;({index:e,parent:r}=n)}else({index:e,_parent:r}=this._tree);for(;r;({index:e,_parent:r}=r))if(e>-1)for(let n=e+t,i=t<0?-1:r.node.children.length;n!=i;n+=t){let t=r.node.children[n];if(1&this.mode||t instanceof d||!t.type.isAnonymous||v(t))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,r=0;if(t&&t.context==this.buffer)t:for(let n=this.index,i=this.stack.length;i>=0;){for(let s=t;s;s=s._parent)if(s.index==n){if(n==this.index)return s;e=s,r=i+1;break t}n=this.stack[--i]}for(let t=r;t<this.stack.length;t++)e=new b(this.buffer,e,this.stack[t]);return this.bufferNode=new b(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree.node}}function v(t){return t.children.some((t=>t instanceof d||!t.type.isAnonymous||v(t)))}const k=new WeakMap;function w(t,e){if(!t.isAnonymous||e instanceof d||e.type!=t)return 1;let r=k.get(e);return null==r&&(r=e.children.reduce(((e,r)=>e+w(t,r)),1),k.set(e,r)),r}function C(t,e,r,n,i,s,o,l,a){let h=0;for(let r=n;r<i;r++)h+=w(t,e[r]);let c=Math.ceil(1.5*h/8),u=[],f=[];return function e(r,n,i,o,l){for(let h=i;h<o;){let i=h,d=n[h],p=w(t,r[h]);for(h++;h<o;h++){let e=w(t,r[h]);if(p+e>=c)break;p+=e}if(h==i+1){if(p>c){let t=r[i];e(t.children,t.positions,0,t.children.length,n[i]+l);continue}u.push(r[i])}else{let e=n[h-1]+r[h-1].length-d;u.push(C(t,r,n,i,h,d,e,null,a))}f.push(d+l-s)}}(e,r,n,i,0),(l||a)(u,f,o)}class A{constructor(t,e,r,n,i=!1,s=!1){this.from=t,this.to=e,this.tree=r,this.offset=n,this.open=(i?1:0)|(s?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(t,e=[],r=!1){let n=[new A(0,t.length,t,0,!1,r)];for(let r of e)r.to>t.length&&n.push(r);return n}static applyChanges(t,e,r=128){if(!e.length)return t;let n=[],i=1,s=t.length?t[0]:null;for(let o=0,l=0,a=0;;o++){let h=o<e.length?e[o]:null,c=h?h.fromA:1e9;if(c-l>=r)for(;s&&s.from<c;){let e=s;if(l>=e.from||c<=e.to||a){let t=Math.max(e.from,l)-a,r=Math.min(e.to,c)-a;e=t>=r?null:new A(t,r,e.tree,e.offset+a,o>0,!!h)}if(e&&n.push(e),s.to>c)break;s=i<t.length?t[i++]:null}if(!h)break;l=h.toA,a=h.toA-h.toB}return n}}class S{startParse(t,e,r){return"string"==typeof t&&(t=new M(t)),r=r?r.length?r.map((t=>new s(t.from,t.to))):[new s(0,0)]:[new s(0,t.length)],this.createParse(t,e||[],r)}parse(t,e,r){let n=this.startParse(t,e,r);for(;;){let t=n.advance();if(t)return t}}}class M{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}}}]);