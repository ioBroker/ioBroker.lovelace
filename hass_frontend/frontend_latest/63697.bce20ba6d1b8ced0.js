export const __webpack_ids__=["63697"];export const __webpack_modules__={50875:function(t,e,a){a.d(e,{Eu:()=>o,hZ:()=>r,o9:()=>c});var s=a(27486),i=a(11259);const n=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#9498a0","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#74787f","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#b6bac2","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#d9d9d9","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function o(t){return n[t%n.length]}function r(t,e){const a=e.getPropertyValue(`--graph-color-${t+1}`)||o(t);return(0,i.Rq)(a)}const c=(0,s.Z)((t=>n.map(((e,a)=>r(a,t)))),((t,e)=>t[0].getPropertyValue("--graph-color-1")===e[0].getPropertyValue("--graph-color-1")))},6736:function(t,e,a){a.d(e,{f:()=>o});var s=a(44249),i=a(72621),n=(a(9359),a(52924),a(15093));const o=t=>(0,s.Z)(null,(function(t,e){class a extends e{constructor(...e){super(...e),t(this)}}return{F:a,d:[{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:void 0},{kind:"field",key:"__unsubs",value:void 0},{kind:"method",key:"connectedCallback",value:function(){(0,i.Z)(a,"connectedCallback",this,3)([]),this._checkSubscribed()}},{kind:"method",key:"disconnectedCallback",value:function(){if((0,i.Z)(a,"disconnectedCallback",this,3)([]),this.__unsubs){for(;this.__unsubs.length;){const t=this.__unsubs.pop();t instanceof Promise?t.then((t=>t())):t()}this.__unsubs=void 0}}},{kind:"method",key:"updated",value:function(t){if((0,i.Z)(a,"updated",this,3)([t]),t.has("hass"))this._checkSubscribed();else if(this.hassSubscribeRequiredHostProps)for(const e of t.keys())if(this.hassSubscribeRequiredHostProps.includes(e))return void this._checkSubscribed()}},{kind:"method",key:"hassSubscribe",value:function(){return[]}},{kind:"method",key:"_checkSubscribed",value:function(){void 0===this.__unsubs&&this.isConnected&&void 0!==this.hass&&!this.hassSubscribeRequiredHostProps?.some((t=>void 0===this[t]))&&(this.__unsubs=this.hassSubscribe())}}]}}),t)},20548:function(t,e,a){a.d(e,{H:()=>n});var s=a(11259),i=a(4643);function n(t,e,a,n,o,r){const c=t.getPropertyValue(o+"-"+r).trim(),d=c.length>0?c:t.getPropertyValue(o).trim();let u=(0,s.Rq)(d);return 0===c.length&&r&&(u=(0,s.CO)((0,s.p3)(e?(0,i.C)((0,s.Rw)((0,s.wK)(u)),r):(0,i.W)((0,s.Rw)((0,s.wK)(u)),r)))),n?u+=a?"32":"7F":a&&(u+="7F"),u}},53259:function(t,e,a){a.a(t,(async function(t,s){try{a.d(e,{J:()=>y,MC:()=>k,Zx:()=>S,b4:()=>v,kT:()=>$});a(92745),a(9359),a(56475),a(31526),a(70104),a(92519),a(42179),a(89256),a(24931),a(88463),a(57449),a(19814);var i=a(21893),n=a(13809),o=a(38836),r=a(84775),c=a(80951),d=a(13730),u=a(6542),h=a(83204),l=a(23459),f=a(23711),m=a(50602),p=a(46467),_=a(33570),b=t([p,_,m]);function k(t,e){let a=new Date(e);return t>2&&0===a.getHours()&&(a=(0,i.b)(a,1)),a.setMinutes(0,0,0),t>35&&a.setDate(1),t>2&&a.setHours(0),a.getTime()}function v(t){return t>35?"month":t>2?"day":"hour"}function y(t,e,a,s,i,o,r,c){const d=(0,n.j)(e,t),u=void 0!==o&&void 0!==r;return{xAxis:{type:"time",min:t,max:k(d,e)},yAxis:{type:"value",name:i,nameGap:2,nameTextStyle:{align:"left"},axisLabel:{formatter:t=>(0,m.uf)(Math.abs(t),a)},splitLine:{show:!0}},grid:{top:15,bottom:0,left:1,right:1,containLabel:!0},tooltip:{trigger:"axis",formatter:t=>{if(Array.isArray(t)){const e=[],n=[];return t.forEach((t=>{t.seriesId?.startsWith("compare-")?n.push(t):e.push(t)})),[e,n].map((t=>g(t,a,s,d,u,i,c))).filter(Boolean).join("<br><br>")}return g([t],a,s,d,u,i,c)}}}}function g(t,e,a,s,i,n,r){if(!t[0]?.value)return"";const c=new Date(t[0].value?.[2]??t[0].value?.[0]);let d;d=s>89?`${(0,p.NC)(c,e,a)}`:s>0?`${(0,p.ud)(c,e,a)}`:`${i?`${(0,p.ud)(c,e,a)}: `:""}${(0,_.mr)(c,e,a)} â€“ ${(0,_.mr)((0,o.T)(c,1),e,a)}`;const u=`<h4 style="text-align: center; margin: 0;">${d}</h4>`;let h=0,l=0,f=0,b=0;const k=t.map((t=>{const a=t.value?.[1],s=(0,m.uf)(a,e);return"0"!==s&&("bar"===t.componentSubType&&(a>0?(h+=a,l++):(f+=a,b++)),`${t.marker} ${t.seriesName}: ${s} ${n}`)})).filter(Boolean);let v="";return 0!==h&&l>1&&r&&(v+=`<br><b>${r(h)}</b>`),0!==f&&b>1&&r&&(v+=`<br><b>${r(f)}</b>`),k.length>0?`${u}${k.join("<br>")}${v}`:""}function S(t){Array.from(new Set(t.map((t=>t.data.map((t=>Number(t[0]))))).flat())).sort(((t,e)=>t-e)).forEach(((e,a)=>{const s={},i={};for(let n=t.length-1;n>=0;n--){const o=t[n].data[a],r=o&&"object"==typeof o&&"value"in o?o:{value:o},c=r.value?.[0],d=t[n].stack??"";void 0!==c&&(Number(c)!==e?t[n].data?.splice(a,0,{value:[e,0],itemStyle:{borderWidth:0}}):0===r.value?.[1]?t[n].data[a]={...r,itemStyle:{...r.itemStyle,borderWidth:0}}:!s[d]&&r.value?.[1]>0?(t[n].data[a]={...r,itemStyle:{...r.itemStyle,borderRadius:[4,4,0,0]}},s[d]=!0):!i[d]&&r.value?.[1]<0&&(t[n].data[a]={...r,itemStyle:{...r.itemStyle,borderRadius:[0,0,4,4]}},i[d]=!0))}}))}function $(t,e){if(!e)return t=>t;const a=(0,r.o)(t,e);if(0!==a&&t.getTime()===(0,c.e)(t).getTime())return t=>(0,d.B)(t,a);const s=(0,u.d)(t,e);if(0!==s&&t.getTime()===(0,h.N)(t).getTime())return t=>(0,l.z)(t,s);const i=t.getTime()-e.getTime();return t=>(0,f.n)(t,i)}[p,_,m]=b.then?(await b)():b,s()}catch(C){s(C)}}))},36681:function(t,e,a){a.a(t,(async function(t,s){try{a.r(e),a.d(e,{HuiEnergyDevicesDetailGraphCard:()=>$});var i=a(44249),n=(a(92745),a(9359),a(56475),a(31526),a(70104),a(48136),a(42625)),o=a(83389),r=a(57243),c=a(15093),d=a(35359),u=a(27486),h=a(50875),l=a(20548),f=(a(54977),a(25179)),m=a(1118),p=a(17705),_=a(6736),b=a(93331),k=a(53259),v=a(68958),y=a(50602),g=t([f,y,m,k]);[f,y,m,k]=g.then?(await g)():g;const S="kWh";let $=(0,i.Z)([(0,c.Mo)("hui-energy-devices-detail-graph-card")],(function(t,e){return{F:class extends e{constructor(...e){super(...e),t(this)}},d:[{kind:"field",decorators:[(0,c.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,c.SB)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,c.SB)()],key:"_chartData",value:()=>[]},{kind:"field",decorators:[(0,c.SB)()],key:"_data",value:void 0},{kind:"field",decorators:[(0,c.SB)()],key:"_start",value:()=>(0,n.I)()},{kind:"field",decorators:[(0,c.SB)()],key:"_end",value:()=>(0,o.p)()},{kind:"field",decorators:[(0,c.SB)()],key:"_compareStart",value:void 0},{kind:"field",decorators:[(0,c.SB)()],key:"_compareEnd",value:void 0},{kind:"field",decorators:[(0,v.t)({key:"energy-devices-hidden-stats",state:!0,subscribe:!1})],key:"_hiddenStats",value:()=>[]},{kind:"field",key:"hassSubscribeRequiredHostProps",value:()=>["_config"]},{kind:"method",key:"hassSubscribe",value:function(){return[(0,m.UB)(this.hass,{key:this._config?.collection_key}).subscribe((t=>{this._data=t,this._processStatistics()}))]}},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(t){this._config=t}},{kind:"method",key:"shouldUpdate",value:function(t){return(0,b.SN)(this,t)||t.size>1||!t.has("hass")}},{kind:"method",key:"willUpdate",value:function(t){(t.has("_hiddenStats")||t.has("_config"))&&this._data&&this._processStatistics()}},{kind:"method",key:"render",value:function(){return this.hass&&this._config?r.dy` <ha-card> ${this._config.title?r.dy`<h1 class="card-header">${this._config.title}</h1>`:""} <div class="content ${(0,d.$)({"has-header":!!this._config.title})}"> <ha-chart-base .hass="${this.hass}" .data="${this._chartData}" .options="${this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,S,this._compareStart,this._compareEnd)}" @dataset-hidden="${this._datasetHidden}" @dataset-unhidden="${this._datasetUnhidden}"></ha-chart-base> </div> </ha-card> `:r.Ld}},{kind:"field",key:"_formatTotal",value(){return t=>this.hass.localize("ui.panel.lovelace.cards.energy.energy_usage_graph.total_consumed",{num:(0,y.uf)(t,this.hass.locale),unit:S})}},{kind:"method",key:"_datasetHidden",value:function(t){this._hiddenStats=[...this._hiddenStats,t.detail.name]}},{kind:"method",key:"_datasetUnhidden",value:function(t){this._hiddenStats=this._hiddenStats.filter((e=>e!==t.detail.name))}},{kind:"field",key:"_createOptions",value(){return(0,u.Z)(((t,e,a,s,i,n,o)=>({...(0,k.J)(t,e,a,s,i,n,o,this._formatTotal),legend:{show:!0,type:"scroll",animationDurationUpdate:400,selected:this._hiddenStats.reduce(((t,e)=>(t[e]=!1,t)),{}),icon:"circle"},grid:{top:15,bottom:0,left:1,right:1,containLabel:!0}})))}},{kind:"method",key:"_processStatistics",value:function(){const t=this._data;this._start=t.start,this._end=t.end||(0,o.p)(),this._compareStart=t.startCompare,this._compareEnd=t.endCompare;const e=t.stats,a=t.statsCompare,s=getComputedStyle(this),i={};t.prefs.device_consumption.forEach((t=>{const a=t.stat_consumption in e&&(0,p.Kj)(e[t.stat_consumption])||0;i[t.stat_consumption]=a}));const n=t.prefs.device_consumption.map((t=>t.stat_consumption));n.sort(((t,e)=>i[e]-i[t]));const r=[],{summedData:c,compareSummedData:d}=(0,m.EH)(t),u="from_grid"in c||"solar"in c||"from_battery"in c,{consumption:h,compareConsumption:l}=u?(0,m.E4)(c,d):{consumption:void 0,compareConsumption:void 0};if(a){const e=this._processDataSet(s,a,t.statsMetadata,t.prefs.device_consumption,n,!0);if(r.push(...e),u){const t=this._processUntracked(s,e,l,!0);r.push(t)}}else{const e=t.prefs.device_consumption[0]?.stat_consumption??"untracked";r.push({id:"compare-"+e,type:"bar",stack:"devices",data:[]})}const f=this._processDataSet(s,e,t.statsMetadata,t.prefs.device_consumption,n);if(r.push(...f),u){const t=this._processUntracked(s,f,h,!1);r.push(t)}(0,k.Zx)(r),this._chartData=r}},{kind:"method",key:"_processUntracked",value:function(t,e,a,s){const i={};e.forEach((t=>{t.data.forEach((t=>{i[t[s?2:0]]=(i[t[s?2:0]]||0)+t[1]}))}));const n=(0,k.kT)(this._start,this._compareStart),o=[];Object.keys(a.total).sort(((t,e)=>Number(t)-Number(e))).forEach((t=>{const e=Number(t),r=[e,a.total[t]-(i[t]||0)];s&&(r[2]=r[0],r[0]=n(new Date(e)).getTime()),o.push(r)}));const r=Date.now();return{type:"bar",cursor:"default",id:s?`compare-untracked-${r}`:`untracked-${r}`,name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_detail_graph.untracked_consumption"),itemStyle:{borderColor:(0,l.H)(t,this.hass.themes.darkMode,!1,s,"--state-unavailable-color")},barMaxWidth:50,color:(0,l.H)(t,this.hass.themes.darkMode,!0,s,"--state-unavailable-color"),data:o,stack:s?"devicesCompare":"devices"}}},{kind:"method",key:"_processDataSet",value:function(t,e,a,s,i,n=!1){const o=[],r=(0,k.kT)(this._start,this._compareStart);return s.forEach(((s,c)=>{const d=i.indexOf(s.stat_consumption);if(this._config?.max_devices&&d>=this._config.max_devices)return void console.warn(`Max devices exceeded for ${s.name} (${d} >= ${this._config.max_devices})`);const u=(0,h.hZ)(c,t);let l=null;const f=[];if(s.stat_consumption in e){const t=e[s.stat_consumption];for(const e of t){if(null===e.change||void 0===e.change||0===e.change)continue;if(l===e.start)continue;const t=[e.start,e.change];n&&(t[2]=t[0],t[0]=r(new Date(e.start)).getTime()),f.push(t),l=e.start}}o.push({type:"bar",cursor:"default",id:n?`compare-${s.stat_consumption}-${d}`:`${s.stat_consumption}-${d}`,name:s.name||(0,p.Kd)(this.hass,s.stat_consumption,a[s.stat_consumption]),itemStyle:{borderColor:n?u+"7F":u},barMaxWidth:50,color:n?u+"32":u+"7F",data:f,stack:n?"devicesCompare":"devices"})})),i.map((t=>o.find((e=>e.id.replace(/^compare-/,"").replace(/-\d+$/,"")===t)))).filter(Boolean)}},{kind:"field",static:!0,key:"styles",value:()=>r.iv`.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}`}]}}),(0,_.f)(r.oi));s()}catch(t){s(t)}}))}};
//# sourceMappingURL=63697.bce20ba6d1b8ced0.js.map