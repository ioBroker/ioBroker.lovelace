{"version":3,"file":"b4477512.js","mappings":";;;;AAMA;;ACQA;AACA;AACA;;;AAKA;;;;;;;;;;;;;;;;;;;AAhBA;AC6CA;AAIA;;AAEA;AAGA;AACA;;;AAKA;;;AAKA;;;;;AAMA;;;AAKA;;;;AAKA;;;AAIA;;;;AAIA;;;AAKA;AAEA;;AAMA;AACA;;AAIA;AACA;AAEA;;AAGA;;;;AAMA;;AAEA;;;AAIA;AAKA;AACA;;AAIA;;AAGA;AACA;;AAIA;;;AAKA;;AAGA;AACA;;AAIA;;AAIA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA3IA","sources":["webpack://home-assistant-frontend/./src/components/ha-checkbox.ts","webpack://home-assistant-frontend/./src/components/ha-faded.ts","webpack://home-assistant-frontend/./src/dialogs/more-info/controls/more-info-update.ts"],"sourcesContent":["import { CheckboxBase } from \"@material/mwc-checkbox/mwc-checkbox-base\";\nimport { styles } from \"@material/mwc-checkbox/mwc-checkbox.css\";\nimport { css } from \"lit\";\nimport { customElement } from \"lit/decorators\";\n\n@customElement(\"ha-checkbox\")\nexport class HaCheckbox extends CheckboxBase {\n  static override styles = [\n    styles,\n    css`\n      :host {\n        --mdc-theme-secondary: var(--primary-color);\n      }\n    `,\n  ];\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-checkbox\": HaCheckbox;\n  }\n}\n","import { css, CSSResultGroup, html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { classMap } from \"lit/directives/class-map\";\n\n@customElement(\"ha-faded\")\nclass HaFaded extends LitElement {\n  @property({ type: Number, attribute: \"faded-height\" })\n  public fadedHeight = 102;\n\n  @state() _contentShown = false;\n\n  protected render(): TemplateResult {\n    return html`\n      <div\n        class=\"container ${classMap({ faded: !this._contentShown })}\"\n        style=${!this._contentShown ? `max-height: ${this.fadedHeight}px` : \"\"}\n        @click=${this._showContent}\n      >\n        <slot\n          @iron-resize=${\n            // ha-markdown-element fire this when render is complete\n            this._setShowContent\n          }\n        ></slot>\n      </div>\n    `;\n  }\n\n  get _slottedHeight(): number {\n    return (\n      (\n        this.shadowRoot!.querySelector(\".container\")\n          ?.firstElementChild as HTMLSlotElement\n      )\n        .assignedElements()\n        .reduce(\n          (partial, element) => partial + (element as HTMLElement).offsetHeight,\n          0\n        ) || 0\n    );\n  }\n\n  private _setShowContent() {\n    const height = this._slottedHeight;\n    this._contentShown = height !== 0 && height <= this.fadedHeight + 50;\n  }\n\n  protected firstUpdated(changedProps) {\n    super.firstUpdated(changedProps);\n    this._setShowContent();\n  }\n\n  private _showContent(): void {\n    this._contentShown = true;\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      .container {\n        display: block;\n        height: auto;\n        cursor: default;\n      }\n      .faded {\n        cursor: pointer;\n        -webkit-mask-image: linear-gradient(\n          to bottom,\n          black 25%,\n          transparent 100%\n        );\n        mask-image: linear-gradient(to bottom, black 25%, transparent 100%);\n        overflow-y: hidden;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-faded\": HaFaded;\n  }\n}\n","import \"../../../components/ha-alert\";\nimport \"../../../components/ha-faded\";\nimport \"@material/mwc-button/mwc-button\";\nimport \"@material/mwc-linear-progress/mwc-linear-progress\";\nimport { css, CSSResultGroup, html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { supportsFeature } from \"../../../common/entity/supports-feature\";\nimport \"../../../components/ha-checkbox\";\nimport \"../../../components/ha-circular-progress\";\nimport \"../../../components/ha-formfield\";\nimport \"../../../components/ha-markdown\";\nimport { UNAVAILABLE_STATES } from \"../../../data/entity\";\nimport {\n  UpdateEntity,\n  updateIsInstalling,\n  updateReleaseNotes,\n  UPDATE_SUPPORT_BACKUP,\n  UPDATE_SUPPORT_INSTALL,\n  UPDATE_SUPPORT_PROGRESS,\n  UPDATE_SUPPORT_RELEASE_NOTES,\n  UPDATE_SUPPORT_SPECIFIC_VERSION,\n} from \"../../../data/update\";\nimport type { HomeAssistant } from \"../../../types\";\nimport { BINARY_STATE_OFF } from \"../../../common/const\";\n\n@customElement(\"more-info-update\")\nclass MoreInfoUpdate extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ attribute: false }) public stateObj?: UpdateEntity;\n\n  @state() private _releaseNotes?: string | null;\n\n  @state() private _error?: string;\n\n  protected render(): TemplateResult {\n    if (\n      !this.hass ||\n      !this.stateObj ||\n      UNAVAILABLE_STATES.includes(this.stateObj.state)\n    ) {\n      return html``;\n    }\n\n    const skippedVersion =\n      this.stateObj.attributes.latest_version &&\n      this.stateObj.attributes.skipped_version ===\n        this.stateObj.attributes.latest_version;\n\n    return html`\n      ${this.stateObj.attributes.in_progress\n        ? supportsFeature(this.stateObj, UPDATE_SUPPORT_PROGRESS) &&\n          typeof this.stateObj.attributes.in_progress === \"number\"\n          ? html`<mwc-linear-progress\n              .progress=${this.stateObj.attributes.in_progress / 100}\n              buffer=\"\"\n            ></mwc-linear-progress>`\n          : html`<mwc-linear-progress indeterminate></mwc-linear-progress>`\n        : \"\"}\n      <h3>${this.stateObj.attributes.title}</h3>\n      ${this._error\n        ? html`<ha-alert alert-type=\"error\">${this._error}</ha-alert>`\n        : \"\"}\n      <div class=\"row\">\n        <div class=\"key\">\n          ${this.hass.localize(\n            \"ui.dialogs.more_info_control.update.installed_version\"\n          )}\n        </div>\n        <div class=\"value\">\n          ${this.stateObj.attributes.installed_version ??\n          this.hass.localize(\"state.default.unavailable\")}\n        </div>\n      </div>\n      <div class=\"row\">\n        <div class=\"key\">\n          ${this.hass.localize(\n            \"ui.dialogs.more_info_control.update.latest_version\"\n          )}\n        </div>\n        <div class=\"value\">\n          ${this.stateObj.attributes.latest_version ??\n          this.hass.localize(\"state.default.unavailable\")}\n        </div>\n      </div>\n\n      ${this.stateObj.attributes.release_url\n        ? html`<div class=\"row\">\n            <div class=\"key\">\n              <a\n                href=${this.stateObj.attributes.release_url}\n                target=\"_blank\"\n                rel=\"noreferrer\"\n              >\n                ${this.hass.localize(\n                  \"ui.dialogs.more_info_control.update.release_announcement\"\n                )}\n              </a>\n            </div>\n          </div>`\n        : \"\"}\n      ${supportsFeature(this.stateObj!, UPDATE_SUPPORT_RELEASE_NOTES) &&\n      !this._error\n        ? this._releaseNotes === undefined\n          ? html`<ha-circular-progress active></ha-circular-progress>`\n          : html`<hr />\n              <ha-faded>\n                <ha-markdown .content=${this._releaseNotes}></ha-markdown>\n              </ha-faded> `\n        : this.stateObj.attributes.release_summary\n        ? html`<hr />\n            <ha-markdown\n              .content=${this.stateObj.attributes.release_summary}\n            ></ha-markdown>`\n        : \"\"}\n      ${supportsFeature(this.stateObj, UPDATE_SUPPORT_BACKUP)\n        ? html`<hr />\n            <ha-formfield\n              .label=${this.hass.localize(\n                \"ui.dialogs.more_info_control.update.create_backup\"\n              )}\n            >\n              <ha-checkbox\n                checked\n                .disabled=${updateIsInstalling(this.stateObj)}\n              ></ha-checkbox>\n            </ha-formfield> `\n        : \"\"}\n      <hr />\n      <div class=\"actions\">\n        ${this.stateObj.attributes.auto_update\n          ? \"\"\n          : this.stateObj.state === BINARY_STATE_OFF &&\n            this.stateObj.attributes.skipped_version\n          ? html`\n              <mwc-button @click=${this._handleClearSkipped}>\n                ${this.hass.localize(\n                  \"ui.dialogs.more_info_control.update.clear_skipped\"\n                )}\n              </mwc-button>\n            `\n          : html`\n              <mwc-button\n                @click=${this._handleSkip}\n                .disabled=${skippedVersion ||\n                this.stateObj.state === BINARY_STATE_OFF ||\n                updateIsInstalling(this.stateObj)}\n              >\n                ${this.hass.localize(\n                  \"ui.dialogs.more_info_control.update.skip\"\n                )}\n              </mwc-button>\n            `}\n        ${supportsFeature(this.stateObj, UPDATE_SUPPORT_INSTALL)\n          ? html`\n              <mwc-button\n                @click=${this._handleInstall}\n                .disabled=${(this.stateObj.state === BINARY_STATE_OFF &&\n                  !skippedVersion) ||\n                updateIsInstalling(this.stateObj)}\n              >\n                ${this.hass.localize(\n                  \"ui.dialogs.more_info_control.update.install\"\n                )}\n              </mwc-button>\n            `\n          : \"\"}\n      </div>\n    `;\n  }\n\n  protected firstUpdated(): void {\n    if (supportsFeature(this.stateObj!, UPDATE_SUPPORT_RELEASE_NOTES)) {\n      updateReleaseNotes(this.hass, this.stateObj!.entity_id)\n        .then((result) => {\n          this._releaseNotes = result;\n        })\n        .catch((err) => {\n          this._error = err.message;\n        });\n    }\n  }\n\n  get _shouldCreateBackup(): boolean | null {\n    if (!supportsFeature(this.stateObj!, UPDATE_SUPPORT_BACKUP)) {\n      return null;\n    }\n    const checkbox = this.shadowRoot?.querySelector(\"ha-checkbox\");\n    if (checkbox) {\n      return checkbox.checked;\n    }\n    return true;\n  }\n\n  private _handleInstall(): void {\n    const installData: Record<string, any> = {\n      entity_id: this.stateObj!.entity_id,\n    };\n\n    if (this._shouldCreateBackup) {\n      installData.backup = true;\n    }\n\n    if (\n      supportsFeature(this.stateObj!, UPDATE_SUPPORT_SPECIFIC_VERSION) &&\n      this.stateObj!.attributes.latest_version\n    ) {\n      installData.version = this.stateObj!.attributes.latest_version;\n    }\n\n    this.hass.callService(\"update\", \"install\", installData);\n  }\n\n  private _handleSkip(): void {\n    this.hass.callService(\"update\", \"skip\", {\n      entity_id: this.stateObj!.entity_id,\n    });\n  }\n\n  private _handleClearSkipped(): void {\n    this.hass.callService(\"update\", \"clear_skipped\", {\n      entity_id: this.stateObj!.entity_id,\n    });\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      hr {\n        border-color: var(--divider-color);\n        border-bottom: none;\n        margin: 16px 0;\n      }\n      ha-expansion-panel {\n        margin: 16px 0;\n      }\n      .row {\n        margin: 0;\n        display: flex;\n        flex-direction: row;\n        justify-content: space-between;\n      }\n      .actions {\n        margin: 8px 0 0;\n        display: flex;\n        flex-wrap: wrap;\n        justify-content: center;\n      }\n\n      .actions mwc-button {\n        margin: 0 4px 4px;\n      }\n      a {\n        color: var(--primary-color);\n      }\n      ha-circular-progress {\n        width: 100%;\n        justify-content: center;\n      }\n      mwc-linear-progress {\n        margin-bottom: -10px;\n        margin-top: -10px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"more-info-update\": MoreInfoUpdate;\n  }\n}\n"],"names":[],"sourceRoot":""}