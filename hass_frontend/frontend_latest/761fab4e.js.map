{"version":3,"file":"761fab4e.js","mappings":";;AAwBA;AACA;AACA;;;;;;;AApBA;;ACeA;AACA;AACA;AACA;;;;AAIA;;AAIA;;;;;AAUA;;AAdA;AApBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;ACoCA;;;AAMA;;AAEA;;;;;AAKA;;;;;AAKA;AAEA;;;AAGA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAvCA;;;;ACZA;AACA;;;;;;;AAZA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;;;;;;;;;;;;;ACEA;;AC0CA;;AAGA;AACA;AACA;;AAEA;AAGA;;AAEA;;;AAGA;;AAGA;AACA;;;;AAIA;;;AAGA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA1DA;;AC8BA;AACA;;;;AAIA;;;;AAIA;;;;;;AAQA;;;;AAMA;;AAKA;;;;;AAmBA;;;AAKA;;AAGA;;;;AAKA;;;AAKA;;;;;;;;;;;AAqBA;;;AAKA;AACA;;;;;;AAQA;;AAEA;;;;AAMA;;;AAKA;;;;;;AAQA;;;;;;AAQA;AACA;AACA;;;;AAIA;AACA;AACA;;;;AAIA;AACA;AACA;;;;AAIA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;;;;;AA5KA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;ACFA;;;;;;;;;;AAYA;;;;;AAOA;AACA;;;;;AAKA;;AAEA;;;AA0CA;;;AAKA;;;AAKA;AACA;;;AArDA;;AAKA;;AAIA;;;;;;;;;AAWA;;;;;;;;;AAWA;;;;;AA/BA;;;;;AA6DA;;;;;AAxGA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;ACmBA;;;;;;;;;;AAYA;;;;;AAOA;AACA;;;;;AAKA;;AAEA;AAwCA;;;AAIA;;AAIA;;;;;AAOA;;;AAKA;;;;AAKA;;;AAKA;;;AAKA;AACA;;;;;;AAMA;;;AAKA;;;;;;AAQA;AAGA;AAGA;AACA;;AAtGA;;AAKA;;AAIA;;;;;;;;;AAWA;;;;;;;;;AAWA;;;;;AA/BA;;;;;AA6GA;;;;;AAzJA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;ACyCA;;;;;;;;;;AAYA;;;;;AAOA;AACA;;;;;AAKA;;AAGA;;AAIA;AAEA;AACA;;AAQA;;;;AAIA;;;AAKA;;AAEA;;;;AAIA;AACA;;;;AA9EA;;;AAGA;;;AAKA;;;AAxBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;AC0BA;;;AAGA;;;;AAQA;AAGA;AACA;AACA;;AAEA;;;;AAOA;AAGA;AACA;AACA;;AAEA;;;;AAOA;AACA;;;;AAjEA;;;;;;;;;;;;;;;;;AAAA;;;ACqBA;;;AAKA;AACA;;AAcA;;AAIA;;AAIA;;AAIA;;;AAKA;AAGA;;AAEA;AACA;;AAIA;AACA;;;;AAKA;AAGA;AACA;;AAIA;;;AAvDA;;AAMA;;;;;;;;;AA6DA;;;;;AAjGA;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AC2BA;AACA;;;;AAIA;;;;AAIA;;;AAKA;;;;;;;AASA;;;AAKA;;;;;;;;AAUA;;;;;AAOA;;AAGA;;AAEA;AACA;;;;AAKA;;;AAKA;;AAIA;;;;;AAOA;AACA;AACA;AACA;;;;AAMA;AAGA;;;;;AAKA;AACA;AACA;;;;AAMA;AACA;;AAEA;;;;;AAOA;AACA;AACA;;;;;;AAQA;;AAEA;;AAIA;;;;;;;;;AAnJA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;ACNA;;;;AAOA;;;;;;AAlBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA","sources":["webpack://home-assistant-frontend/./src/components/buttons/ha-call-api-button.ts","webpack://home-assistant-frontend/./src/components/buttons/ha-progress-button.ts","webpack://home-assistant-frontend/./src/components/ha-alert.ts","webpack://home-assistant-frontend/./src/components/ha-settings-row.ts","webpack://home-assistant-frontend/./src/components/ha-switch.ts","webpack://home-assistant-frontend/./src/layouts/hass-subpage.ts","webpack://home-assistant-frontend/./src/panels/config/cloud/account/cloud-account.ts","webpack://home-assistant-frontend/./src/panels/config/cloud/account/cloud-alexa-pref.ts","webpack://home-assistant-frontend/./src/panels/config/cloud/account/cloud-google-pref.ts","webpack://home-assistant-frontend/./src/panels/config/cloud/account/cloud-remote-pref.ts","webpack://home-assistant-frontend/./src/panels/config/cloud/account/cloud-tts-pref.ts","webpack://home-assistant-frontend/./src/panels/config/cloud/account/cloud-webhooks.ts","webpack://home-assistant-frontend/./src/panels/config/cloud/login/cloud-login.ts","webpack://home-assistant-frontend/./src/panels/config/ha-config-section.ts"],"sourcesContent":["import { css, CSSResultGroup, html, LitElement } from \"lit\";\nimport { property, query } from \"lit/decorators\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { HomeAssistant } from \"../../types\";\nimport \"./ha-progress-button\";\n\nclass HaCallApiButton extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property() public method: \"POST\" | \"GET\" | \"PUT\" | \"DELETE\" = \"POST\";\n\n  @property() public data = {};\n\n  @property({ type: Boolean, reflect: true }) public disabled = false;\n\n  @property({ type: Boolean }) public progress = false;\n\n  @property() public path?: string;\n\n  @query(\"ha-progress-button\", true) private _progressButton;\n\n  render() {\n    return html`\n      <ha-progress-button\n        .progress=${this.progress}\n        @click=${this._buttonTapped}\n        ?disabled=${this.disabled}\n        ><slot></slot\n      ></ha-progress-button>\n    `;\n  }\n\n  async _buttonTapped() {\n    this.progress = true;\n    const eventData: {\n      method: string;\n      path: string;\n      data: any;\n      success?: boolean;\n      response?: any;\n    } = {\n      method: this.method,\n      path: this.path!,\n      data: this.data,\n    };\n\n    try {\n      const resp = await this.hass.callApi(this.method, this.path!, this.data);\n      this.progress = false;\n      this._progressButton.actionSuccess();\n      eventData.success = true;\n      eventData.response = resp;\n    } catch (err: any) {\n      this.progress = false;\n      this._progressButton.actionError();\n      eventData.success = false;\n      eventData.response = err;\n    }\n\n    fireEvent(this, \"hass-api-called\", eventData as any);\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      :host([disabled]) {\n        pointer-events: none;\n      }\n    `;\n  }\n}\n\ncustomElements.define(\"ha-call-api-button\", HaCallApiButton);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-call-api-button\": HaCallApiButton;\n  }\n}\n","import \"@material/mwc-button\";\nimport { mdiAlertOctagram, mdiCheckBold } from \"@mdi/js\";\nimport { css, CSSResultGroup, html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport \"../ha-circular-progress\";\nimport \"../ha-svg-icon\";\n\n@customElement(\"ha-progress-button\")\nexport class HaProgressButton extends LitElement {\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public progress = false;\n\n  @property({ type: Boolean }) public raised = false;\n\n  @state() private _result?: \"success\" | \"error\";\n\n  public render(): TemplateResult {\n    const overlay = this._result || this.progress;\n    return html`\n      <mwc-button\n        ?raised=${this.raised}\n        .disabled=${this.disabled || this.progress}\n        @click=${this._buttonTapped}\n        class=${this._result || \"\"}\n      >\n        <slot></slot>\n      </mwc-button>\n      ${!overlay\n        ? \"\"\n        : html`\n            <div class=\"progress\">\n              ${this._result === \"success\"\n                ? html`<ha-svg-icon .path=${mdiCheckBold}></ha-svg-icon>`\n                : this._result === \"error\"\n                ? html`<ha-svg-icon .path=${mdiAlertOctagram}></ha-svg-icon>`\n                : this.progress\n                ? html`\n                    <ha-circular-progress\n                      size=\"small\"\n                      active\n                    ></ha-circular-progress>\n                  `\n                : \"\"}\n            </div>\n          `}\n    `;\n  }\n\n  public actionSuccess(): void {\n    this._setResult(\"success\");\n  }\n\n  public actionError(): void {\n    this._setResult(\"error\");\n  }\n\n  private _setResult(result: \"success\" | \"error\"): void {\n    this._result = result;\n    setTimeout(() => {\n      this._result = undefined;\n    }, 2000);\n  }\n\n  private _buttonTapped(ev: Event): void {\n    if (this.progress) {\n      ev.stopPropagation();\n    }\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      :host {\n        outline: none;\n        display: inline-block;\n        position: relative;\n      }\n\n      mwc-button {\n        transition: all 1s;\n      }\n\n      mwc-button.success {\n        --mdc-theme-primary: white;\n        background-color: var(--success-color);\n        transition: none;\n        border-radius: 4px;\n        pointer-events: none;\n      }\n\n      mwc-button[raised].success {\n        --mdc-theme-primary: var(--success-color);\n        --mdc-theme-on-primary: white;\n      }\n\n      mwc-button.error {\n        --mdc-theme-primary: white;\n        background-color: var(--error-color);\n        transition: none;\n        border-radius: 4px;\n        pointer-events: none;\n      }\n\n      mwc-button[raised].error {\n        --mdc-theme-primary: var(--error-color);\n        --mdc-theme-on-primary: white;\n      }\n\n      .progress {\n        bottom: 4px;\n        position: absolute;\n        text-align: center;\n        top: 4px;\n        width: 100%;\n      }\n\n      ha-svg-icon {\n        color: white;\n      }\n\n      mwc-button.success slot,\n      mwc-button.error slot {\n        visibility: hidden;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-progress-button\": HaProgressButton;\n  }\n}\n","import {\n  mdiAlertCircleOutline,\n  mdiAlertOutline,\n  mdiCheckboxMarkedCircleOutline,\n  mdiClose,\n  mdiInformationOutline,\n} from \"@mdi/js\";\nimport { css, html, LitElement } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport { classMap } from \"lit/directives/class-map\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport \"./ha-icon-button\";\nimport \"./ha-svg-icon\";\n\nconst ALERT_ICONS = {\n  info: mdiInformationOutline,\n  warning: mdiAlertOutline,\n  error: mdiAlertCircleOutline,\n  success: mdiCheckboxMarkedCircleOutline,\n};\n\ndeclare global {\n  interface HASSDomEvents {\n    \"alert-dismissed-clicked\": undefined;\n  }\n}\n\n@customElement(\"ha-alert\")\nclass HaAlert extends LitElement {\n  @property() public title = \"\";\n\n  @property({ attribute: \"alert-type\" }) public alertType:\n    | \"info\"\n    | \"warning\"\n    | \"error\"\n    | \"success\" = \"info\";\n\n  @property({ type: Boolean }) public dismissable = false;\n\n  @property({ type: Boolean }) public rtl = false;\n\n  public render() {\n    return html`\n      <div\n        class=\"issue-type ${classMap({\n          rtl: this.rtl,\n          [this.alertType]: true,\n        })}\"\n        role=\"alert\"\n      >\n        <div class=\"icon ${this.title ? \"\" : \"no-title\"}\">\n          <slot name=\"icon\">\n            <ha-svg-icon .path=${ALERT_ICONS[this.alertType]}></ha-svg-icon>\n          </slot>\n        </div>\n        <div class=\"content\">\n          <div class=\"main-content\">\n            ${this.title ? html`<div class=\"title\">${this.title}</div>` : \"\"}\n            <slot></slot>\n          </div>\n          <div class=\"action\">\n            <slot name=\"action\">\n              ${this.dismissable\n                ? html`<ha-icon-button\n                    @click=${this._dismiss_clicked}\n                    label=\"Dismiss alert\"\n                    .path=${mdiClose}\n                  ></ha-icon-button>`\n                : \"\"}\n            </slot>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  private _dismiss_clicked() {\n    fireEvent(this, \"alert-dismissed-clicked\");\n  }\n\n  static styles = css`\n    .issue-type {\n      position: relative;\n      padding: 8px;\n      display: flex;\n    }\n    .issue-type.rtl {\n      flex-direction: row-reverse;\n    }\n    .issue-type::after {\n      position: absolute;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      left: 0;\n      opacity: 0.12;\n      pointer-events: none;\n      content: \"\";\n      border-radius: 4px;\n    }\n    .icon {\n      z-index: 1;\n    }\n    .icon.no-title {\n      align-self: center;\n    }\n    .issue-type.rtl > .content {\n      flex-direction: row-reverse;\n      text-align: right;\n    }\n    .content {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      width: 100%;\n    }\n    .action {\n      z-index: 1;\n      width: min-content;\n      --mdc-theme-primary: var(--primary-text-color);\n    }\n    .main-content {\n      overflow-wrap: anywhere;\n      word-break: break-word;\n      margin-left: 8px;\n      margin-right: 0;\n    }\n    .issue-type.rtl > .content > .main-content {\n      margin-left: 0;\n      margin-right: 8px;\n    }\n    .title {\n      margin-top: 2px;\n      font-weight: bold;\n    }\n    .action mwc-button,\n    .action ha-icon-button {\n      --mdc-theme-primary: var(--primary-text-color);\n      --mdc-icon-button-size: 36px;\n    }\n    .issue-type.info > .icon {\n      color: var(--info-color);\n    }\n    .issue-type.info::after {\n      background-color: var(--info-color);\n    }\n\n    .issue-type.warning > .icon {\n      color: var(--warning-color);\n    }\n    .issue-type.warning::after {\n      background-color: var(--warning-color);\n    }\n\n    .issue-type.error > .icon {\n      color: var(--error-color);\n    }\n    .issue-type.error::after {\n      background-color: var(--error-color);\n    }\n\n    .issue-type.success > .icon {\n      color: var(--success-color);\n    }\n    .issue-type.success::after {\n      background-color: var(--success-color);\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-alert\": HaAlert;\n  }\n}\n","import \"@polymer/paper-item/paper-item-body\";\nimport { css, CSSResultGroup, html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\n\n@customElement(\"ha-settings-row\")\nexport class HaSettingsRow extends LitElement {\n  @property({ type: Boolean, reflect: true }) public narrow!: boolean;\n\n  @property({ type: Boolean, attribute: \"three-line\" })\n  public threeLine = false;\n\n  protected render(): TemplateResult {\n    return html`\n      <div class=\"prefix-wrap\">\n        <slot name=\"prefix\"></slot>\n        <paper-item-body\n          ?two-line=${!this.threeLine}\n          ?three-line=${this.threeLine}\n        >\n          <slot name=\"heading\"></slot>\n          <div secondary><slot name=\"description\"></slot></div>\n        </paper-item-body>\n      </div>\n      <div class=\"content\"><slot></slot></div>\n    `;\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      :host {\n        display: flex;\n        padding: 0 16px;\n        align-content: normal;\n        align-self: auto;\n        align-items: center;\n      }\n      paper-item-body {\n        padding: 8px 16px 8px 0;\n      }\n      paper-item-body[two-line] {\n        min-height: calc(\n          var(--paper-item-body-two-line-min-height, 72px) - 16px\n        );\n        flex: 1;\n      }\n      .content {\n        display: contents;\n      }\n      :host(:not([narrow])) .content {\n        display: var(--settings-row-content-display, flex);\n        justify-content: flex-end;\n        flex: 1;\n        padding: 16px 0;\n      }\n      .content ::slotted(*) {\n        width: var(--settings-row-content-width);\n      }\n      :host([narrow]) {\n        align-items: normal;\n        flex-direction: column;\n        border-top: 1px solid var(--divider-color);\n        padding-bottom: 8px;\n      }\n      ::slotted(ha-switch) {\n        padding: 16px 0;\n      }\n      div[secondary] {\n        white-space: normal;\n      }\n      .prefix-wrap {\n        display: var(--settings-row-prefix-display);\n      }\n      :host([narrow]) .prefix-wrap {\n        display: flex;\n        align-items: center;\n      }\n    `;\n  }\n}\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-settings-row\": HaSettingsRow;\n  }\n}\n","import { SwitchBase } from \"@material/mwc-switch/deprecated/mwc-switch-base\";\nimport { styles } from \"@material/mwc-switch/deprecated/mwc-switch.css\";\nimport { css } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport { forwardHaptic } from \"../data/haptics\";\n\n@customElement(\"ha-switch\")\nexport class HaSwitch extends SwitchBase {\n  // Generate a haptic vibration.\n  // Only set to true if the new value of the switch is applied right away when toggling.\n  // Do not add haptic when a user is required to press save.\n  @property({ type: Boolean }) public haptic = false;\n\n  protected firstUpdated() {\n    super.firstUpdated();\n    this.addEventListener(\"change\", () => {\n      if (this.haptic) {\n        forwardHaptic(\"light\");\n      }\n    });\n  }\n\n  static override styles = [\n    styles,\n    css`\n      :host {\n        --mdc-theme-secondary: var(--switch-checked-color);\n      }\n      .mdc-switch.mdc-switch--checked .mdc-switch__thumb {\n        background-color: var(--switch-checked-button-color);\n        border-color: var(--switch-checked-button-color);\n      }\n      .mdc-switch.mdc-switch--checked .mdc-switch__track {\n        background-color: var(--switch-checked-track-color);\n        border-color: var(--switch-checked-track-color);\n      }\n      .mdc-switch:not(.mdc-switch--checked) .mdc-switch__thumb {\n        background-color: var(--switch-unchecked-button-color);\n        border-color: var(--switch-unchecked-button-color);\n      }\n      .mdc-switch:not(.mdc-switch--checked) .mdc-switch__track {\n        background-color: var(--switch-unchecked-track-color);\n        border-color: var(--switch-unchecked-track-color);\n      }\n    `,\n  ];\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-switch\": HaSwitch;\n  }\n}\n","import {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { customElement, eventOptions, property } from \"lit/decorators\";\nimport { restoreScroll } from \"../common/decorators/restore-scroll\";\nimport { toggleAttribute } from \"../common/dom/toggle_attribute\";\nimport { computeRTL } from \"../common/util/compute_rtl\";\nimport \"../components/ha-icon-button-arrow-prev\";\nimport \"../components/ha-menu-button\";\nimport { HomeAssistant } from \"../types\";\n\n@customElement(\"hass-subpage\")\nclass HassSubpage extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property() public header?: string;\n\n  @property({ type: Boolean, attribute: \"main-page\" }) public mainPage = false;\n\n  @property({ type: String, attribute: \"back-path\" }) public backPath?: string;\n\n  @property() public backCallback?: () => void;\n\n  @property({ type: Boolean, reflect: true }) public narrow = false;\n\n  @property({ type: Boolean }) public supervisor = false;\n\n  // @ts-ignore\n  @restoreScroll(\".content\") private _savedScrollPos?: number;\n\n  protected willUpdate(changedProps: PropertyValues): void {\n    super.willUpdate(changedProps);\n    if (!changedProps.has(\"hass\")) {\n      return;\n    }\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (!oldHass || oldHass.locale !== this.hass.locale) {\n      toggleAttribute(this, \"rtl\", computeRTL(this.hass));\n    }\n  }\n\n  protected render(): TemplateResult {\n    return html`\n      <div class=\"toolbar\">\n        ${this.mainPage || history.state?.root\n          ? html`\n              <ha-menu-button\n                .hassio=${this.supervisor}\n                .hass=${this.hass}\n                .narrow=${this.narrow}\n              ></ha-menu-button>\n            `\n          : this.backPath\n          ? html`\n              <a href=${this.backPath}>\n                <ha-icon-button-arrow-prev\n                  .hass=${this.hass}\n                ></ha-icon-button-arrow-prev>\n              </a>\n            `\n          : html`\n              <ha-icon-button-arrow-prev\n                .hass=${this.hass}\n                @click=${this._backTapped}\n              ></ha-icon-button-arrow-prev>\n            `}\n\n        <div class=\"main-title\">${this.header}</div>\n        <slot name=\"toolbar-icon\"></slot>\n      </div>\n      <div class=\"content\" @scroll=${this._saveScrollPos}><slot></slot></div>\n      <div id=\"fab\">\n        <slot name=\"fab\"></slot>\n      </div>\n    `;\n  }\n\n  @eventOptions({ passive: true })\n  private _saveScrollPos(e: Event) {\n    this._savedScrollPos = (e.target as HTMLDivElement).scrollTop;\n  }\n\n  private _backTapped(): void {\n    if (this.backCallback) {\n      this.backCallback();\n      return;\n    }\n    history.back();\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      :host {\n        display: block;\n        height: 100%;\n        background-color: var(--primary-background-color);\n      }\n\n      :host([narrow]) {\n        width: 100%;\n        position: fixed;\n      }\n\n      .toolbar {\n        display: flex;\n        align-items: center;\n        font-size: 20px;\n        height: var(--header-height);\n        padding: 0 16px;\n        pointer-events: none;\n        background-color: var(--app-header-background-color);\n        font-weight: 400;\n        color: var(--app-header-text-color, white);\n        border-bottom: var(--app-header-border-bottom, none);\n        box-sizing: border-box;\n      }\n      .toolbar a {\n        color: var(--sidebar-text-color);\n        text-decoration: none;\n      }\n\n      ha-menu-button,\n      ha-icon-button-arrow-prev,\n      ::slotted([slot=\"toolbar-icon\"]) {\n        pointer-events: auto;\n        color: var(--sidebar-icon-color);\n      }\n\n      .main-title {\n        margin: 0 0 0 24px;\n        line-height: 20px;\n        flex-grow: 1;\n      }\n\n      .content {\n        position: relative;\n        width: 100%;\n        height: calc(100% - 1px - var(--header-height));\n        overflow-y: auto;\n        overflow: auto;\n        -webkit-overflow-scrolling: touch;\n      }\n\n      #fab {\n        position: fixed;\n        right: calc(16px + env(safe-area-inset-right));\n        bottom: calc(16px + env(safe-area-inset-bottom));\n        z-index: 1;\n      }\n      :host([narrow]) #fab.tabs {\n        bottom: calc(84px + env(safe-area-inset-bottom));\n      }\n      #fab[is-wide] {\n        bottom: 24px;\n        right: 24px;\n      }\n      :host([rtl]) #fab {\n        right: auto;\n        left: calc(16px + env(safe-area-inset-left));\n      }\n      :host([rtl][is-wide]) #fab {\n        bottom: 24px;\n        left: 24px;\n        right: auto;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hass-subpage\": HassSubpage;\n  }\n}\n","import \"@material/mwc-button\";\nimport \"@material/mwc-list/mwc-list-item\";\nimport \"@polymer/paper-item/paper-item-body\";\nimport { css, html, LitElement, PropertyValues } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { formatDateTime } from \"../../../../common/datetime/format_date_time\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\nimport { computeRTLDirection } from \"../../../../common/util/compute_rtl\";\nimport { debounce } from \"../../../../common/util/debounce\";\nimport \"../../../../components/buttons/ha-call-api-button\";\nimport \"../../../../components/ha-alert\";\nimport \"../../../../components/ha-card\";\nimport {\n  cloudLogout,\n  CloudStatusLoggedIn,\n  fetchCloudSubscriptionInfo,\n  SubscriptionInfo,\n} from \"../../../../data/cloud\";\nimport { showConfirmationDialog } from \"../../../../dialogs/generic/show-dialog-box\";\nimport \"../../../../layouts/hass-subpage\";\nimport { SubscribeMixin } from \"../../../../mixins/subscribe-mixin\";\nimport { haStyle } from \"../../../../resources/styles\";\nimport { HomeAssistant } from \"../../../../types\";\nimport \"../../ha-config-section\";\nimport \"./cloud-alexa-pref\";\nimport \"./cloud-google-pref\";\nimport \"./cloud-remote-pref\";\nimport \"./cloud-tts-pref\";\nimport \"./cloud-webhooks\";\n\n@customElement(\"cloud-account\")\nexport class CloudAccount extends SubscribeMixin(LitElement) {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ type: Boolean }) public isWide = false;\n\n  @property({ type: Boolean }) public narrow = false;\n\n  @property({ attribute: false }) public cloudStatus!: CloudStatusLoggedIn;\n\n  @state() private _subscription?: SubscriptionInfo;\n\n  @state() private _rtlDirection: \"rtl\" | \"ltr\" = \"rtl\";\n\n  protected render() {\n    return html`\n      <hass-subpage\n        .hass=${this.hass}\n        .narrow=${this.narrow}\n        header=\"Home Assistant Cloud\"\n      >\n        <div class=\"content\">\n          <ha-config-section .isWide=${this.isWide}>\n            <span slot=\"header\">Home Assistant Cloud</span>\n            <div slot=\"introduction\">\n              <p>\n                ${this.hass.localize(\n                  \"ui.panel.config.cloud.account.thank_you_note\"\n                )}\n              </p>\n            </div>\n\n            <ha-card\n              outlined\n              .header=${this.hass.localize(\n                \"ui.panel.config.cloud.account.nabu_casa_account\"\n              )}\n            >\n              <div class=\"account-row\">\n                <paper-item-body two-line>\n                  ${this.cloudStatus.email.replace(\n                    /(\\w{3})[\\w.-]+@([\\w.]+\\w)/,\n                    \"$1***@$2\"\n                  )}\n                  <div secondary class=\"wrap\">\n                    ${this._subscription\n                      ? this._subscription.human_description.replace(\n                          \"{periodEnd}\",\n                          this._subscription.plan_renewal_date\n                            ? formatDateTime(\n                                new Date(\n                                  this._subscription.plan_renewal_date * 1000\n                                ),\n                                this.hass.locale\n                              )\n                            : \"\"\n                        )\n                      : this.hass.localize(\n                          \"ui.panel.config.cloud.account.fetching_subscription\"\n                        )}\n                  </div>\n                </paper-item-body>\n              </div>\n\n              ${this.cloudStatus.cloud === \"connecting\" &&\n              this.cloudStatus.cloud_last_disconnect_reason\n                ? html`\n                    <ha-alert\n                      alert-type=\"warning\"\n                      .title=${this.cloudStatus.cloud_last_disconnect_reason\n                        .reason}\n                    ></ha-alert>\n                  `\n                : \"\"}\n\n              <div class=\"account-row\">\n                <paper-item-body>\n                  ${this.hass.localize(\n                    \"ui.panel.config.cloud.account.connection_status\"\n                  )}\n                </paper-item-body>\n                <div class=\"status\">\n                  ${this.cloudStatus.cloud === \"connected\"\n                    ? this.hass.localize(\n                        \"ui.panel.config.cloud.account.connected\"\n                      )\n                    : this.cloudStatus.cloud === \"disconnected\"\n                    ? this.hass.localize(\n                        \"ui.panel.config.cloud.account.not_connected\"\n                      )\n                    : this.hass.localize(\n                        \"ui.panel.config.cloud.account.connecting\"\n                      )}\n                </div>\n              </div>\n\n              <div class=\"card-actions\">\n                <a\n                  href=\"https://account.nabucasa.com\"\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                >\n                  <mwc-button>\n                    ${this.hass.localize(\n                      \"ui.panel.config.cloud.account.manage_account\"\n                    )}\n                  </mwc-button>\n                </a>\n                <mwc-button @click=${this._signOut} class=\"warning\">\n                  ${this.hass.localize(\n                    \"ui.panel.config.cloud.account.sign_out\"\n                  )}\n                </mwc-button>\n              </div>\n            </ha-card>\n          </ha-config-section>\n\n          <ha-config-section .isWide=${this.isWide}>\n            <span slot=\"header\"\n              >${this.hass.localize(\n                \"ui.panel.config.cloud.account.integrations\"\n              )}</span\n            >\n            <div slot=\"introduction\">\n              <p>\n                ${this.hass.localize(\n                  \"ui.panel.config.cloud.account.integrations_introduction\"\n                )}\n              </p>\n              <p>\n                ${this.hass.localize(\n                  \"ui.panel.config.cloud.account.integrations_introduction2\"\n                )}\n                <a\n                  href=\"https://www.nabucasa.com\"\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                >\n                  ${this.hass.localize(\n                    \"ui.panel.config.cloud.account.integrations_link_all_features\"\n                  )}</a\n                >.\n              </p>\n            </div>\n\n            <cloud-remote-pref\n              .hass=${this.hass}\n              .cloudStatus=${this.cloudStatus}\n              dir=${this._rtlDirection}\n            ></cloud-remote-pref>\n\n            <cloud-tts-pref\n              .hass=${this.hass}\n              .cloudStatus=${this.cloudStatus}\n              dir=${this._rtlDirection}\n            ></cloud-tts-pref>\n\n            <cloud-alexa-pref\n              .hass=${this.hass}\n              .cloudStatus=${this.cloudStatus}\n              dir=${this._rtlDirection}\n            ></cloud-alexa-pref>\n\n            <cloud-google-pref\n              .hass=${this.hass}\n              .cloudStatus=${this.cloudStatus}\n              dir=${this._rtlDirection}\n            ></cloud-google-pref>\n\n            <cloud-webhooks\n              .hass=${this.hass}\n              .narrow=${this.narrow}\n              .cloudStatus=${this.cloudStatus}\n              dir=${this._rtlDirection}\n            ></cloud-webhooks>\n          </ha-config-section>\n        </div>\n      </hass-subpage>\n    `;\n  }\n\n  firstUpdated() {\n    this._fetchSubscriptionInfo();\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    if (changedProps.has(\"hass\")) {\n      const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n      if (!oldHass || oldHass.locale !== this.hass.locale) {\n        this._rtlDirection = computeRTLDirection(this.hass);\n      }\n    }\n  }\n\n  protected override hassSubscribe() {\n    const googleCheck = debounce(\n      () => {\n        if (this.cloudStatus && !this.cloudStatus.google_registered) {\n          fireEvent(this, \"ha-refresh-cloud-status\");\n        }\n      },\n      10000,\n      true\n    );\n    return [\n      this.hass.connection.subscribeEvents(() => {\n        if (!this.cloudStatus?.alexa_registered) {\n          fireEvent(this, \"ha-refresh-cloud-status\");\n        }\n      }, \"alexa_smart_home\"),\n      this.hass.connection.subscribeEvents(\n        googleCheck,\n        \"google_assistant_command\"\n      ),\n      this.hass.connection.subscribeEvents(\n        googleCheck,\n        \"google_assistant_query\"\n      ),\n      this.hass.connection.subscribeEvents(\n        googleCheck,\n        \"google_assistant_sync\"\n      ),\n    ];\n  }\n\n  private async _fetchSubscriptionInfo() {\n    this._subscription = await fetchCloudSubscriptionInfo(this.hass);\n    if (\n      this._subscription.provider &&\n      this.cloudStatus &&\n      this.cloudStatus.cloud !== \"connected\"\n    ) {\n      fireEvent(this, \"ha-refresh-cloud-status\");\n    }\n  }\n\n  private async _signOut() {\n    showConfirmationDialog(this, {\n      text: this.hass.localize(\n        \"ui.panel.config.cloud.account.sign_out_confirm\"\n      ),\n      confirmText: this.hass!.localize(\"ui.common.yes\"),\n      dismissText: this.hass!.localize(\"ui.common.no\"),\n      confirm: () => this._logoutFromCloud(),\n    });\n  }\n\n  private async _logoutFromCloud() {\n    await cloudLogout(this.hass);\n    fireEvent(this, \"ha-refresh-cloud-status\");\n  }\n\n  _computeRTLDirection(hass) {\n    return computeRTLDirection(hass);\n  }\n\n  static get styles() {\n    return [\n      haStyle,\n      css`\n        [slot=\"introduction\"] {\n          margin: -1em 0;\n        }\n        [slot=\"introduction\"] a {\n          color: var(--primary-color);\n        }\n        .content {\n          padding-bottom: 24px;\n        }\n        .account-row {\n          display: flex;\n          padding: 0 16px;\n        }\n        .card-actions {\n          display: flex;\n          flex-direction: row-reverse;\n          justify-content: space-between;\n        }\n        mwc-button {\n          align-self: center;\n        }\n        .wrap {\n          white-space: normal;\n        }\n        .status {\n          text-transform: capitalize;\n          padding: 16px;\n        }\n      `,\n    ];\n  }\n}\n\ncustomElements.define(\"cloud-account\", CloudAccount);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"cloud-account\": CloudAccount;\n  }\n}\n","import \"@material/mwc-button\";\nimport { mdiHelpCircle } from \"@mdi/js\";\nimport { css, CSSResultGroup, html, LitElement, TemplateResult } from \"lit\";\nimport { property } from \"lit/decorators\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\nimport \"../../../../components/ha-alert\";\nimport \"../../../../components/ha-card\";\nimport \"../../../../components/ha-settings-row\";\nimport \"../../../../components/ha-switch\";\nimport type { HaSwitch } from \"../../../../components/ha-switch\";\nimport { CloudStatusLoggedIn, updateCloudPref } from \"../../../../data/cloud\";\nimport type { HomeAssistant } from \"../../../../types\";\n\nexport class CloudAlexaPref extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property() public cloudStatus?: CloudStatusLoggedIn;\n\n  protected render(): TemplateResult {\n    if (!this.cloudStatus) {\n      return html``;\n    }\n\n    const alexa_registered = this.cloudStatus.alexa_registered;\n    const { alexa_enabled, alexa_report_state } = this.cloudStatus!.prefs;\n\n    return html`\n      <ha-card\n        outlined\n        header=${this.hass!.localize(\n          \"ui.panel.config.cloud.account.alexa.title\"\n        )}\n      >\n        <div class=\"header-actions\">\n          <a\n            href=\"https://www.nabucasa.com/config/amazon_alexa/\"\n            target=\"_blank\"\n            rel=\"noreferrer\"\n            class=\"icon-link\"\n          >\n            <ha-icon-button\n              .label=${this.hass.localize(\n                \"ui.panel.config.cloud.account.alexa.link_learn_how_it_works\"\n              )}\n              .path=${mdiHelpCircle}\n            ></ha-icon-button>\n          </a>\n          <ha-switch\n            .checked=${alexa_enabled}\n            @change=${this._enabledToggleChanged}\n          ></ha-switch>\n        </div>\n        <div class=\"card-content\">\n          <p>\n            ${this.hass!.localize(\"ui.panel.config.cloud.account.alexa.info\")}\n          </p>\n          ${!alexa_enabled\n            ? \"\"\n            : !alexa_registered\n            ? html`\n                <ha-alert\n                  .title=${this.hass.localize(\n                    \"ui.panel.config.cloud.account.alexa.not_configured_title\"\n                  )}\n                >\n                  ${this.hass.localize(\n                    \"ui.panel.config.cloud.account.alexa.not_configured_text\"\n                  )}\n\n                  <ul>\n                    <li>\n                      <a\n                        href=\"https://skills-store.amazon.com/deeplink/dp/B0772J1QKB?deviceType=app\"\n                        target=\"_blank\"\n                        rel=\"noreferrer\"\n                      >\n                        ${this.hass!.localize(\n                          \"ui.panel.config.cloud.account.alexa.enable_ha_skill\"\n                        )}\n                      </a>\n                    </li>\n                    <li>\n                      <a\n                        href=\"https://www.nabucasa.com/config/amazon_alexa/\"\n                        target=\"_blank\"\n                        rel=\"noreferrer\"\n                      >\n                        ${this.hass!.localize(\n                          \"ui.panel.config.cloud.account.alexa.config_documentation\"\n                        )}\n                      </a>\n                    </li>\n                  </ul>\n                </ha-alert>\n              `\n            : html`\n                <ha-settings-row>\n                  <span slot=\"heading\">\n                    ${this.hass!.localize(\n                      \"ui.panel.config.cloud.account.alexa.enable_state_reporting\"\n                    )}\n                  </span>\n                  <span slot=\"description\">\n                    ${this.hass!.localize(\n                      \"ui.panel.config.cloud.account.alexa.info_state_reporting\"\n                    )}\n                  </span>\n                  <ha-switch\n                    .checked=${alexa_report_state}\n                    @change=${this._reportToggleChanged}\n                  ></ha-switch>\n                </ha-settings-row>\n              `}\n        </div>\n        <div class=\"card-actions\">\n          <a href=\"/config/cloud/alexa\">\n            <mwc-button\n              >${this.hass!.localize(\n                \"ui.panel.config.cloud.account.alexa.manage_entities\"\n              )}</mwc-button\n            >\n          </a>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  private async _enabledToggleChanged(ev) {\n    const toggle = ev.target as HaSwitch;\n    try {\n      await updateCloudPref(this.hass!, { alexa_enabled: toggle.checked! });\n      fireEvent(this, \"ha-refresh-cloud-status\");\n    } catch (err: any) {\n      toggle.checked = !toggle.checked;\n    }\n  }\n\n  private async _reportToggleChanged(ev) {\n    const toggle = ev.target as HaSwitch;\n    try {\n      await updateCloudPref(this.hass!, {\n        alexa_report_state: toggle.checked!,\n      });\n      fireEvent(this, \"ha-refresh-cloud-status\");\n    } catch (err: any) {\n      alert(\n        `${this.hass!.localize(\n          \"ui.panel.config.cloud.account.alexa.state_reporting_error\",\n          \"enable_disable\",\n          this.hass!.localize(\n            toggle.checked\n              ? \"ui.panel.config.cloud.account.alexa.enable\"\n              : \"ui.panel.config.cloud.account.alexa.disable\"\n          )\n        )} ${err.message}`\n      );\n      toggle.checked = !toggle.checked;\n    }\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      a {\n        color: var(--primary-color);\n      }\n      ha-settings-row {\n        padding: 0;\n      }\n      .header-actions {\n        position: absolute;\n        right: 24px;\n        top: 24px;\n        display: flex;\n        flex-direction: row;\n      }\n      :host([dir=\"rtl\"]) .header-actions {\n        right: auto;\n        left: 24px;\n      }\n      .header-actions .icon-link {\n        margin-top: -16px;\n        margin-inline-end: 8px;\n        margin-right: 8px;\n        direction: var(--direction);\n        color: var(--secondary-text-color);\n      }\n      .card-actions {\n        display: flex;\n      }\n      .card-actions a {\n        text-decoration: none;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"cloud-alexa-pref\": CloudAlexaPref;\n  }\n}\n\ncustomElements.define(\"cloud-alexa-pref\", CloudAlexaPref);\n","import \"@material/mwc-button\";\nimport { mdiHelpCircle } from \"@mdi/js\";\nimport { css, CSSResultGroup, html, LitElement, TemplateResult } from \"lit\";\nimport { property } from \"lit/decorators\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\nimport \"../../../../components/ha-alert\";\nimport \"../../../../components/ha-card\";\nimport \"../../../../components/ha-settings-row\";\nimport type { HaSwitch } from \"../../../../components/ha-switch\";\nimport \"../../../../components/ha-textfield\";\nimport type { HaTextField } from \"../../../../components/ha-textfield\";\nimport { CloudStatusLoggedIn, updateCloudPref } from \"../../../../data/cloud\";\nimport type { HomeAssistant } from \"../../../../types\";\nimport { showSaveSuccessToast } from \"../../../../util/toast-saved-success\";\n\nexport class CloudGooglePref extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ attribute: false }) public cloudStatus?: CloudStatusLoggedIn;\n\n  protected render(): TemplateResult {\n    if (!this.cloudStatus) {\n      return html``;\n    }\n\n    const google_registered = this.cloudStatus.google_registered;\n    const { google_enabled, google_report_state, google_secure_devices_pin } =\n      this.cloudStatus.prefs;\n\n    return html`\n      <ha-card\n        outlined\n        header=${this.hass.localize(\n          \"ui.panel.config.cloud.account.google.title\"\n        )}\n      >\n        <div class=\"header-actions\">\n          <a\n            href=\"https://www.nabucasa.com/config/google_assistant/\"\n            target=\"_blank\"\n            rel=\"noreferrer\"\n            class=\"icon-link\"\n          >\n            <ha-icon-button\n              .label=${this.hass.localize(\n                \"ui.panel.config.cloud.account.google.link_learn_how_it_works\"\n              )}\n              .path=${mdiHelpCircle}\n            ></ha-icon-button>\n          </a>\n          <ha-switch\n            .checked=${google_enabled}\n            @change=${this._enabledToggleChanged}\n          ></ha-switch>\n        </div>\n        <div class=\"card-content\">\n          <p>\n            ${this.hass.localize(\"ui.panel.config.cloud.account.google.info\")}\n          </p>\n          ${!google_enabled\n            ? \"\"\n            : !google_registered\n            ? html`\n                <ha-alert\n                  .title=${this.hass.localize(\n                    \"ui.panel.config.cloud.account.google.not_configured_title\"\n                  )}\n                >\n                  ${this.hass.localize(\n                    \"ui.panel.config.cloud.account.google.not_configured_text\"\n                  )}\n\n                  <ul>\n                    <li>\n                      <a\n                        href=\"https://assistant.google.com/services/a/uid/00000091fd5fb875?hl=en-US\"\n                        target=\"_blank\"\n                        rel=\"noreferrer\"\n                      >\n                        ${this.hass.localize(\n                          \"ui.panel.config.cloud.account.google.enable_ha_skill\"\n                        )}\n                      </a>\n                    </li>\n                    <li>\n                      <a\n                        href=\"https://www.nabucasa.com/config/google_assistant/\"\n                        target=\"_blank\"\n                        rel=\"noreferrer\"\n                      >\n                        ${this.hass.localize(\n                          \"ui.panel.config.cloud.account.google.config_documentation\"\n                        )}\n                      </a>\n                    </li>\n                  </ul>\n                </ha-alert>\n              `\n            : html`\n                ${this.cloudStatus.http_use_ssl\n                  ? html`\n                      <ha-alert\n                        alert-type=\"warning\"\n                        .title=${this.hass.localize(\n                          \"ui.panel.config.cloud.account.google.http_use_ssl_warning_title\"\n                        )}\n                      >\n                        ${this.hass.localize(\n                          \"ui.panel.config.cloud.account.google.http_use_ssl_warning_text\"\n                        )}\n                        <a\n                          href=\"https://www.nabucasa.com/config/google_assistant/#local-communication\"\n                          target=\"_blank\"\n                          rel=\"noreferrer\"\n                          >${this.hass.localize(\n                            \"ui.panel.config.common.learn_more\"\n                          )}</a\n                        >\n                      </ha-alert>\n                    `\n                  : \"\"}\n\n                <ha-settings-row>\n                  <span slot=\"heading\">\n                    ${this.hass!.localize(\n                      \"ui.panel.config.cloud.account.google.enable_state_reporting\"\n                    )}\n                  </span>\n                  <span slot=\"description\">\n                    ${this.hass!.localize(\n                      \"ui.panel.config.cloud.account.google.info_state_reporting\"\n                    )}\n                  </span>\n                  <ha-switch\n                    .checked=${google_report_state}\n                    @change=${this._reportToggleChanged}\n                  ></ha-switch>\n                </ha-settings-row>\n\n                <ha-settings-row>\n                  <span slot=\"heading\">\n                    ${this.hass.localize(\n                      \"ui.panel.config.cloud.account.google.security_devices\"\n                    )}\n                  </span>\n                  <span slot=\"description\">\n                    ${this.hass.localize(\n                      \"ui.panel.config.cloud.account.google.enter_pin_info\"\n                    )}\n                  </span>\n                </ha-settings-row>\n\n                <ha-textfield\n                  id=\"google_secure_devices_pin\"\n                  .label=${this.hass.localize(\n                    \"ui.panel.config.cloud.account.google.devices_pin\"\n                  )}\n                  .placeholder=${this.hass.localize(\n                    \"ui.panel.config.cloud.account.google.enter_pin_hint\"\n                  )}\n                  .value=${google_secure_devices_pin || \"\"}\n                  @change=${this._pinChanged}\n                ></ha-textfield>\n              `}\n        </div>\n        <div class=\"card-actions\">\n          <a href=\"/config/cloud/google-assistant\">\n            <mwc-button>\n              ${this.hass.localize(\n                \"ui.panel.config.cloud.account.google.manage_entities\"\n              )}\n            </mwc-button>\n          </a>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  private async _enabledToggleChanged(ev) {\n    const toggle = ev.target as HaSwitch;\n    try {\n      await updateCloudPref(this.hass, { google_enabled: toggle.checked! });\n      fireEvent(this, \"ha-refresh-cloud-status\");\n    } catch (err: any) {\n      toggle.checked = !toggle.checked;\n    }\n  }\n\n  private async _reportToggleChanged(ev) {\n    const toggle = ev.target as HaSwitch;\n    try {\n      await updateCloudPref(this.hass, {\n        google_report_state: toggle.checked!,\n      });\n      fireEvent(this, \"ha-refresh-cloud-status\");\n    } catch (err: any) {\n      alert(\n        `Unable to ${toggle.checked ? \"enable\" : \"disable\"} report state. ${\n          err.message\n        }`\n      );\n      toggle.checked = !toggle.checked;\n    }\n  }\n\n  private async _pinChanged(ev) {\n    const input = ev.target as HaTextField;\n    try {\n      await updateCloudPref(this.hass, {\n        [input.id]: input.value || null,\n      });\n      showSaveSuccessToast(this, this.hass);\n      fireEvent(this, \"ha-refresh-cloud-status\");\n    } catch (err: any) {\n      alert(\n        `${this.hass.localize(\n          \"ui.panel.config.cloud.account.google.enter_pin_error\"\n        )} ${err.message}`\n      );\n      input.value = this.cloudStatus!.prefs.google_secure_devices_pin || \"\";\n    }\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      a {\n        color: var(--primary-color);\n      }\n      .header-actions {\n        position: absolute;\n        right: 24px;\n        top: 24px;\n        display: flex;\n        flex-direction: row;\n      }\n      :host([dir=\"rtl\"]) .header-actions {\n        right: auto;\n        left: 24px;\n      }\n      .header-actions .icon-link {\n        margin-top: -16px;\n        margin-inline-end: 8px;\n        margin-right: 8px;\n        direction: var(--direction);\n        color: var(--secondary-text-color);\n      }\n      ha-settings-row {\n        padding: 0;\n      }\n      ha-textfield {\n        width: 250px;\n        display: block;\n        margin-top: 8px;\n      }\n      .card-actions {\n        display: flex;\n      }\n      .card-actions a {\n        text-decoration: none;\n      }\n      .warning {\n        color: var(--error-color);\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"cloud-google-pref\": CloudGooglePref;\n  }\n}\n\ncustomElements.define(\"cloud-google-pref\", CloudGooglePref);\n","import \"@material/mwc-button\";\nimport { mdiContentCopy, mdiHelpCircle } from \"@mdi/js\";\nimport { css, CSSResultGroup, html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\nimport { copyToClipboard } from \"../../../../common/util/copy-clipboard\";\nimport \"../../../../components/ha-alert\";\nimport \"../../../../components/ha-card\";\nimport \"../../../../components/ha-switch\";\n// eslint-disable-next-line\nimport type { HaSwitch } from \"../../../../components/ha-switch\";\nimport {\n  CloudStatusLoggedIn,\n  connectCloudRemote,\n  disconnectCloudRemote,\n} from \"../../../../data/cloud\";\nimport type { HomeAssistant } from \"../../../../types\";\nimport { showToast } from \"../../../../util/toast\";\nimport { showCloudCertificateDialog } from \"../dialog-cloud-certificate/show-dialog-cloud-certificate\";\n\n@customElement(\"cloud-remote-pref\")\nexport class CloudRemotePref extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property() public cloudStatus?: CloudStatusLoggedIn;\n\n  protected render(): TemplateResult {\n    if (!this.cloudStatus) {\n      return html``;\n    }\n\n    const { remote_enabled } = this.cloudStatus.prefs;\n\n    const { remote_connected, remote_domain, remote_certificate } =\n      this.cloudStatus;\n\n    if (!remote_certificate) {\n      return html`\n        <ha-card\n          outlined\n          header=${this.hass.localize(\n            \"ui.panel.config.cloud.account.remote.title\"\n          )}\n        >\n          <div class=\"preparing\">\n            ${this.hass.localize(\n              \"ui.panel.config.cloud.account.remote.access_is_being_prepared\"\n            )}\n          </div>\n        </ha-card>\n      `;\n    }\n\n    return html`\n      <ha-card\n        outlined\n        header=${this.hass.localize(\n          \"ui.panel.config.cloud.account.remote.title\"\n        )}\n      >\n        <div class=\"header-actions\">\n          <a\n            href=\"https://www.nabucasa.com/config/remote/\"\n            target=\"_blank\"\n            rel=\"noreferrer\"\n            class=\"icon-link\"\n          >\n            <ha-icon-button\n              .label=${this.hass.localize(\n                \"ui.panel.config.cloud.account.remote.link_learn_how_it_works\"\n              )}\n              .path=${mdiHelpCircle}\n            ></ha-icon-button>\n          </a>\n          <ha-switch\n            .checked=${remote_enabled}\n            @change=${this._toggleChanged}\n          ></ha-switch>\n        </div>\n\n        <div class=\"card-content\">\n          ${!remote_connected && remote_enabled\n            ? html`\n                <ha-alert\n                  .title=${this.hass.localize(\n                    `ui.panel.config.cloud.account.remote.reconnecting`\n                  )}\n                ></ha-alert>\n              `\n            : \"\"}\n          ${this.hass.localize(\"ui.panel.config.cloud.account.remote.info\")}\n          ${this.hass.localize(\n            `ui.panel.config.cloud.account.remote.${\n              remote_connected\n                ? \"instance_is_available\"\n                : \"instance_will_be_available\"\n            }`\n          )}\n          <a\n            href=\"https://${remote_domain}\"\n            target=\"_blank\"\n            class=\"break-word\"\n            rel=\"noreferrer\"\n            >${this.hass.localize(\n              \"ui.panel.config.cloud.account.remote.nabu_casa_url\"\n            )}</a\n          >.\n          <ha-svg-icon\n            .url=${`https://${remote_domain}`}\n            .path=${mdiContentCopy}\n            @click=${this._copyURL}\n          ></ha-svg-icon>\n        </div>\n        <div class=\"card-actions\">\n          <mwc-button @click=${this._openCertInfo}>\n            ${this.hass.localize(\n              \"ui.panel.config.cloud.account.remote.certificate_info\"\n            )}\n          </mwc-button>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  private _openCertInfo() {\n    showCloudCertificateDialog(this, {\n      certificateInfo: this.cloudStatus!.remote_certificate!,\n    });\n  }\n\n  private async _toggleChanged(ev) {\n    const toggle = ev.target as HaSwitch;\n\n    try {\n      if (toggle.checked) {\n        await connectCloudRemote(this.hass);\n      } else {\n        await disconnectCloudRemote(this.hass);\n      }\n      fireEvent(this, \"ha-refresh-cloud-status\");\n    } catch (err: any) {\n      alert(err.message);\n      toggle.checked = !toggle.checked;\n    }\n  }\n\n  private async _copyURL(ev): Promise<void> {\n    const url = ev.currentTarget.url;\n    await copyToClipboard(url);\n    showToast(this, {\n      message: this.hass.localize(\"ui.common.copied_clipboard\"),\n    });\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      .preparing {\n        padding: 0 16px 16px;\n      }\n      a {\n        color: var(--primary-color);\n      }\n      .header-actions {\n        position: absolute;\n        right: 24px;\n        top: 24px;\n        display: flex;\n        flex-direction: row;\n      }\n      :host([dir=\"rtl\"]) .header-actions {\n        right: auto;\n        left: 24px;\n      }\n      .header-actions .icon-link {\n        margin-top: -16px;\n        margin-inline-end: 8px;\n        margin-right: 8px;\n        direction: var(--direction);\n        color: var(--secondary-text-color);\n      }\n      .warning {\n        font-weight: bold;\n        margin-bottom: 1em;\n      }\n      .break-word {\n        overflow-wrap: break-word;\n      }\n      .connection-status {\n        position: absolute;\n        right: 24px;\n        top: 24px;\n      }\n      .card-actions {\n        display: flex;\n      }\n      .card-actions a {\n        text-decoration: none;\n      }\n      ha-svg-icon {\n        --mdc-icon-size: 18px;\n        color: var(--secondary-text-color);\n        cursor: pointer;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"cloud-remote-pref\": CloudRemotePref;\n  }\n}\n","import \"@material/mwc-button\";\nimport \"@material/mwc-list/mwc-list-item\";\nimport { css, CSSResultGroup, html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport memoizeOne from \"memoize-one\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\nimport \"../../../../components/ha-card\";\nimport \"../../../../components/ha-select\";\nimport \"../../../../components/ha-svg-icon\";\nimport \"../../../../components/ha-switch\";\nimport { CloudStatusLoggedIn, updateCloudPref } from \"../../../../data/cloud\";\nimport {\n  CloudTTSInfo,\n  getCloudTTSInfo,\n  getCloudTtsLanguages,\n  getCloudTtsSupportedGenders,\n} from \"../../../../data/cloud/tts\";\nimport { showAlertDialog } from \"../../../../dialogs/generic/show-dialog-box\";\nimport type { HomeAssistant } from \"../../../../types\";\nimport { showTryTtsDialog } from \"./show-dialog-cloud-tts-try\";\n\n@customElement(\"cloud-tts-pref\")\nexport class CloudTTSPref extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property() public cloudStatus?: CloudStatusLoggedIn;\n\n  @state() private savingPreferences = false;\n\n  @state() private ttsInfo?: CloudTTSInfo;\n\n  protected render(): TemplateResult {\n    if (!this.cloudStatus || !this.ttsInfo) {\n      return html``;\n    }\n\n    const languages = this.getLanguages(this.ttsInfo);\n    const defaultVoice = this.cloudStatus.prefs.tts_default_voice;\n    const genders = this.getSupportedGenders(\n      defaultVoice[0],\n      this.ttsInfo,\n      this.hass.localize\n    );\n\n    return html`\n      <ha-card\n        outlined\n        header=${this.hass.localize(\"ui.panel.config.cloud.account.tts.title\")}\n      >\n        <div class=\"card-content\">\n          ${this.hass.localize(\n            \"ui.panel.config.cloud.account.tts.info\",\n            \"service\",\n            '\"tts.cloud_say\"'\n          )}\n          <br /><br />\n\n          <ha-select\n            .label=${this.hass.localize(\n              \"ui.panel.config.cloud.account.tts.default_language\"\n            )}\n            .disabled=${this.savingPreferences}\n            .value=${defaultVoice[0]}\n            @selected=${this._handleLanguageChange}\n          >\n            ${languages.map(\n              ([key, label]) =>\n                html`<mwc-list-item .value=${key}>${label}</mwc-list-item>`\n            )}\n          </ha-select>\n\n          <ha-select\n            .label=${this.hass.localize(\n              \"ui.panel.config.cloud.account.tts.default_gender\"\n            )}\n            .disabled=${this.savingPreferences}\n            .value=${defaultVoice[1]}\n            @selected=${this._handleGenderChange}\n          >\n            ${genders.map(\n              ([key, label]) =>\n                html`<mwc-list-item .value=${key}>${label}</mwc-list-item>`\n            )}\n          </ha-select>\n        </div>\n        <div class=\"card-actions\">\n          <mwc-button @click=${this._openTryDialog}>\n            ${this.hass.localize(\"ui.panel.config.cloud.account.tts.try\")}\n          </mwc-button>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected willUpdate(changedProps) {\n    super.willUpdate(changedProps);\n    if (!this.hasUpdated) {\n      getCloudTTSInfo(this.hass).then((info) => {\n        this.ttsInfo = info;\n      });\n    }\n    if (changedProps.has(\"cloudStatus\")) {\n      this.savingPreferences = false;\n    }\n  }\n\n  private getLanguages = memoizeOne(getCloudTtsLanguages);\n\n  private getSupportedGenders = memoizeOne(getCloudTtsSupportedGenders);\n\n  private _openTryDialog() {\n    showTryTtsDialog(this, {\n      defaultVoice: this.cloudStatus!.prefs.tts_default_voice,\n    });\n  }\n\n  async _handleLanguageChange(ev) {\n    if (ev.target.value === this.cloudStatus!.prefs.tts_default_voice[0]) {\n      return;\n    }\n    this.savingPreferences = true;\n    const language = ev.target.value;\n\n    const curGender = this.cloudStatus!.prefs.tts_default_voice[1];\n    const genders = this.getSupportedGenders(\n      language,\n      this.ttsInfo,\n      this.hass.localize\n    );\n    const newGender = genders.find((item) => item[0] === curGender)\n      ? curGender\n      : genders[0][0];\n\n    try {\n      await updateCloudPref(this.hass, {\n        tts_default_voice: [language, newGender],\n      });\n      fireEvent(this, \"ha-refresh-cloud-status\");\n    } catch (err: any) {\n      this.savingPreferences = false;\n      // eslint-disable-next-line no-console\n      console.error(err);\n      showAlertDialog(this, {\n        text: `Unable to save default language. ${err}`,\n        warning: true,\n      });\n    }\n  }\n\n  async _handleGenderChange(ev) {\n    if (ev.target.value === this.cloudStatus!.prefs.tts_default_voice[1]) {\n      return;\n    }\n    this.savingPreferences = true;\n    const language = this.cloudStatus!.prefs.tts_default_voice[0];\n    const gender = ev.target.value;\n\n    try {\n      await updateCloudPref(this.hass, {\n        tts_default_voice: [language, gender],\n      });\n      fireEvent(this, \"ha-refresh-cloud-status\");\n    } catch (err: any) {\n      this.savingPreferences = false;\n      // eslint-disable-next-line no-console\n      console.error(err);\n      showAlertDialog(this, {\n        text: `Unable to save default gender. ${err}`,\n        warning: true,\n      });\n    }\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      a {\n        color: var(--primary-color);\n      }\n      .example {\n        position: absolute;\n        right: 16px;\n        top: 16px;\n      }\n      :host([dir=\"rtl\"]) .example {\n        right: auto;\n        left: 24px;\n      }\n      .card-actions {\n        display: flex;\n        flex-direction: row-reverse;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"cloud-tts-pref\": CloudTTSPref;\n  }\n}\n","import { css, CSSResultGroup, html, LitElement, PropertyValues } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { isComponentLoaded } from \"../../../../common/config/is_component_loaded\";\nimport \"../../../../components/ha-card\";\nimport \"../../../../components/ha-circular-progress\";\nimport \"../../../../components/ha-settings-row\";\nimport \"../../../../components/ha-switch\";\nimport {\n  CloudStatusLoggedIn,\n  CloudWebhook,\n  createCloudhook,\n  deleteCloudhook,\n} from \"../../../../data/cloud\";\nimport { fetchWebhooks, Webhook, WebhookError } from \"../../../../data/webhook\";\nimport { haStyle } from \"../../../../resources/styles\";\nimport { HomeAssistant } from \"../../../../types\";\nimport { showManageCloudhookDialog } from \"../dialog-manage-cloudhook/show-dialog-manage-cloudhook\";\n\n@customElement(\"cloud-webhooks\")\nexport class CloudWebhooks extends LitElement {\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @property({ attribute: false }) public cloudStatus?: CloudStatusLoggedIn;\n\n  @property({ type: Boolean }) public narrow!: boolean;\n\n  @state() private _cloudHooks?: {\n    [webhookId: string]: CloudWebhook;\n  };\n\n  @state() private _localHooks?: Webhook[];\n\n  @state() private _progress: string[] = [];\n\n  public connectedCallback() {\n    super.connectedCallback();\n    this._fetchData();\n  }\n\n  protected render() {\n    return html`\n      <ha-card\n        outlined\n        header=${this.hass!.localize(\n          \"ui.panel.config.cloud.account.webhooks.title\"\n        )}\n      >\n        <div class=\"card-content\">\n          ${this.hass!.localize(\"ui.panel.config.cloud.account.webhooks.info\")}\n          ${!this.cloudStatus ||\n          !this._localHooks ||\n          !this._cloudHooks ||\n          !this.hass\n            ? html`\n                <div class=\"body-text\">\n                  ${this.hass!.localize(\n                    \"ui.panel.config.cloud.account.webhooks.loading\"\n                  )}\n                </div>\n              `\n            : this._localHooks.length === 0\n            ? html`\n                <div class=\"body-text\">\n                  ${this.hass.localize(\n                    \"ui.panel.config.cloud.account.webhooks.no_hooks_yet\"\n                  )}\n                  <a href=\"/config/integrations\"\n                    >${this.hass.localize(\n                      \"ui.panel.config.cloud.account.webhooks.no_hooks_yet_link_integration\"\n                    )}\n                  </a>\n                  ${this.hass.localize(\n                    \"ui.panel.config.cloud.account.webhooks.no_hooks_yet2\"\n                  )}\n                  <a href=\"/config/automation/new\"\n                    >${this.hass.localize(\n                      \"ui.panel.config.cloud.account.webhooks.no_hooks_yet_link_automation\"\n                    )}</a\n                  >.\n                </div>\n              `\n            : this._localHooks.map(\n                (entry) => html`\n                  <ha-settings-row .narrow=${this.narrow} .entry=${entry}>\n                    <span slot=\"heading\">\n                      ${entry.name}\n                      ${entry.domain !== entry.name.toLowerCase()\n                        ? ` (${entry.domain})`\n                        : \"\"}\n                    </span>\n                    <span slot=\"description\">${entry.webhook_id}</span>\n                    ${this._progress.includes(entry.webhook_id)\n                      ? html`\n                          <div class=\"progress\">\n                            <ha-circular-progress active></ha-circular-progress>\n                          </div>\n                        `\n                      : this._cloudHooks![entry.webhook_id]\n                      ? html`\n                          <mwc-button @click=${this._handleManageButton}>\n                            ${this.hass!.localize(\n                              \"ui.panel.config.cloud.account.webhooks.manage\"\n                            )}\n                          </mwc-button>\n                        `\n                      : html`<ha-switch @click=${this._enableWebhook}>\n                        </ha-switch>`}\n                  </ha-settings-row>\n                `\n              )}\n          <div class=\"footer\">\n            <a\n              href=\"https://www.nabucasa.com/config/webhooks\"\n              target=\"_blank\"\n              rel=\"noreferrer\"\n            >\n              ${this.hass!.localize(\n                \"ui.panel.config.cloud.account.webhooks.link_learn_more\"\n              )}\n            </a>\n          </div>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    super.updated(changedProps);\n    if (changedProps.has(\"cloudStatus\") && this.cloudStatus) {\n      this._cloudHooks = this.cloudStatus.prefs.cloudhooks || {};\n    }\n  }\n\n  private _showDialog(webhookId: string) {\n    const webhook = this._localHooks!.find(\n      (ent) => ent.webhook_id === webhookId\n    )!;\n    const cloudhook = this._cloudHooks![webhookId];\n    showManageCloudhookDialog(this, {\n      webhook,\n      cloudhook,\n      disableHook: () => this._disableWebhook(webhookId),\n    });\n  }\n\n  private _handleManageButton(ev: MouseEvent) {\n    const entry = (ev.currentTarget as any).parentElement.entry as Webhook;\n    this._showDialog(entry.webhook_id);\n  }\n\n  private async _enableWebhook(ev: MouseEvent) {\n    const entry = (ev.currentTarget as any).parentElement!.entry as Webhook;\n    this._progress = [...this._progress, entry.webhook_id];\n    let updatedWebhook;\n\n    try {\n      updatedWebhook = await createCloudhook(this.hass!, entry.webhook_id);\n    } catch (err: any) {\n      alert((err as WebhookError).message);\n      return;\n    } finally {\n      this._progress = this._progress.filter((wid) => wid !== entry.webhook_id);\n    }\n\n    this._cloudHooks = {\n      ...this._cloudHooks,\n      [entry.webhook_id]: updatedWebhook,\n    };\n\n    // Only open dialog if we're not also enabling others, otherwise it's confusing\n    if (this._progress.length === 0) {\n      this._showDialog(entry.webhook_id);\n    }\n  }\n\n  private async _disableWebhook(webhookId: string) {\n    this._progress = [...this._progress, webhookId];\n    try {\n      await deleteCloudhook(this.hass!, webhookId!);\n    } catch (err: any) {\n      alert(\n        `${this.hass!.localize(\n          \"ui.panel.config.cloud.account.webhooks.disable_hook_error_msg\"\n        )} ${(err as WebhookError).message}`\n      );\n      return;\n    } finally {\n      this._progress = this._progress.filter((wid) => wid !== webhookId);\n    }\n\n    // Remove cloud related parts from entry.\n    const { [webhookId]: disabledHook, ...newHooks } = this._cloudHooks!;\n    this._cloudHooks = newHooks;\n  }\n\n  private async _fetchData() {\n    if (!isComponentLoaded(this.hass!, \"webhook\")) {\n      this._localHooks = [];\n      return;\n    }\n    const hooks = await fetchWebhooks(this.hass!);\n    this._localHooks = hooks.filter(\n      (hook) =>\n        // Only hooks that are not limited to local requests are relevant\n        !hook.local_only &&\n        // Deleted webhooks -> nobody cares :)\n        (hook.domain !== \"mobile_app\" || hook.name !== \"Deleted Webhook\")\n    );\n  }\n\n  static get styles(): CSSResultGroup {\n    return [\n      haStyle,\n      css`\n        .body-text {\n          padding: 8px 0;\n        }\n        .webhook {\n          display: flex;\n          padding: 4px 0;\n        }\n        .progress {\n          margin-right: 16px;\n          display: flex;\n          flex-direction: column;\n          justify-content: center;\n        }\n        .footer {\n          padding-top: 16px;\n        }\n        .body-text a,\n        .footer a {\n          color: var(--primary-color);\n        }\n        ha-settings-row {\n          padding: 0;\n        }\n      `,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"cloud-webhooks\": CloudWebhooks;\n  }\n}\n","import \"@material/mwc-button\";\nimport \"@polymer/paper-item/paper-item\";\nimport \"@polymer/paper-item/paper-item-body\";\nimport { css, html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\nimport { navigate } from \"../../../../common/navigate\";\nimport \"../../../../components/buttons/ha-progress-button\";\nimport \"../../../../components/ha-alert\";\nimport \"../../../../components/ha-card\";\nimport \"../../../../components/ha-icon-next\";\nimport type { HaTextField } from \"../../../../components/ha-textfield\";\nimport \"../../../../components/ha-textfield\";\nimport { cloudLogin } from \"../../../../data/cloud\";\nimport { showAlertDialog } from \"../../../../dialogs/generic/show-dialog-box\";\nimport \"../../../../layouts/hass-subpage\";\nimport { haStyle } from \"../../../../resources/styles\";\nimport \"../../../../styles/polymer-ha-style\";\nimport { HomeAssistant } from \"../../../../types\";\nimport \"../../ha-config-section\";\n\n@customElement(\"cloud-login\")\nexport class CloudLogin extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ type: Boolean }) public isWide = false;\n\n  @property({ type: Boolean }) public narrow = false;\n\n  @property() public email?: string;\n\n  @property() public flashMessage?: string;\n\n  @state() private _password?: string;\n\n  @state() private _requestInProgress = false;\n\n  @state() private _error?: string;\n\n  @query(\"#email\", true) private _emailField!: HaTextField;\n\n  @query(\"#password\", true) private _passwordField!: HaTextField;\n\n  protected render(): TemplateResult {\n    return html`\n      <hass-subpage\n        .hass=${this.hass}\n        .narrow=${this.narrow}\n        header=\"Home Assistant Cloud\"\n      >\n        <div class=\"content\">\n          <ha-config-section .isWide=${this.isWide}>\n            <span slot=\"header\">Home Assistant Cloud</span>\n            <div slot=\"introduction\">\n              <p>\n                ${this.hass.localize(\n                  \"ui.panel.config.cloud.login.introduction\"\n                )}\n              </p>\n              <p>\n                ${this.hass.localize(\n                  \"ui.panel.config.cloud.login.introduction2\"\n                )}\n                <a\n                  href=\"https://www.nabucasa.com\"\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                >\n                  Nabu&nbsp;Casa,&nbsp;Inc</a\n                >${this.hass.localize(\n                  \"ui.panel.config.cloud.login.introduction2a\"\n                )}\n              </p>\n              <p>\n                ${this.hass.localize(\n                  \"ui.panel.config.cloud.login.introduction3\"\n                )}\n              </p>\n              <p>\n                <a\n                  href=\"https://www.nabucasa.com\"\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                >\n                  ${this.hass.localize(\n                    \"ui.panel.config.cloud.login.learn_more_link\"\n                  )}\n                </a>\n              </p>\n            </div>\n\n            ${this.flashMessage\n              ? html`<ha-alert\n                  dismissable\n                  @alert-dismissed-clicked=${this._dismissFlash}\n                >\n                  ${this.flashMessage}\n                </ha-alert>`\n              : \"\"}\n\n            <ha-card\n              outlined\n              .header=${this.hass.localize(\n                \"ui.panel.config.cloud.login.sign_in\"\n              )}\n            >\n              <div class=\"card-content login-form\">\n                ${this._error\n                  ? html`<ha-alert alert-type=\"error\">${this._error}</ha-alert>`\n                  : \"\"}\n                <ha-textfield\n                  .label=${this.hass.localize(\n                    \"ui.panel.config.cloud.login.email\"\n                  )}\n                  id=\"email\"\n                  type=\"email\"\n                  autocomplete=\"username\"\n                  required\n                  .value=${this.email}\n                  @keydown=${this._keyDown}\n                  .disabled=${this._requestInProgress}\n                  .validationMessage=${this.hass.localize(\n                    \"ui.panel.config.cloud.login.email_error_msg\"\n                  )}\n                ></ha-textfield>\n                <ha-textfield\n                  id=\"password\"\n                  .label=${this.hass.localize(\n                    \"ui.panel.config.cloud.login.password\"\n                  )}\n                  .value=${this._password || \"\"}\n                  type=\"password\"\n                  autocomplete=\"current-password\"\n                  required\n                  minlength=\"8\"\n                  @keydown=${this._keyDown}\n                  .disabled=${this._requestInProgress}\n                  .validationMessage=${this.hass.localize(\n                    \"ui.panel.config.cloud.login.password_error_msg\"\n                  )}\n                ></ha-textfield>\n                <button\n                  class=\"link pwd-forgot-link\"\n                  .disabled=${this._requestInProgress}\n                  @click=${this._handleForgotPassword}\n                >\n                  ${this.hass.localize(\n                    \"ui.panel.config.cloud.login.forgot_password\"\n                  )}\n                </button>\n              </div>\n              <div class=\"card-actions\">\n                <ha-progress-button\n                  @click=${this._handleLogin}\n                  .progress=${this._requestInProgress}\n                  >${this.hass.localize(\n                    \"ui.panel.config.cloud.login.sign_in\"\n                  )}</ha-progress-button\n                >\n              </div>\n            </ha-card>\n\n            <ha-card outlined>\n              <paper-item @click=${this._handleRegister}>\n                <paper-item-body two-line>\n                  ${this.hass.localize(\n                    \"ui.panel.config.cloud.login.start_trial\"\n                  )}\n                  <div secondary>\n                    ${this.hass.localize(\n                      \"ui.panel.config.cloud.login.trial_info\"\n                    )}\n                  </div>\n                </paper-item-body>\n                <ha-icon-next></ha-icon-next>\n              </paper-item>\n            </ha-card>\n          </ha-config-section>\n        </div>\n      </hass-subpage>\n    `;\n  }\n\n  private _keyDown(ev: KeyboardEvent) {\n    if (ev.key === \"Enter\") {\n      this._handleLogin();\n    }\n  }\n\n  private async _handleLogin() {\n    const emailField = this._emailField;\n    const passwordField = this._passwordField;\n\n    const email = emailField.value;\n    const password = passwordField.value;\n\n    if (!emailField.reportValidity()) {\n      passwordField.reportValidity();\n      emailField.focus();\n      return;\n    }\n\n    if (!passwordField.reportValidity()) {\n      passwordField.focus();\n      return;\n    }\n\n    this._requestInProgress = true;\n\n    try {\n      await cloudLogin(this.hass, email, password);\n      fireEvent(this, \"ha-refresh-cloud-status\");\n      this.email = \"\";\n      this._password = \"\";\n    } catch (err: any) {\n      const errCode = err && err.body && err.body.code;\n      if (errCode === \"PasswordChangeRequired\") {\n        showAlertDialog(this, {\n          title: this.hass.localize(\n            \"ui.panel.config.cloud.login.alert_password_change_required\"\n          ),\n        });\n        navigate(\"/config/cloud/forgot-password\");\n        return;\n      }\n\n      this._password = \"\";\n      this._requestInProgress = false;\n\n      if (errCode === \"UserNotConfirmed\") {\n        this._error = this.hass.localize(\n          \"ui.panel.config.cloud.login.alert_email_confirm_necessary\"\n        );\n      } else {\n        this._error =\n          err && err.body && err.body.message\n            ? err.body.message\n            : \"Unknown error\";\n      }\n\n      emailField.focus();\n    }\n  }\n\n  private _handleRegister() {\n    this._dismissFlash();\n    // @ts-ignore\n    fireEvent(this, \"email-changed\", { value: this._emailField.value });\n    navigate(\"/config/cloud/register\");\n  }\n\n  private _handleForgotPassword() {\n    this._dismissFlash();\n    // @ts-ignore\n    fireEvent(this, \"email-changed\", { value: this._emailField.value });\n    navigate(\"/config/cloud/forgot-password\");\n  }\n\n  private _dismissFlash() {\n    // @ts-ignore\n    fireEvent(this, \"flash-message-changed\", { value: \"\" });\n  }\n\n  static get styles() {\n    return [\n      haStyle,\n      css`\n        .content {\n          padding-bottom: 24px;\n        }\n        [slot=\"introduction\"] {\n          margin: -1em 0;\n        }\n        [slot=\"introduction\"] a {\n          color: var(--primary-color);\n        }\n        paper-item {\n          cursor: pointer;\n        }\n        ha-card {\n          overflow: hidden;\n        }\n        ha-card .card-header {\n          margin-bottom: -8px;\n        }\n        h1 {\n          margin: 0;\n        }\n        .card-actions {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n        }\n        .login-form {\n          display: flex;\n          flex-direction: column;\n        }\n        .pwd-forgot-link {\n          color: var(--secondary-text-color) !important;\n          text-align: right !important;\n          align-self: flex-end;\n        }\n      `,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"cloud-login\": CloudLogin;\n  }\n}\n","import { css, html, LitElement } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport { classMap } from \"lit/directives/class-map\";\n\n@customElement(\"ha-config-section\")\nexport class HaConfigSection extends LitElement {\n  @property() public isWide = false;\n\n  @property({ type: Boolean }) public vertical = false;\n\n  @property({ type: Boolean, attribute: \"full-width\" })\n  public fullWidth = false;\n\n  protected render() {\n    return html`\n      <div\n        class=\"content ${classMap({\n          narrow: !this.isWide,\n          \"full-width\": this.fullWidth,\n        })}\"\n      >\n        <div class=\"header\"><slot name=\"header\"></slot></div>\n        <div\n          class=\"together layout ${classMap({\n            narrow: !this.isWide,\n            vertical: this.vertical || !this.isWide,\n            horizontal: !this.vertical && this.isWide,\n          })}\"\n        >\n          <div class=\"intro\"><slot name=\"introduction\"></slot></div>\n          <div class=\"panel flex-auto\"><slot></slot></div>\n        </div>\n      </div>\n    `;\n  }\n\n  static get styles() {\n    return css`\n      :host {\n        display: block;\n      }\n      .content {\n        padding: 28px 20px 0;\n        max-width: 1040px;\n        margin: 0 auto;\n      }\n\n      .layout {\n        display: flex;\n      }\n\n      .horizontal {\n        flex-direction: row;\n      }\n\n      .vertical {\n        flex-direction: column;\n      }\n\n      .flex-auto {\n        flex: 1 1 auto;\n      }\n\n      .header {\n        font-family: var(--paper-font-headline_-_font-family);\n        -webkit-font-smoothing: var(\n          --paper-font-headline_-_-webkit-font-smoothing\n        );\n        font-size: var(--paper-font-headline_-_font-size);\n        font-weight: var(--paper-font-headline_-_font-weight);\n        letter-spacing: var(--paper-font-headline_-_letter-spacing);\n        line-height: var(--paper-font-headline_-_line-height);\n        opacity: var(--dark-primary-opacity);\n      }\n\n      .together {\n        margin-top: 32px;\n      }\n\n      .intro {\n        font-family: var(--paper-font-subhead_-_font-family);\n        -webkit-font-smoothing: var(\n          --paper-font-subhead_-_-webkit-font-smoothing\n        );\n        font-weight: var(--paper-font-subhead_-_font-weight);\n        line-height: var(--paper-font-subhead_-_line-height);\n        width: 100%;\n        opacity: var(--dark-primary-opacity);\n        font-size: 14px;\n        padding-bottom: 20px;\n      }\n\n      .horizontal .intro {\n        max-width: 400px;\n        margin-right: 40px;\n      }\n\n      .panel {\n        margin-top: -24px;\n      }\n\n      .panel ::slotted(*) {\n        margin-top: 24px;\n        display: block;\n      }\n\n      .narrow.content {\n        max-width: 640px;\n      }\n      .narrow .together {\n        margin-top: 20px;\n      }\n      .narrow .intro {\n        padding-bottom: 20px;\n        margin-right: 0;\n        max-width: 500px;\n      }\n\n      .full-width {\n        padding: 0;\n      }\n\n      .full-width .layout {\n        flex-direction: column;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-config-section\": HaConfigSection;\n  }\n}\n"],"names":[],"sourceRoot":""}