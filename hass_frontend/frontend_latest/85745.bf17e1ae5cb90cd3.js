export const __webpack_ids__=["85745"];export const __webpack_modules__={50875:function(e,t,a){a.d(t,{Eu:()=>i,hZ:()=>o,o9:()=>c});var s=a(27486),r=a(11259);const n=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#9498a0","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#74787f","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#b6bac2","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#d9d9d9","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function i(e){return n[e%n.length]}function o(e,t){const a=t.getPropertyValue(`--graph-color-${e+1}`)||i(e);return(0,r.Rq)(a)}const c=(0,s.Z)((e=>n.map(((t,a)=>o(a,e)))),((e,t)=>e[0].getPropertyValue("--graph-color-1")===t[0].getPropertyValue("--graph-color-1")))},6736:function(e,t,a){a.d(t,{f:()=>i});var s=a(44249),r=a(72621),n=(a(9359),a(52924),a(15093));const i=e=>(0,s.Z)(null,(function(e,t){class a extends t{constructor(...t){super(...t),e(this)}}return{F:a,d:[{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:void 0},{kind:"field",key:"__unsubs",value:void 0},{kind:"method",key:"connectedCallback",value:function(){(0,r.Z)(a,"connectedCallback",this,3)([]),this._checkSubscribed()}},{kind:"method",key:"disconnectedCallback",value:function(){if((0,r.Z)(a,"disconnectedCallback",this,3)([]),this.__unsubs){for(;this.__unsubs.length;){const e=this.__unsubs.pop();e instanceof Promise?e.then((e=>e())):e()}this.__unsubs=void 0}}},{kind:"method",key:"updated",value:function(e){if((0,r.Z)(a,"updated",this,3)([e]),e.has("hass"))this._checkSubscribed();else if(this.hassSubscribeRequiredHostProps)for(const t of e.keys())if(this.hassSubscribeRequiredHostProps.includes(t))return void this._checkSubscribed()}},{kind:"method",key:"hassSubscribe",value:function(){return[]}},{kind:"method",key:"_checkSubscribed",value:function(){void 0===this.__unsubs&&this.isConnected&&void 0!==this.hass&&!this.hassSubscribeRequiredHostProps?.some((e=>void 0===this[e]))&&(this.__unsubs=this.hassSubscribe())}}]}}),e)},20548:function(e,t,a){a.d(t,{H:()=>n});var s=a(11259),r=a(4643);function n(e,t,a,n,i,o){const c=e.getPropertyValue(i+"-"+o).trim(),d=c.length>0?c:e.getPropertyValue(i).trim();let u=(0,s.Rq)(d);return 0===c.length&&o&&(u=(0,s.CO)((0,s.p3)(t?(0,r.C)((0,s.Rw)((0,s.wK)(u)),o):(0,r.W)((0,s.Rw)((0,s.wK)(u)),o)))),n?u+=a?"32":"7F":a&&(u+="7F"),u}},53259:function(e,t,a){a.a(e,(async function(e,s){try{a.d(t,{J:()=>k,MC:()=>m,Zx:()=>S,b4:()=>g,kT:()=>$});a(92745),a(9359),a(56475),a(31526),a(70104),a(92519),a(42179),a(89256),a(24931),a(88463),a(57449),a(19814);var r=a(21893),n=a(13809),i=a(38836),o=a(84775),c=a(80951),d=a(13730),u=a(6542),h=a(83204),l=a(23459),f=a(23711),p=a(50602),_=a(46467),b=a(33570),y=e([_,b,p]);function m(e,t){let a=new Date(t);return e>2&&0===a.getHours()&&(a=(0,r.b)(a,1)),a.setMinutes(0,0,0),e>35&&a.setDate(1),e>2&&a.setHours(0),a.getTime()}function g(e){return e>35?"month":e>2?"day":"hour"}function k(e,t,a,s,r,i,o,c){const d=(0,n.j)(t,e),u=void 0!==i&&void 0!==o;return{xAxis:{type:"time",min:e,max:m(d,t)},yAxis:{type:"value",name:r,nameGap:2,nameTextStyle:{align:"left"},axisLabel:{formatter:e=>(0,p.uf)(Math.abs(e),a)},splitLine:{show:!0}},grid:{top:15,bottom:0,left:1,right:1,containLabel:!0},tooltip:{trigger:"axis",formatter:e=>{if(Array.isArray(e)){const t=[],n=[];return e.forEach((e=>{e.seriesId?.startsWith("compare-")?n.push(e):t.push(e)})),[t,n].map((e=>v(e,a,s,d,u,r,c))).filter(Boolean).join("<br><br>")}return v([e],a,s,d,u,r,c)}}}}function v(e,t,a,s,r,n,o){if(!e[0]?.value)return"";const c=new Date(e[0].value?.[2]??e[0].value?.[0]);let d;d=s>89?`${(0,_.NC)(c,t,a)}`:s>0?`${(0,_.ud)(c,t,a)}`:`${r?`${(0,_.ud)(c,t,a)}: `:""}${(0,b.mr)(c,t,a)} â€“ ${(0,b.mr)((0,i.T)(c,1),t,a)}`;const u=`<h4 style="text-align: center; margin: 0;">${d}</h4>`;let h=0,l=0,f=0,y=0;const m=e.map((e=>{const a=e.value?.[1],s=(0,p.uf)(a,t);return"0"!==s&&("bar"===e.componentSubType&&(a>0?(h+=a,l++):(f+=a,y++)),`${e.marker} ${e.seriesName}: ${s} ${n}`)})).filter(Boolean);let g="";return 0!==h&&l>1&&o&&(g+=`<br><b>${o(h)}</b>`),0!==f&&y>1&&o&&(g+=`<br><b>${o(f)}</b>`),m.length>0?`${u}${m.join("<br>")}${g}`:""}function S(e){Array.from(new Set(e.map((e=>e.data.map((e=>Number(e[0]))))).flat())).sort(((e,t)=>e-t)).forEach(((t,a)=>{const s={},r={};for(let n=e.length-1;n>=0;n--){const i=e[n].data[a],o=i&&"object"==typeof i&&"value"in i?i:{value:i},c=o.value?.[0],d=e[n].stack??"";void 0!==c&&(Number(c)!==t?e[n].data?.splice(a,0,{value:[t,0],itemStyle:{borderWidth:0}}):0===o.value?.[1]?e[n].data[a]={...o,itemStyle:{...o.itemStyle,borderWidth:0}}:!s[d]&&o.value?.[1]>0?(e[n].data[a]={...o,itemStyle:{...o.itemStyle,borderRadius:[4,4,0,0]}},s[d]=!0):!r[d]&&o.value?.[1]<0&&(e[n].data[a]={...o,itemStyle:{...o.itemStyle,borderRadius:[0,0,4,4]}},r[d]=!0))}}))}function $(e,t){if(!t)return e=>e;const a=(0,o.o)(e,t);if(0!==a&&e.getTime()===(0,c.e)(e).getTime())return e=>(0,d.B)(e,a);const s=(0,u.d)(e,t);if(0!==s&&e.getTime()===(0,h.N)(e).getTime())return e=>(0,l.z)(e,s);const r=e.getTime()-t.getTime();return e=>(0,f.n)(e,r)}[_,b,p]=y.then?(await y)():y,s()}catch(x){s(x)}}))},63:function(e,t,a){a.a(e,(async function(e,s){try{a.r(t),a.d(t,{HuiEnergySolarGraphCard:()=>S});var r=a(44249),n=(a(92745),a(9359),a(56475),a(31526),a(52924),a(42625)),i=a(83389),o=a(16444),c=a(13809),d=a(57243),u=a(15093),h=a(35359),l=a(27486),f=a(20548),p=a(50602),_=a(25179),b=(a(54977),a(1118)),y=a(17705),m=a(6736),g=a(93331),k=a(53259),v=e([_,p,b,k]);[_,p,b,k]=v.then?(await v)():v;let S=(0,r.Z)([(0,u.Mo)("hui-energy-solar-graph-card")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,u.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,u.SB)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,u.SB)()],key:"_chartData",value:()=>[]},{kind:"field",decorators:[(0,u.SB)()],key:"_start",value:()=>(0,n.I)()},{kind:"field",decorators:[(0,u.SB)()],key:"_end",value:()=>(0,i.p)()},{kind:"field",decorators:[(0,u.SB)()],key:"_compareStart",value:void 0},{kind:"field",decorators:[(0,u.SB)()],key:"_compareEnd",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:()=>["_config"]},{kind:"method",key:"hassSubscribe",value:function(){return[(0,b.UB)(this.hass,{key:this._config?.collection_key}).subscribe((e=>this._getStatistics(e)))]}},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(e){this._config=e}},{kind:"method",key:"shouldUpdate",value:function(e){return(0,g.SN)(this,e)||e.size>1||!e.has("hass")}},{kind:"method",key:"render",value:function(){return this.hass&&this._config?d.dy` <ha-card> ${this._config.title?d.dy`<h1 class="card-header">${this._config.title}</h1>`:""} <div class="content ${(0,h.$)({"has-header":!!this._config.title})}"> <ha-chart-base .hass="${this.hass}" .data="${this._chartData}" .options="${this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,this._compareStart,this._compareEnd)}" chart-type="bar"></ha-chart-base> ${this._chartData.length?"":d.dy`<div class="no-data"> ${(0,o.z)(this._start)?this.hass.localize("ui.panel.lovelace.cards.energy.no_data"):this.hass.localize("ui.panel.lovelace.cards.energy.no_data_period")} </div>`} </div> </ha-card> `:d.Ld}},{kind:"field",key:"_formatTotal",value(){return e=>this.hass.localize("ui.panel.lovelace.cards.energy.energy_solar_graph.total_produced",{num:(0,p.uf)(e,this.hass.locale)})}},{kind:"field",key:"_createOptions",value(){return(0,l.Z)(((e,t,a,s,r,n)=>(0,k.J)(e,t,a,s,"kWh",r,n,this._formatTotal)))}},{kind:"method",key:"_getStatistics",value:async function(e){this._start=e.start,this._end=e.end||(0,i.p)(),this._compareStart=e.startCompare,this._compareEnd=e.endCompare;const t=e.prefs.energy_sources.filter((e=>"solar"===e.type));let a;if(t.some((e=>e.config_entry_solar_forecast?.length)))try{a=await(0,b.jB)(this.hass)}catch(e){}const s=[],r=getComputedStyle(this);if(e.statsCompare)s.push(...this._processDataSet(e.statsCompare,e.statsMetadata,t,r,!0));else{const e=t[0]?.stat_energy_from??"placeholder";s.push({id:"compare-"+e,type:"bar",stack:"solar",data:[]})}s.push(...this._processDataSet(e.stats,e.statsMetadata,t,r)),(0,k.Zx)(s),a&&s.push(...this._processForecast(e.statsMetadata,a,t,r.getPropertyValue("--primary-text-color"),e.start,e.end)),this._chartData=s}},{kind:"method",key:"_processDataSet",value:function(e,t,a,s,r=!1){const n=[],i=(0,k.kT)(this._start,this._compareStart);return a.forEach(((a,o)=>{let c=null;const d=[];if(a.stat_energy_from in e){const t=e[a.stat_energy_from];for(const e of t){if(null===e.change||void 0===e.change||0===e.change)continue;if(c===e.start)continue;const t=[e.start,e.change];r&&(t[2]=t[0],t[0]=i(new Date(e.start))),d.push(t),c=e.start}}n.push({type:"bar",cursor:"default",id:r?"compare-"+a.stat_energy_from:a.stat_energy_from,name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_solar_graph.production",{name:(0,y.Kd)(this.hass,a.stat_energy_from,t[a.stat_energy_from])}),barMaxWidth:50,itemStyle:{borderColor:(0,f.H)(s,this.hass.themes.darkMode,!1,r,"--energy-solar-color",o)},color:(0,f.H)(s,this.hass.themes.darkMode,!0,r,"--energy-solar-color",o),data:d,stack:r?"compare":"solar"})})),n}},{kind:"method",key:"_processForecast",value:function(e,t,a,s,r,n){const i=[],o=(0,c.j)(n||new Date,r);return a.forEach((a=>{if(a.config_entry_solar_forecast){const c={};if(a.config_entry_solar_forecast.forEach((e=>{t[e]&&Object.entries(t[e].wh_hours).forEach((([e,t])=>{const a=new Date(e);if(a<r||n&&a>n)return;o>35&&a.setDate(1),o>2?a.setHours(0,0,0,0):a.setMinutes(0,0,0);const s=a.getTime();s in c?c[s]+=t:c[s]=t}))})),c){const t=[];for(const[e,a]of Object.entries(c))t.push([Number(e),a/1e3]);t.length&&i.push({id:"forecast-"+a.stat_energy_from,type:"line",stack:"forecast",name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_solar_graph.forecast",{name:(0,y.Kd)(this.hass,a.stat_energy_from,e[a.stat_energy_from])}),step:!1,color:s,lineStyle:{type:[7,5],width:1.5},symbol:"none",data:t})}}})),i}},{kind:"field",static:!0,key:"styles",value:()=>d.iv`ha-card{height:100%}.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}.no-data{position:absolute;height:100%;top:0;left:0;right:0;display:flex;justify-content:center;align-items:center;padding:20%;margin-left:32px;margin-inline-start:32px;margin-inline-end:initial;box-sizing:border-box}`}]}}),(0,m.f)(d.oi));s()}catch(e){s(e)}}))},41924:function(e,t,a){a.d(t,{y:()=>r});var s=a(53907);function r(e){return(0,s.L)(e,Date.now())}},97836:function(e,t,a){a.d(t,{K:()=>n});var s=a(18492),r=a(7591);function n(e,t,a){const[n,i]=(0,s.d)(a?.in,e,t);return+(0,r.b)(n)==+(0,r.b)(i)}},16444:function(e,t,a){a.d(t,{z:()=>i});var s=a(53907),r=a(41924),n=a(97836);function i(e,t){return(0,n.K)((0,s.L)(t?.in||e,e),(0,r.y)(t?.in||e))}}};
//# sourceMappingURL=85745.bf17e1ae5cb90cd3.js.map