export const id=29672;export const ids=[29672];export const modules={92195:(t,e,i)=>{i.d(e,{vh:()=>s,yJ:()=>a});Math.pow(10,8);var a=6e4,s=36e5},72277:(t,e,i)=>{i.d(e,{Z:()=>o});var a=i(92195),s=i(99307),n=i(23682),r=i(86102);function o(t,e,i){(0,n.Z)(2,arguments);var o=(0,s.Z)(t,e)/a.vh;return(0,r.u)(null==i?void 0:i.roundingMethod)(o)}},99307:(t,e,i)=>{i.d(e,{Z:()=>n});var a=i(34327),s=i(23682);function n(t,e){return(0,s.Z)(2,arguments),(0,a.Z)(t).getTime()-(0,a.Z)(e).getTime()}},76680:(t,e,i)=>{function a(t){return void 0===t||Array.isArray(t)?t:[t]}i.d(e,{r:()=>a})},43986:(t,e,i)=>{i.d(e,{L:()=>n,a:()=>s});var a=i(87367);const s={ms:1,s:1e3,min:6e4,h:36e5,d:864e5},n=(t,e)=>(0,a.Z)(parseFloat(t)*s[e])||"0"},87367:(t,e,i)=>{i.d(e,{Z:()=>s});const a=(t,e=2)=>{let i=""+t;for(let t=1;t<e;t++)i=parseInt(i)<10**t?`0${i}`:i;return i};function s(t){const e=Math.floor(t/1e3/3600),i=Math.floor(t/1e3%3600/60),s=Math.floor(t/1e3%3600%60),n=Math.floor(t%1e3);return e>0?`${e}:${a(i)}:${a(s)}`:i>0?`${i}:${a(s)}`:s>0||n>0?`${s}${n>0?`.${a(n,3)}`:""}`:null}},85157:(t,e,i)=>{i.d(e,{t:()=>n});class a{constructor(t=window.localStorage){this.storage=void 0,this._storage={},this._listeners={},this.storage=t,t===window.localStorage&&window.addEventListener("storage",(t=>{t.key&&this.hasKey(t.key)&&(this._storage[t.key]=t.newValue?JSON.parse(t.newValue):t.newValue,this._listeners[t.key]&&this._listeners[t.key].forEach((e=>e(t.oldValue?JSON.parse(t.oldValue):t.oldValue,this._storage[t.key]))))}))}addFromStorage(t){if(!this._storage[t]){const e=this.storage.getItem(t);e&&(this._storage[t]=JSON.parse(e))}}subscribeChanges(t,e){return this._listeners[t]?this._listeners[t].push(e):this._listeners[t]=[e],()=>{this.unsubscribeChanges(t,e)}}unsubscribeChanges(t,e){if(!(t in this._listeners))return;const i=this._listeners[t].indexOf(e);-1!==i&&this._listeners[t].splice(i,1)}hasKey(t){return t in this._storage}getValue(t){return this._storage[t]}setValue(t,e){const i=this._storage[t];this._storage[t]=e;try{void 0===e?this.storage.removeItem(t):this.storage.setItem(t,JSON.stringify(e))}catch(t){}finally{this._listeners[t]&&this._listeners[t].forEach((t=>t(i,e)))}}}const s={},n=t=>e=>{const i=t.storage||"localStorage";let n;i&&i in s?n=s[i]:(n=new a(window[i]),s[i]=n);const r=String(e.key),o=t.key||String(e.key),d=e.initializer?e.initializer():void 0;n.addFromStorage(o);const l=!1!==t.subscribe?t=>n.subscribeChanges(o,((i,a)=>{t.requestUpdate(e.key,i)})):void 0,c=()=>n.hasKey(o)?n.getValue(o):d;return{kind:"method",placement:"prototype",key:e.key,descriptor:{set(i){((i,a)=>{let s;t.state&&(s=c()),n.setValue(o,a),t.state&&i.requestUpdate(e.key,s)})(this,i)},get:()=>c(),enumerable:!0,configurable:!0},finisher(i){if(t.state&&t.subscribe){const t=i.prototype.connectedCallback,e=i.prototype.disconnectedCallback;i.prototype.connectedCallback=function(){t.call(this),this[`__unbsubLocalStorage${r}`]=null==l?void 0:l(this)},i.prototype.disconnectedCallback=function(){var t;e.call(this),null===(t=this[`__unbsubLocalStorage${r}`])||void 0===t||t.call(this),this[`__unbsubLocalStorage${r}`]=void 0}}t.state&&i.createProperty(e.key,{noAccessor:!0,...t.stateOptions})}}}},29171:(t,e,i)=>{i.a(t,(async(t,a)=>{try{i.d(e,{c:()=>k,computeStateDisplay:()=>m,v:()=>g});var s=i(56007),n=i(66477),r=i(24833),o=i(43986),d=i(12198),l=i(44583),c=i(49684),u=i(18457),h=i(68307),_=i(58831),y=i(40095),v=t([d,l,c]);[d,l,c]=v.then?(await v)():v;const g=(t,e,i,a,s,n)=>k(t,i,a,s,e.entity_id,e.attributes,void 0!==n?n:e.state),m=(t,e,i,a,s,n)=>{const r=null==s?void 0:s[e.entity_id];return k(t,i,a,r,e.entity_id,e.attributes,void 0!==n?n:e.state)},k=(t,e,i,a,v,g,m)=>{if(m===s.lz||m===s.nZ)return t(`state.default.${m}`);if((0,u.sJ)(g)){if("duration"===g.device_class&&g.unit_of_measurement&&o.a[g.unit_of_measurement])try{return(0,o.L)(m,g.unit_of_measurement)}catch(t){}if("monetary"===g.device_class)try{return(0,u.uf)(m,e,{style:"currency",currency:g.unit_of_measurement,minimumFractionDigits:2,...(0,u.l4)({state:m,attributes:g},a)})}catch(t){}const t=g.unit_of_measurement?"%"===g.unit_of_measurement?(0,h.K)(e)+"%":` ${g.unit_of_measurement}`:"";return`${(0,u.uf)(m,e,(0,u.l4)({state:m,attributes:g},a))}${t}`}const k=(0,_.M)(v);if("datetime"===k){const t=new Date(m);return(0,l.o0)(t,e,i)}if(["date","input_datetime","time"].includes(k))try{const t=m.split(" ");if(2===t.length)return(0,l.o0)(new Date(t.join("T")),{...e,time_zone:n.c_.local},i);if(1===t.length){if(m.includes("-"))return(0,d.p6)(new Date(`${m}T00:00`),{...e,time_zone:n.c_.local},i);if(m.includes(":")){const t=new Date;return(0,c.mr)(new Date(`${t.toISOString().split("T")[0]}T${m}`),{...e,time_zone:n.c_.local},i)}}return m}catch(t){return m}if("counter"===k||"number"===k||"input_number"===k)return(0,u.uf)(m,e,(0,u.l4)({state:m,attributes:g},a));if(["button","event","image","input_button","scene","stt","tts"].includes(k)||"sensor"===k&&"timestamp"===g.device_class)try{return(0,l.o0)(new Date(m),e,i)}catch(t){return m}var f;return"update"===k?"on"===m?(0,r.X4)(g)?(0,y.f)(g,r.k6)&&"number"==typeof g.in_progress?t("ui.card.update.installing_with_progress",{progress:g.in_progress}):t("ui.card.update.installing"):g.latest_version:g.skipped_version===g.latest_version?null!==(f=g.latest_version)&&void 0!==f?f:t("state.default.unavailable"):t("ui.card.update.up_to_date"):(null==a?void 0:a.translation_key)&&t(`component.${a.platform}.entity.${k}.${a.translation_key}.state.${m}`)||g.device_class&&t(`component.${k}.entity_component.${g.device_class}.state.${m}`)||t(`component.${k}.entity_component._.state.${m}`)||m};a()}catch(t){a(t)}}))},50239:(t,e,i)=>{i.d(e,{Y:()=>s,u:()=>a});const a=(t,e,i)=>Math.min(Math.max(t,e),i),s=(t,e,i)=>{let a;return a=null!=e?Math.max(t,e):t,a=null!=i?Math.min(a,i):a,a}},18457:(t,e,i)=>{i.d(e,{Hd:()=>o,SL:()=>n,l4:()=>l,sJ:()=>r,uf:()=>d});var a=i(66477),s=i(27593);const n=t=>r(t.attributes),r=t=>!!t.unit_of_measurement||!!t.state_class,o=t=>{switch(t.number_format){case a.y4.comma_decimal:return["en-US","en"];case a.y4.decimal_comma:return["de","es","it"];case a.y4.space_comma:return["fr","sv","cs"];case a.y4.system:return;default:return t.language}},d=(t,e,i)=>{const n=e?o(e):void 0;if(Number.isNaN=Number.isNaN||function t(e){return"number"==typeof e&&t(e)},(null==e?void 0:e.number_format)!==a.y4.none&&!Number.isNaN(Number(t))&&Intl)try{return new Intl.NumberFormat(n,c(t,i)).format(Number(t))}catch(e){return console.error(e),new Intl.NumberFormat(void 0,c(t,i)).format(Number(t))}return!Number.isNaN(Number(t))&&""!==t&&(null==e?void 0:e.number_format)===a.y4.none&&Intl?new Intl.NumberFormat("en-US",c(t,{...i,useGrouping:!1})).format(Number(t)):"string"==typeof t?t:`${(0,s.N)(t,null==i?void 0:i.maximumFractionDigits).toString()}${"currency"===(null==i?void 0:i.style)?` ${i.currency}`:""}`},l=(t,e)=>{var i;const a=null==e?void 0:e.display_precision;return null!=a?{maximumFractionDigits:a,minimumFractionDigits:a}:Number.isInteger(Number(null==t||null===(i=t.attributes)||void 0===i?void 0:i.step))&&Number.isInteger(Number(null==t?void 0:t.state))?{maximumFractionDigits:0}:void 0},c=(t,e)=>{const i={maximumFractionDigits:2,...e};if("string"!=typeof t)return i;if(!e||void 0===e.minimumFractionDigits&&void 0===e.maximumFractionDigits){const e=t.indexOf(".")>-1?t.split(".")[1].length:0;i.minimumFractionDigits=e,i.maximumFractionDigits=e}return i}},68307:(t,e,i)=>{i.d(e,{K:()=>a});const a=t=>{switch(null==t?void 0:t.language){case"cz":case"de":case"fi":case"fr":case"sk":case"sv":return" ";default:return""}}},31206:(t,e,i)=>{i.r(e),i.d(e,{HaCircularProgress:()=>l});var a=i(17463),s=i(34541),n=i(47838),r=i(30879),o=i(68144),d=i(79932);let l=(0,a.Z)([(0,d.Mo)("ha-circular-progress")],(function(t,e){class i extends e{constructor(...e){super(...e),t(this)}}return{F:i,d:[{kind:"field",decorators:[(0,d.Cb)({type:Boolean})],key:"active",value:()=>!1},{kind:"field",decorators:[(0,d.Cb)()],key:"alt",value:()=>"Loading"},{kind:"field",decorators:[(0,d.Cb)()],key:"size",value:()=>"medium"},{kind:"set",key:"density",value:function(t){}},{kind:"get",key:"density",value:function(){switch(this.size){case"tiny":return-8;case"small":return-5;case"medium":default:return 0;case"large":return 5}}},{kind:"set",key:"indeterminate",value:function(t){}},{kind:"get",key:"indeterminate",value:function(){return this.active}},{kind:"get",static:!0,key:"styles",value:function(){return[(0,s.Z)((0,n.Z)(i),"styles",this),o.iv`:host{overflow:hidden}`]}}]}}),r.D)},3542:(t,e,i)=>{i.a(t,(async(t,a)=>{try{i.r(e);var s=i(17463),n=i(34541),r=i(47838),o=i(72277),d=i(68144),l=i(79932),c=i(76680),u=i(85157),h=i(83849),_=i(69934),y=i(15493),v=i(87744),g=i(62336),m=i(77243),k=(i(31206),i(39143)),f=(i(10983),i(2315),i(48932),i(63681),i(36226),i(57066)),p=i(57292),b=i(74186),D=i(58763),$=i(73826),w=i(11654),L=t([m,k,D]);[m,k,D]=L.then?(await L)():L;const V="M14.76,20.83L17.6,18L14.76,15.17L16.17,13.76L19,16.57L21.83,13.76L23.24,15.17L20.43,18L23.24,20.83L21.83,22.24L19,19.4L16.17,22.24L14.76,20.83M12,12V19.88C12.04,20.18 11.94,20.5 11.71,20.71C11.32,21.1 10.69,21.1 10.3,20.71L8.29,18.7C8.06,18.47 7.96,18.16 8,17.87V12H7.97L2.21,4.62C1.87,4.19 1.95,3.56 2.38,3.22C2.57,3.08 2.78,3 3,3V3H17V3C17.22,3 17.43,3.08 17.62,3.22C18.05,3.56 18.13,4.19 17.79,4.62L12.03,12H12Z",x="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z";let C=(0,s.Z)(null,(function(t,e){class i extends e{constructor(){super(),t(this);const e=new Date;e.setHours(e.getHours()-1,0,0,0),this._startDate=e;const i=new Date;i.setHours(i.getHours()+2,0,0,0),this._endDate=i}}return{F:i,d:[{kind:"field",decorators:[(0,l.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,l.Cb)({reflect:!0,type:Boolean})],key:"narrow",value:void 0},{kind:"field",decorators:[(0,l.Cb)({reflect:!0,type:Boolean})],key:"rtl",value:()=>!1},{kind:"field",decorators:[(0,l.SB)()],key:"_startDate",value:void 0},{kind:"field",decorators:[(0,l.SB)()],key:"_endDate",value:void 0},{kind:"field",decorators:[(0,u.t)({key:"historyPickedValue",state:!0,subscribe:!1})],key:"_targetPickerValue",value:void 0},{kind:"field",decorators:[(0,l.SB)()],key:"_isLoading",value:()=>!1},{kind:"field",decorators:[(0,l.SB)()],key:"_stateHistory",value:void 0},{kind:"field",decorators:[(0,l.SB)()],key:"_deviceEntityLookup",value:void 0},{kind:"field",decorators:[(0,l.SB)()],key:"_areaEntityLookup",value:void 0},{kind:"field",decorators:[(0,l.SB)()],key:"_areaDeviceLookup",value:void 0},{kind:"field",decorators:[(0,l.SB)()],key:"_showBack",value:void 0},{kind:"field",decorators:[(0,l.IO)("state-history-charts")],key:"_stateHistoryCharts",value:void 0},{kind:"field",key:"_subscribed",value:void 0},{kind:"field",key:"_interval",value:void 0},{kind:"method",key:"connectedCallback",value:function(){(0,n.Z)((0,r.Z)(i.prototype),"connectedCallback",this).call(this),this.hasUpdated&&this._getHistory()}},{kind:"method",key:"disconnectedCallback",value:function(){(0,n.Z)((0,r.Z)(i.prototype),"disconnectedCallback",this).call(this),this._unsubscribeHistory()}},{kind:"method",key:"hassSubscribe",value:function(){return[(0,b.LM)(this.hass.connection,(t=>{this._deviceEntityLookup=(0,p.pI)(t),this._areaEntityLookup=(0,f.TD)(t)})),(0,p.q4)(this.hass.connection,(t=>{this._areaDeviceLookup=(0,f.Dl)(t)}))]}},{kind:"method",key:"_goBack",value:function(){history.back()}},{kind:"method",key:"render",value:function(){return d.dy` <ha-top-app-bar-fixed> ${this._showBack?d.dy` <ha-icon-button-arrow-prev slot="navigationIcon" @click="${this._goBack}"></ha-icon-button-arrow-prev> `:d.dy` <ha-menu-button slot="navigationIcon" .hass="${this.hass}" .narrow="${this.narrow}"></ha-menu-button> `} <div slot="title">${this.hass.localize("panel.history")}</div> ${this._targetPickerValue?d.dy` <ha-icon-button slot="actionItems" @click="${this._removeAll}" .disabled="${this._isLoading}" .path="${V}" .label="${this.hass.localize("ui.panel.history.remove_all")}"></ha-icon-button> `:""} <ha-icon-button slot="actionItems" @click="${this._getHistory}" .disabled="${this._isLoading||!this._targetPickerValue}" .path="${x}" .label="${this.hass.localize("ui.common.refresh")}"></ha-icon-button> <div class="flex content"> <div class="filters"> <ha-date-range-picker .hass="${this.hass}" ?disabled="${this._isLoading}" .startDate="${this._startDate}" .endDate="${this._endDate}" @change="${this._dateRangeChanged}"></ha-date-range-picker> <ha-target-picker .hass="${this.hass}" .value="${this._targetPickerValue}" .disabled="${this._isLoading}" addOnTop @value-changed="${this._targetsChanged}"></ha-target-picker> </div> ${this._isLoading?d.dy`<div class="progress-wrapper"> <ha-circular-progress active alt="${this.hass.localize("ui.common.loading")}"></ha-circular-progress> </div>`:this._targetPickerValue?d.dy` <state-history-charts .hass="${this.hass}" .historyData="${this._stateHistory}" .startTime="${this._startDate}" .endTime="${this._endDate}"> </state-history-charts> `:d.dy`<div class="start-search"> ${this.hass.localize("ui.panel.history.start_search")} </div>`} </div> </ha-top-app-bar-fixed> `}},{kind:"method",key:"willUpdate",value:function(t){if((0,n.Z)((0,r.Z)(i.prototype),"willUpdate",this).call(this,t),this.hasUpdated)return;const e=(0,y.Q2)(),a=e.entity_id,s=e.device_id,o=e.area_id;if((a||s||o)&&(this._targetPickerValue={}),a){const t=a.split(",");this._targetPickerValue.entity_id=t}if(s){const t=s.split(",");this._targetPickerValue.device_id=t}if(o){const t=o.split(",");this._targetPickerValue.area_id=t}const d=e.start_date;d&&(this._startDate=new Date(d));const l=e.end_date;l&&(this._endDate=new Date(l))}},{kind:"method",key:"firstUpdated",value:function(t){(0,n.Z)((0,r.Z)(i.prototype),"firstUpdated",this).call(this,t);"1"===(0,y.Q2)().back&&history.length>1&&(this._showBack=!0,(0,h.c)((0,_.q)((0,y.pc)("back")),{replace:!0}))}},{kind:"method",key:"updated",value:function(t){if(this._targetPickerValue&&(t.has("_startDate")||t.has("_endDate")||t.has("_targetPickerValue")||!this._stateHistory&&(t.has("_deviceEntityLookup")||t.has("_areaEntityLookup")||t.has("_areaDeviceLookup")))&&this._getHistory(),!t.has("hass")&&!t.has("_entities"))return;const e=t.get("hass");e&&e.language===this.hass.language||(this.rtl=(0,v.HE)(this.hass))}},{kind:"method",key:"_removeAll",value:function(){this._targetPickerValue=void 0,this._updatePath()}},{kind:"method",key:"_getHistory",value:async function(){if(!this._targetPickerValue)return;this._isLoading=!0;const t=this._getEntityIds();if(void 0===t)return this._isLoading=!1,void(this._stateHistory=void 0);if(0===t.length)return this._isLoading=!1,void(this._stateHistory={line:[],timeline:[]});this._subscribed&&this._unsubscribeHistory();const e=new Date;this._subscribed=(0,D.Vk)(this.hass,(t=>{this._isLoading=!1,this._stateHistory=(0,D.Nu)(this.hass,t,this.hass.localize)}),this._startDate,this._endDate,t),this._subscribed.catch((()=>{this._isLoading=!1,this._unsubscribeHistory()})),this._endDate>e&&this._setRedrawTimer()}},{kind:"method",key:"_setRedrawTimer",value:function(){clearInterval(this._interval);const t=new Date,e=this._endDate>t?t:this._endDate,i=(0,o.Z)(e,this._startDate);this._interval=window.setInterval((()=>{var t;return null===(t=this._stateHistoryCharts)||void 0===t?void 0:t.requestUpdate()}),i<2?1e4:i<10?6e4:g.Q)}},{kind:"method",key:"_unsubscribeHistory",value:function(){this._interval&&(clearInterval(this._interval),this._interval=void 0),this._subscribed&&(this._subscribed.then((t=>null==t?void 0:t())),this._subscribed=void 0)}},{kind:"method",key:"_getEntityIds",value:function(){if(!this._targetPickerValue||void 0===this._deviceEntityLookup||void 0===this._areaEntityLookup||void 0===this._areaDeviceLookup)return;const t=new Set;let{area_id:e,device_id:i,entity_id:a}=this._targetPickerValue;if(e){e=(0,c.r)(e);for(const i of e){const e=this._areaEntityLookup[i];if(null!=e&&e.length)for(const i of e)null===i.entity_category&&t.add(i.entity_id);const a=this._areaDeviceLookup[i];if(null!=a&&a.length)for(const e of a){const a=this._deviceEntityLookup[e.id];if(null!=a&&a.length)for(const e of a)e.area_id&&e.area_id!==i||null!==e.entity_category||t.add(e.entity_id)}}}if(i){i=(0,c.r)(i);for(const e of i){const i=this._deviceEntityLookup[e];if(null!=i&&i.length)for(const e of i)null===e.entity_category&&t.add(e.entity_id)}}if(a){a=(0,c.r)(a);for(const e of a)t.add(e)}return[...t]}},{kind:"method",key:"_dateRangeChanged",value:function(t){this._startDate=t.detail.startDate;const e=t.detail.endDate;0===e.getHours()&&0===e.getMinutes()&&(e.setDate(e.getDate()+1),e.setMilliseconds(e.getMilliseconds()-1)),this._endDate=e,this._updatePath()}},{kind:"method",key:"_targetsChanged",value:function(t){this._targetPickerValue=t.detail.value,this._updatePath()}},{kind:"method",key:"_updatePath",value:function(){const t={};this._targetPickerValue&&(this._targetPickerValue.entity_id&&(t.entity_id=(0,c.r)(this._targetPickerValue.entity_id).join(",")),this._targetPickerValue.area_id&&(t.area_id=(0,c.r)(this._targetPickerValue.area_id).join(",")),this._targetPickerValue.device_id&&(t.device_id=(0,c.r)(this._targetPickerValue.device_id).join(","))),this._startDate&&(t.start_date=this._startDate.toISOString()),this._endDate&&(t.end_date=this._endDate.toISOString()),(0,h.c)(`/history?${(0,y.ou)(t)}`,{replace:!0})}},{kind:"get",static:!0,key:"styles",value:function(){return[w.Qx,d.iv`.content{padding:0 16px 16px;padding-bottom:max(env(safe-area-inset-bottom),16px)}:host([virtualize]){height:100%}.progress-wrapper{position:relative;display:flex;align-items:center;flex-direction:column;padding:16px}.filters{display:flex;align-items:flex-start;margin-top:16px}ha-date-range-picker{margin-right:16px;margin-inline-end:16px;margin-inline-start:initial;max-width:100%;direction:var(--direction)}@media all and (max-width:1025px){.filters{flex-direction:column}ha-date-range-picker{margin-right:0;margin-inline-end:0;width:100%}}.start-search{padding-top:16px;text-align:center;color:var(--secondary-text-color)}`]}}]}}),(0,$.f)(d.oi));customElements.define("ha-panel-history",C),a()}catch(t){a(t)}}))}};
//# sourceMappingURL=29672-G-7yFDNVfnc.js.map