{"version":3,"file":"5dd8d339.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgFA;;ACyKA;AACA;AACA;AACA;;;AAMA;;;AAGA;AAKA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;;AAIA;AAGA;;;AAGA;AACA;AACA;;;;AAIA;AAGA;;;AAGA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;;AA9EA;;;;;;;;;;;AA5BA;;;;AC/IA;AACA;AACA;AACA;;;;AAIA;AAGA;AACA;AACA;;;AAGA;AAGA;AACA;AACA;AACA;AAKA;;;AAGA;;;;AAIA;AACA;AACA;;;AAGA;;AAIA;AAOA;AACA;;AAMA;;;;AAjGA;;;ACLA;AAGA;;;;AAQA;;AAaA;;;AAKA;;;AAGA;;;AAKA;;AA1BA;;AAGA;;;AAKA;;;;AAhCA;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;ACwKA;;AAGA;;;;;;AAOA;;AAGA;;;;;AAMA;AACA;AACA;AACA;AACA;;;;AAIA;;AAGA;;AAMA;AAEA;;AAGA;;;AAGA;;;AAGA;AAEA;;;AAIA;;AAIA;AAEA;AAGA;AAEA;;AAEA;;AApMA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;ACWA;;;AAQA;;;AAOA;;;;AAKA;;;AAKA;;;;AAMA;;;;AAKA;AACA;AACA;AACA;;;;AAIA;;;AAKA;AACA;;;AAGA;;;AAKA;AACA;;;;;;AAQA;AACA;;AAxEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAzBA;;;;ACOA;;AAEA;;;AAGA;;;;;AAOA;AACA;;AAEA;;;AAOA;;;AAIA;AACA;AACA;AACA;;AAEA;;;AAKA;AACA;AACA;AACA;;AAEA;AA3DA;;;;;;;;;;;AAAA","sources":["webpack://home-assistant-frontend/./node_modules/@polymer/paper-item/paper-item-body.js","webpack://home-assistant-frontend/./src/panels/lovelace/editor/config-elements/hui-entities-card-editor.ts","webpack://home-assistant-frontend/./src/panels/lovelace/editor/config-elements/hui-generic-entity-row-editor.ts","webpack://home-assistant-frontend/./src/panels/lovelace/editor/header-footer-editor/hui-header-footer-editor.ts","webpack://home-assistant-frontend/./src/panels/lovelace/editor/hui-element-editor.ts","webpack://home-assistant-frontend/./src/panels/lovelace/editor/hui-entities-card-row-editor.ts","webpack://home-assistant-frontend/./src/panels/lovelace/editor/hui-sub-element-editor.ts"],"sourcesContent":["/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\n\nimport '@polymer/iron-flex-layout/iron-flex-layout.js';\nimport '@polymer/paper-styles/default-theme.js';\nimport '@polymer/paper-styles/typography.js';\nimport {Polymer} from '@polymer/polymer/lib/legacy/polymer-fn.js';\nimport {html} from '@polymer/polymer/lib/utils/html-tag.js';\n\n/*\nUse `<paper-item-body>` in a `<paper-item>` or `<paper-icon-item>` to make two-\nor three- line items. It is a flex item that is a vertical flexbox.\n\n    <paper-item>\n      <paper-item-body two-line>\n        <div>Show your status</div>\n        <div secondary>Your status is visible to everyone</div>\n      </paper-item-body>\n    </paper-item>\n\nThe child elements with the `secondary` attribute is given secondary text\nstyling.\n\n### Styling\n\nThe following custom properties and mixins are available for styling:\n\nCustom property | Description | Default\n----------------|-------------|----------\n`--paper-item-body-two-line-min-height` | Minimum height of a two-line item | `72px`\n`--paper-item-body-three-line-min-height` | Minimum height of a three-line item | `88px`\n`--paper-item-body-secondary-color` | Foreground color for the `secondary` area | `--secondary-text-color`\n`--paper-item-body-secondary` | Mixin applied to the `secondary` area | `{}`\n\n*/\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        overflow: hidden; /* needed for text-overflow: ellipsis to work on ff */\n        @apply --layout-vertical;\n        @apply --layout-center-justified;\n        @apply --layout-flex;\n      }\n\n      :host([two-line]) {\n        min-height: var(--paper-item-body-two-line-min-height, 72px);\n      }\n\n      :host([three-line]) {\n        min-height: var(--paper-item-body-three-line-min-height, 88px);\n      }\n\n      :host > ::slotted(*) {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n      }\n\n      :host > ::slotted([secondary]) {\n        @apply --paper-font-body1;\n\n        color: var(--paper-item-body-secondary-color, var(--secondary-text-color));\n\n        @apply --paper-item-body-secondary;\n      }\n    </style>\n\n    <slot></slot>\n`,\n\n  is: 'paper-item-body'\n});\n","import \"@polymer/paper-dropdown-menu/paper-dropdown-menu\";\nimport \"@polymer/paper-input/paper-input\";\nimport \"@polymer/paper-item/paper-item\";\nimport \"@polymer/paper-listbox/paper-listbox\";\nimport { css, CSSResultGroup, html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport {\n  any,\n  array,\n  assert,\n  assign,\n  boolean,\n  dynamic,\n  enums,\n  literal,\n  number,\n  object,\n  optional,\n  string,\n  type,\n  union,\n} from \"superstruct\";\nimport { fireEvent, HASSDomEvent } from \"../../../../common/dom/fire_event\";\nimport {\n  customType,\n  isCustomType,\n} from \"../../../../common/structs/is-custom-type\";\nimport { entityId } from \"../../../../common/structs/is-entity-id\";\nimport { computeRTLDirection } from \"../../../../common/util/compute_rtl\";\nimport \"../../../../components/entity/state-badge\";\nimport \"../../../../components/ha-card\";\nimport \"../../../../components/ha-formfield\";\nimport \"../../../../components/ha-icon\";\nimport \"../../../../components/ha-switch\";\nimport type { HomeAssistant } from \"../../../../types\";\nimport type { EntitiesCardConfig } from \"../../cards/types\";\nimport \"../../components/hui-theme-select-editor\";\nimport { TIMESTAMP_RENDERING_FORMATS } from \"../../components/types\";\nimport type { LovelaceRowConfig } from \"../../entity-rows/types\";\nimport { headerFooterConfigStructs } from \"../../header-footer/structs\";\nimport type { LovelaceCardEditor } from \"../../types\";\nimport \"../header-footer-editor/hui-header-footer-editor\";\nimport \"../hui-entities-card-row-editor\";\nimport \"../hui-sub-element-editor\";\nimport { processEditorEntities } from \"../process-editor-entities\";\nimport { actionConfigStruct } from \"../structs/action-struct\";\nimport { baseLovelaceCardConfig } from \"../structs/base-card-struct\";\nimport { entitiesConfigStruct } from \"../structs/entities-struct\";\nimport {\n  EditorTarget,\n  EditSubElementEvent,\n  SubElementEditorConfig,\n} from \"../types\";\nimport { configElementStyle } from \"./config-elements-style\";\n\nconst buttonEntitiesRowConfigStruct = object({\n  type: literal(\"button\"),\n  entity: optional(string()),\n  name: optional(string()),\n  icon: optional(string()),\n  action_name: optional(string()),\n  tap_action: actionConfigStruct,\n  hold_action: optional(actionConfigStruct),\n  double_tap_action: optional(actionConfigStruct),\n});\n\nconst castEntitiesRowConfigStruct = object({\n  type: literal(\"cast\"),\n  view: union([string(), number()]),\n  dashboard: optional(string()),\n  name: optional(string()),\n  icon: optional(string()),\n  hide_if_unavailable: optional(boolean()),\n});\n\nconst callServiceEntitiesRowConfigStruct = object({\n  type: literal(\"call-service\"),\n  name: string(),\n  service: string(),\n  icon: optional(string()),\n  action_name: optional(string()),\n  service_data: optional(any()),\n});\n\nconst conditionalEntitiesRowConfigStruct = object({\n  type: literal(\"conditional\"),\n  row: any(),\n  conditions: array(\n    object({\n      entity: string(),\n      state: optional(string()),\n      state_not: optional(string()),\n    })\n  ),\n});\n\nconst dividerEntitiesRowConfigStruct = object({\n  type: literal(\"divider\"),\n  style: optional(any()),\n});\n\nconst sectionEntitiesRowConfigStruct = object({\n  type: literal(\"section\"),\n  label: optional(string()),\n});\n\nconst webLinkEntitiesRowConfigStruct = object({\n  type: literal(\"weblink\"),\n  url: string(),\n  name: optional(string()),\n  icon: optional(string()),\n});\n\nconst buttonsEntitiesRowConfigStruct = object({\n  type: literal(\"buttons\"),\n  entities: array(\n    union([\n      object({\n        entity: string(),\n        name: optional(string()),\n        icon: optional(string()),\n        image: optional(string()),\n        show_name: optional(boolean()),\n        show_icon: optional(boolean()),\n        tap_action: optional(actionConfigStruct),\n        hold_action: optional(actionConfigStruct),\n        double_tap_action: optional(actionConfigStruct),\n      }),\n      string(),\n    ])\n  ),\n});\n\nconst attributeEntitiesRowConfigStruct = object({\n  type: literal(\"attribute\"),\n  entity: string(),\n  attribute: string(),\n  prefix: optional(string()),\n  suffix: optional(string()),\n  name: optional(string()),\n  icon: optional(string()),\n  format: optional(enums(TIMESTAMP_RENDERING_FORMATS)),\n});\n\nconst textEntitiesRowConfigStruct = object({\n  type: literal(\"text\"),\n  name: string(),\n  text: string(),\n  icon: optional(string()),\n});\n\nconst customEntitiesRowConfigStruct = type({\n  type: customType(),\n});\n\nconst entitiesRowConfigStruct = dynamic<any>((value) => {\n  if (value && typeof value === \"object\" && \"type\" in value) {\n    if (isCustomType((value as LovelaceRowConfig).type!)) {\n      return customEntitiesRowConfigStruct;\n    }\n\n    switch ((value as LovelaceRowConfig).type!) {\n      case \"attribute\": {\n        return attributeEntitiesRowConfigStruct;\n      }\n      case \"button\": {\n        return buttonEntitiesRowConfigStruct;\n      }\n      case \"buttons\": {\n        return buttonsEntitiesRowConfigStruct;\n      }\n      case \"call-service\": {\n        return callServiceEntitiesRowConfigStruct;\n      }\n      case \"cast\": {\n        return castEntitiesRowConfigStruct;\n      }\n      case \"conditional\": {\n        return conditionalEntitiesRowConfigStruct;\n      }\n      case \"divider\": {\n        return dividerEntitiesRowConfigStruct;\n      }\n      case \"section\": {\n        return sectionEntitiesRowConfigStruct;\n      }\n      case \"text\": {\n        return textEntitiesRowConfigStruct;\n      }\n      case \"weblink\": {\n        return webLinkEntitiesRowConfigStruct;\n      }\n    }\n  }\n\n  // No \"type\" property => has to be the default entity row config struct\n  return entitiesConfigStruct;\n});\n\nconst cardConfigStruct = assign(\n  baseLovelaceCardConfig,\n  object({\n    title: optional(union([string(), boolean()])),\n    entity: optional(entityId()),\n    theme: optional(string()),\n    icon: optional(string()),\n    show_header_toggle: optional(boolean()),\n    state_color: optional(boolean()),\n    entities: array(entitiesRowConfigStruct),\n    header: optional(headerFooterConfigStructs),\n    footer: optional(headerFooterConfigStructs),\n  })\n);\n\n@customElement(\"hui-entities-card-editor\")\nexport class HuiEntitiesCardEditor\n  extends LitElement\n  implements LovelaceCardEditor\n{\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @state() private _config?: EntitiesCardConfig;\n\n  @state() private _configEntities?: LovelaceRowConfig[];\n\n  @state() private _subElementEditorConfig?: SubElementEditorConfig;\n\n  public setConfig(config: EntitiesCardConfig): void {\n    assert(config, cardConfigStruct);\n    this._config = config;\n    this._configEntities = processEditorEntities(config.entities);\n  }\n\n  get _title(): string {\n    return this._config!.title || \"\";\n  }\n\n  get _theme(): string {\n    return this._config!.theme || \"\";\n  }\n\n  protected render(): TemplateResult {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n\n    if (this._subElementEditorConfig) {\n      return html`\n        <hui-sub-element-editor\n          .hass=${this.hass}\n          .config=${this._subElementEditorConfig}\n          @go-back=${this._goBack}\n          @config-changed=${this._handleSubElementChanged}\n        >\n        </hui-sub-element-editor>\n      `;\n    }\n\n    return html`\n      <div class=\"card-config\">\n        <paper-input\n          .label=\"${this.hass.localize(\n            \"ui.panel.lovelace.editor.card.generic.title\"\n          )} (${this.hass.localize(\n            \"ui.panel.lovelace.editor.card.config.optional\"\n          )})\"\n          .value=${this._title}\n          .configValue=${\"title\"}\n          @value-changed=${this._valueChanged}\n        ></paper-input>\n        <hui-theme-select-editor\n          .hass=${this.hass}\n          .value=${this._theme}\n          .configValue=${\"theme\"}\n          @value-changed=${this._valueChanged}\n        ></hui-theme-select-editor>\n        <div class=\"side-by-side\">\n          <ha-formfield\n            .label=${this.hass.localize(\n              \"ui.panel.lovelace.editor.card.entities.show_header_toggle\"\n            )}\n            .dir=${computeRTLDirection(this.hass)}\n          >\n            <ha-switch\n              .checked=${this._config!.show_header_toggle !== false}\n              .configValue=${\"show_header_toggle\"}\n              @change=${this._valueChanged}\n            ></ha-switch>\n          </ha-formfield>\n          <ha-formfield\n            .label=${this.hass.localize(\n              \"ui.panel.lovelace.editor.card.generic.state_color\"\n            )}\n            .dir=${computeRTLDirection(this.hass)}\n          >\n            <ha-switch\n              .checked=${this._config!.state_color}\n              .configValue=${\"state_color\"}\n              @change=${this._valueChanged}\n            ></ha-switch>\n          </ha-formfield>\n        </div>\n        <hui-header-footer-editor\n          .hass=${this.hass}\n          .configValue=${\"header\"}\n          .config=${this._config.header}\n          @value-changed=${this._valueChanged}\n          @edit-detail-element=${this._editDetailElement}\n        ></hui-header-footer-editor>\n        <hui-header-footer-editor\n          .hass=${this.hass}\n          .configValue=${\"footer\"}\n          .config=${this._config.footer}\n          @value-changed=${this._valueChanged}\n          @edit-detail-element=${this._editDetailElement}\n        ></hui-header-footer-editor>\n      </div>\n      <hui-entities-card-row-editor\n        .hass=${this.hass}\n        .entities=${this._configEntities}\n        @entities-changed=${this._valueChanged}\n        @edit-detail-element=${this._editDetailElement}\n      ></hui-entities-card-row-editor>\n    `;\n  }\n\n  private _valueChanged(ev: CustomEvent): void {\n    ev.stopPropagation();\n    if (!this._config || !this.hass) {\n      return;\n    }\n\n    const target = ev.target! as EditorTarget;\n    const configValue =\n      target.configValue || this._subElementEditorConfig?.type;\n    const value =\n      target.checked !== undefined\n        ? target.checked\n        : target.value || ev.detail.config || ev.detail.value;\n\n    if (\n      (configValue! === \"title\" && target.value === this._title) ||\n      (configValue! === \"theme\" && target.value === this._theme)\n    ) {\n      return;\n    }\n\n    if (configValue === \"row\" || (ev.detail && ev.detail.entities)) {\n      const newConfigEntities =\n        ev.detail.entities || this._configEntities!.concat();\n      if (configValue === \"row\") {\n        if (!value) {\n          newConfigEntities.splice(this._subElementEditorConfig!.index!, 1);\n          this._goBack();\n        } else {\n          newConfigEntities[this._subElementEditorConfig!.index!] = value;\n        }\n\n        this._subElementEditorConfig!.elementConfig = value;\n      }\n\n      this._config = { ...this._config!, entities: newConfigEntities };\n      this._configEntities = processEditorEntities(this._config!.entities);\n    } else if (configValue) {\n      if (value === \"\") {\n        this._config = { ...this._config };\n        delete this._config[configValue!];\n      } else {\n        this._config = {\n          ...this._config,\n          [configValue]: value,\n        };\n      }\n    }\n\n    fireEvent(this, \"config-changed\", { config: this._config });\n  }\n\n  private _handleSubElementChanged(ev: CustomEvent): void {\n    ev.stopPropagation();\n    if (!this._config || !this.hass) {\n      return;\n    }\n\n    const configValue = this._subElementEditorConfig?.type;\n    const value = ev.detail.config;\n\n    if (configValue === \"row\") {\n      const newConfigEntities = this._configEntities!.concat();\n      if (!value) {\n        newConfigEntities.splice(this._subElementEditorConfig!.index!, 1);\n        this._goBack();\n      } else {\n        newConfigEntities[this._subElementEditorConfig!.index!] = value;\n      }\n\n      this._config = { ...this._config!, entities: newConfigEntities };\n      this._configEntities = processEditorEntities(this._config!.entities);\n    } else if (configValue) {\n      if (value === \"\") {\n        this._config = { ...this._config };\n        delete this._config[configValue!];\n      } else {\n        this._config = {\n          ...this._config,\n          [configValue]: value,\n        };\n      }\n    }\n\n    this._subElementEditorConfig = {\n      ...this._subElementEditorConfig!,\n      elementConfig: value,\n    };\n\n    fireEvent(this, \"config-changed\", { config: this._config });\n  }\n\n  private _editDetailElement(ev: HASSDomEvent<EditSubElementEvent>): void {\n    this._subElementEditorConfig = ev.detail.subElementConfig;\n  }\n\n  private _goBack(): void {\n    this._subElementEditorConfig = undefined;\n  }\n\n  static get styles(): CSSResultGroup {\n    return [\n      configElementStyle,\n      css`\n        .edit-entity-row-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          font-size: 18px;\n        }\n\n        hui-header-footer-editor {\n          padding-top: 4px;\n        }\n      `,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-entities-card-editor\": HuiEntitiesCardEditor;\n  }\n}\n","import \"@polymer/paper-input/paper-input\";\nimport { CSSResultGroup, html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { assert } from \"superstruct\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\nimport { computeDomain } from \"../../../../common/entity/compute_domain\";\nimport { domainIcon } from \"../../../../common/entity/domain_icon\";\nimport \"../../../../components/ha-formfield\";\nimport \"../../../../components/ha-icon-picker\";\nimport \"../../../../components/ha-switch\";\nimport { HomeAssistant } from \"../../../../types\";\nimport { EntitiesCardEntityConfig } from \"../../cards/types\";\nimport \"../../components/hui-action-editor\";\nimport \"../../components/hui-entity-editor\";\nimport \"../../components/hui-theme-select-editor\";\nimport { LovelaceRowEditor } from \"../../types\";\nimport { entitiesConfigStruct } from \"../structs/entities-struct\";\nimport { EditorTarget, EntitiesEditorEvent } from \"../types\";\nimport { configElementStyle } from \"./config-elements-style\";\n\nconst SecondaryInfoValues: { [key: string]: { domains?: string[] } } = {\n  \"entity-id\": {},\n  \"last-changed\": {},\n  \"last-updated\": {},\n  \"last-triggered\": { domains: [\"automation\", \"script\"] },\n  position: { domains: [\"cover\"] },\n  \"tilt-position\": { domains: [\"cover\"] },\n  brightness: { domains: [\"light\"] },\n};\n\n@customElement(\"hui-generic-entity-row-editor\")\nexport class HuiGenericEntityRowEditor\n  extends LitElement\n  implements LovelaceRowEditor\n{\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @state() private _config?: EntitiesCardEntityConfig;\n\n  public setConfig(config: EntitiesCardEntityConfig): void {\n    assert(config, entitiesConfigStruct);\n    this._config = config;\n  }\n\n  get _entity(): string {\n    return this._config!.entity || \"\";\n  }\n\n  get _name(): string {\n    return this._config!.name || \"\";\n  }\n\n  get _icon(): string {\n    return this._config!.icon || \"\";\n  }\n\n  get _secondary_info(): string {\n    return this._config!.secondary_info || \"\";\n  }\n\n  protected render(): TemplateResult {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n\n    const domain = computeDomain(this._entity);\n    const entityState = this.hass.states[this._entity];\n\n    return html`\n      <div class=\"card-config\">\n        <ha-entity-picker\n          allow-custom-entity\n          .hass=${this.hass}\n          .value=${this._config.entity}\n          .configValue=${\"entity\"}\n          @change=${this._valueChanged}\n        ></ha-entity-picker>\n        <div class=\"side-by-side\">\n          <paper-input\n            .label=${this.hass!.localize(\n              \"ui.panel.lovelace.editor.card.generic.name\"\n            )}\n            .value=${this._config.name}\n            .configValue=${\"name\"}\n            @value-changed=${this._valueChanged}\n          ></paper-input>\n          <ha-icon-picker\n            .label=${this.hass!.localize(\n              \"ui.panel.lovelace.editor.card.generic.icon\"\n            )}\n            .value=${this._config.icon}\n            .configValue=${\"icon\"}\n            .placeholder=${entityState?.attributes.icon}\n            .fallbackPath=${!this._icon &&\n            !entityState?.attributes.icon &&\n            entityState\n              ? domainIcon(computeDomain(entityState.entity_id), entityState)\n              : undefined}\n            @value-changed=${this._valueChanged}\n          ></ha-icon-picker>\n        </div>\n        <paper-dropdown-menu .label=${\"Secondary Info\"}>\n          <paper-listbox\n            slot=\"dropdown-content\"\n            attr-for-selected=\"value\"\n            .selected=${this._config.secondary_info || \"none\"}\n            .configValue=${\"secondary_info\"}\n            @iron-select=${this._valueChanged}\n          >\n            <paper-item value=\"\"\n              >${this.hass!.localize(\n                \"ui.panel.lovelace.editor.card.entities.secondary_info_values.none\"\n              )}</paper-item\n            >\n            ${Object.keys(SecondaryInfoValues).map((info) => {\n              if (\n                !(\"domains\" in SecondaryInfoValues[info]) ||\n                (\"domains\" in SecondaryInfoValues[info] &&\n                  SecondaryInfoValues[info].domains!.includes(domain))\n              ) {\n                return html`\n                  <paper-item .value=${info}\n                    >${this.hass!.localize(\n                      `ui.panel.lovelace.editor.card.entities.secondary_info_values.${info}`\n                    )}</paper-item\n                  >\n                `;\n              }\n              return \"\";\n            })}\n          </paper-listbox>\n        </paper-dropdown-menu>\n      </div>\n    `;\n  }\n\n  private _valueChanged(ev: EntitiesEditorEvent): void {\n    if (!this._config || !this.hass) {\n      return;\n    }\n    const target = ev.target! as EditorTarget;\n    const value = target.value || ev.detail?.item?.value;\n\n    if (this[`_${target.configValue}`] === value) {\n      return;\n    }\n\n    if (target.configValue) {\n      if (value === \"\" || !value) {\n        this._config = { ...this._config };\n        delete this._config[target.configValue!];\n      } else {\n        this._config = {\n          ...this._config,\n          [target.configValue!]: value,\n        };\n      }\n    }\n\n    fireEvent(this, \"config-changed\", { config: this._config });\n  }\n\n  static get styles(): CSSResultGroup {\n    return configElementStyle;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-generic-entity-row-editor\": HuiGenericEntityRowEditor;\n  }\n}\n","import { mdiClose, mdiPencil, mdiPlus } from \"@mdi/js\";\nimport \"@polymer/paper-item/paper-item\";\nimport \"@polymer/paper-listbox/paper-listbox\";\nimport { css, CSSResultGroup, html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\nimport \"../../../../components/ha-icon-button\";\nimport type { LovelaceConfig } from \"../../../../data/lovelace\";\nimport type { HomeAssistant } from \"../../../../types\";\nimport type { LovelaceHeaderFooterConfig } from \"../../header-footer/types\";\nimport { showCreateHeaderFooterDialog } from \"./show-create-headerfooter-dialog\";\n\n@customElement(\"hui-header-footer-editor\")\nexport class HuiHeaderFooterEditor extends LitElement {\n  public hass!: HomeAssistant;\n\n  public lovelaceConfig!: LovelaceConfig;\n\n  @property({ attribute: false }) public config?: LovelaceHeaderFooterConfig;\n\n  @property() public configValue!: \"header\" | \"footer\";\n\n  protected render(): TemplateResult {\n    return html`\n      <div>\n        <span>\n          ${this.hass.localize(\n            `ui.panel.lovelace.editor.header-footer.${this.configValue}`\n          )}:\n          ${!this.config?.type\n            ? this.hass!.localize(\"ui.panel.lovelace.editor.common.none\")\n            : this.hass!.localize(\n                `ui.panel.lovelace.editor.header-footer.types.${this.config?.type}.name`\n              )}\n        </span>\n      </div>\n      <div>\n        ${!this.config?.type\n          ? html`\n              <ha-icon-button\n                .label=${this.hass!.localize(\n                  \"ui.panel.lovelace.editor.common.add\"\n                )}\n                .path=${mdiPlus}\n                class=\"add-icon\"\n                @click=${this._add}\n              ></ha-icon-button>\n            `\n          : html`\n              <ha-icon-button\n                .label=${this.hass!.localize(\n                  \"ui.panel.lovelace.editor.common.clear\"\n                )}\n                .path=${mdiClose}\n                class=\"remove-icon\"\n                @click=${this._delete}\n              ></ha-icon-button>\n              <ha-icon-button\n                .label=${this.hass!.localize(\n                  \"ui.panel.lovelace.editor.common.edit\"\n                )}\n                .path=${mdiPencil}\n                class=\"edit-icon\"\n                @click=${this._edit}\n              ></ha-icon-button>\n            `}\n      </div>\n    `;\n  }\n\n  private _edit(): void {\n    fireEvent(this, \"edit-detail-element\", {\n      subElementConfig: {\n        elementConfig: this.config,\n        type: this.configValue,\n      },\n    });\n  }\n\n  private _add(): void {\n    showCreateHeaderFooterDialog(this, {\n      pickHeaderFooter: (config) => this._elementPicked(config),\n      type: this.configValue,\n    });\n  }\n\n  private _elementPicked(config: LovelaceHeaderFooterConfig): void {\n    fireEvent(this, \"value-changed\", { value: config });\n    fireEvent(this, \"edit-detail-element\", {\n      subElementConfig: {\n        elementConfig: config,\n        type: this.configValue,\n      },\n    });\n  }\n\n  private _delete(): void {\n    fireEvent(this, \"value-changed\", { value: \"\" });\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      :host {\n        font-size: 16px;\n        display: flex;\n        flex-wrap: wrap;\n        justify-content: space-between;\n        align-items: center;\n        padding-bottom: 12px;\n      }\n\n      :host > div {\n        display: flex;\n        align-items: center;\n      }\n\n      ha-icon-button,\n      .header-footer-icon {\n        --mdc-icon-button-size: 36px;\n        color: var(--secondary-text-color);\n      }\n\n      .header-footer-icon {\n        padding-right: 8px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-header-footer-editor\": HuiHeaderFooterEditor;\n  }\n}\n","import \"@material/mwc-button\";\nimport { dump, load } from \"js-yaml\";\nimport {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { property, state, query } from \"lit/decorators\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { handleStructError } from \"../../../common/structs/handle-errors\";\nimport { computeRTL } from \"../../../common/util/compute_rtl\";\nimport { deepEqual } from \"../../../common/util/deep-equal\";\nimport \"../../../components/ha-circular-progress\";\nimport \"../../../components/ha-code-editor\";\nimport \"../../../components/ha-alert\";\nimport type { HaCodeEditor } from \"../../../components/ha-code-editor\";\nimport type {\n  LovelaceCardConfig,\n  LovelaceConfig,\n} from \"../../../data/lovelace\";\nimport type { HomeAssistant } from \"../../../types\";\nimport type { LovelaceRowConfig } from \"../entity-rows/types\";\nimport { LovelaceHeaderFooterConfig } from \"../header-footer/types\";\nimport type { LovelaceGenericElementEditor } from \"../types\";\nimport \"./config-elements/hui-generic-entity-row-editor\";\nimport { GUISupportError } from \"./gui-support-error\";\nimport { EditSubElementEvent, GUIModeChangedEvent } from \"./types\";\n\nexport interface ConfigChangedEvent {\n  config: LovelaceCardConfig | LovelaceRowConfig | LovelaceHeaderFooterConfig;\n  error?: string;\n  guiModeAvailable?: boolean;\n}\n\ndeclare global {\n  interface HASSDomEvents {\n    \"config-changed\": ConfigChangedEvent;\n    \"GUImode-changed\": GUIModeChangedEvent;\n    \"edit-detail-element\": EditSubElementEvent;\n  }\n}\n\nexport interface UIConfigChangedEvent extends Event {\n  detail: {\n    config: LovelaceCardConfig | LovelaceRowConfig | LovelaceHeaderFooterConfig;\n  };\n}\n\nexport abstract class HuiElementEditor<T> extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ attribute: false }) public lovelace?: LovelaceConfig;\n\n  @state() private _yaml?: string;\n\n  @state() private _config?: T;\n\n  @state() private _configElement?: LovelaceGenericElementEditor;\n\n  @state() private _configElementType?: string;\n\n  @state() private _guiMode = true;\n\n  // Error: Configuration broken - do not save\n  @state() private _errors?: string[];\n\n  // Warning: GUI editor can't handle configuration - ok to save\n  @state() private _warnings?: string[];\n\n  @state() private _guiSupported?: boolean;\n\n  @state() private _loading = false;\n\n  @query(\"ha-code-editor\") _yamlEditor?: HaCodeEditor;\n\n  public get yaml(): string {\n    if (!this._yaml) {\n      this._yaml = dump(this._config);\n    }\n    return this._yaml || \"\";\n  }\n\n  public set yaml(_yaml: string) {\n    this._yaml = _yaml;\n    try {\n      this._config = load(this.yaml) as any;\n      this._errors = undefined;\n    } catch (err: any) {\n      this._errors = [err.message];\n    }\n    this._setConfig();\n  }\n\n  public get value(): T | undefined {\n    return this._config;\n  }\n\n  public set value(config: T | undefined) {\n    if (this._config && deepEqual(config, this._config)) {\n      return;\n    }\n    this._config = config;\n    this._yaml = undefined;\n    this._errors = undefined;\n    this._setConfig();\n  }\n\n  private _setConfig(): void {\n    if (!this._errors) {\n      try {\n        this._updateConfigElement();\n      } catch (err: any) {\n        this._errors = [err.message];\n      }\n    }\n\n    fireEvent(this, \"config-changed\", {\n      config: this.value! as any,\n      error: this._errors?.join(\", \"),\n      guiModeAvailable: !(\n        this.hasWarning ||\n        this.hasError ||\n        this._guiSupported === false\n      ),\n    });\n  }\n\n  public get hasWarning(): boolean {\n    return this._warnings !== undefined && this._warnings.length > 0;\n  }\n\n  public get hasError(): boolean {\n    return this._errors !== undefined && this._errors.length > 0;\n  }\n\n  public get GUImode(): boolean {\n    return this._guiMode;\n  }\n\n  public set GUImode(guiMode: boolean) {\n    this._guiMode = guiMode;\n    fireEvent(this as HTMLElement, \"GUImode-changed\", {\n      guiMode,\n      guiModeAvailable: !(\n        this.hasWarning ||\n        this.hasError ||\n        this._guiSupported === false\n      ),\n    });\n  }\n\n  public toggleMode() {\n    this.GUImode = !this.GUImode;\n  }\n\n  public focusYamlEditor() {\n    if (this._configElement?.focusYamlEditor) {\n      this._configElement.focusYamlEditor();\n    }\n    if (!this._yamlEditor?.codemirror) {\n      return;\n    }\n    this._yamlEditor.codemirror.focus();\n  }\n\n  protected async getConfigElement(): Promise<\n    LovelaceGenericElementEditor | undefined\n  > {\n    return undefined;\n  }\n\n  protected get configElementType(): string | undefined {\n    return this.value ? (this.value as any).type : undefined;\n  }\n\n  protected render(): TemplateResult {\n    return html`\n      <div class=\"wrapper\">\n        ${this.GUImode\n          ? html`\n              <div class=\"gui-editor\">\n                ${this._loading\n                  ? html`\n                      <ha-circular-progress\n                        active\n                        alt=\"Loading\"\n                        class=\"center margin-bot\"\n                      ></ha-circular-progress>\n                    `\n                  : this._configElement}\n              </div>\n            `\n          : html`\n              <div class=\"yaml-editor\">\n                <ha-code-editor\n                  mode=\"yaml\"\n                  autofocus\n                  .value=${this.yaml}\n                  .error=${Boolean(this._errors)}\n                  .rtl=${computeRTL(this.hass)}\n                  @value-changed=${this._handleYAMLChanged}\n                  @keydown=${this._ignoreKeydown}\n                ></ha-code-editor>\n              </div>\n            `}\n        ${this._guiSupported === false && this.configElementType\n          ? html`\n              <div class=\"info\">\n                ${this.hass.localize(\n                  \"ui.errors.config.editor_not_available\",\n                  \"type\",\n                  this.configElementType\n                )}\n              </div>\n            `\n          : \"\"}\n        ${this.hasError\n          ? html`\n              <div class=\"error\">\n                ${this.hass.localize(\"ui.errors.config.error_detected\")}:\n                <br />\n                <ul>\n                  ${this._errors!.map((error) => html`<li>${error}</li>`)}\n                </ul>\n              </div>\n            `\n          : \"\"}\n        ${this.hasWarning\n          ? html`\n              <ha-alert\n                alert-type=\"warning\"\n                .title=\"${this.hass.localize(\n                  \"ui.errors.config.editor_not_supported\"\n                )}:\"\n              >\n                ${this._warnings!.length > 0 && this._warnings![0] !== undefined\n                  ? html` <ul>\n                      ${this._warnings!.map(\n                        (warning) => html`<li>${warning}</li>`\n                      )}\n                    </ul>`\n                  : \"\"}\n                ${this.hass.localize(\"ui.errors.config.edit_in_yaml_supported\")}\n              </ha-alert>\n            `\n          : \"\"}\n      </div>\n    `;\n  }\n\n  protected updated(changedProperties: PropertyValues) {\n    super.updated(changedProperties);\n\n    if (this._configElement && changedProperties.has(\"hass\")) {\n      this._configElement.hass = this.hass;\n    }\n    if (\n      this._configElement &&\n      \"lovelace\" in this._configElement &&\n      changedProperties.has(\"lovelace\")\n    ) {\n      this._configElement.lovelace = this.lovelace;\n    }\n  }\n\n  private _handleUIConfigChanged(ev: UIConfigChangedEvent) {\n    ev.stopPropagation();\n    const config = ev.detail.config;\n    this.value = config as unknown as T;\n  }\n\n  private _handleYAMLChanged(ev: CustomEvent) {\n    ev.stopPropagation();\n    const newYaml = ev.detail.value;\n    if (newYaml !== this.yaml) {\n      this.yaml = newYaml;\n    }\n  }\n\n  private async _updateConfigElement(): Promise<void> {\n    if (!this.value) {\n      return;\n    }\n\n    let configElement: LovelaceGenericElementEditor | undefined;\n\n    try {\n      this._errors = undefined;\n      this._warnings = undefined;\n\n      if (this._configElementType !== this.configElementType) {\n        // If the type has changed, we need to load a new GUI editor\n        this._guiSupported = undefined;\n        this._configElement = undefined;\n\n        if (!this.configElementType) {\n          throw new Error(\n            this.hass.localize(\"ui.errors.config.no_type_provided\")\n          );\n        }\n\n        this._configElementType = this.configElementType;\n\n        this._loading = true;\n        configElement = await this.getConfigElement();\n\n        if (configElement) {\n          configElement.hass = this.hass;\n          if (\"lovelace\" in configElement) {\n            configElement.lovelace = this.lovelace;\n          }\n          configElement.addEventListener(\"config-changed\", (ev) =>\n            this._handleUIConfigChanged(ev as UIConfigChangedEvent)\n          );\n\n          this._configElement = configElement;\n          this._guiSupported = true;\n        }\n      }\n\n      if (this._configElement) {\n        // Setup GUI editor and check that it can handle the current config\n        try {\n          this._configElement.setConfig(this.value);\n        } catch (err: any) {\n          const msgs = handleStructError(this.hass, err);\n          throw new GUISupportError(\n            \"Config is not supported\",\n            msgs.warnings,\n            msgs.errors\n          );\n        }\n      } else {\n        this.GUImode = false;\n      }\n    } catch (err: any) {\n      if (err instanceof GUISupportError) {\n        this._warnings = err.warnings ?? [err.message];\n        this._errors = err.errors || undefined;\n      } else {\n        this._errors = [err.message];\n      }\n      this.GUImode = false;\n    } finally {\n      this._loading = false;\n    }\n  }\n\n  private _ignoreKeydown(ev: KeyboardEvent) {\n    ev.stopPropagation();\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      :host {\n        display: flex;\n      }\n      .wrapper {\n        width: 100%;\n      }\n      .gui-editor,\n      .yaml-editor {\n        padding: 8px 0px;\n      }\n      ha-code-editor {\n        --code-mirror-max-height: calc(100vh - 245px);\n      }\n      .error,\n      .warning,\n      .info {\n        word-break: break-word;\n        margin-top: 8px;\n      }\n      .error {\n        color: var(--error-color);\n      }\n      .warning {\n        color: var(--warning-color);\n      }\n      .warning ul,\n      .error ul {\n        margin: 4px 0;\n      }\n      .warning li,\n      .error li {\n        white-space: pre-wrap;\n      }\n      ha-circular-progress {\n        display: block;\n        margin: auto;\n      }\n    `;\n  }\n}\n","import { mdiClose, mdiDrag, mdiPencil } from \"@mdi/js\";\nimport {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { guard } from \"lit/directives/guard\";\nimport type { SortableEvent } from \"sortablejs\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport \"../../../components/entity/ha-entity-picker\";\nimport type { HaEntityPicker } from \"../../../components/entity/ha-entity-picker\";\nimport \"../../../components/ha-icon-button\";\nimport \"../../../components/ha-svg-icon\";\nimport { sortableStyles } from \"../../../resources/ha-sortable-style\";\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityConfig, LovelaceRowConfig } from \"../entity-rows/types\";\n\nlet Sortable;\n\ndeclare global {\n  interface HASSDomEvents {\n    \"entities-changed\": {\n      entities: LovelaceRowConfig[];\n    };\n  }\n}\n\n@customElement(\"hui-entities-card-row-editor\")\nexport class HuiEntitiesCardRowEditor extends LitElement {\n  @property({ attribute: false }) protected hass?: HomeAssistant;\n\n  @property({ attribute: false }) protected entities?: LovelaceRowConfig[];\n\n  @property() protected label?: string;\n\n  @state() private _attached = false;\n\n  @state() private _renderEmptySortable = false;\n\n  private _sortable?;\n\n  public connectedCallback() {\n    super.connectedCallback();\n    this._attached = true;\n  }\n\n  public disconnectedCallback() {\n    super.disconnectedCallback();\n    this._attached = false;\n  }\n\n  protected render(): TemplateResult {\n    if (!this.entities || !this.hass) {\n      return html``;\n    }\n\n    return html`\n      <h3>\n        ${this.label ||\n        `${this.hass!.localize(\n          \"ui.panel.lovelace.editor.card.generic.entities\"\n        )} (${this.hass!.localize(\n          \"ui.panel.lovelace.editor.card.config.required\"\n        )})`}\n      </h3>\n      <div class=\"entities\">\n        ${guard([this.entities, this._renderEmptySortable], () =>\n          this._renderEmptySortable\n            ? \"\"\n            : this.entities!.map(\n                (entityConf, index) => html`\n                  <div class=\"entity\">\n                    <ha-svg-icon class=\"handle\" .path=${mdiDrag}></ha-svg-icon>\n                    ${entityConf.type\n                      ? html`\n                          <div class=\"special-row\">\n                            <div>\n                              <span>\n                                ${this.hass!.localize(\n                                  `ui.panel.lovelace.editor.card.entities.entity_row.${entityConf.type}`\n                                )}\n                              </span>\n                              <span class=\"secondary\"\n                                >${this.hass!.localize(\n                                  \"ui.panel.lovelace.editor.card.entities.edit_special_row\"\n                                )}</span\n                              >\n                            </div>\n                          </div>\n                        `\n                      : html`\n                          <ha-entity-picker\n                            allow-custom-entity\n                            hideClearIcon\n                            .hass=${this.hass}\n                            .value=${(entityConf as EntityConfig).entity}\n                            .index=${index}\n                            @value-changed=${this._valueChanged}\n                          ></ha-entity-picker>\n                        `}\n                    <ha-icon-button\n                      .label=${this.hass!.localize(\n                        \"ui.components.entity.entity-picker.clear\"\n                      )}\n                      .path=${mdiClose}\n                      class=\"remove-icon\"\n                      .index=${index}\n                      @click=${this._removeRow}\n                    ></ha-icon-button>\n                    <ha-icon-button\n                      .label=${this.hass!.localize(\n                        \"ui.components.entity.entity-picker.edit\"\n                      )}\n                      .path=${mdiPencil}\n                      class=\"edit-icon\"\n                      .index=${index}\n                      @click=${this._editRow}\n                    ></ha-icon-button>\n                  </div>\n                `\n              )\n        )}\n      </div>\n      <ha-entity-picker\n        .hass=${this.hass}\n        @value-changed=${this._addEntity}\n      ></ha-entity-picker>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n\n    const attachedChanged = changedProps.has(\"_attached\");\n    const entitiesChanged = changedProps.has(\"entities\");\n\n    if (!entitiesChanged && !attachedChanged) {\n      return;\n    }\n\n    if (attachedChanged && !this._attached) {\n      // Tear down sortable, if available\n      this._sortable?.destroy();\n      this._sortable = undefined;\n      return;\n    }\n\n    if (!this._sortable && this.entities) {\n      this._createSortable();\n      return;\n    }\n\n    if (entitiesChanged) {\n      this._handleEntitiesChanged();\n    }\n  }\n\n  private async _handleEntitiesChanged() {\n    this._renderEmptySortable = true;\n    await this.updateComplete;\n    const container = this.shadowRoot!.querySelector(\".entities\")!;\n    while (container.lastElementChild) {\n      container.removeChild(container.lastElementChild);\n    }\n    this._renderEmptySortable = false;\n  }\n\n  private async _createSortable() {\n    if (!Sortable) {\n      const sortableImport = await import(\n        \"sortablejs/modular/sortable.core.esm\"\n      );\n\n      Sortable = sortableImport.Sortable;\n      Sortable.mount(sortableImport.OnSpill);\n      Sortable.mount(sortableImport.AutoScroll());\n    }\n\n    this._sortable = new Sortable(this.shadowRoot!.querySelector(\".entities\"), {\n      animation: 150,\n      fallbackClass: \"sortable-fallback\",\n      handle: \".handle\",\n      onEnd: async (evt: SortableEvent) => this._rowMoved(evt),\n    });\n  }\n\n  private async _addEntity(ev: CustomEvent): Promise<void> {\n    const value = ev.detail.value;\n    if (value === \"\") {\n      return;\n    }\n    const newConfigEntities = this.entities!.concat({\n      entity: value as string,\n    });\n    (ev.target as HaEntityPicker).value = \"\";\n    fireEvent(this, \"entities-changed\", { entities: newConfigEntities });\n  }\n\n  private _rowMoved(ev: SortableEvent): void {\n    if (ev.oldIndex === ev.newIndex) {\n      return;\n    }\n\n    const newEntities = this.entities!.concat();\n\n    newEntities.splice(ev.newIndex!, 0, newEntities.splice(ev.oldIndex!, 1)[0]);\n\n    fireEvent(this, \"entities-changed\", { entities: newEntities });\n  }\n\n  private _removeRow(ev: CustomEvent): void {\n    const index = (ev.currentTarget as any).index;\n    const newConfigEntities = this.entities!.concat();\n\n    newConfigEntities.splice(index, 1);\n\n    fireEvent(this, \"entities-changed\", { entities: newConfigEntities });\n  }\n\n  private _valueChanged(ev: CustomEvent): void {\n    const value = ev.detail.value;\n    const index = (ev.target as any).index;\n    const newConfigEntities = this.entities!.concat();\n\n    if (value === \"\") {\n      newConfigEntities.splice(index, 1);\n    } else {\n      newConfigEntities[index] = {\n        ...newConfigEntities[index],\n        entity: value!,\n      };\n    }\n\n    fireEvent(this, \"entities-changed\", { entities: newConfigEntities });\n  }\n\n  private _editRow(ev: CustomEvent): void {\n    const index = (ev.currentTarget as any).index;\n    fireEvent(this, \"edit-detail-element\", {\n      subElementConfig: {\n        index,\n        type: \"row\",\n        elementConfig: this.entities![index],\n      },\n    });\n  }\n\n  static get styles(): CSSResultGroup {\n    return [\n      sortableStyles,\n      css`\n        .entity {\n          display: flex;\n          align-items: center;\n        }\n\n        .entity .handle {\n          padding-right: 8px;\n          cursor: move;\n        }\n\n        .entity ha-entity-picker {\n          flex-grow: 1;\n        }\n\n        .special-row {\n          height: 60px;\n          font-size: 16px;\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          flex-grow: 1;\n        }\n\n        .special-row div {\n          display: flex;\n          flex-direction: column;\n        }\n\n        .remove-icon,\n        .edit-icon {\n          --mdc-icon-button-size: 36px;\n          color: var(--secondary-text-color);\n        }\n\n        .secondary {\n          font-size: 12px;\n          color: var(--secondary-text-color);\n        }\n      `,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-entities-card-row-editor\": HuiEntitiesCardRowEditor;\n  }\n}\n","import \"@material/mwc-button\";\nimport { mdiArrowLeft } from \"@mdi/js\";\nimport { css, CSSResultGroup, html, LitElement, TemplateResult } from \"lit\";\nimport { customElement, property, state, query } from \"lit/decorators\";\nimport { fireEvent, HASSDomEvent } from \"../../../common/dom/fire_event\";\nimport \"../../../components/ha-icon-button\";\nimport type { HomeAssistant } from \"../../../types\";\nimport type { LovelaceRowConfig } from \"../entity-rows/types\";\nimport type { LovelaceHeaderFooterConfig } from \"../header-footer/types\";\nimport \"./entity-row-editor/hui-row-element-editor\";\nimport \"./header-footer-editor/hui-header-footer-element-editor\";\nimport type { HuiElementEditor } from \"./hui-element-editor\";\nimport type { GUIModeChangedEvent, SubElementEditorConfig } from \"./types\";\n\ndeclare global {\n  interface HASSDomEvents {\n    \"go-back\": undefined;\n  }\n}\n\n@customElement(\"hui-sub-element-editor\")\nexport class HuiSubElementEditor extends LitElement {\n  public hass!: HomeAssistant;\n\n  @property({ attribute: false }) public config!: SubElementEditorConfig;\n\n  @state() private _guiModeAvailable = true;\n\n  @state() private _guiMode = true;\n\n  @query(\".editor\") private _editorElement?: HuiElementEditor<\n    LovelaceRowConfig | LovelaceHeaderFooterConfig\n  >;\n\n  protected render(): TemplateResult {\n    return html`\n      <div class=\"header\">\n        <div class=\"back-title\">\n          <ha-icon-button\n            .label=${this.hass!.localize(\"ui.common.back\")}\n            .path=${mdiArrowLeft}\n            @click=${this._goBack}\n          ></ha-icon-button>\n          <span slot=\"title\"\n            >${this.hass.localize(\n              `ui.panel.lovelace.editor.sub-element-editor.types.${this.config?.type}`\n            )}</span\n          >\n        </div>\n        <mwc-button\n          slot=\"secondaryAction\"\n          .disabled=${!this._guiModeAvailable}\n          @click=${this._toggleMode}\n        >\n          ${this.hass.localize(\n            this._guiMode\n              ? \"ui.panel.lovelace.editor.edit_card.show_code_editor\"\n              : \"ui.panel.lovelace.editor.edit_card.show_visual_editor\"\n          )}\n        </mwc-button>\n      </div>\n      ${this.config.type === \"row\"\n        ? html`\n            <hui-row-element-editor\n              class=\"editor\"\n              .hass=${this.hass}\n              .value=${this.config.elementConfig}\n              @config-changed=${this._handleConfigChanged}\n              @GUImode-changed=${this._handleGUIModeChanged}\n            ></hui-row-element-editor>\n          `\n        : this.config.type === \"header\" || this.config.type === \"footer\"\n        ? html`\n            <hui-headerfooter-element-editor\n              class=\"editor\"\n              .hass=${this.hass}\n              .value=${this.config.elementConfig}\n              @config-changed=${this._handleConfigChanged}\n              @GUImode-changed=${this._handleGUIModeChanged}\n            ></hui-headerfooter-element-editor>\n          `\n        : \"\"}\n    `;\n  }\n\n  private _goBack(): void {\n    fireEvent(this, \"go-back\");\n  }\n\n  private _toggleMode(): void {\n    this._editorElement?.toggleMode();\n  }\n\n  private _handleGUIModeChanged(ev: HASSDomEvent<GUIModeChangedEvent>): void {\n    ev.stopPropagation();\n    this._guiMode = ev.detail.guiMode;\n    this._guiModeAvailable = ev.detail.guiModeAvailable;\n  }\n\n  private _handleConfigChanged(ev: CustomEvent): void {\n    this._guiModeAvailable = ev.detail.guiModeAvailable;\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      .header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n      }\n      .back-title {\n        display: flex;\n        align-items: center;\n        font-size: 18px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-sub-element-editor\": HuiSubElementEditor;\n  }\n}\n"],"names":[],"sourceRoot":""}